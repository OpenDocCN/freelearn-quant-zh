- en: '4'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '4  '
- en: Derivative Valuation
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '衍生品估值  '
- en: Derivatives pricing is one of the most crucial aspects of quantitative finance.
    The gross market value of derivatives contracts stood at $12.4 trillion (*OTC
    derivatives statistics at end-December 2021* – [bis.org](http://bis.org)), making
    it one of the most lucrative and challenging problems to simulate and optimize.
    Although many aspects of derivative pricing can be computed using classical computing,
    gate-based quantum computers can be an efficient resource when multiple computations
    are required, due to their ability to parallelize and handle multiple assets.
    This chapter looks into the theoretical aspects of derivatives pricing and examines
    its real-time applications through classical computing and gate-based quantum
    computers.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '衍生品定价是量化金融中最重要的方面之一。衍生品合约的总市场价值为12.4万亿美元（*2021年12月底场外衍生品统计数据* —— [bis.org](http://bis.org)），使其成为最有利可图且最具挑战性的模拟与优化问题之一。尽管衍生品定价的许多方面可以通过经典计算来进行，但当需要进行多次计算时，基于门的量子计算机可以作为一种高效资源，因为它们能够并行处理并处理多个资产。本章探讨了衍生品定价的理论方面，并通过经典计算和基于门的量子计算机考察了其实时应用。  '
- en: This chapter addresses the need to explain option pricing from a layman’s point
    of view. Various aspects of option pricing will be described in an easy-to-understand
    manner. Different case studies and anecdotes will be incorporated to make the
    explanation more comprehensive and detailed. The first part covers the theoretical
    aspects of derivatives pricing, while the practical aspects of transitioning to
    more complicated **Quantum Machine Learning** (**QML**) models are also introduced.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '本章讨论了从普通人角度解释期权定价的必要性。期权定价的各个方面将以易于理解的方式进行描述。不同的案例研究和轶事将被融入，以使解释更加全面和详细。第一部分涵盖了衍生品定价的理论方面，同时也介绍了过渡到更复杂的**量子机器学习**（**QML**）模型的实际方面。  '
- en: In subsequent sections, we will see a demo example of implementing options pricing
    using classical and quantum computing. The valuation of a plain vanilla option
    will be derived using the classical Monte Carlo simulation method. Afterward,
    a comprehensive case study with code snippets will help you understand the implementation
    of mathematical modeling of derivatives pricing on quantum computing.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在后续部分，我们将看到一个使用经典计算和量子计算实现期权定价的演示示例。我们将通过经典的蒙特卡洛模拟方法推导出一个普通期权的估值。随后，一个包含代码片段的全面案例研究将帮助你理解如何在量子计算上实现衍生品定价的数学建模。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '本章将涵盖以下主题：  '
- en: Derivatives pricing – the theoretical aspects
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '衍生品定价——理论方面  '
- en: Classical implementation of the Monte Carlo simulation for derivatives valuation
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '衍生品估值的经典蒙特卡洛模拟实现  '
- en: A quantum computing algorithm for derivatives valuation
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '衍生品估值的量子计算算法  '
- en: Derivatives pricing – the theoretical aspects
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '衍生品定价——理论方面  '
- en: Learning the factors that go into setting derivatives pricing is crucial. An
    in-depth knowledge of financial product pricing is essential to make sound investing
    decisions, whether you’re on the buying or selling side of the market. After all,
    knowing how a product’s attributes interact to produce value is necessary to decide
    what to offer or bid for a financial product. It is crucial to comprehend the
    price of financial assets. The capital asset pricing model and its variants, based
    on discounted cash flow, help establish values for financial assets. However,
    unlike traditional assets such as stocks and bonds, derivatives have their challenges,
    but they also have several unexpectedly straightforward properties. In the next
    section, we will discuss the important concept of money’s time value, which forms
    the basis for securities pricing.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '学习衍生品定价所涉及的因素至关重要。深入了解金融产品定价对于做出明智的投资决策至关重要，无论你是在市场的买方还是卖方。毕竟，了解一个产品的属性如何相互作用以产生价值，对于决定提供或竞标一个金融产品是必要的。理解金融资产的价格至关重要。资本资产定价模型及其基于贴现现金流的变体帮助确定金融资产的价值。然而，与传统资产如股票和债券不同，衍生品有其挑战，但也具有一些出乎意料的简单特性。在接下来的部分，我们将讨论货币的时间价值这一重要概念，这为证券定价奠定了基础。  '
- en: The time value of money
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '货币的时间价值  '
- en: The value of money fluctuates over time. What does this imply in detail? If
    you had the choice between getting $100 now or $100 a year from now, which would
    you choose? The majority would probably get the $100 as quickly as feasible (today).
    The further a cash flow is in the future, the less valuable it becomes. A similar
    approach may be extended to compare the values of cash flows at various times.
    Let’s say we want to get $100 one year instead of two years from now. Mathematically,
    a risk-free interest rate is to blame for the temporal variation in the value
    of money. The quicker funds are received, the quicker interest may be collected.
    Calculating the present value of the cash flows and comparing them makes it possible
    to compare various amounts of money at different dates.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 金钱的价值随着时间波动。这具体意味着什么呢？假设你可以选择现在拿到100美元，或者一年后拿到100美元，你会选择哪一个？大多数人可能会选择尽快拿到100美元（也就是今天）。现金流越远离现在，它的价值就越低。类似的方法可以用来比较不同时间点现金流的价值。假设我们希望一年后得到100美元，而不是两年后。数学上，风险无关的利率是金钱价值随时间变化的原因。资金获得得越快，所能获得的利息就越快。通过计算现金流的现值并进行比较，我们可以比较在不同日期得到的不同金额的价值。
- en: Case study one
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 案例研究一
- en: The time value of money is a key concept in finance that refers to the idea
    that money today is worth more than the same amount in the future, due to its
    earning potential. This concept is important in many financial decisions, including
    investments, loans, and other transactions. In this essay, we will explore an
    example of the time value of money in the context of a future discounted price,
    with a $450 cash flow for three years at a 10% discount rate.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 时间价值是金融学中的一个关键概念，它指的是今天的金钱比未来相同金额的金钱更有价值，因为它具有赚取回报的潜力。这个概念在许多金融决策中都非常重要，包括投资、贷款和其他交易。在本文中，我们将探讨一个时间价值的例子，背景是一个折现价格的未来案例，假设三年后有一笔450美元的现金流，折现率为10%。
- en: 'Assuming a discount rate of 10%, the present value of a $450 cash flow in three
    years can be calculated using the following formula:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 假设折现率为10%，可以使用以下公式计算三年后450美元现金流的现值：
- en: PV =  FV _ (1 + r) n
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: PV =  FV  *  (1 + r) ^ n
- en: where r represents the discount rate, n refers to the number of periods, and
    PV and FV represent the present and future values respectively.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 其中r代表折现率，n代表期数，PV和FV分别表示现值和未来值。
- en: 'Using this formula, we can calculate the present value of a $450 cash flow
    in three years as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这个公式，我们可以计算出三年后450美元现金流的现值，计算方法如下：
- en: PV =  $450 _ (1 + 0.1) 3
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: PV = 450美元 * (1 + 0.1) ^ 3
- en: PV = $300.30
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: PV = 300.30美元
- en: This means that the present value of a $450 cash flow in three years at a 10%
    discount rate is $300.30\. In other words, if we were to receive $450 in three
    years and wanted to know how much that cash flow is worth today, we would discount
    it back to its present value of $300.30.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着，在10%的折现率下，三年后450美元的现值为300.30美元。换句话说，如果我们将在三年后收到450美元，并且想知道今天这笔现金流的价值，我们将把它折算回今天的现值300.30美元。
- en: 'The time value of money can also be applied to investments. For example, let’s
    say we can invest $1,000 today in a fund that promises to pay a 10% annual return
    for three years. Using the formula to calculate the future value of a lump sum
    investment, we can calculate the future value of this investment as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 时间价值理论也可以应用于投资。例如，假设我们今天投资1000美元于一个承诺三年年回报率为10%的基金。使用公式计算该笔一次性投资的未来价值，我们可以计算出这项投资的未来价值如下：
- en: FV = PV × (1 + r) n
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: FV = PV × (1 + r) ^ n
- en: FV = $1,000 × (1 + 0.1) 3
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: FV = 1000美元 × (1 + 0.1) ^ 3
- en: FV = $1,331
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: FV = 1331美元
- en: If we were to invest $1,000 today at a 10% annual return for three years, the
    investment would be worth $1,331 at the end of the third year.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们今天以10%的年回报率投资1000美元，三年后的投资价值将为1331美元。
- en: Hence, the time value of money is a fundamental concept in finance that plays
    a crucial role in many financial decisions. Whether calculating the present value
    of future cash flows or the future value of investments, understanding the time
    value of money is essential to make informed financial decisions and manage risk
    effectively. By applying the formulas and concepts discussed in this essay, investors
    can make better financial decisions and achieve their financial goals. The following
    passage will discuss a fundamental concept of securities pricing.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，货币的时间价值是金融中的一个基本概念，在许多金融决策中起着至关重要的作用。无论是计算未来现金流的现值，还是计算投资的未来价值，理解货币的时间价值对于做出明智的金融决策和有效管理风险至关重要。通过运用本文讨论的公式和概念，投资者可以做出更好的金融决策，达成财务目标。以下部分将讨论证券定价的一个基本概念。
- en: Securities pricing
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 证券定价
- en: Securities pricing refers to determining the value of financial instruments
    such as stocks, bonds, options, and other investment products. The price of a
    security reflects the supply and demand for that security in the market, which
    is affected by a wide range of factors, including company performance, economic
    conditions, and investor sentiment.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 证券定价是指确定股票、债券、期权及其他投资产品等金融工具的价值。证券的价格反映了市场上对该证券的供求关系，受多种因素的影响，包括公司业绩、经济状况和投资者情绪。
- en: In general, the price of a security is determined through the interaction of
    buyers and sellers in the market. When there are more buyers than sellers, the
    security price goes up, and when there are more sellers than buyers, the price
    goes down.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一般而言，证券的价格是通过市场中买卖双方的互动来决定的。当买方多于卖方时，证券价格会上涨；而当卖方多于买方时，价格则会下跌。
- en: 'There are several methods used to determine the price of securities, including
    the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种方法用于确定证券的价格，包括以下几种：
- en: '**Market-based pricing**: This is the most common method of pricing securities,
    where the price of a security is determined based on its current market value.
    Market-based pricing is often used for publicly traded securities, where prices
    are determined through bidding and trading on an exchange.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**市场定价**：这是最常见的证券定价方法，通过证券的当前市场价值来确定其价格。市场定价通常适用于公开交易的证券，这些证券的价格通过在交易所的竞标和交易来确定。'
- en: '**Fundamental analysis**: This method involves analyzing a company’s financial
    statements and other relevant information to determine its intrinsic value. Fundamental
    analysis considers revenue, earnings, assets, liabilities, and growth potential
    to determine whether a security is undervalued or overvalued.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基本面分析**：该方法通过分析公司财务报表和其他相关信息来确定其内在价值。基本面分析考虑收入、利润、资产、负债和增长潜力等因素，来判断证券是被低估还是高估。'
- en: '**Technical analysis**: This method involves analyzing price and volume data
    to identify patterns and trends that can be used to predict future price movements.
    Technical analysis is often used with fundamental analysis to make investment
    decisions.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**技术分析**：该方法通过分析价格和交易量数据，识别可以用来预测未来价格走势的模式和趋势。技术分析通常与基本面分析结合使用，以做出投资决策。'
- en: '**Options pricing models**: These models use mathematical formulas to determine
    the fair value of options contracts, based on factors such as the underlying asset
    price, the time to expiration, and the underlying asset’s volatility.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**期权定价模型**：这些模型使用数学公式来确定期权合约的公允价值，考虑的因素包括标的资产的价格、到期时间以及标的资产的波动性。'
- en: In addition to these methods, market participants also consider other factors,
    such as interest rates, inflation, geopolitical events, and market sentiment when
    determining the price of securities.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 除了这些方法外，市场参与者在确定证券价格时，还会考虑其他因素，如利率、通货膨胀、地缘政治事件和市场情绪。
- en: Case study two
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 案例研究二
- en: Securities pricing values financial assets such as stocks, bonds, and other
    securities. Market demand, economic conditions, and company performance influence
    securities pricing. Let’s consider an example of securities pricing for a company,
    ABC, that issued a bond with a face value of $1,000 and a coupon rate of 5%, payable
    annually for ten years.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 证券定价是对股票、债券和其他证券等金融资产的定价过程。市场需求、经济状况和公司业绩都会影响证券定价。我们来看一个关于证券定价的例子，假设一家公司ABC发行了一只面值为$1,000，票面利率为5%的债券，每年支付利息，期限为十年。
- en: Step one – determine the market interest rate
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第一步 – 确定市场利率
- en: The market interest rate is the rate of return that investors expect to earn
    on similar securities. Let’s assume that the market interest rate for bonds with
    similar characteristics as ABC’s bond is 6%.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 市场利率是投资者期望从类似证券中获得的回报率。假设与ABC公司债券特征相似的债券的市场利率为6%。
- en: Step two – calculate the present value of the bond
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二步 – 计算债券的现值
- en: 'Using the market interest rate of 6%, we can calculate the present value of
    the bond using the following formula:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 使用6%的市场利率，我们可以通过以下公式计算债券的现值：
- en: PV =  C _ (1 + r) n  +  FV _ (1 + r) n
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: PV =  C _ (1 + r) n  +  FV _ (1 + r) n
- en: 'For ABC’s bond, the annual coupon payment is $50 (5% of $1,000 at face value),
    and the bond matures in 10 years. Using these values and the market interest rate
    of 6%, we can calculate the present value of the bond as follows:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 对于ABC公司的债券，年利息支付为$50（$1,000面值的5%），债券的期限为10年。使用这些数值和6%的市场利率，我们可以计算债券的现值如下：
- en: PV =  $50 _ (1 + 0.06) 1  +  $50 _ (1 + 0.06) 2  + … +  $50 _ (1 + 0.06) 10 
    +  $1,000 _ (1 + 0.06) 10
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: PV =  $50 _ (1 + 0.06) 1  +  $50 _ (1 + 0.06) 2  + … +  $50 _ (1 + 0.06) 10 
    +  $1,000 _ (1 + 0.06) 10
- en: PV =  $50 _ 1.06  +  $50 _ 1.236  + … +  $50 _ 1.791  + $385.54
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: PV =  $50 _ 1.06  +  $50 _ 1.236  + … +  $50 _ 1.791  + $385.54
- en: PV = $850.31
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: PV = $850.31
- en: Step three – determine the market price of the bond
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第三步 – 确定债券的市场价格
- en: The bond’s market price is the present value of the expected cash flows from
    the bond. In this case, the market price of ABC’s bond is $850.31, which is the
    present value of the annual coupon payments and the face value discounted at the
    market interest rate of 6%.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 债券的市场价格是债券预期现金流的现值。在本例中，ABC公司债券的市场价格为$850.31，这是年利息支付和面值按6%的市场利率折现后的现值。
- en: Step four – compare the market price with the face value
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第四步 – 将市场价格与面值进行比较
- en: If the market price is lower than the face value, the bond sells at a discount,
    and if the market price is higher than the face value, the bond sells at a premium.
    In this case, the market price of ABC’s bond is lower than the face value of $1,000,
    which means the bond sells at a discount.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如果市场价格低于面值，则债券以折扣价格出售；如果市场价格高于面值，则债券以溢价出售。在本例中，ABC公司债券的市场价格低于面值$1,000，这意味着该债券以折扣价出售。
- en: Thus, securities pricing is a complex process, involving analyzing various factors
    that influence the value of financial assets. By understanding the principles
    of securities pricing and using the appropriate valuation methods, investors can
    make informed decisions about buying and selling securities to maximize their
    returns and manage risk. The following section will discuss the process and methodology
    involving derivatives pricing.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，证券定价是一个复杂的过程，涉及分析影响金融资产价值的各种因素。通过理解证券定价的原理并使用适当的估值方法，投资者可以做出明智的买卖决策，最大化回报并管理风险。接下来的部分将讨论衍生品定价的过程和方法。
- en: Derivatives pricing
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 衍生品定价
- en: Derivatives pricing is a vital aspect of financial portfolio management. Within
    the vast realm of financial instruments, derivatives, as their name suggests,
    derive value from the asset they are represented by. These assets or securities
    may be represented by stocks, bonds, commodities, or currencies. Derivatives pricing
    involves determining the fair value of these instruments, which can be used for
    trading, hedging, or speculation purposes.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 衍生品定价是金融投资组合管理中的一个重要方面。在广泛的金融工具领域中，衍生品顾名思义，从其所代表的资产中衍生出价值。这些资产或证券可能由股票、债券、商品或货币表示。衍生品定价涉及确定这些工具的公允价值，可用于交易、对冲或投机目的。
- en: Factors that affect derivatives pricing
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 影响衍生品定价的因素
- en: Several factors may affect the price of a given derivative. Relevant drivers
    are the price of the underlying asset, the time to expiration, the volatility
    of the underlying asset, and the interest rate. For example, if the price of the
    underlying asset increases, the price of a call option on that asset will also
    increase, while the price of a put option will decrease. Similarly, if the time
    to expiration increases, the price of an option will also increase. The underlying
    asset’s volatility is also a significant factor in pricing derivatives, as higher
    volatility implies a greater chance of the asset moving in the desired direction.
    Finally, the interest rate can affect the price of a derivative, as it can influence
    the cost of borrowing and the opportunity cost of holding the underlying asset.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个因素可能会影响特定衍生品的价格。相关因素包括标的资产的价格、到期时间、标的资产的波动性和利率。例如，如果标的资产的价格上升，那么该资产的看涨期权的价格也会增加，而看跌期权的价格则会下降。同样，如果到期时间增加，期权的价格也会增加。标的资产的波动性也是定价衍生品的重要因素，因为更高的波动性意味着资产有更大的可能性朝着预期的方向波动。最后，利率也会影响衍生品的价格，因为它会影响借贷成本和持有标的资产的机会成本。
- en: The methods of derivatives pricing
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 衍生品定价的方法
- en: There are several types of pricing derivatives, including the Black-Scholes
    model, the binomial option pricing model, and the Monte Carlo simulation. The
    Black-Scholes model is a mathematical model used to price European-style options,
    which assumes that an underlying asset’s price follows a lognormal distribution.
    The binomial option pricing model is a discrete-time model that uses a tree structure
    to represent the possible outcomes of the underlying asset’s price. The Monte
    Carlo simulation is a stochastic model that uses random sampling to simulate the
    underlying asset’s price path and calculate the derivative’s expected value.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 定价衍生品的方法有几种，包括布莱克-斯科尔斯模型、二项式期权定价模型和蒙特卡罗模拟。布莱克-斯科尔斯模型是一个用于定价欧式期权的数学模型，它假设标的资产的价格遵循对数正态分布。二项式期权定价模型是一个离散时间模型，它使用树状结构表示标的资产价格的可能结果。蒙特卡罗模拟是一个随机模型，它通过随机抽样模拟标的资产的价格路径，并计算衍生品的期望值。
- en: The risks involved in derivatives pricing
  id: totrans-59
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 衍生品定价所涉及的风险
- en: Derivatives pricing involves several risks, including market, credit, and operational
    risks. Market risk arises from changes in an underlying asset’s price, which can
    affect the value of the derivative. Credit risk arises when one party fails to
    fulfill its obligation to the other party, which can lead to default. Operational
    risk arises from errors in the trading, settlement, or accounting of derivatives,
    which can result in financial losses.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 衍生品定价涉及多种风险，包括市场风险、信用风险和操作风险。市场风险源于标的资产价格的变化，这可能影响衍生品的价值。信用风险则是当一方未能履行其对另一方的义务时，可能导致违约。操作风险源于衍生品交易、结算或会计过程中的错误，这可能导致财务损失。
- en: Derivatives pricing is a crucial aspect of financial portfolio management, as
    it allows investors to hedge their risks, speculate on market movements, and create
    customized investment strategies. There are several methods to calculate the price
    of derivatives, including the Black-Scholes model, the binomial option pricing
    model, and the Monte Carlo simulation. However, derivatives pricing also involves
    several risks, including market, credit, and operational risks. Therefore, it
    is essential to thoroughly understand these risks and use appropriate risk management
    strategies to minimize their impact on financial portfolios.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 衍生品定价是金融投资组合管理中的一个关键方面，因为它允许投资者对冲风险、预测市场波动并制定定制化的投资策略。定价衍生品的方法有多种，包括布莱克-斯科尔斯模型、二项式期权定价模型和蒙特卡罗模拟。然而，衍生品定价也涉及多种风险，包括市场风险、信用风险和操作风险。因此，彻底理解这些风险并采取适当的风险管理策略，以将其对金融投资组合的影响降到最低，至关重要。
- en: Case study three
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 案例研究三
- en: One example of securities pricing is the pricing of a stock option. A stock
    option is a derivative that, without the obligation for it, gives the holder the
    right to buy or sell a specific number of shares of a stock. This is done at a
    contract-binding price (known as the strike price) within a specific time frame.
    The price of a stock, as mentioned, may be affected by a number of factors.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 证券定价的一个例子是股票期权的定价。股票期权是一种衍生工具，持有者在没有义务的情况下，拥有在特定时间内以合同约定的价格（即执行价格）买入或卖出特定数量股票的权利。正如前面所提到的，股票价格可能会受到多个因素的影响。
- en: For example, let’s consider a call option for 100 shares of XYZ Corporation,
    with a strike price of $50 and an expiration date of three months from now. If
    the current market price of XYZ Corporation’s stock is $55, the option would have
    an intrinsic value of $5 per share (the difference between the market price and
    the strike price). However, the option’s price would also be influenced by factors
    such as the time to expiration, the volatility of the stock, and the interest
    rate.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设我们考虑XYZ公司100股认购期权，执行价格为50美元，三个月后到期。如果XYZ公司当前的市场价格为55美元，则该期权的内在价值为每股5美元（市场价格与执行价格的差额）。然而，期权的价格还会受到诸如到期时间、股票波动性和利率等因素的影响。
- en: Suppose the stock’s volatility is high, indicating a higher likelihood of significant
    price swings, and the interest rate is low, making it cheaper to borrow money.
    In that case, the option’s price would be higher, due to the increased likelihood
    of the stock price moving in the desired direction, making the option more valuable.
    Conversely, if the stock’s volatility is low and the interest rate is high, the
    option’s price would be lower, since the likelihood of the stock price moving
    in the desired direction is lower. The cost of borrowing money is higher. Overall,
    pricing securities, such as options, involves assessing multiple factors and using
    various pricing models to determine a fair value. The pricing process helps investors
    make informed investment decisions and manage risk effectively.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 假设股票的波动性较高，表明股价有更大的波动可能，而利率较低，借款成本较低。在这种情况下，期权的价格会较高，因为股票价格朝着期望方向波动的可能性增大，期权的价值也随之增加。相反，如果股票的波动性较低而利率较高，期权的价格会较低，因为股票价格朝着期望方向波动的可能性较低，借款成本较高。总体而言，证券定价（如期权）涉及评估多个因素，并使用各种定价模型来确定公允价值。定价过程帮助投资者做出明智的投资决策，并有效管理风险。
- en: 'The process of securities pricing involves several steps, including the following:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 证券定价过程包括多个步骤，以下是其中的一些：
- en: '**Identifying the security**: The first step in pricing securities is to identify
    the specific security being priced. This could be a stock, bond, option, or another
    financial instrument.'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**识别证券**：定价证券的第一步是识别所定价的具体证券。这可能是股票、债券、期权或其他金融工具。'
- en: '**Gathering information**: Gather all relevant information about the security,
    including its current market price, historical price trends, any news or events
    that may affect its value, and any associated risks.'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**收集信息**：收集关于证券的所有相关信息，包括当前市场价格、历史价格趋势、可能影响其价值的新闻或事件，以及任何相关的风险。'
- en: '**Determining pricing factors**: The price of a security is influenced by several
    factors, including supply and demand, interest rates, economic conditions, and
    market sentiment. Identify the most relevant factors likely to affect the security’s
    price.'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**确定定价因素**：证券的价格受多种因素的影响，包括供需关系、利率、经济状况和市场情绪。识别可能影响证券价格的最相关因素。'
- en: '**Choosing a pricing model**: There are several pricing models used to determine
    the fair value of securities, including the **discounted cash flow** (**DCF**)
    model, the **dividend discount model** (**DDM**), and the Black-Scholes model
    for options. Choose the most appropriate model, based on the type of security
    being priced and the available information.'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**选择定价模型**：有多种定价模型用于确定证券的公允价值，包括**折现现金流**（**DCF**）模型、**股息折现模型**（**DDM**）以及用于期权的布莱克-舒尔斯模型。根据所定价证券的类型和可用信息，选择最合适的模型。'
- en: '**Calculating the price**: Once the pricing model is chosen, calculate the
    security’s fair value, using the relevant pricing factors and any assumptions
    required by the model. This may involve complex mathematical calculations, especially
    for options and other derivatives.'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**计算价格**：一旦选择了定价模型，就使用相关的定价因素和模型所需的假设来计算证券的公允价值。这可能涉及复杂的数学计算，特别是对于期权和其他衍生品。'
- en: '**Evaluating the results**: Evaluate the results of the pricing model and ensure
    that the calculated price is reasonable and consistent with market conditions
    and other available information.'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**评估结果**：评估定价模型的结果，确保计算出的价格合理，并与市场条件和其他可用信息一致。'
- en: '**Updating pricing regularly**: Securities pricing is an ongoing process, and
    prices can change rapidly based on new information and market conditions. Regularly
    update the pricing model, and recalculate the security’s price as needed to ensure
    that the investment portfolio is up to date and accurately reflects the value
    of the securities.'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**定期更新定价**：证券定价是一个持续的过程，价格可能会根据新信息和市场条件迅速变化。定期更新定价模型，并在需要时重新计算证券的价格，以确保投资组合保持最新，并准确反映证券的价值。'
- en: This shows that securities pricing is a complex process that involves multiple
    steps, including identifying the security, gathering information, determining
    pricing factors, choosing a pricing model, calculating the price, evaluating the
    results, and updating pricing regularly. By following these steps, investors can
    make informed investment decisions and manage risk effectively.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明，证券定价是一个复杂的过程，涉及多个步骤，包括识别证券、收集信息、确定定价因素、选择定价模型、计算价格、评估结果和定期更新定价。通过遵循这些步骤，投资者可以做出明智的投资决策，并有效管理风险。
- en: Derivatives pricing – theory
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 衍生品定价 – 理论
- en: The Black-Scholes model is widely used for pricing derivatives such as options.
    Fischer Black and Myron Scholes came up with this formalism in 1973, which has
    since become a cornerstone of modern finance. The model considers various factors
    that influence the value of an option, including the underlying asset price, the
    option’s strike price, the time to expiration, volatility, and the risk-free interest
    rate. Let’s consider an example of the Black-Scholes model when setting the price
    a call option could pose on a stock.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: Black-Scholes模型广泛用于定价衍生品，如期权。Fischer Black和Myron Scholes在1973年提出了这一公式，并且它已经成为现代金融的基石。该模型考虑了影响期权价值的多个因素，包括基础资产价格、期权的行使价格、到期时间、波动率和无风险利率。让我们考虑一个例子，使用Black-Scholes模型为股票的看涨期权定价。
- en: Let’s assume that a call option on the XYZ stock with a strike price of $50
    is set to expire in six months. The current stock price is $52, and the volatility
    of the stock is 20%, while the risk-free interest rate is 3%.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 假设XYZ股票的看涨期权行使价格为50美元，将在六个月后到期。当前股票价格为52美元，股票的波动率为20%，而无风险利率为3%。
- en: Step one – calculate the d1 and d2 values
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第一步 – 计算d1和d2的值
- en: d 1 =  [ln  S _ K + (r + σ 2 _ 2 )t ]  ____________ (σ √ _ t )
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: d 1 = [ln S _ K + (r + σ 2 _ 2 )t ] ____________ (σ √ _ t )
- en: d 2 = d 1 − σ √ _ t
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: d 2 = d 1 − σ √ _ t
- en: where S is the current stock price, K is the option’s strike price, r is the
    risk-free interest rate, σ is the volatility of the stock, and t is the time to
    expire in years.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，S为当前股票价格，K为期权的行使价格，r为无风险利率，σ为股票的波动率，t为到期时间（单位：年）。
- en: 'Using the given values, we can calculate d1 and d2 as follows:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 使用给定的值，我们可以按如下方式计算d1和d2：
- en: d 1 = [ln 52 _ 50 + (0.03 + 0.2 2 _ 2 )0.5 ] ___________ (0.2 √ _ 0.5 )  = 0.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: d 1 = [ln 52 _ 50 + (0.03 + 0.2 2 _ 2 )0.5 ] ___________ (0.2 √ _ 0.5 ) = 0.
- en: d 2 = 0.5601 − 0.2 √ _ 0.5  = 0.4187
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: d 2 = 0.5601 − 0.2 √ _ 0.5 = 0.4187
- en: Step two – calculate the option price
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第二步 – 计算期权价格
- en: 'Using the following formula, we can calculate the theoretical price of the
    call option:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下公式，我们可以计算出看涨期权的理论价格：
- en: C = S × N(d 1) − K e −rt N( d 2)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: C = S × N(d 1) − K e −rt N( d 2)
- en: Where C is the theoretical price of the call option, S is the current stock
    price, K is the option’s strike price, r is the risk-free interest rate, t is
    the time to expiration in years, N() is the cumulative distribution function of
    the standard normal distribution.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 其中C是看涨期权的理论价格，S为当前股票价格，K为期权的行使价格，r为无风险利率，t为到期时间（单位：年），N()为标准正态分布的累积分布函数。
- en: 'Using the given values, we can calculate the theoretical price of the call
    option as follows:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 使用给定的值，我们可以按如下方式计算出看涨期权的理论价格：
- en: C = 52 × N(0.5601) − 50 e −0.03*0.5 N(0.4187) = $4.42
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: C = 52 × N(0.5601) − 50 e^−0.03*0.5 N(0.4187) = $4.42
- en: Step three – analyze the results
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第三步 – 分析结果
- en: The calculated theoretical price of the call option is $4.42, which means that
    an investor can purchase the option for $4.42 and has the right to buy the XYZ
    stock for $50 before the expiration date in six months. If the stock price goes
    above $54.42 (the strike price plus the option price), the investor can exercise
    the option and make a profit. On the other hand, if the stock price stays below
    the strike price, the investor can let the option expire and only lose the premium
    paid for the option.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 计算出的看涨期权理论价格为$4.42，这意味着投资者可以以$4.42的价格购买期权，并在六个月内有权以$50的价格购买XYZ股票。如果股票价格超过$54.42（执行价格加期权价格），投资者可以行使期权并获利。另一方面，如果股票价格低于执行价格，投资者可以让期权到期，仅损失购买期权时支付的权利金。
- en: Thus, the Black-Scholes model is an important tool for pricing derivatives such
    as options. By taking into account various factors that influence the value of
    an option, investors can make informed decisions about buying and selling options
    to manage risk and maximize returns. However, it’s important to note that the
    model has some limitations and assumptions, such as constant volatility and no
    transaction costs, which may only sometimes be true in real-world situations.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，布莱克-斯科尔斯模型是定价衍生品（如期权）的重要工具。通过考虑影响期权价值的各种因素，投资者可以做出明智的买卖决策，以管理风险并最大化回报。然而，需要注意的是，该模型存在一些限制和假设，例如假设波动率恒定且不存在交易成本，而这些假设在现实情况下可能并不总是成立。
- en: The Black-Scholes-Merton (BSM) model
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 布莱克-斯科尔斯-默顿（BSM）模型
- en: The BSM model is widely regarded as one of the most important breakthroughs
    in modern finance, and its widespread use has made options trading more efficient
    and accessible to investors.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: BSM模型被广泛认为是现代金融学中最重要的突破之一，其广泛应用使期权交易变得更加高效，并且让投资者更易参与。
- en: The BSM model uses six variables to determine the fair value of an option. These
    variables include volatility, the type, the stock price, the strike price, time,
    and the risk-free rate. Volatility refers to the degree of fluctuation in the
    underlying asset’s price. In contrast, the type refers to whether the option is
    a call or a put option. A call option refers to the buying action as opposed to
    a put option, which refers to the selling right. The stock price and strike price
    refer to the current market price and the predetermined price at which the underlying
    asset can be bought or sold. Time refers to the length of time until the option
    expires. The risk-free rate is the theoretical rate of return on a risk-free investment,
    such as a government bond.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: BSM模型使用六个变量来确定期权的公允价值。这些变量包括波动率、类型、股价、执行价格、时间和无风险利率。波动率指的是标的资产价格的波动幅度，而类型则指期权是看涨期权还是看跌期权。看涨期权是指买入权，而看跌期权则指卖出权。股价和执行价格分别指当前市场价格和可用于买卖标的资产的预定价格。时间指期权到期前的剩余时间。无风险利率是指无风险投资（如政府债券）的理论回报率。
- en: The BSM model is often used to determine the fair value of options based on
    these six variables. To illustrate the BSM model, let us consider an example of
    an investor who holds a call option with a strike price of $100, which will expire
    in six months. We will assume that the current market price of the underlying
    asset is $110, the risk-free rate is 3%, and the underlying asset’s volatility
    is 20%.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: BSM模型常用于根据这六个变量来确定期权的公允价值。为了说明BSM模型，我们以一个例子为例：假设一位投资者持有一个执行价格为$100的看涨期权，该期权将在六个月后到期。我们假设标的资产的当前市场价格为$110，无风险利率为3%，且标的资产的波动率为20%。
- en: 'Using the BSM model, we can calculate the fair value of the call option. The
    formula to calculate the fair value of a call option using the BSM model is:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 使用BSM模型，我们可以计算出看涨期权的公允价值。使用BSM模型计算看涨期权公允价值的公式如下：
- en: C = S × N(d 1) − K e −rt N( d 2)
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: C = S × N(d1) − K e^−rt N(d2)
- en: where C is the fair value of the call option, S is the current market price
    of the underlying asset, K is the strike price of the option, r is the risk-free
    rate, t is the time until expiration, and N(d 1) and N(d 2) are cumulative standard
    normal distribution functions.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 其中C是看涨期权的公允价值，S是标的资产的当前市场价格，K是期权的执行价格，r是无风险利率，t是到期时间，N(d1)和N(d2)是累积分布的标准正态函数。
- en: 'Applying the formula to the given example, we have:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 将公式应用到给定的例子中，我们得到：
- en: d 1 =  [ln 110 _ 100 + (0.03 + 0.2 2 _ 2 )0.5 ]  _________________  (0.2 √ _ 0.5 ) 
    = 0.9568
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: d 2 = 0.9568 − 0.2 √ _ 0.5  = 0.8154
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: N(d 1) = 0.831
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: N(d 2) = 0.7926
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: C = 110 × 0.831 − 100 × e −0.03×0.5 × 0.7926 = $13.29
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: Therefore, the fair value of the call option is $13.29\. This means that if
    the investor were to sell the option at this price, it would be a fair price based
    on the BSM model.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: The BSM model is a widely used formula that allows investors to determine the
    fair value of options based on six variables – volatility, type, the stock price,
    the strike price, time, and the risk-free rate. The model has revolutionized the
    options market by making pricing more efficient and transparent. The example presented
    here illustrates the application of the BSM model and highlights its importance
    in modern finance.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: Assumptions
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The BSM model is a widely used options pricing model that assumes several factors.
    These assumptions are critical in determining the fair value of an underlying
    asset for either of the two options – put or call. Here are some of the significant
    assumptions of the BSM model:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: '**Efficient markets**: The model assumes that markets are efficient, meaning
    all available information is immediately reflected in the asset’s price'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**No dividends**: The model assumes that the underlying asset does not pay
    dividends during the option’s life'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**No transaction costs**: The model assumes no transaction costs are associated
    with buying or selling the underlying asset or option'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**No arbitrage**: The model assumes that there are no arbitrage opportunities,
    which means it is impossible to make a riskless profit by simultaneously buying
    and selling the underlying asset and option'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Lognormal distribution**: The model assumes that the underlying asset’s price
    follows a lognormal distribution, which means that the price changes are proportional
    to the current price and a random variable'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Constant volatility**: The model assumes that the underlying asset’s volatility
    is constant over the option’s life'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These assumptions may be false, but they provide a useful framework to understand
    the factors influencing price options.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: Limitations
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The BSM model is one of the most widely used models for options pricing. However,
    despite its popularity, the model has several limitations that make it less suitable
    for certain options and market conditions. Some of the limitations of the BSM
    model include the following:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: '**An assumption of continuous trading**: The BSM model assumes that trading
    in the underlying asset is continuous, which means that the stock price can change
    by an infinite number of small amounts. In reality, trading is not continuous,
    and stock prices can experience sudden and large changes due to news events, market
    shocks, and other factors.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**No consideration of market frictions**: The BSM model assumes that no transaction
    costs, taxes, or other market frictions affect the price of the underlying asset.
    In reality, these frictions can significantly impact the value of options.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**An assumption of constant volatility**: The BSM model assumes that volatility
    is constant over the option’s life. In reality, volatility can be highly variable
    and change significantly over short periods.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Limited applicability to specific options**: The BSM model is most suitable
    for pricing European options, which can only be exercised at expiration. The model
    is less suitable for pricing American options, which can be exercised before expiration,
    and other exotic options.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Limited applicability to specific market conditions**: The BSM assumes specific
    behavior distribution on both the asset and markets. This limits the normal case
    where they can show all types of distributions, ranging from skewed to normal
    distributions as observed in reality.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use of the risk-neutral approach**: The BSM model uses a risk-neutral approach
    to pricing options, which assumes that investors are indifferent to the risk and
    that the expected return on the option is equal to the risk-free rate. This assumption
    may not apply, especially for highly risky or illiquid options.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Despite these limitations, the BSM model remains a valuable tool for options
    pricing and has been used extensively by traders, investors, and academics since
    its introduction in 1973\. However, it is essential to recognize the model’s limitations
    and use it appropriately in the context of specific market conditions and types
    of options. These limitations can be overcome with the help of computational modeling.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: Computational models
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The BSM model is a popular mathematical formula used to calculate the price
    of European-style options. However, the traditional BSM model has limitations,
    such as the assumption of constant volatility and risk-neutral pricing, which
    can lead to inaccurate pricing predictions. In recent years, machine learning
    algorithms have been applied to enhance the BSM model and improve its predictive
    power. In this subsection, we will explore the implementation of the BSM model
    using machine learning algorithms, its benefits, and its limitations.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: 'The BSM assumes the following:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: The price of an underlying asset exhibits a random behavior characterized by
    a stochastic process known as Geometric Brownian motion
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The volatility of the asset’s returns is constant over the option’s life
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The risk-free rate is known and constant
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The option can only be exercised at the expiration date
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To implement the BSM model using machine learning algorithms, you can use historical
    data to train the model and learn from past market behavior. The model can then
    use this learned information to predict future prices. Machine learning algorithms,
    such as neural networks and decision trees, can help overcome the limitations
    of the traditional BSM model by doing the following:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: Accounting for non-constant volatility in asset returns
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Incorporating new market data in real time to update pricing predictions
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Considering non-normal distributions of asset returns and incorporating skewness
    and kurtosis into pricing calculations
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Using machine learning algorithms to enhance the BSM model has several benefits,
    such as the following:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: Improved accuracy in predicting option prices
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Increased flexibility in modeling complex financial instruments
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Faster pricing calculations, allowing for more timely trading decisions
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'However, there are also limitations to using machine learning algorithms in
    conjunction with the BSM model, such as the following:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: Increased complexity and the need for specialized technical expertise
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The potential to overfit the model with historical data, leading to inaccurate
    pricing predictions
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A large amount of high-quality data is needed to train the model effectively
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Despite these limitations, implementing the BSM model using machine learning
    algorithms represents a promising approach to pricing financial instruments. Incorporating
    new market data in real time and accounting for non-constant volatility can improve
    accuracy, helping traders to make more informed decisions. Implementing the BSM
    model using machine learning algorithms significantly advances financial modeling.
    By incorporating new data and accounting for non-constant volatility, this approach
    can improve the accuracy of pricing predictions and allow for more informed trading
    decisions. However, it is essential to recognize this approach’s limitations and
    use it with other financial models and analysis techniques.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: Machine learning
  id: totrans-147
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Machine learning in derivative pricing employs complex algorithms to predict
    future derivative prices, drawing from a vast dataset of historical trading data.
    By modeling market dynamics and identifying patterns, it provides more accurate
    price forecasts than traditional models. This not only reduces financial risk
    but also optimizes trading strategies. Furthermore, it provides insights into
    market behavior, assisting in the development of more resilient financial systems.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: Geometric Brownian motion
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We must model the underlying equities before estimating the price of derivative
    instruments based on their value. The **geometric Brownian motion** (**GBM**),
    also called the Wiener process, is the method often uses to model the stochastic
    process of a Brownian motion, driving the future values of an asset. It helps
    create trajectories that the asset price of the underlying stock may take in the
    future.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: 'A stochastic or random process, here defined as the time-dependent function
    S(t), is said to follow GBM if it can be expressed as the following SDE:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: d S t = μ S t dt + σ S t d W t
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: 'where:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: St – the stock price at time t
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: dSt – the change in stock price from time t
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: μ – the drift term
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: σ – the volatility term
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: dt – the change in time
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: dWt – the Brownian motion
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Wt notation belongs to the Wiener process or Brownian motion, μ is the percentage
    drift, and σ is the percentage volatility. Itô’s lemma (reference), the following
    analytical solution can be derived:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: S(t) = S 0 exp((r −  1 _ 2  σ 2)t + σ √ _ t  z)
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: Where S 0 is the initial stock index level, t the time to maturity when the
    stock will be acted on, r a constant representing the risk-less short rate, σ
    the constant volatility (often computed as the standard deviation of the stock),
    and z a normally distributed random variable. Thus, S(t) can easily be estimated
    for a given stock at time t.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: One key feature of GBM is that the projected distribution of the asset follows
    a log-normal distribution. This is convenient given that, as we saw before, we
    expect certain skewness for the value to be lower.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: 'By setting *I* random numbers for z i i ∈ 1, … , I, and computing the associated
    S i(t) for each sample, we can generate said future price distribution. Let’s
    create a hypothetical case to prove that:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'With those parameters set, we can simply code our St for future stock prices
    at the projected time t:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'It is interesting to plot the trajectories behind those numbers so that we
    know where they come from. We will place the trajectories for the future by one
    year:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'This iterative process will create sufficient samples of future scenarios projecting
    to our target time T, based on each time step preceding the value (t-1). The final
    code is the coded representation of the formulation described previously for the
    stochastic process:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This should yield a graph like the following one:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.1 – GBM trajectories generated for a given asset price and 12 month
    projection (image generated by the preceding code)](img/B19146_04_001.jpg)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
- en: Figure 4.1 – GBM trajectories generated for a given asset price and 12 month
    projection (image generated by the preceding code)
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: 'It may look chaotic but it is, in fact, the representation of the underlying
    stochastic process we described before. We can see how all trajectories start
    from the same point (the price today) and evolve in different directions, according
    to previously described equations, broadening the range as we move forward in
    time. If we plot the distribution at time *T* (one year in our case), we can see
    that the potential evolution meets the criteria previously explained, and by showcasing
    the price distribution, we are able to make assumptions about the likelihood of
    some of those specific trajectories, some of which are more plausible than others:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![Figure 4.2 – Distribution of the price](img/B19146_04_002.jpg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
- en: Figure 4.2 – Distribution of the price
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: This distribution is one that will drive all our calculations associated with
    the call and put prices of a stock option. Also, it is skewed toward a lower-value
    bet than the high valuations, which are plausible but less probable.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: Quantum computing
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we saw in the previous section, in order to estimate the future price of
    an equity, many iterations over potential future prices need to be run. However,
    what if we could establish a way to load those potential distributions into quantum
    states and evaluate them using quantum devices? The following subsection will
    dig into different ways to load those future price distributions into quantum
    states using existing solutions for direct loading, such as Qiskit functionalities
    and adversarial training using PennyLane, which might be better suited for ML
    tasks due to its differentiable programming approach (similar to TensorFlow or
    PyTorch in the classical ML domain).
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: Implementation in Qiskit
  id: totrans-182
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As discussed in [*Chapter 2*](B19146_02.xhtml#_idTextAnchor032), Qiskit is one
    of the most mature quantum computing frameworks available and counts with higher-level
    modules so that specific applications can be easily translated to the quantum
    regime. This is the case with Qiskit Finance, which we will explore in detail
    while translating previous exercises to a quantum approach.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: 'As we already know, classical data must be converted into a quantum state to
    work with it on a quantum device. In the case of price valuation, that means representing
    our target distribution as a quantum state. Therefore, we should build a quantum
    state like the following:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: '| ψ⟩ n = ∑ 0 2 n−1 √ _ p i  |i⟩ n,'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: where *p**ᵢ*is the probability associated with the truncated distribution, and
    i is the mapping between our discrete bins, representing each value range of our
    target distribution.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: 'Quantum hardware may face some challenges, which is one of the first to affect
    us. We need to truncate our distribution into discrete bins, as possible prices
    can fall into infinite bins, depending on the numerical precision we want to achieve.
    Thus, |i⟩ will be associated with a range of values sufficiently precise to encode
    a probability associated with that range. The truncation for i qubits is placed
    as follows:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: '{0, … , 2 n − 1} ∈ i ⟶  high − low _ 2 n − 1  × i + low'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: 'By setting the number of qubits of our algorithm, we also limit the response
    resolution:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Then, we need to embed our target distribution into the quantum state explained
    before:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Now that the truncated target distribution is ready, we must generate a circuit
    encoding the quantum state. It is a manageable task and can take time to learn
    how to do it properly. Luckily for us, Qiskit Finance is here to help. It already
    provides this functionality:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This circuit we just created encodes the distribution of our assets. We can
    print it if we like, but it will look like a big box at our working level:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![Figure 4.3 – Logical circuit generated by the code above encapsulating the
    target distribution into a quantum state](img/B19146_04_003.jpg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
- en: Figure 4.3 – Logical circuit generated by the code above encapsulating the target
    distribution into a quantum state
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: 'However, if we look at the distribution it encodes, we can check whether it
    fits our expectations:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![Figure 4.4 – Discretized distribution generated by the previous circuit in
    Figure 4.3](img/B19146_04_004.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
- en: Figure 4.4 – Discretized distribution generated by the previous circuit in Figure
    4.3
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: This target distribution shows an additional limitation we will face when encoding
    the problem into quantum states. Given that they encode the bin representation
    of our probability distribution, the truncation we might decide on could cut some
    of the values at each end. Therefore, an important initial assessment needs to
    be done in order to properly characterize the distribution we aim to fit into
    our quantum states.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that our target distribution is loaded, it is just a matter of evaluating
    the call and put options within the quantum regime. For that, we might need to
    encode a linear piecewise function that will do this price calculation according
    to the probability, encoded as state amplitudes of our *|i>*. It is able to estimate
    these prices for each of our bins, simultaneously leveraging the parallelism that
    quantum states provide:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: F|x⟩|0⟩ = √ _ 1 − f(x)  |x⟩|0⟩ + √ _ f(x) |x⟩|1⟩
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: 'for a function f:{0,...,2^n-1} →[0,1] mapping the option function and x being
    a n qubit state mapping the option price bin. This encoded function will flag
    price buckets in the distribution, with the positive probability amplitude associated
    with their likelihood:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'This will be our call objective function:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We can compose a European call circuit by adding this amplitude estimation
    block to our previous circuit. This is mostly provided by Qiskit, thanks to its
    high-level module:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![Figure 4.5 – Probability distribution generation block (P) followed by linear
    amplitude function block (f)](img/B19146_04_005.jpg)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
- en: Figure 4.5 – Probability distribution generation block (P) followed by linear
    amplitude function block (f)
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: 'First, block (P) will add the price distribution we loaded into quantum states
    as the second block (F), as shown in the preceding diagram, evaluates their potential
    outcome. Given that amplitudes have been encoded already after the F block in
    the preceding figure, the last step is to extract from the quantum state into
    classical values the probabilities for our equity to fall into different bins
    of future pricing. Different methods exist for **Quantum Amplitude Estimation**
    (**QAE**); this technique allows you to extract the amplitudes on a given quantum
    state. Formally, we would pose it as the ability to estimate amplitude *a* for
    state ψ, defined as:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: a = |⟨ψ | ψ⟩|²
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: 'It is often used as the quantum counterpart of the classical Monte Carlo simulation.
    We will here use an iterative QAE variant that has proven better error rates compared
    to other approaches:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Given that the whole process is quite systematic, Qiskit already provides all
    these steps in a single piece of code, so we do not have to worry about each specific
    step:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Using qGANs for price distribution loading
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: So far, we have encoded the uncertainty model of a given stock based on previously
    discussed statistical models, but could we exploit empirical knowledge from data
    instead of using statistical knowledge? We have retrieved information from Binance
    to get the market behaviors. We want our model to exploit the fact that each option
    does not behave in an isolated environment but depends on the evolutions of the
    rest of the stocks.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: When data is available, ML techniques can have a field day, particularly generative
    models. Models that are once trained can create samples from a distribution.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: 'In our particular case, we are interested in obtaining a generator model G
    such that:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: G θ| ψ⟩ n = ∑ 0 2 n−1 √ _ p i  |i⟩ n,
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: where the square root of p i represents the probability amplitude of the |i⟩
    quantum bin to be measured. In this case, the same quantum state we have been
    manually loading, the state that encodes future prices as discretized probable
    values, will be created, based on data samples extracted from our market data
    through a learning process that will iterate, making G map the preceding equation.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: '**Generative Adversarial Networks** (**GANs**) have been successful in realistic
    image and video generation, as you may be aware of, due to the success in the
    media of deepfakes. However, GANs can be exploited in many other regimes, from
    tabular data to time series data, which is quite a common case in the financial
    sector. Their quantum version was proposed by Zoufal et al. in 2019\. It is based
    on opposing two models, one quantum generator and one classical discriminator
    (a classical neural network), that are trained with opposing objectives so that
    we end up in a Nash equilibrium.'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.6 – A pictorial representation of the two models used in qGAN, the
    quantum generator G and classical discriminator D, as presented by Zoufal et al.](img/B19146_04_006.jpg)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
- en: Figure 4.6 – A pictorial representation of the two models used in qGAN, the
    quantum generator G and classical discriminator D, as presented by Zoufal et al.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: 'From a dataset loaded from Binance, where we can select the stocks to be used,
    we can select a subset:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'As we already know, a discretized and truncated version of the data must be
    delivered to the quantum device to fit our data into the quantum regime:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'We need to map our samples to discrete values. This means depending on the
    qubit resolution we choose. Each sample will need to be placed in a discrete bin
    as before. Choosing a 3-qubit representation means our data should fit into 2 3
    = 8 bins. This is something that needs to be considered, as it affects the resolution
    of our model:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'We can plot our discrete distribution for the three assets to learn which distributions
    we can effectively encode in our quantum resource:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![Figure 4.7 – Discretized distribution of three targeted stocks](img/B19146_04_007.jpg)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
- en: Figure 4.7 – Discretized distribution of three targeted stocks
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: 'The original paper by Zoufal et al. proposed a specific parameterized quantum
    circuit as the generator circuit, using a sequence of *Y* rotations parameterized
    per qubit and a cycle of CZ gates circularly entangling all qubits (called an
    entangling block). We will try to mimic a similar approach in PennyLane:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'That way we can easily use this setup for different repetitions and data dimensions
    we might be looking for:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The output circuit should look like the one in *Figure 4**.8*. Even though it
    does not show a detailed view in the ansatz, this circuit is parameterized by
    the weights or parameters provided to the generator function. To know which parameters
    will output our expected distribution, we need to find them by following the techniques
    described in [*Chapter 2*](B19146_02.xhtml#_idTextAnchor032) for ansatz training.
    GANs offer a different approach to how these parameters are adapted, opposing
    the discriminator as the cost function for the training of the generator.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.8 – The generator ansatz composed of Hadamard gates, the parameterized
    Y rotations, and the CZ gate cycle by the nearest neighbor coupling](img/B19146_04_008.jpg)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
- en: Figure 4.8 – The generator ansatz composed of Hadamard gates, the parameterized
    Y rotations, and the CZ gate cycle by the nearest neighbor coupling
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: 'GANs need a counterpart for the discriminator trying to assess whether samples
    come from the real dataset or the data faked by the generator, as depicted in
    *Figure 4**.8*. For this discriminator, a simple neural network will be defined,
    whose binary output should establish the sample source:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: This choice for the classical discriminator and its architecture of layers can
    be as complex as you want, and a big effort has been made by the community to
    identify the best-performing quantum and classical model designs for specific
    tasks.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
- en: The key now resides in opposing the loss functions associated with training
    both models, quantum and classical. The loss is opposed, so you can see how variations
    on the parameters associated with our generator (G) are also considered in the
    discriminators’ loss function.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: L G(ϕ, θ) = −  1 _ m  ∑ i=1 m log D ψ( g i)
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
- en: L D(ϕ, θ) = −  1 _ m  ∑ i=1 m log D ψ(x i) + log(1 − D ψ( g i))
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: 'In both cases, the Adam optimization method (*Kingma et al., 2014*) will be
    used to train the model. This is enabled due to the fact that both frameworks,
    PennyLane for the quantum model and PyTorch for the classical one, provide this
    method:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Once all pieces are set, it is just a matter of iteration, looking for the
    Nash equilibrium between the G and D models:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: By plotting the evolution of both loss functions (appended to `generator_loss_values`
    and `discriminator_loss_values` arrays), we can see how both models try to adapt
    to one another so that the generator will ultimately be the best version of a
    synthetic data generator we can achieve.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 4.9 – Loss evolution while training both models reaching the equilibrium
    point at the end of the iterations](img/B19146_04_009.jpg)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
- en: Figure 4.9 – Loss evolution while training both models reaching the equilibrium
    point at the end of the iterations
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: With this, we obtain a P block, as shown when manually loading the distribution
    using Qiskit, but trained to mimic the price distribution, as seen in the historic
    dataset we used to train the generator in our qGAN. Therefore, by adding this
    trained generator as the probability and appending the linear amplitude function
    and QAE blocks a purely data-driven quantum approach for the pricing of our stocks
    would be created. It would take quite a big block of code with different frameworks
    to perform such a task, so the technical complexity to implement this may be too
    high, but we definitely recommend going through the three blocks to understand
    how these interfaces between different frameworks can be achieved (PennyLane for
    a trainable parameterized quantum circuit and Qiskit Finance to avoid implementing
    the already available functionalities).
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we explored a complex use case to forecast the future, the
    future of how markets will evolve, how stock prices will evolve, and so on a non-trivial
    task indeed. We showed how classical statistics extensively used in the field
    can be used in a quantum regime. This brings some benefits but also, given its
    current status and the limitations of the devices themselves, poses other impediments
    we would need to work around.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
- en: Encoding a probability distribution on a gate-based quantum device entails some
    resolution loss. Probability distributions may need to be truncated, and value
    ranges will be rendered as the same discrete bin that the future price of an option
    may be placed. This limitation will probably change when bigger devices are made
    available so that larger distributions can be encoded. However, it is indeed a
    limitation we should have present in our minds when adopting these techniques.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: Of course, there are benefits, as quantum devices are capable of native parallelization
    of many calculations, which are done sequentially or require large classical setups
    to perform fast enough. Thanks to QML setups and qGANs in particular, we can even
    compose a piece of machinery that does this distribution encoding, based on an
    asset’s past evolution, which might not be entirely accurate but at least is based
    on evidence. So far, simulators have been used in this section to ease the complexity
    of using real devices, as we will explain in the following chapters. Dealing with
    device specifics could be quite challenging as well and add more complexity to
    the already complex procedure we showed here. Even though we will cover use cases
    that better fit the current status of quantum devices, being the growing field
    that it is and with its relevance in the financial sector, we must keep an eye
    on advances toward better price forecasting in the literature. There are really
    relevant research initiatives that could give us a breakthrough not far from now.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  id: totrans-264
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A quintessential part of what we have discussed in this chapter relates to some
    of the foundational algorithms in quantum computing. Grover’s algorithm (Jozsa
    1999) and QAE (Rao et al. 2020) are not only key contenders for financial use
    cases but also for numerous applications pertaining to quantum algorithms.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
- en: More and more, QML is gaining relevance, as it allows the exploitation of existing
    data to create those embeddings or dynamics that quantum algorithms often require.
    [*Chapter 6*](B19146_06.xhtml#_idTextAnchor124) will examine in more detail these
    techniques. However, for those already knowledgeable about classical generative
    models such as GANs, variational autoencoders, and neural networks in general,
    there is plenty of literature that can be found to help their adaptation to the
    Quantum regime (Lloyd and Weedbrook, 2018). New ways that QNNs can be exploited
    for financial applications (Tapia et al. 2022) or different perspectives on how
    a price projection can be tackled constantly appear in the literature (Singh 2021).
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
- en: On a more practical note, even though understanding the basics of how these
    algorithms are designed and implemented can be crucial at this stage, higher and
    higher abstraction enablers such as Qiskit Finance or ML will boost your ability
    to try and test some of the cutting-edge discoveries, offering a faster-paced
    transition from research to corporate innovation (Moguel et al. 2020).
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: References
  id: totrans-268
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '*Glasserman, P. (2004). Monte Carlo methods in financial engineering (Vol.
    53, pp. xiv+-596). New* *York: Springer.*'
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Jozsa, R. (1999). Searching in Grover’s algorithm. arXiv* *preprint quant-ph/9901021.*'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Kingma, D. P., & Ba, J. (2014). Adam: A method for stochastic optimization.
    arXiv* *preprint arXiv:1412.6980.*'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Lloyd, S., & Weedbrook, C. (2018). Quantum generative adversarial learning.
    Physical review letters,* *121(4), 040502.*'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*MacBeth, J. D., & Merville, L. J. (1979). An empirical examination of the
    Black-Scholes call option pricing model. The journal of finance,* *34(5), 1173-1186.*'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Moguel, E., Berrocal, J., García-Alonso, J., & Murillo, J. M. (2020, October).
    A Roadmap for Quantum Software Engineering: Applying the Lessons Learned from
    the Classics. In Q-SET@ QCE (**pp. 5-13).*'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Singh, P. (2021). FQTSFM: A fuzzy-quantum time series forecasting model. Information
    Sciences,* *566, 57-79.*'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Stojkoski, V., Sandev, T., Basnarkov, L., Kocarev, L., & Metzler, R. (2020).
    Generalised geometric Brownian motion: Theory and applications to option pricing.
    Entropy,* *22(12), 1432.*'
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Tapia, E. P., Scarpa, G., & Pozas-Kerstjens, A. (2022). Fraud detection with
    a single-qubit quantum neural network. arXiv* *preprint arXiv:2211.13191.*'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Rao, P., Yu, K., Lim, H., Jin, D., & Choi, D. (2020, August). Quantum amplitude
    estimation algorithms on IBM quantum devices. In Quantum Communications and Quantum
    Imaging XVIII (Vol. 11507, pp.* *49-60). SPIE.*'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Ross, S. M., Kelly, J. J., Sullivan, R. J., Perry, W. J., Mercer, D., Davis,
    R. M., ... & Bristow, V. L. (1996). Stochastic processes (Vol. 2). New* *York:
    Wiley.*'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Zoufal, C., Lucchi, A., & Woerner, S. (2019). Quantum generative adversarial
    networks for learning and loading random distributions. npj Quantum Information,*
    *5(1), 103.*'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
