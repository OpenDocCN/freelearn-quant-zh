- en: Chapter 7.  Risk Management
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章 风险管理
- en: In this chapter, we are going to discuss the various types of risk associated
    with the banking and financial domains. Banks and financial institutions are all
    exposed to risk, and they need to develop risk identification and risk mitigation
    mechanisms with the implementation of regulatory norms to stay competitive and
    profitable. In this chapter, we are going to discuss various techniques to measure
    different types of risk using R. It also includes risk pertaining to banking operations
    such as credit risk, fraud detection, and Basel regulations.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将讨论与银行和金融领域相关的各种风险类型。银行和金融机构都面临风险，它们需要在实施监管规范的同时，开发风险识别和风险缓解机制，以保持竞争力和盈利能力。本章将讨论使用R语言衡量不同类型风险的各种技术。内容还包括与银行业务相关的风险，如信用风险、欺诈检测和巴塞尔协议等。
- en: 'The chapter covers the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖以下主题：
- en: Market risk
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 市场风险
- en: Portfolio risk
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 投资组合风险
- en: VaR
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VaR
- en: Monte Carlo simulations
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蒙特卡罗模拟
- en: Hedging
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对冲
- en: Basel regulation
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 巴塞尔协议
- en: Credit risk
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 信用风险
- en: Fraud detection
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欺诈检测
- en: Market risk
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 市场风险
- en: The risk for an investor to encounter losses due to changes in overall performance
    of the market in which he has invested, is known as market risk. Market risk is
    a kind of systematic risk which cannot be tackled with diversification. It may
    be hedged. The risks happening due to recessions, political instability, interest
    rate changes, natural disasters, and terrorist attacks are examples of market
    risks. Market risks are measured differently for banks, individual stocks, portfolios,
    and so on.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 投资者因市场整体表现变化而遭遇损失的风险，称为市场风险。市场风险是一种系统性风险，无法通过多样化来应对。它可以通过对冲来减轻。由于经济衰退、政治不稳定、利率变化、自然灾害和恐怖袭击等原因产生的风险都是市场风险的例子。市场风险的衡量方法因银行、单个股票、投资组合等不同而有所不同。
- en: Let us consider how market risks are measured for individual securities. The
    market risk of a stock which is a part of a portfolio is measured as the contribution
    of a security in the overall risk of the portfolio. The individual stock risk
    is measured by the beta coefficient, which is the volatility of stock with respect
    to the market.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑如何衡量单一证券的市场风险。作为投资组合一部分的股票的市场风险被衡量为该证券对整体投资组合风险的贡献。单个股票的风险通过beta系数来衡量，它表示股票相对于市场的波动性。
- en: 'Let us run regression analysis on stock IBM as dependent variable and GPSC
    index as the independent variable and try to estimate the beta. It can be done
    by executing the following code, which uses monthly data of GPSC and IBM both
    between 2010 to 2016:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对IBM股票（作为因变量）和GPSC指数（作为自变量）进行回归分析，并尝试估算beta值。可以通过执行以下代码实现，该代码使用2010年至2016年期间GPSC和IBM的月度数据：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'It gives an estimate of beta, as shown here:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 它给出了beta的估算值，如下所示：
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Another technique used by investors and analysts is value at risk. It is a very
    common method of measuring risk in financial markets. The value at risk method
    is a well-known and established risk management method, but it comes with some
    assumptions that limit its correctness. For instance, one of the assumptions is
    that the content of the portfolio being measured is unchanged over a provided
    period. So, this may generate good results for short-term horizons but will not
    be such an accurate measurement for long-term horizons of investments, because
    it is more exposed to changes in interest rates and monetary policies. We will
    be discussing calculating VaR and CVAR/ES in R later on.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 投资者和分析师使用的另一种技术是价值-at-风险（VaR）。这是一种在金融市场中非常常见的风险衡量方法。价值-at-风险方法是一个知名且成熟的风险管理方法，但它也有一些假设，限制了其正确性。例如，其中一个假设是，被测量的投资组合内容在给定期间内保持不变。因此，这种方法可能对短期投资有效，但对于长期投资的风险测量准确性较差，因为它更容易受到利率和货币政策变化的影响。我们将在后面讨论如何在R中计算VaR和CVAR/ES。
- en: Portfolio risk
  id: totrans-19
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 投资组合风险
- en: With the use of R language, we can manage portfolios better by mitigating the
    risk and portfolio optimization. To avoid the risk associated with portfolio analysis,
    diversification of the portfolio is required, with the selection of optimum weights
    for the portfolio's constituents.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 使用R语言，我们可以通过降低风险和优化投资组合来更好地管理投资组合。为了避免与投资组合分析相关的风险，必须进行投资组合多样化，并为投资组合中的各成分选择最佳权重。
- en: 'Let us try to find the optimal weight of the portfolio whose stocks are IBM
    and FB, and using the CAPM. First, let us get the relevant data by executing the
    following code:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试找出由 IBM 和 FB 组成的投资组合的最佳权重，并使用 CAPM。首先，通过执行以下代码获取相关数据：
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: It is monthly-level data between 2015 and 2016.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 2015 年至 2016 年间的月度数据。
- en: 'Now, let us try to find the returns for the preceding data for close prices
    by executing the following code:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码，尝试找到上述数据的收盘价格收益：
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: It generates the returns for all the series.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成所有系列的收益。
- en: 'Now, let us try to find the excess return for all the series. The excess return
    is given by monthly return minus monthly T-Bills interest rate (let it be `.0015`).
    This can be done by executing the following code:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试找出所有系列的超额收益。超额收益由月度收益减去月度国债利率（设为 `.0015`）给出。可以通过执行以下代码来完成：
- en: '[PRE4]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Next, find the mean and SD for the excess returns of all the series. It is
    given by executing the following code:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，计算所有系列的超额收益的均值和标准差。可以通过执行以下代码得到：
- en: '[PRE5]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'It generates the following output:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Portfolio risk](img/00094.jpeg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合风险](img/00094.jpeg)'
- en: 'Figure 7.1: Mean and standard deviation of all the stocks considered'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.1：所有考虑股票的均值和标准差
- en: Now, let us find out the beta of all the excess returns of stocks by regressing
    them individually against the excess return of the S&P index.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过回归分析来找出所有股票超额收益的贝塔值，回归对象为 S&P 指数的超额收益。
- en: 'This can be done by executing the following code:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过执行以下代码完成：
- en: '[PRE6]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'It gives the following output:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Portfolio risk](img/00095.jpeg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合风险](img/00095.jpeg)'
- en: 'Figure 7.2: Output summary of regression'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2：回归输出汇总
- en: This shows that the beta for IBM is `1.1035670`.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明 IBM 的贝塔值为 `1.1035670`。
- en: Similarly, we can find the beta for FB and V.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们可以找到 FB 和 V 的贝塔值。
- en: 'So using the CAPM, the excess expected return for IBM is given as follows:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，使用 CAPM，IBM 的超额预期收益如下所示：
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'According to the single-factor model, the variance of IBM is given by this
    formula:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 根据单因子模型，IBM 的方差由以下公式给出：
- en: '![Portfolio risk](img/00096.jpeg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合风险](img/00096.jpeg)'
- en: 'Figure 7.3: Variance given by single-factor model'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3：单因子模型给出的方差
- en: Here, *e* is the residual error coming from regression.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*e* 是回归中产生的残差误差。
- en: 'So by running regression for all the independent variables and calculating
    excess returns and variance, we have the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，通过对所有独立变量进行回归并计算超额收益和方差，我们得到以下结果：
- en: '|  | **IBM** | **FB** | **V** |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '|  | **IBM** | **FB** | **V** |'
- en: '| **Variance** | 0.002906 | 0.002949 | 0.455695 |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| **方差** | 0.002906 | 0.002949 | 0.455695 |'
- en: '| **Beta** | 1.103567 | 0.423458 | 3.74228 |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| **贝塔值** | 1.103567 | 0.423458 | 3.74228 |'
- en: '| **Expected excess return** | -0.00657 | -0.00252 | -0.02229 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| **预期超额收益** | -0.00657 | -0.00252 | -0.02229 |'
- en: 'The covariance matrix can be calculated using the following formula:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 协方差矩阵可以使用以下公式计算：
- en: '![Portfolio risk](img/00097.jpeg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合风险](img/00097.jpeg)'
- en: 'Figure 7.4: Covariance formula'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4：协方差公式
- en: 'It generates the following matrix:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下矩阵：
- en: '|  | `IBM` | `FB` | `V` |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '|  | `IBM` | `FB` | `V` |'
- en: '| `IBM` | `0.001378` | `0.000529` | `0.004673` |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| `IBM` | `0.001378` | `0.000529` | `0.004673` |'
- en: '| `FB` | `0.000529` | `0.000203` | `0.001793` |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| `FB` | `0.000529` | `0.000203` | `0.001793` |'
- en: '| `V` | `0.004673` | `0.001793` | `0.015848` |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| `V` | `0.004673` | `0.001793` | `0.015848` |'
- en: 'Now, let us find the optimal weight for the portfolio by executing the following
    code:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码来找到投资组合的最佳权重：
- en: '[PRE8]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'It generates the optimal weight as given in the following table:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成最佳权重，如下表所示：
- en: '| `IBM` | `FB` | `V` |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| `IBM` | `FB` | `V` |'
- en: '| `0` | `0.70387703` | `0.29612297` |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| `0` | `0.70387703` | `0.29612297` |'
- en: VaR
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VaR
- en: Value at risk is a measure in risk management to measure the potential risk
    which can occur to the portfolio of an investor. VaR imputed at 5% confidence
    means that the loss will not be less than predicted value 95% of the time or,
    in other words, loss will be greater in 5% of times than predicted value.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 风险价值（VaR）是风险管理中的一个指标，用来衡量可能发生的风险，它能衡量投资者投资组合可能遭遇的潜在损失。5% 信心水平下的 VaR 表示损失值 95%
    的时间不会低于预测值，换句话说，损失将有 5% 的概率大于预测值。
- en: 'There are three common ways of computing value at risk:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 计算风险价值有三种常见方法：
- en: Parametric VaR
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参数化 VaR
- en: Historical VaR
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 历史 VaR
- en: Monte Carlo VaR
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 蒙特卡洛 VaR
- en: In this section, we will be capturing the first two, and the third one will
    be captured in the next section.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将介绍前两种方法，第三种将在下一节介绍。
- en: Parametric VaR
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参数化 VaR
- en: Parametric VaR is also known as the variance-covariance method and is used to
    find VaR using mean and standard deviation as parameters.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 参数VaR也称为方差-协方差法，用于通过均值和标准差作为参数计算VaR。
- en: '`qnorm` is used for value at risk calculation using parametric methods. It
    uses the parameters mean and standard deviation. The general syntax is as follows:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '`qnorm`用于通过参数法计算风险价值。它使用均值和标准差作为参数。一般语法如下：'
- en: '[PRE9]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here, `p` is the desired percentile; `mean` is the given mean of the sample;
    and `sd` is the standard deviation of the sample.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，`p`是所需的百分位数；`mean`是样本的给定均值；`sd`是样本的标准差。
- en: 'Let us assume that the average return of a stock is 2% and standard deviation
    is 4%, then the value at risk for a one day horizon at 95% confidence level using
    the parametric approach is given by executing the following approach:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 假设某只股票的平均收益率为2%，标准差为4%，那么使用参数法，在95%置信水平下，计算出一天期限的风险价值可以执行以下方法：
- en: '[PRE10]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'It generates the following output upon execution:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 执行后，它生成以下输出：
- en: '[PRE11]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Alternatively, we can find the VaR by the parametric method using the following
    code:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们可以使用以下代码通过参数法找到VaR：
- en: '[PRE12]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'It generates the output as shown here:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成如下的输出：
- en: '[PRE13]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Let us assume we have VaR for a one day horizon and, if we want to convert
    it at a different horizon, say a month, then it can be converted using the formula
    given here:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一天期限的VaR，如果我们想将其转换到不同的期限，比如一个月，可以使用这里给出的公式进行转换：
- en: '![Parametric VaR](img/00098.jpeg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![参数VaR](img/00098.jpeg)'
- en: Here, *T* is the number of days in a month.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*T*是一个月中的天数。
- en: '**Expected shortfall** (**ES**) is also known as conditional value of risk
    and it is an alternative to VaR. ES is a weighted average between the value at
    risk and the losses greater than value at risk. By means of ES, we try to quantify
    VaR.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**期望损失**（**ES**）也被称为风险条件值，是VaR的替代方法。ES是风险价值和大于风险价值的损失之间的加权平均。通过ES，我们试图量化VaR。'
- en: 'The ES/CVAR for the above example can be computed using the following example:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 上述示例的ES/CVAR可以使用以下示例计算：
- en: '[PRE14]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'It generates the following output:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '[PRE15]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Historical VaR
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 历史VaR
- en: The main assumption is that the past repeats itself. It does not assume any
    particular type of distribution. Historical VaR is estimated by simulating or
    constructing the **cumulative distribution function** (**CDF**) of asset returns
    over time. Generally, we find the returns on the regular time interval basis and
    sort them, and then find the relevant percentile.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 主要假设是过去会重演。它不假设任何特定的分布类型。历史VaR是通过模拟或构建资产收益的**累计分布函数**（**CDF**）来估算的。通常，我们按常规时间间隔找到收益并进行排序，然后找出相关的百分位数。
- en: 'Now let us try to find individual, as well as portfolio, VaR on a dataset.
    The dataset is generated by executing the following code:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们尝试在数据集上找到单独的VaR，以及投资组合的VaR。数据集是通过执行以下代码生成的：
- en: '[PRE16]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'It prepares the dataset required for historical VaR and displays a sample of
    the data as shown here:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 它准备好历史VaR所需的数据集，并显示如下的数据样本：
- en: '![Historical VaR](img/00099.jpeg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![历史VaR](img/00099.jpeg)'
- en: 'Figure 7.5: Return calculation output'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5：收益计算输出
- en: 'Now, let us try to estimate individual `historical` VaR of stocks by running
    the following code:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试通过运行以下代码估计个别股票的`历史`VaR：
- en: '[PRE17]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'It generates the following output:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Historical VaR](img/00100.jpeg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![历史VaR](img/00100.jpeg)'
- en: 'Figure 7.6: Historical individual output'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6：历史单独输出
- en: 'Similarly, let us try to estimate CVAR/ES, which can be computed using the
    following code:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，让我们尝试估计CVAR/ES，它可以使用以下代码计算：
- en: '[PRE18]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Upon executing, it generates the output as shown:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 执行后，它生成如下的输出：
- en: '![Historical VaR](img/00101.jpeg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![历史VaR](img/00101.jpeg)'
- en: 'Figure 7.7: Historical CVAR individual output'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.7：历史CVAR单独输出
- en: 'We can find a lot of options in the `VaR()` function. The most important ones
    are given here:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在`VaR()`函数中找到许多选项。这里列出了最重要的选项：
- en: '`R`: Matrix, xts vector, or DataFrame'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`R`：矩阵，xts向量或数据框'
- en: '`p`: Confidence level'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`p`：置信水平'
- en: '`method`: It uses four methods - modified, Gaussian, historical, and kernel'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`method`：它使用四种方法——修正法、高斯法、历史法和核方法'
- en: '`portfolio_method`: It has options - single, component, and marginal - defining
    whether to do univariate, component, or marginal calculation'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`portfolio_method`：它有三种选项——单一、成分和边际——定义是否进行单变量、成分或边际计算'
- en: 'Now let us try to find the `component` VaR of the portfolio. If the weights
    are not specified then it takes equal weights. It can be obtained by running the
    following code:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们尝试计算投资组合的`组件`VaR。如果没有指定权重，则默认为等权重。可以通过运行以下代码来获得：
- en: '[PRE19]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'It generates the following output:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Historical VaR](img/00102.jpeg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![历史VaR](img/00102.jpeg)'
- en: 'Figure 7.8: Historical VaR output by component method'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.8：通过组件法输出的历史VaR
- en: 'Similarly, we can find the `marginal` VaR by executing the following code:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们可以通过执行以下代码来找到`边际`VaR：
- en: '[PRE20]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'It generates the following result:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下结果：
- en: '![Historical VaR](img/00103.jpeg)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![历史VaR](img/00103.jpeg)'
- en: 'Figure 7.9: Historical VaR output by marginal output'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.9：通过边际输出法输出的历史VaR
- en: Monte Carlo simulation
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 蒙特卡罗模拟
- en: Monte Carlo simulation plays a very important role in risk management. Even
    if we have access to all the relevant information pertaining to risk associated
    with a firm, it is still not possible to predict the associated risk and quantify
    it. By the means of Monte Carlo simulation, we can generate all the possible scenarios
    of risk and using it, we can evaluate the impact of risk and build a better risk
    mitigation strategy.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 蒙特卡罗模拟在风险管理中起着非常重要的作用。即使我们获得了与公司相关的所有风险信息，仍然无法预测和量化相关风险。通过蒙特卡罗模拟，我们可以生成所有可能的风险情景，并利用这些情景评估风险的影响，从而构建更好的风险缓解策略。
- en: Monte Carlo simulation is a computational mathematical approach which gives
    the user the option of creating a range of possible outcome scenarios, including
    extreme ones, with the probability associated with each outcome. The possible
    outcomes are also drawn on the expected line of distribution, which may be closer
    to real outcomes. The range of possible outcomes can be used in risk analysis
    for building the models and drawing the inferences. Analysis is repeated again
    and again using a different set of random values from the probability function
    to test the model in order to build a robust model. Probability distributions
    are a much more realistic way of describing uncertainty in variables of a risk
    analysis. Monte Carlo simulation uses the concept of Brownian motion dynamics.
    Now we will demonstrate how to build a sample with a given distribution using
    Monte Carlo simulation, and will try to estimate VaR.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 蒙特卡罗模拟是一种计算数学方法，允许用户创建一系列可能的结果情景，包括极端情形，并为每个结果分配相应的概率。这些可能的结果也被绘制在期望的分布线中，这可能更接近真实结果。可能的结果范围可用于风险分析，用于构建模型并得出推论。分析会重复进行，每次使用概率函数中不同的一组随机值来测试模型，从而构建一个稳健的模型。概率分布是描述风险分析中变量不确定性的更现实的方式。蒙特卡罗模拟使用布朗运动动力学的概念。现在我们将演示如何使用蒙特卡罗模拟构建一个具有给定分布的样本，并尝试估算VaR。
- en: 'Let us assume we are trying to generate a sample of returns for `2000` months
    for a stock using normal distribution of `mean.20`, `sigma.25` and `deltat` =
    `.08333` for month. This can be done using the following code:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们要使用正态分布生成`2000`个月的股票回报样本，正态分布的均值为`mean.20`，标准差为`sigma.25`，时间间隔为`deltat`
    = `.08333`（每月）。这可以通过以下代码实现：
- en: '[PRE21]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'It generates the following displayed histogram:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下显示的直方图：
- en: '![Monte Carlo simulation](img/00104.jpeg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![蒙特卡罗模拟](img/00104.jpeg)'
- en: 'Figure 7.10: Histogram of returns generated by MCM'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.10：MCM生成的回报直方图
- en: 'Now let us try to find the mean and standard deviation of newly constructed
    sample, which is given by executing the following code:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们尝试计算新构建样本的均值和标准差，可以通过执行以下代码来获得：
- en: '[PRE22]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: It generates the mean as `0.1821` and standard deviation as `0.2439`, which
    is close to the mean and standard deviation taken for constructing the sample.
    Thus, clearly, the new sample is a normal distribution.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成的均值为`0.1821`，标准差为`0.2439`，与用于构建样本的均值和标准差接近。因此，显然，新的样本符合正态分布。
- en: 'The value at risk of the above series can be computed using the following code:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 上述系列的风险值可以使用以下代码计算：
- en: '[PRE23]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'It generates the following output:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '[PRE24]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Hedging
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对冲
- en: Hedging is basically taking a position in the market to reduce the risk. It
    is a strategy built to reduce the risk in investment using call/put options/futures
    short selling. The idea of hedging is to reduce the volatility of a portfolio
    by reducing the potential risk to loss. Hedging especially protects small businesses
    against catastrophic or extreme risk by protecting the cost at the time of distress.
    The tax laws also benefit those who do hedging. For firms who do hedging, it works
    like insurance and they have more independence to make their financial decisions
    without thinking about the risks.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 对冲基本上是通过在市场上采取一定的头寸来降低风险。这是一种旨在通过使用看涨/看跌期权或期货空头卖出减少投资风险的策略。对冲的理念是通过降低可能的损失风险来减少投资组合的波动性。对冲尤其能保护小型企业免受灾难性或极端风险的影响，从而在困境中锁定成本。税法对从事对冲的企业也有优惠。对于进行对冲的公司来说，它就像一种保险，他们可以更独立地做出财务决策，而不必过多考虑风险。
- en: 'Now, let us consider some scenarios of hedging:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们考虑一些对冲场景：
- en: '**Currency risk**: Also known as exchange-rate risk, it happens due to fluctuations
    in the prices of one currency with respect to another. Investors or companies
    who operate across the world are exposed to currency risk, which may lead to profit
    and losses. This risk can be reduced by hedging, which can prevent losses happening
    due to price fluctuation.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**汇率风险**：也称为汇率波动风险，因一种货币相对于另一种货币的价格波动而发生。跨国经营的投资者或公司面临汇率风险，这可能导致盈亏。通过对冲，可以减少这种风险，从而避免因价格波动导致的损失。'
- en: '**Short hedge**: Let us suppose a farmer is planning to plant 200,000 bushels
    of corn and will be ready for harvesting in the next 2 months and for delivery
    in the consecutive month. The farmer knows from his experience that the cost of
    planting and harvesting is $5.30 per bushel. Delivery month corn futures are traded
    at $5.70 per bushel. The farmer wants to lock his selling price so he enters a
    short hedge by selling some delivery month futures. Each corn future contract
    consists of 5,000 bushels. He will need to sell 40 future contracts. For his crop
    protection in the delivery month, he realizes that the price of corn has gone
    down and is priced at $5.20 per bushel and the price of a delivery month future
    contract has also reduced to **$5.40 per bushel**.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**空头对冲**：假设一个农民计划种植200,000蒲式耳的玉米，并将在接下来的2个月内收获，随后交割。农民凭借经验知道，种植和收获的成本是每蒲式耳$5.30。交割月的玉米期货交易价格为每蒲式耳$5.70。农民希望锁定自己的销售价格，因此他通过卖出一些交割月期货进行空头对冲。每个玉米期货合约包括5,000蒲式耳，他需要卖出40份期货合约。为了保护交割月份的作物，他发现玉米价格下跌，现货价格为每蒲式耳$5.20，而交割月期货合约的价格也降至**$5.40每蒲式耳**。'
- en: Selling the corn in the cash market generates him a sum of **$5.20*200,000 =
    $1,040,000.**
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在现货市场出售玉米为他带来了**$5.20*200,000 = $1,040,000**。
- en: Total cost incurred is $1,060,000 so he may suffer a loss of **$20,000**.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 总成本为$1,060,000，因此他可能会遭受**$20,000**的损失。
- en: But, since he has hedged some value of corn futures sold in planting month =
    **$5.70*200,000=$1,140,000.**
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，由于他已经对冲了种植月份出售的部分玉米期货价值 = **$5.70*200,000=$1,140,000**。
- en: Value of corn futures bought in delivery month = **$5.40*200,000=1,080,000.**
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 交割月份买入的玉米期货价值 = **$5.40*200,000=1,080,000**。
- en: So gain in future market is **1,140,000-1,080,000=$60,000.**
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 所以期货市场的收益是**1,140,000-1,080,000=$60,000**。
- en: So overall profit is **$60,000-$20,000=$40,000.**
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 所以整体利润是**$60,000-$20,000=$40,000**。
- en: Similarly, according to requirement, the investor can do long hedging.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，根据需要，投资者可以进行长期对冲。
- en: The most common instruments used for hedging are forward contracts, future contracts,
    and option contracts.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 对冲中最常用的工具是远期合约、期货合约和期权合约。
- en: Basel regulation
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 巴塞尔法规
- en: The main goal for the Basel Committee on Banking Supervision is to improve understanding
    of key supervisory issues to set a healthy banking supervision worldwide. Its
    main objective is to develop regulatory frameworks in order to improve banking
    systems. Currently, Basel III has been developed to meet the deficiencies in financial
    regulations exposed during the financial crisis of 2007-2008\. Basel III is a
    global voluntary regulatory framework on bank capital adequacy, stress testing,
    and market liquidity risk. It is assumed to strengthen bank capital requirements
    by decreasing bank leverage and increasing bank liquidity. The objective of implementing
    Basel III is to make the banking sector more robust so that it can absorb shocks
    arising from financial and economic stress, improve risk management and governance,
    and strengthen banks' transparency and disclosures.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 巴塞尔银行监管委员会的主要目标是加深对关键监管问题的理解，以制定全球健康的银行监管。其主要目标是制定监管框架，以改善银行体系。目前，巴塞尔 III 已经制定，以弥补在2007-2008年金融危机中暴露的金融监管不足。巴塞尔
    III 是一个全球自愿性的银行资本充足性、压力测试和市场流动性风险的监管框架。其目标是通过减少银行杠杆并增加银行流动性来加强银行的资本要求。实施巴塞尔 III
    的目的是使银行业更加稳健，以便能够应对由金融和经济压力引发的冲击，改善风险管理和治理，并加强银行的透明度和信息披露。
- en: The R community has developed a library, SACCR, keeping in mind the regulations
    of Basel III. This library has many methods which are based upon the standardized
    norms of Basel III. It has implemented all the examples appearing in the regulatory
    framework. For example, it computes exposure at default according to Basel norms.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: R 社区开发了一个名为 SACCR 的库，旨在遵守巴塞尔 III 的监管规定。这个库包含了许多基于巴塞尔 III 标准化规范的方法，已实现所有出现在监管框架中的示例。例如，它根据巴塞尔规范计算违约敞口。
- en: It uses the function `CalcEAD(RC,PFE)` to calculate the exposure of default.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 它使用函数 `CalcEAD(RC,PFE)` 来计算违约敞口。
- en: Here, `RC` is replacement cost and `PFE` is projected future exposure.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`RC` 是替代成本，`PFE` 是预测的未来敞口。
- en: 'So, if the `RC` component is `50` and `PFE` is `400` then executing the following
    code finds exposure at default:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如果 `RC` 组件为 `50`，`PFE` 为 `400`，那么执行以下代码会计算违约敞口：
- en: '[PRE25]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: It generates the output `630`.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 它会生成输出 `630`。
- en: Similarly, there are other functions in this library on the basis of implementation
    of Basel III.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，这个库中还有其他基于巴塞尔 III 实现的函数。
- en: Credit risk
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 信用风险
- en: 'Credit risk is the risk associated with an investment where the borrower is
    not able to repay the amount to the lender. This can happen on account of poor
    financial conditions of the borrower, and it represents a risk for the lender.
    The risk is for the lender to incur loss due to non-payment and hence disruption
    of cash flows and increased collection costs. The loss may be complete or partial.
    There are multiple scenarios in which a lender can suffer loss. Some of the scenarios
    are given here:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 信用风险是与投资相关的风险，指借款人无法按时向贷款人偿还款项。这可能是由于借款人财务状况不佳引起的，且对贷款人构成风险。风险表现为贷款人因未能收回款项而遭受损失，从而导致现金流中断和催收成本增加。损失可能是完全的，也可能是部分的。贷款人可能面临多种场景下的损失，以下是其中的一些情形：
- en: A customer not making a payment on a mortgage loan, credit card, line of credit,
    or other type of loan
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户未支付抵押贷款、信用卡、信用额度或其他类型的贷款
- en: Business/consumer not paying due trade invoice
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 商业/消费者未支付到期的交易发票
- en: A business not paying an employee's due earned wages
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 企业未支付员工到期的应得工资
- en: A business/government bond issuer not making payment on a due coupon or principal
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 商业/政府债券发行人未按期支付到期的利息或本金
- en: An insurance company not obliging its policy obligation due
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保险公司未履行其到期的保单义务
- en: A bank not returning funds of depositors
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 银行未按时返还存款人的资金
- en: 'It is a practice of mitigating losses by understanding the adequacy of a bank''s
    capital and loan loss reserves at any given time. In order to reduce the credit
    risk, the lender needs to develop a mechanism to perform a credit check on the
    prospective borrower. Generally, banks quantify the credit risk using two metrics
    - expected loss and economic capital. Expected loss is the value of a possible
    loss times the probability of that loss occurring. Economic capital is the amount
    of capital necessary to cover unexpected losses. There are three risk parameters
    that are essential in the process of calculating the EL and EC measurements: the
    **probability of default** (**PD**), **loss given default** (**LGD**), and **exposure
    at default** (**EAD**). Calculation of PD is more important, so we will be discussing
    it.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 它是一种通过理解银行资本和贷款损失准备金的充分性来减轻损失的做法。为了减少信用风险，贷款方需要建立机制，对潜在借款人进行信用检查。通常，银行使用两种指标来量化信用风险——预期损失和经济资本。预期损失是可能损失的价值与该损失发生的概率的乘积。经济资本是用来覆盖意外损失所需的资本额。在计算预期损失（EL）和经济资本（EC）的过程中，有三个风险参数至关重要：**违约概率**（**PD**）、**违约损失率**（**LGD**）和**违约时的敞口**（**EAD**）。违约概率的计算更为重要，因此我们将重点讨论它。
- en: 'For building the PD model, let us use the subset of German Credit Data available
    in R. Data used for the analysis is given by executing the following code:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 为了构建PD模型，我们将使用R中提供的德国信用数据子集。执行以下代码即可获得用于分析的数据：
- en: '[PRE26]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Before starting the modeling, we need to understand the data, which can be
    done by executing the following code:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始建模之前，我们需要了解数据，可以通过执行以下代码来实现：
- en: '[PRE27]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'It gives us the column types and kind of values it has, as shown here:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 它为我们提供了列类型及其包含的值，如下所示：
- en: '![Credit risk](img/00105.jpeg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00105.jpeg)'
- en: 'Figure 7.11: Column description of the dataset'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.11：数据集的列描述
- en: 'In this example, our target variable is `Class`. `Class = Good` means non-defaulter
    and `Class = bad` means defaulter. Now, to understand the distribution of all
    the numeric variables, we can compute all the basic statistics related to the
    numeric attributes. This can be done by executing the following code:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们的目标变量是`Class`。`Class = Good`表示非违约者，`Class = bad`表示违约者。现在，为了了解所有数值变量的分布，我们可以计算与数值属性相关的所有基本统计数据。可以通过执行以下代码来实现：
- en: '[PRE28]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'A sample of the output generated by the preceding code is displayed here:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 前述代码生成的输出样本如下所示：
- en: '![Credit risk](img/00106.jpeg)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00106.jpeg)'
- en: Figure 7.12 Basic statistics of numeric variables
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.12 数值变量的基本统计
- en: 'Now let us prepare our data for modeling by executing the following code:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码准备数据进行建模：
- en: '[PRE29]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: The preceding code generates `Train` and `Test` data for modeling.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 前述代码生成了用于建模的`Train`和`Test`数据。
- en: The proportion of selecting the `Train` and `Test` data is quite subjective.
    Now we can do basic statistics for imputation of missing/outlier values and exploratory
    analysis (such as information value analysis and correlation matrix) of the independent
    variables with respect to dependent variables for understanding the relationship.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 选择`Train`和`Test`数据的比例相当主观。现在我们可以进行基本统计，填补缺失值或异常值，并进行探索性分析（如信息价值分析和相关矩阵），以了解自变量与因变量之间的关系。
- en: 'Now let us try to fit the model on the `Train` data, which can be done by executing
    the following code:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试在`Train`数据上拟合模型，可以通过执行以下代码来实现：
- en: '[PRE30]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'It generates the summary of the model as displayed here:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成如这里所示的模型摘要：
- en: '![Credit risk](img/00107.jpeg)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00107.jpeg)'
- en: 'Figure 7.13: Output summary of logistic regression'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.13：逻辑回归的输出摘要
- en: As we can see in the summary, by means of Pvalues, there are significant as
    well as insignificant attributes in the model. Keeping in mind the significance
    of attributes and multicollinearity, we can iterate the model to find the best
    model. In our case, let us rerun the model with only significant attributes.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们在摘要中看到的，通过P值可以识别模型中的显著和非显著属性。考虑到属性的显著性和多重共线性，我们可以迭代模型，找到最佳模型。在我们的案例中，让我们只使用显著属性重新运行模型。
- en: 'This can be done by executing the following code:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过执行以下代码来实现：
- en: '[PRE31]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'It generates the summary output as follows:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成如下所示的摘要输出：
- en: '![Credit risk](img/00108.jpeg)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00108.jpeg)'
- en: 'Figure 7.14: Output summary of logistic regression having only significant
    attributes'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.14：仅包含显著属性的逻辑回归输出摘要
- en: The output summary shows that all the attributes considered in the model are
    significant.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 输出摘要显示，模型中考虑的所有属性都是显著的。
- en: There are a lot of statistics in logistic regression for checks of model accuracy
    and in this case, we will be showing the ROC curve and the confusion matrix for
    accuracy checks.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归中有许多统计数据可以用来检查模型的准确性，在这种情况下，我们将显示 ROC 曲线和混淆矩阵来进行准确性检查。
- en: 'We can compute the threshold for classification by KS statistics but here let
    us assume the threshold value is `0.5` and try to score our `Train` sample by
    executing the following code:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过 KS 统计量计算分类的阈值，但在这里让我们假设阈值为 `0.5`，并通过执行以下代码尝试为我们的 `Train` 样本打分：
- en: '[PRE32]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'It generates the confusion matrix as displayed here:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成了如下所示的混淆矩阵：
- en: '![Credit risk](img/00109.jpeg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00109.jpeg)'
- en: 'Figure 7.15: Confusion matrix for logistic regression'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.15：逻辑回归的混淆矩阵
- en: 'Now, let us compute the `auc` by executing the following code:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码来计算 `auc`：
- en: '[PRE33]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'It gives the value of `auc` as shown here:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 它给出了 `auc` 的值，如下所示：
- en: '[PRE34]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Now, let us plot the ROC curve by executing the following code:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码绘制 ROC 曲线：
- en: '[PRE35]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'It plots the ROC curve as shown here:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 它绘制了如图所示的 ROC 曲线：
- en: '![Credit risk](img/00110.jpeg)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![信用风险](img/00110.jpeg)'
- en: 'Figure 7.16: ROC curve'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.16：ROC 曲线
- en: We can use the same model fit created on `Train_data` and score `Test_data`
    and check whether the accuracy measures are in the same range or not to validate
    the model.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用在 `Train_data` 上创建的相同模型，并对 `Test_data` 进行评分，检查准确度指标是否在相同范围内，从而验证模型。
- en: Fraud detection
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 欺诈检测
- en: Identifying fraudulent transactions is one of the most important components
    of risk management. R has many functions and packages that can be used to find
    fraudulent transactions, including binary classification techniques such as logistic
    regression, decision tree, random forest, and so on. We will be again using a
    subset of the German Credit data available in R library. In this section, we are
    going to use random forest for fraud detection. Just like logistic regression,
    we can do basic exploratory analysis to understand the attributes. Here we are
    not going to do the basic exploratory analysis but will be using the labeled data
    to train the model using random forest, and then will try to do the prediction
    of fraud on validation data.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 识别欺诈交易是风险管理中最重要的组成部分之一。R 语言有许多函数和包可以用来发现欺诈交易，包括逻辑回归、决策树、随机森林等二分类技术。我们将再次使用 R
    库中的德国信用数据子集。在本节中，我们将使用随机森林进行欺诈检测。与逻辑回归一样，我们可以进行基本的探索性分析以了解属性。这里我们不会进行基础的探索性分析，而是使用标记数据来训练模型，使用随机森林，然后尝试在验证数据上进行欺诈预测。
- en: 'So the dataset used for the analysis will be given by executing the following
    code:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，分析所用的数据集可以通过执行以下代码来获取：
- en: '[PRE36]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'It generates a few lines of the sample data:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成了一些示例数据行：
- en: '![Fraud detection](img/00111.jpeg)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![欺诈检测](img/00111.jpeg)'
- en: 'Figure 7.17: Sample data used for fraud analysis'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.17：用于欺诈分析的示例数据
- en: 'The class will be our target variable in the dataset and a class with level
    bad means fraud has been committed by the customer. Now let us divide the preceding data
    into `train` and `test` samples by executing the following code:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 类别将是数据集中的目标变量，类别为 "bad" 表示客户已实施欺诈。现在，让我们通过执行以下代码将前面的数据划分为 `train` 和 `test` 样本：
- en: '[PRE37]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: It generates the `Train` and `Test` data.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成了 `Train` 和 `Test` 数据。
- en: 'Now, let us try to build the classification model on the train sample with
    the random forest technique. This can be done by executing the following code:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们尝试使用随机森林技术在训练样本上构建分类模型。可以通过执行以下代码来完成：
- en: '[PRE38]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'It generates the following output:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Fraud detection](img/00112.jpeg)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![欺诈检测](img/00112.jpeg)'
- en: 'Figure 7.18: Output summary of logistic random forest'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.18：逻辑回归随机森林的输出摘要
- en: 'The error for the trees can also be plotted by executing the following code:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过执行以下代码绘制树的误差：
- en: '[PRE39]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Here is the output generated:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 这是生成的输出：
- en: '![Fraud detection](img/00113.jpeg)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![欺诈检测](img/00113.jpeg)'
- en: 'Figure 7.19: Error plot for trees of random forest'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.19：随机森林树的误差图
- en: 'The comparative importance of the attributes can be given by executing the
    following code:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过执行以下代码来给出属性的相对重要性：
- en: '[PRE40]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'It generates the following output:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下输出：
- en: '![Fraud detection](img/00114.jpeg)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![欺诈检测](img/00114.jpeg)'
- en: 'Figure 7.20: Variable comparison summary by random forest'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.20：随机森林的变量比较摘要
- en: 'Now, let us do classification on the test data by executing the following code:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们通过执行以下代码对测试数据进行分类：
- en: '[PRE41]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'It generates the following classification table:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 它生成以下分类表：
- en: '![Fraud detection](img/00115.jpeg)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![欺诈检测](img/00115.jpeg)'
- en: 'Figure 7.21: Classification summary of random forest'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.21：随机森林的分类总结
- en: Liability management
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 负债管理
- en: Liability management is the process of keeping appropriate liquidity reserves
    and allocating assets by financial institutions to balance outstanding liabilities
    such as deposits, CDs, and so on to obtain best performance by simultaneously
    meeting liabilities and growing net assets. Banks have several risks - asset management
    risk, interest rate risk, and currency exchange risks - and by using liability
    management, banks and financial institutions try to minimize the risk.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 负债管理是金融机构保持适当流动性储备和分配资产的过程，目的是平衡未偿付负债（如存款、定期存单等），通过同时满足负债并增长净资产来获得最佳表现。银行面临着多种风险——资产管理风险、利率风险和汇率风险——通过负债管理，银行和金融机构试图最小化这些风险。
- en: In this chapter, we have discussed several topics, such as market risk, portfolio
    risk, credit risk, fraud detection, diversification of portfolios, optimization
    of portfolios, and rebalancing of the portfolio, which can help financial in situation
    with liability management.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了多个主题，如市场风险、投资组合风险、信用风险、欺诈检测、投资组合的多样化、投资组合优化以及投资组合再平衡，这些内容可以帮助金融领域处理负债管理问题。
- en: Questions
  id: totrans-249
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What is market risk and how can R help in measuring market risk? Please give
    an example.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么是市场风险？R如何帮助衡量市场风险？请举例说明。
- en: What are the ways of measuring risk associated with the portfolio?
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 衡量投资组合相关风险的方法有哪些？
- en: What are the most common ways of measuring VaR? Please construct a portfolio
    and find VaR using all the methods.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 衡量VaR的最常见方法有哪些？请构建一个投资组合并使用所有方法计算VaR。
- en: How do you compute ES/CVAR in R?
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何在R中计算ES/CVAR？
- en: Construct a sample using normal and lognormal distribution using the Monte Carlo
    method and find the historical VaR for each of them.
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用蒙特卡洛方法构造一个样本，采用正态分布和对数正态分布，并计算它们的历史VaR。
- en: How do you find component and marginal VaR for a portfolio in R?
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何在R中为一个投资组合找到组件和边际VaR？
- en: What is credit scoring and how do you execute it in R? Construct an example
    and build a scoring example along with validation.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 什么是信用评分？你如何在R中执行信用评分？请构造一个例子并构建一个评分示例并进行验证。
- en: What are the ways to identify fraud? How do you execute them in R?
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何识别欺诈行为？你如何在R中执行这些方法？
- en: Summary
  id: totrans-258
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have covered the types of risks associated with financial
    institutions, such as market risk, portfolio risk, VaR, Monte Carlo simulation,
    hedging, Basel regulations, credit risk, and fraud detection. Also, we have discussed
    how the strengths of R can be leveraged for measuring different types of risk.
    In this chapter, we have demonstrated examples of measuring risks such as market,
    portfolio, and credit using R, and also how to use techniques such as random forest
    classification for fraud detection.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了金融机构面临的各种风险类型，如市场风险、投资组合风险、VaR、蒙特卡洛模拟、对冲、巴塞尔协议、信用风险和欺诈检测。我们还讨论了如何利用R的优势来衡量不同类型的风险。在本章中，我们展示了如何使用R衡量市场、投资组合和信用风险，并展示了如何使用随机森林分类技术进行欺诈检测。
- en: In the next chapter, we will be covering various optimization techniques used
    in trading algorithms and parameter estimation. Optimization techniques such as
    dynamic rebalancing, walk forward testing, grid testing, and genetic algorithm
    will be covered.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍在交易算法和参数估计中使用的各种优化技术。将涵盖的优化技术包括动态再平衡、前向步进测试、网格测试和遗传算法。
