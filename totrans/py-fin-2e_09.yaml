- en: Chapter 9. Portfolio Theory
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第9章 投资组合理论
- en: 'Understanding portfolio theory is very important in learning finance. It is
    well known that *don''t put all your eggs in one basket*, that is, it is a great
    idea to diversify away your risk. However, very few know the implied assumption
    behind such a famous idiom. In this chapter, we will discuss various risk measures
    for individual stocks or portfolios, such as Sharpe ratio, Treynor ratio, Sortino
    ratio, how to minimize portfolio risk based on those measures (ratios), how to
    set up an objective function, how to choose an efficient portfolio for a given
    set of stocks, and how to construct an efficient frontier. Our focus is on how
    to apply portfolio theory by using real-world data. For instance, today we have
    $2 million cash and plan to purchase IBM and Walmart stocks. If we have 30% invested
    in the first one and the rest in the second, what is our portfolio risk? What
    is the least risky portfolio that we could form based on those two stocks? How
    about 10 or 500 stocks? In this chapter, the following topics will be covered:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 理解投资组合理论对于学习金融非常重要。众所周知，*不要把所有的鸡蛋放在一个篮子里*，也就是说，分散风险是一个非常好的主意。然而，很少有人知道这种著名谚语背后的隐含假设。在本章中，我们将讨论个别股票或投资组合的各种风险衡量指标，如夏普比率、特雷诺比率、索提诺比率，如何基于这些指标（比率）最小化投资组合风险，如何设置目标函数，如何为给定的股票选择高效投资组合，以及如何构建有效前沿。我们的重点是如何使用实际数据应用投资组合理论。例如，今天我们有200万美元的现金，计划购买IBM和沃尔玛的股票。如果我们将30%的资金投资于第一只股票，剩下的投资于第二只股票，那么我们的投资组合风险是多少？我们能基于这两只股票构建出最小风险的投资组合吗？如果是10只或500只股票呢？本章将涵盖以下主题：
- en: Introduction to portfolio theory
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 投资组合理论简介
- en: A 2-stock portfolio
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两只股票的投资组合
- en: N-stock portfolio
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: N只股票的投资组合
- en: Correlation versus diversification effect
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关性与多样化效应
- en: Producing a return matrix
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成收益矩阵
- en: Generating an optimal portfolio based on Sharpe ratio, Treynor ratio, and Sortinor
    ratio
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于夏普比率、特雷诺比率和索提诺比率生成最优投资组合
- en: Constructing an efficient frontier
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建有效前沿
- en: Modigliani and Modigliani performance measure (M2 measure)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 莫迪利安尼和莫迪利安尼绩效衡量（M2衡量）
- en: Introduction to portfolio theory
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 投资组合理论简介
- en: 'The keyword for the portfolio theory is diversification, while the keyword
    for diversification is correlation. In other words, correlation is used to measure
    how closely two stocks or portfolios are moving together. The objective of portfolio
    theory is to allocate our assets optimally with respect to risk and return. Markowitz
    (1952) argues that we should consider only the first two moments of a security''s
    return distribution: mean and variance. For financial markets, several important
    assumptions are made, such as stock markets are inefficient, a typical investor
    is rational, and an arbitrage opportunity would not last long. For the preferences
    between two stocks, for a given risk, a rational investor would prefer stock with
    a higher expected return; for a given return, a rational investor prefers stock
    with a lower risk level. Sometimes, a single period portfolio optimization is
    called *Markowitz Portfolio Optimization*. The input includes a return matrix,
    and a variance and covariance matrix, while the output is an efficient portfolio.
    By connecting numerous efficient portfolios, an efficient frontier is formed.
    Here, we start with the simplest scenario: a two-stock portfolio.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 投资组合理论的关键字是**多样化**，而多样化的关键字是**相关性**。换句话说，相关性用于衡量两只股票或投资组合之间的共同运动程度。投资组合理论的目标是根据风险和收益最优地分配我们的资产。马科维茨（1952年）认为，我们应只考虑证券收益分布的前两个时刻：均值和方差。对于金融市场，做出了一些重要假设，例如股市无效、典型投资者是理性的、套利机会不会持续太长时间。对于两只股票之间的偏好，对于给定的风险，理性投资者会偏好预期收益较高的股票；对于给定的收益，理性投资者偏好风险较低的股票。有时，单期投资组合优化被称为*马科维茨投资组合优化*。输入包括收益矩阵、方差和协方差矩阵，而输出是高效投资组合。通过连接众多高效投资组合，形成了有效前沿。在这里，我们从最简单的情境开始：一个由两只股票组成的投资组合。
- en: A 2-stock portfolio
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 两只股票的投资组合
- en: 'Clearly, a 2-stock portfolio is the simplest one. Let''s assume that the weights
    of those two stocks are *w1* and *w2*. The portfolio returns are given here:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，两只股票的投资组合是最简单的假设。假设这两只股票的权重分别是*w1*和*w2*。投资组合的收益如下所示：
- en: '![A 2-stock portfolio](img/B06175_09_01.jpg)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![两只股票的投资组合](img/B06175_09_01.jpg)'
- en: 'Here, *Rp,t*, is the portfolio return at time *t*, *w1* (*w2*) is the weight
    for stock 1 (2), and *R1,t* (*R2,t*) is return at time *t* for stock 1 (2). When
    talking about expected return or mean, we have a quite similar formula:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*Rp,t* 是在时间 *t* 的投资组合回报，*w1*（*w2*）是股票1（2）的权重，而 *R1,t*（*R2,t*）是股票1（2）在时间
    *t* 的回报。当谈到预期回报或均值时，我们有一个类似的公式：
- en: '![A 2-stock portfolio](img/B06175_09_02.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_02.jpg)'
- en: 'Here, ![A 2-stock portfolio](img/B06175_09_73.jpg) is the mean or expected
    portfolio returns and ![A 2-stock portfolio](img/B06175_09_03.jpg) ![A 2-stock
    portfolio](img/B06175_09_04.jpg) is the mean or expected returns for stock 1 (2).
    The variance of such a 2-stock portfolio is given here:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，![一个两只股票的投资组合](img/B06175_09_73.jpg) 是均值或预期的投资组合回报，而![一个两只股票的投资组合](img/B06175_09_03.jpg)
    ![一个两只股票的投资组合](img/B06175_09_04.jpg) 是股票1（2）的均值或预期回报。此类两只股票的投资组合的方差定义如下：
- en: '![A 2-stock portfolio](img/B06175_09_05.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_05.jpg)'
- en: 'Here, ![A 2-stock portfolio](img/B06175_09_06.jpg) is the portfolio variance
    and ![A 2-stock portfolio](img/B06175_09_07.jpg) is the standard deviation for
    stock 1 (2). The definitions of variance and standard for stock 1 are shown here:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，![一个两只股票的投资组合](img/B06175_09_06.jpg) 是投资组合的方差，![一个两只股票的投资组合](img/B06175_09_07.jpg)
    是股票1（2）的标准差。股票1的方差和标准差的定义如下：
- en: '![A 2-stock portfolio](img/B06175_09_08.jpg) ![A 2-stock portfolio](img/B06175_09_09.jpg)
    is the covariance (correlation) between stocks 1 and 2\. They are defined here:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '![一个两只股票的投资组合](img/B06175_09_08.jpg) ![一个两只股票的投资组合](img/B06175_09_09.jpg) 是股票1和股票2之间的协方差（相关性）。它们在此定义如下：'
- en: '![A 2-stock portfolio](img/B06175_09_10.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_10.jpg)'
- en: For covariance, if it is positive, then those two stocks usually would move
    together. On the other hand, if it is negative, they would move in the opposite
    way most of times. If the covariance is zero, then they are not related. However,
    if we know that ![A 2-stock portfolio](img/B06175_09_11.jpg) we could not claim
    whether A is strongly correlated with B than C, or the other way around. On the
    other hand, if ![A 2-stock portfolio](img/B06175_09_12.jpg) we would claim that
    A is strongly correlated with B than A. This suggests that correlation is more
    useful than covariance. The range of a correlation is from -1 to 1\. The lower
    the value of correlation, the higher is the effectiveness of the diversification
    effect. When the correlation is -1 (1), it is called perfectively negatively (positively)
    correlated. When two stocks (or portfolios) are perfectively positively correlated
    there is no diversification.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 对于协方差，如果它是正的，那么这两只股票通常会一起变动。另一方面，如果它是负的，它们通常会朝相反的方向变动。如果协方差为零，那么它们没有相关性。然而，如果我们知道![一个两只股票的投资组合](img/B06175_09_11.jpg)，我们不能断言A与B的相关性比A与C的相关性强，或反之亦然。另一方面，如果![一个两只股票的投资组合](img/B06175_09_12.jpg)，我们则可以断言A与B的相关性比A与A的相关性强。这表明相关性比协方差更有用。相关性的范围从-1到1。相关性值越低，分散化效应越强。当相关性为-1（1）时，称为完全负相关（完全正相关）。当两只股票（或投资组合）完全正相关时，就没有分散化。
- en: Assume that the volatilities (standard deviations) of two stocks are 0.06 and
    0.24 and they are perfectively negatively correlated. What are two weights in
    order to form a zero-risk portfolio? There exist several methods to find a solution.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 假设两只股票的波动率（标准差）分别为0.06和0.24，并且它们是完全负相关的。为了形成一个零风险投资组合，需要什么样的权重？有几种方法可以找到解决方案。
- en: 'Method 1: we could manually find a solution: plug in given values into Equation
    (3) and set it equal to zero where *x=x1* and *x2=1-x*:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 方法1：我们可以手动找到一个解：将给定的值代入方程（3），并设其等于零，其中 *x=x1* 且 *x2=1-x*：
- en: '![A 2-stock portfolio](img/B06175_09_13.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_13.jpg)'
- en: 'After expanding and collecting terms, we would end up with the following general
    equation:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展并整理项后，我们将得到以下通用方程：
- en: '![A 2-stock portfolio](img/B06175_09_14.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_14.jpg)'
- en: 'For such a general form, we have the following two solutions if the term inside
    the square root is positive, that is, ![A 2-stock portfolio](img/B06175_09_15.jpg):'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种通用形式，如果根号内的项为正，即![一个两只股票的投资组合](img/B06175_09_15.jpg)，我们有以下两种解法：
- en: '![A 2-stock portfolio](img/B06175_09_16.jpg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![一个两只股票的投资组合](img/B06175_09_16.jpg)'
- en: 'Based on a set of *a*, *b*, and *c*, we have a solution of x=80%, that is,
    when *w1=0.80* and *w2=0.2*, the preceding 2-stock portfolio will be risk-free.
    Assume that we have an equation of *x2+6x+3=0*, the following Python program offers
    two solutions:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 基于一组 *a*、*b* 和 *c*，我们得到了一个解 x=80%，即当 *w1=0.80* 和 *w2=0.2* 时，前述两只股票组合将是无风险的。假设我们有一个方程
    *x2+6x+3=0*，以下 Python 程序提供两个解：
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Method 2: For a given pair of standard deviations (or a pair of variances)
    plus a correlation between those two stocks, we generate many weights for stock
    1, such as 0, 0.001, 0.002, 0.003, and the like. Remember that *w2=1-w1*. By applying
    Equation (3), we estimate the variances of this 2-stock portfolio. Our final solution
    will be the pair of *w1* and *w2* achieving the minimum portfolio variance, see
    the following code:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 方法 2：对于一对给定的标准差（或一对方差）以及它们之间的相关性，我们生成许多股票1的权重，例如 0、0.001、0.002、0.003 等。记住，*w2=1-w1*。通过应用公式（3），我们估计这个两只股票组合的方差。我们的最终解决方案将是实现最小组合方差的
    *w1* 和 *w2*，请参见以下代码：
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'First, the result confirms our previous result with *w1=0.8* and *w2=0.2*.
    In the program, we have 1000 pairs of *w1* and *w2*. A small value, called `tiny`,
    is *1/1000=0.001*. The first pair of two weights is 0.1% and 99.9%. A very big
    number is assigned to our solution variable, that is, as an initial value. In
    this program, `portVar=10`. Other big numbers would work perfectly, such as 100\.
    Here is the logic: based on the first pair of *w1* and *w2*, we estimate the portfolio
    variance. If this new portfolio variance is less than `portVar`, we replace `portVar`
    with this new value and record *w1* as well. If the new portfolio variance is
    bigger than `portVar`, we do nothing. Repeat the same procedure until we finish
    the loop. Here is an analogy. Assume that we want to find the tallest person among
    1,000 persons. Assume that we have a variable call `tallestPerson` and its initial
    vale is 0.1 inch. Since every person will be taller than this value, the first
    person''s height will replace this value. If the next person''s height is higher
    than this variable, we replace it. Otherwise, we go to the next one. The procedure
    is repeated until the last person. In terms of efficiency, one small trick is
    to estimate `var1` and `var2` just once.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，结果确认了我们之前的结果，其中 *w1=0.8* 和 *w2=0.2*。在程序中，我们有1000对 *w1* 和 *w2*。一个很小的值，称为 `tiny`，是
    *1/1000=0.001*。第一对两个权重是 0.1% 和 99.9%。我们为我们的解变量分配一个非常大的数字，作为初始值。在这个程序中，`portVar=10`。其他大数字也完全有效，比如100。这里的逻辑是：基于第一对
    *w1* 和 *w2*，我们估计组合方差。如果这个新的组合方差小于 `portVar`，我们就用这个新值替换 `portVar` 并记录 *w1*。如果新的组合方差大于
    `portVar`，我们什么也不做。重复相同的过程，直到完成循环。这里有个类比。假设我们想在1000人中找到身高最高的人。假设我们有一个变量叫 `tallestPerson`，初始值为
    0.1 英寸。由于每个人都会比这个值高，第一个人的身高将替代这个值。如果下一个人的身高比这个变量还高，我们就替换它。否则，我们就到下一个人。这个过程会一直重复，直到最后一个人。在效率方面，有一个小技巧，就是只需估算一次
    `var1` 和 `var2`。
- en: 'In finance, it is a convention to use both variance and standard deviation
    to represent risk, since they describe uncertainty. Usually, we use standard deviation
    of returns to represent the volatility. It is a good idea to look at the impact
    of correlation on the efficient frontier. First, let''s learn how to generate
    a set of correlated random numbers. There are two steps involved:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融领域，使用方差和标准差来表示风险是一种惯例，因为它们描述了不确定性。通常，我们使用收益的标准差来代表波动性。观察相关性对有效前沿的影响是一个不错的主意。首先，让我们学习如何生成一组相关的随机数。涉及两个步骤：
- en: Generate two random time series, *x1* and *x2*, with a zero-correlation.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成两个随机时间序列，*x1* 和 *x2*，其相关性为零。
- en: Apply the following formula:![A 2-stock portfolio](img/B06175_09_17.jpg)
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用以下公式：![一个两只股票组合](img/B06175_09_17.jpg)
- en: 'Here ρ is the predetermined correlation between those two time series. Now,
    *y1* and *y2* are correlated with a predetermined correlation. The following Python
    program would implement the preceding approach:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这里 ρ 是预定的两个时间序列之间的相关性。现在，*y1* 和 *y2* 是具有预定相关性的。以下 Python 程序将实现前述方法：
- en: '[PRE2]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Optimization – minimization
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 优化 – 最小化
- en: 'Before discussing how to generate an optimal portfolio, it is necessary to
    study a few optimization functions. In the following example, we minimize our
    objective function of y:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在讨论如何生成最优组合之前，有必要研究几个优化函数。在以下示例中，我们最小化目标函数 y：
- en: '![Optimization – minimization](img/B06175_09_18.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_18.jpg)'
- en: 'First, let''s look at the graph of this objective function, see the following
    code:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们看一下该目标函数的图形，见以下代码：
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The graph is shown here:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图形如下所示：
- en: '![Optimization – minimization](img/B06175_09_19.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_19.jpg)'
- en: 'To make the program more general, two coefficients of `a` and `b` are generated.
    Apparently, since the power of `x` is 2, `y` is minimized only when `x` is 0\.
    The Python code for minimization is as follows:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使程序更具通用性，生成了两个系数`a`和`b`。显然，由于`x`的幂为2，`y`只有在`x`为0时才最小化。最小化的Python代码如下：
- en: '[PRE4]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'In the preceding program, the major function used is called the `scipy.optimize.minimize()`
    function. The first input is our objective function. In this case, it is our y
    function. The second value is our input value, that is, initial value. Since there
    is only one independent variable of `x` for the `y` function, `x0` is a scalar.
    For the third input value, method, we have several choices: `NelderMead`. The
    following table lists 11 choices for the variable:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的程序中，使用的主要函数是`scipy.optimize.minimize()`函数。第一个输入是我们的目标函数，在这个例子中是我们的y函数。第二个值是输入值，即初始值。由于`y`函数只有一个自变量`x`，因此`x0`是一个标量。第三个输入值是方法，我们有多个选择：`NelderMead`。下表列出了11种变量选择：
- en: '| Method | Description |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| 方法 | 描述 |'
- en: '| --- | --- |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `NelderMead` | Uses the Simplex algorithm. This algorithm is robust in many
    applications. However, if numerical computation of derivative can be trusted,
    other algorithms using the first and/or second derivatives information might be
    preferred for their better performance in general. |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| `NelderMead` | 使用Simplex算法。该算法在许多应用中都具有鲁棒性。然而，如果可以信任数值导数计算，其他使用一阶和/或二阶导数信息的算法可能会因其更好的性能而被优先选择。
    |'
- en: '| `Powell` | It is a modification of Powell''s method, which is a conjugate
    direction method. It performs sequential one-dimensional minimizations along each
    vector of the directions set, which is updated at each iteration of the main minimization
    loop. The function need not be differentiable, and no derivatives are taken. |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| `Powell` | 这是Powell方法的修改版，Powell方法是一种共轭方向法。它沿着每个方向向量执行顺序的一维最小化，并在每次主最小化循环迭代时更新方向集。该函数不需要可微性，也不需要计算导数。
    |'
- en: '| `CG` | Uses a nonlinear conjugate gradient algorithm by Polak and Ribiere,
    a variant of the Fletcher-Reeves method. Only the first derivatives are used.
    |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| `CG` | 使用Polak和Ribiere的非线性共轭梯度算法，这是Fletcher-Reeves方法的一个变种。仅使用一阶导数。 |'
- en: '| `BFGS` | Uses the quasi-Newton method of Broyden, Fletcher, Goldfarb, and
    Shanno (BFGS). It uses the first derivatives only. BFGS has proven good performance
    even for non-smooth optimizations. This method also returns an approximation of
    the Hessian inverse, stored as hess_inv in the OptimizeResult object. |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| `BFGS` | 使用布罗伊登、弗莱彻、戈尔德法布和香农（BFGS）的拟牛顿法。只使用一阶导数。即使对于非光滑优化，BFGS也表现出良好的性能。该方法还返回海森矩阵逆的近似值，存储在OptimizeResult对象中的hess_inv字段。
    |'
- en: '| `NewtonCG` | Uses a Newton-CG algorithm (also known as the truncated Newton
    method). It uses a CG method to compute the search direction. |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| `NewtonCG` | 使用牛顿-共轭梯度（Newton-CG）算法（也称为截断牛顿法）。它使用共轭梯度法计算搜索方向。 |'
- en: '| `LBFGSB` | Uses the help() function to find more information. |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| `LBFGSB` | 使用help()函数来获取更多信息。 |'
- en: '| `TNC` | [ibid] |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| `TNC` | [同上] |'
- en: '| `COBYLA` | [ibid] |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| `COBYLA` | [同上] |'
- en: '| `SLSQP` | [ibid] |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| `SLSQP` | [同上] |'
- en: '| `dogleg` | [ibid] |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| `dogleg` | [同上] |'
- en: '| `trustncg` | [ibid] |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| `trustncg` | [同上] |'
- en: Table 9.1 Types of solver
  id: totrans-63
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 表9.1 求解器类型
- en: The output shows that the function value is 3.2, and it is achieved by assigning
    `0` to `x`.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 输出显示函数值为3.2，这是通过将`x`赋值为`0`实现的。
- en: 'Optimization terminated successfully:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 优化成功终止：
- en: '![Optimization – minimization](img/B06175_09_20.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_20.jpg)'
- en: 'The next example is using the `scipy.optimize.brent()` function on an exponential
    function minimization, see the code followed by the objective function:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个例子使用`scipy.optimize.brent()`函数进行指数函数的最小化，见下方的目标函数代码：
- en: '![Optimization – minimization](img/B06175_09_21.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_21.jpg)'
- en: 'The following program tries to minimize the objective function, that is, `y`:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序尝试最小化目标函数，即`y`：
- en: '[PRE5]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The solution is `0.799999999528` and the related graph is shown here:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案是`0.799999999528`，相关图形如下所示：
- en: '![Optimization – minimization](img/B06175_09_22.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_22.jpg)'
- en: 'In economics and finance, there is an important concept called utility. One
    of the major reasons to design such a concept is that for many situations, we
    could not quantify certain effects, such as happiness, willingness, risk preference,
    wellness, emotion, and the like. For example, your boss asks you to work extra
    hours on Friday and promises you a bonus. Assume that its value is *x* dollar
    per hour and you are happy with it. If the task is urgent, your boss might ask
    for more hours. Assume that you have to work on Saturday. Do you think the same
    x dollar per hour would make your happy? For most workers the extra bonus should
    be higher than x since they would think that they have sacrificed more now than
    just a Friday evening. Usually, a utility function could be defined as the different
    between benefits and costs. The marginal benefit is a decreasing function of our
    input. It means the extra dollar received is not as valuable of the previous dollar.
    On the other hand, the marginal cost will be an increasing function of your input.
    When you asked to contribute extra work, the appropriate monetary incentive would
    go higher. Here is one utility function:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在经济学和金融学中，有一个重要的概念叫做效用。设计这个概念的主要原因之一是，在许多情况下，我们无法量化某些影响因素，例如幸福感、意愿、风险偏好、健康、情绪等。例如，如果你的老板要求你在周五加班并承诺给你奖金，假设每小时的奖金是*x*美元，并且你对此感到满意。如果任务很紧急，老板可能会要求你工作更长时间。假设你还需要在周六工作，你认为相同的每小时*x*美元还会让你高兴吗？对于大多数员工来说，额外的奖金应该高于x，因为他们会认为自己现在的付出已经不仅仅是一个周五的晚上了。通常，效用函数可以定义为收益与成本之间的差异。边际效益是我们投入的递减函数。这意味着，额外获得的一美元并不像之前的那一美元那样有价值。另一方面，边际成本将是你投入的递增函数。当你被要求做额外工作时，适当的货币激励应该更高。这里是一个效用函数：
- en: '![Optimization – minimization](img/B06175_09_23.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_23.jpg)'
- en: 'Here, *U* is the utility function, *E(R)* is the expected portfolio return
    and we could use its mean to approximate, *A* is the risk-averse coefficient,
    and *σ2* is the variance of the portfolio. When the expected return is higher,
    our utility is higher. The opposite is true: when the risk of our portfolio is
    higher the utility is lower. The key is *A*, which represents the risk-tolerance.
    With the same expected return and risk level, a more risk-reverse investor (a
    higher A) would experience a lower utility. Generally speaking, the objective
    is to balance the benefits (expected returns) with risk (variance).'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*U*是效用函数，*E(R)*是预期的投资组合回报，我们可以用它的均值来近似，*A*是风险厌恶系数，*σ2*是投资组合的方差。当预期回报更高时，我们的效用也更高。反之，当我们投资组合的风险更高时，效用更低。关键在于*A*，它代表了风险承受能力。在相同的预期回报和风险水平下，风险厌恶的投资者（更高的A值）会体验到较低的效用。一般来说，目标是平衡收益（预期回报）与风险（方差）。
- en: 'Assume that we have a set of stocks, such as **International Business Machine**
    (**IBM**), **Walmart** (**WMT**), and **Citi Group** (**C**). Based on the preceding
    utility function, which stock should we choose for different given risk preference?
    The code is given here:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有一组股票，如**国际商用机器公司**（**IBM**）、**沃尔玛**（**WMT**）和**花旗集团**（**C**）。基于前面的效用函数，我们应该根据不同的风险偏好选择哪只股票呢？以下是给出的代码：
- en: '[PRE6]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'In the preceding program, the mean and standard deviation are both annualized.
    The value of 252 represents the number of trading days per year. The time period
    used is from 1/1/2012 to 12/31/2016, that is, a five-year period. The output is
    shown here. Again, the result is for the investor with a risk preference with
    A=1:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的程序中，均值和标准差都是年化的。252的数值代表每年的交易天数。使用的时间段是从2012年1月1日到2016年12月31日，即五年的时间段。输出结果如下。再次提醒，结果是针对风险偏好A=1的投资者：
- en: '![Optimization – minimization](img/B06175_09_24.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_24.jpg)'
- en: 'Based on the concept of utility, investors prefer stock with the highest utility.
    Thus, we should choose the last stock. In other words, if we have to choose one
    stock as our investment, we should choose City Group. On the other hand, when
    A=10, that is, extremely risk-averse, we have the following utility values for
    those three stocks:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 基于效用的概念，投资者偏好效用值最高的股票。因此，我们应该选择最后一只股票。换句话说，如果我们必须选择一只股票作为投资，我们应该选择花旗集团。另一方面，当A=10时，也就是极度风险厌恶时，这三只股票的效用值如下：
- en: '![Optimization – minimization](img/B06175_09_25.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_25.jpg)'
- en: 'The result suggests that such an investor should choose the second stock, that
    is, Walmart as our sole investment. This is consistent with our common sense,
    see their corresponding mean returns and risk levels:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，这样的投资者应该选择第二只股票，也就是沃尔玛作为唯一的投资。这与我们的常识一致，见其对应的平均回报和风险水平：
- en: '[PRE7]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The output is shown here:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Optimization – minimization](img/B06175_09_26.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![优化 – 最小化](img/B06175_09_26.jpg)'
- en: In the preceding program, a function called `meanVarAnnual()` is generated that
    delivers annualized mean return and annualized volatility. Let's compare the last
    two stocks. The second stock is less risky than the third one at the same time;
    it has a higher risk than the third stock. The mean annual return of the second
    stock decreases by 12%, however, its variance decreases by 63%. The consequence
    is that utility increased.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的程序中，生成了一个名为`meanVarAnnual()`的函数，计算年化的平均回报和年化波动率。我们来比较最后两只股票。第二只股票在同一时间比第三只股票风险更低；它的风险高于第三只股票。第二只股票的年平均回报下降了12%，然而，它的方差下降了63%。结果是效用增加了。
- en: 'For portfolio optimization, or Markowitz Portfolio Optimization, our input
    datasets include: expected returns, standard deviations, and correlation matrix.
    The output will be an optimal portfolio. By connecting those efficient portfolios,
    an efficient frontier could be constructed. In the rest of this chapter, we use
    historical returns to represent expected returns and use the historical correlation
    in the place of expected correlation.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 对于投资组合优化，或者马克维茨投资组合优化，我们的输入数据集包括：预期收益、标准差和相关矩阵。输出将是一个最优的投资组合。通过连接这些高效的投资组合，可以构建一个有效前沿。在本章其余部分，我们使用历史回报来代表预期回报，并使用历史相关性来代替预期相关性。
- en: Forming an n-stock portfolio
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 形成一个n只股票的投资组合
- en: 'The following program generates a return matrix with three stocks plus S&P500:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序生成一个回报矩阵，包含三只股票和S&P500：
- en: '[PRE8]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To show the first and last few lines, we use the `.head()` and `.tail()` functions
    as follows:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示前几行和最后几行，我们使用`.head()`和`.tail()`函数，如下所示：
- en: '[PRE9]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'In the preceding program, we retrieve S&P500 data first. Then stock data is
    merged with the market index. The major function used is `pandas.merge()`. Please
    pay attention to the meanings of two input parameters: `left_index=True` and `right_index=True`.
    They indicate that those two datasets are merged by their indices. In the program,
    the daily frequency is retrieved. It is quite often that academic researchers
    and professionals prefer monthly frequency. One of the reasons is that monthly
    data has little so-called micro-structure effect compared with daily data. The
    following program uses monthly data. The Python data used is `yanM` `onthly.pkl`,
    [http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl).
    First, we print a list of securities included:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的程序中，我们首先提取S&P500数据。然后将股票数据与市场指数合并。使用的主要函数是`pandas.merge()`。请注意两个输入参数的含义：`left_index=True`和`right_index=True`。它们表示这两个数据集是通过它们的索引进行合并的。在程序中，获取的是日频率数据。学术研究人员和专业人士通常更倾向于使用月度频率数据，其中一个原因是月度数据相比日度数据更少受到所谓的微观结构效应的影响。以下程序使用了月度数据。使用的Python数据是`yanMonthly.pkl`，[http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl)。首先，我们打印出所包含的证券列表：
- en: '[PRE10]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'To choose a specific security, the index of the dataset is compared with the
    ticker; see the following code for choosing IBM''s monthly price data:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 要选择特定的证券，可以将数据集的索引与股票代码进行比较；请参见以下代码选择IBM的月度价格数据：
- en: '[PRE11]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The following program generates returns first, and then use ticker name as
    its corresponding column name instead of using a generate term, such as `return`.
    The reason is that we intend to choose several stocks and put them together side-by-side,
    that is, arranged by date:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序先生成回报，然后使用股票代码作为对应的列名，而不是使用生成的术语，如`return`。原因是我们打算选择几只股票并将它们并排放置，即按日期排列：
- en: '[PRE12]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Finally, we could construct an n-stock return matrix from `yanMonthly.pkl`:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以从`yanMonthly.pkl`构建一个n只股票的回报矩阵：
- en: '[PRE13]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'To randomly choose m stocks from a set of existing available stocks (n of them),
    see the command of `scipy.random.uniform(low=1,high=len(x4),size=n_stocks)`.Since
    `n_stocks` has a value of 10, we choose 10 stocks from `len(x4)`. The output is
    shown here:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 要从一组现有可用股票（其中有n个）中随机选择m只股票，请参见`scipy.random.uniform(low=1,high=len(x4),size=n_stocks)`命令。由于`n_stocks`的值为10，我们从`len(x4)`中选择了10只股票。输出结果如下：
- en: '[PRE14]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'In finance, constructing an efficient frontier is always a challenging job.
    This is especially true with real-world data. In this section, we discuss the
    estimation of a variance-covariance matrix and its optimization, finding an optimal
    portfolio, and constructing an efficient frontier with stock data downloaded from
    Yahoo! Finance. When a return matrix is given, we could estimate its variance-covariance
    matrix. For a given set of weights, we could further estimate the portfolio variance.
    The formula to estimate the variance and standard deviation for returns from a
    single stock are given as follows:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融领域，构建有效前沿始终是一项具有挑战性的工作，尤其是在使用真实数据时。在这一部分，我们讨论了方差-协方差矩阵的估算及其优化、寻找最优投资组合以及使用从Yahoo!
    Finance下载的股票数据构建有效前沿。当给定回报矩阵时，我们可以估算其方差-协方差矩阵。对于一组给定的权重，我们可以进一步估算投资组合的方差。估算单只股票回报的方差和标准差的公式如下：
- en: '![Forming an n-stock portfolio](img/B06175_09_27.jpg)![Forming an n-stock portfolio](img/B06175_09_28.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![形成一个n股投资组合](img/B06175_09_27.jpg)![形成一个n股投资组合](img/B06175_09_28.jpg)'
- en: 'Here, ![Forming an n-stock portfolio](img/B06175_09_29.jpg) is the mean, ![Forming
    an n-stock portfolio](img/B06175_09_30.jpg) is the stock return for period *i*,
    and *n* is the number of returns. For an n-stock portfolio, we have the following
    formula to estimate its portfolio return:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![形成一个n股投资组合](img/B06175_09_29.jpg)是均值，![形成一个n股投资组合](img/B06175_09_30.jpg)是第*i*期的股票回报，*n*是回报的数量。对于一个n股投资组合，我们有以下公式来估算其投资组合回报：
- en: '![Forming an n-stock portfolio](img/B06175_09_31.jpg)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![形成一个n股投资组合](img/B06175_09_31.jpg)'
- en: 'Here, ![Forming an n-stock portfolio](img/B06175_09_32.jpg) is the portfolio
    return, ![Forming an n-stock portfolio](img/B06175_09_33.jpg) is the weight for
    stock *i*, and ![Forming an n-stock portfolio](img/B06175_09_30.jpg) is the stock
    i''s return. This is true for the portfolio mean or expected portfolio return,
    see here:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![形成一个n股投资组合](img/B06175_09_32.jpg)是投资组合回报，![形成一个n股投资组合](img/B06175_09_33.jpg)是第*i*只股票的权重，![形成一个n股投资组合](img/B06175_09_30.jpg)是第i只股票的回报。这对于投资组合的均值或预期投资组合回报是成立的，见下文：
- en: '![Forming an n-stock portfolio](img/B06175_09_34.jpg)![Forming an n-stock portfolio](img/B06175_09_35.jpg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![形成一个n股投资组合](img/B06175_09_34.jpg)![形成一个n股投资组合](img/B06175_09_35.jpg)'
- en: 'The portfolio variance for an n-stock portfolio is defined here:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: n股投资组合的投资组合方差在此定义：
- en: '![Forming an n-stock portfolio](img/B06175_09_36.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![形成一个n股投资组合](img/B06175_09_36.jpg)'
- en: 'Here, ![Forming an n-stock portfolio](img/B06175_09_06.jpg) is the portfolio
    variance, *n* is the number of stocks in the portfolio, ![Forming an n-stock portfolio](img/B06175_09_33.jpg)
    is the weight of stock i, and ![Forming an n-stock portfolio](img/B06175_09_38.jpg)
    is the covariance between stocks *i* and *j*. Note that when *i* is the same as
    *j*, ![Forming an n-stock portfolio](img/B06175_09_38.jpg) is the variance, that
    is:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![形成一个n股投资组合](img/B06175_09_06.jpg)是投资组合方差，*n*是投资组合中的股票数量，![形成一个n股投资组合](img/B06175_09_33.jpg)是第i只股票的权重，![形成一个n股投资组合](img/B06175_09_38.jpg)是第*i*只股票和第*j*只股票之间的协方差。请注意，当*i*与*j*相同时，![形成一个n股投资组合](img/B06175_09_38.jpg)就是方差，即：
- en: '![Forming an n-stock portfolio](img/B06175_09_37.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![形成一个n股投资组合](img/B06175_09_37.jpg)'
- en: 'Understandably, a 2-stock portfolio is just a special case of an n-stock portfolio.
    Again, when the values of the return matrix and the weight vector are given, we
    can estimate their variance-covariance matrix and portfolio variance as follows:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 可以理解的是，2只股票的投资组合只是n股投资组合的一个特例。同样，当回报矩阵和权重向量的值给定时，我们可以如下估算其方差-协方差矩阵和投资组合方差：
- en: '[PRE15]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The key command used is `ret.T*ret`. `ret.T` is the transpose of a return matrix.
    Since the return matrix is 6 by 2 matrix, its transpose will be a 2 by 6 matrix.
    Thus, the result of a matrix multiplication of *(2*6)* and *(6*2)* will be *(2*2)*.
    The corresponding outputs, such as return matrix, covariance matrix, weights,
    and portfolio variance, are given as follows:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 使用的关键命令是`ret.T*ret`。`ret.T`是回报矩阵的转置。由于回报矩阵是一个6×2的矩阵，其转置将是一个2×6的矩阵。因此，(2×6)与(6×2)的矩阵乘法结果将是(2×2)。相应的输出，如回报矩阵、协方差矩阵、权重和投资组合方差，列示如下：
- en: '[PRE16]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The second way to conduct a matrix multiplication is by using the `spcipy.dot()`
    function, see the following code:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 进行矩阵乘法的第二种方法是使用`spcipy.dot()`函数，见以下代码：
- en: '[PRE17]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Constructing an optimal portfolio
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建一个最优投资组合
- en: 'In finance, we are dealing with a trade-off between risk and return. One of
    the widely used criteria is Sharpe ratio, which is defined as follows:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融学中，我们处理的是风险与收益之间的权衡。一个广泛使用的标准是夏普比率，其定义如下：
- en: '![Constructing an optimal portfolio](img/B06175_09_40.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![构建最优投资组合](img/B06175_09_40.jpg)'
- en: 'The following program would maximize the Sharpe ratio by changing the weights
    of the stocks in the portfolio. The whole program could be divided into several
    parts. The input area is very simple, just several tickers in addition to the
    beginning and ending dates. Then, we define four functions, convert daily returns
    into annual ones, estimate a portfolio variance, estimate the Sharpe ratio, and
    estimate the last (that is, nth) weight when *n-1* weights are estimated from
    our optimization procedure:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '以下程序通过改变投资组合中股票的权重来最大化夏普比率。整个程序可以分为几个部分。输入区域非常简单，只需要输入一些股票代码以及起始和结束日期。接下来，我们定义四个函数，分别是将日收益转换为年收益、估算投资组合的方差、估算夏普比率，并在优化过程中估算最后一个（即第n个）权重，而前n-1个权重已经通过我们的优化程序估算出来：  '
- en: '[PRE18]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Code for input area:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入区域的代码：
- en: '[PRE19]'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Code for defining a few functions:'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一些函数的代码：
- en: '[PRE20]'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Code for generating a return matrix (annul return):'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成收益矩阵（年收益）的代码：
- en: '[PRE21]'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'In step 2, we estimate annual returns from daily returns. For the optimization,
    the most important function is the `scipy.optimize.fmin()` function. The first
    input for this minimization function is our objective function, `negative_sharpe_n_minus_1`.
    Our objective is to maximize a Sharpe Ratio. Since this is a minimization function,
    it is equivalent to minimize a negative Sharpe ratio. Another issue is that we
    need n weights to calculate a Sharpe ratio. However, since the summation of *n*
    weights is 1, we have only n-1 weights as our choice variables. From the following
    output, we know that if we use a naïve equal-weighted strategy, the Sharpe ratio
    is 0.63\. On the other hand, the Sharpe ratio for our optimal portfolio is 0.67:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在步骤2中，我们将日收益估算为年收益。对于优化而言，最重要的函数是`scipy.optimize.fmin()`函数。该最小化函数的第一个输入是我们的目标函数`negative_sharpe_n_minus_1`。我们的目标是最大化夏普比率。由于这是一个最小化函数，它等同于最小化负的夏普比率。另一个问题是，我们需要n个权重来计算夏普比率。然而，由于n个权重的总和为1，我们只有n-1个权重作为选择变量。从以下输出可以看出，如果我们使用一个简单的等权重策略，夏普比率为0.63。另一方面，我们的最优投资组合的夏普比率为0.67：
- en: '[PRE22]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Constructing an efficient frontier with n stocks
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建具有n只股票的有效前沿
- en: 'Constructing an efficient frontier is always one of the most difficult tasks
    for finance instructors since the task involves matrix manipulation and a constrained
    optimization procedure. One efficient frontier could vividly explain the Markowitz
    Portfolio theory. The following Python program uses five stocks to construct an
    efficient frontier:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 构建有效前沿一直是金融学教授面临的最困难的任务之一，因为这个任务涉及矩阵操作和约束优化过程。一个有效前沿能够生动地解释马科维茨投资组合理论。以下Python程序使用五只股票构建有效前沿：
- en: '[PRE23]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Code for input area:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入区域的代码：
- en: '[PRE24]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Code for defining two functions:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义两个函数的代码：
- en: '[PRE25]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Code for generating a return matrix R:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成收益矩阵R的代码：
- en: '[PRE26]'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Code for estimating optimal portfolios for a given return:'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 估算给定收益的最优投资组合的代码：
- en: '[PRE27]'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Code for plotting the efficient frontier:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 绘制有效前沿的代码：
- en: '[PRE28]'
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The key to understanding this program is its objective function under the title
    of *# function 2: objective function*. Our objective is for a given target portfolio
    mean or expected value, we would minimize our portfolio risk. The first part of
    the command line of return `np.sqrt(port_var) + penalty`, is the portfolio variance.
    There is no ambiguity about the first term. Now, let''s turn to the second term
    called penalty, which is defined as the absolute deviation of the portfolio mean
    from our target mean times a big number. This is a quite popular way to define
    our objective function by using an unconstrained optimization procedure. An alternative
    way is to apply an optimization procedure with constraints. The output graph is
    presented as follows:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 理解该程序的关键是其目标函数，在*# 函数2：目标函数*标题下。我们的目标是，对于给定的目标投资组合的均值或预期值，我们将最小化投资组合的风险。命令行的第一部分`np.sqrt(port_var)
    + penalty`是投资组合方差。第一项没有歧义。现在，让我们转到第二项，称为惩罚项，它定义为投资组合均值与目标均值的绝对偏差乘以一个大数值。这是一种通过使用无约束优化过程来定义目标函数的非常流行的方式。另一种方式是应用带有约束条件的优化过程。输出图像如下所示：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_41.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![构建具有n只股票的有效前沿](img/B06175_09_41.jpg)'
- en: 'In one of the previous programs, our objective function is to maximize a Sharpe
    ratio. From the previous chapter, we know that when the portfolio under consideration
    is not all our wealth, Sharpe ratio might not be a good measure. Viewed as a modification
    to the Sharpe ratio, the Treynor ratio is defined here:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的一个程序中，我们的目标函数是最大化夏普比率。从上一章我们知道，当考虑的投资组合不是我们所有的财富时，夏普比率可能不是一个好的衡量标准。作为夏普比率的修正，特雷诺比率定义如下：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_42.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_42.jpg)'
- en: Here, the left-hand side is Treynor ratio, ![Constructing an efficient frontier
    with n stocks](img/B06175_09_43.jpg) is the mean portfolio return, ![Constructing
    an efficient frontier with n stocks](img/B06175_09_44.jpg) is the risk-free rate,
    and ![Constructing an efficient frontier with n stocks](img/B06175_09_45.jpg)
    is the portfolio beta. The only modification is that the sigma (total risk) is
    replaced by beta (market risk).
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，左侧是特雷诺比率，![构建含有n个股票的有效前沿](img/B06175_09_43.jpg) 是平均投资组合收益，![构建含有n个股票的有效前沿](img/B06175_09_44.jpg)
    是无风险利率，![构建含有n个股票的有效前沿](img/B06175_09_45.jpg) 是投资组合的贝塔值。唯一的修改是，将西格玛（总风险）替换为贝塔（市场风险）。
- en: 'In the following program, Treynor ratio will be our objective function:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下程序中，特雷诺比率将是我们的目标函数：
- en: '[PRE29]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The output is shown here:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_46.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_46.jpg)'
- en: 'Another argument against using standard deviation in the Sharpe ratio is that
    it considers the deviations in both directions, below and above the mean. Nevertheless,
    we know that investors worry more about the downside risk (deviation below mean
    return). The second issue for the Sharpe ratio is that for the numerator, we compare
    mean returns with a risk-free rate. Nevertheless, for the denominator, the deviations
    are from the mean return instead of the same risk-free rate. To overcome those
    two shortcomings, a so-called **Lower Partial Standard Deviation** (**LPSD**)
    is developed. Assume we have n returns and one **risk-free rate** (**Rf**). Assume
    further that there are m returns that are less than this risk-free rate. We estimate
    LPSP by using only those m returns and it is defined here:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个反对在夏普比率中使用标准差的观点是，它考虑了上下两方面的偏差，低于均值和高于均值。然而，我们知道投资者更关注下行风险（低于均值的偏差）。夏普比率的第二个问题是，对于分子，我们将均值收益与无风险利率进行比较。然而，对于分母，偏差是基于均值收益，而不是相同的无风险利率。为了克服这两个缺点，提出了一种所谓的**下行偏差标准差**（**LPSD**）。假设我们有n个收益和一个**无风险利率**（**Rf**）。进一步假设，有m个收益低于该无风险利率。我们通过仅使用这m个收益来估算LPSD，其定义如下：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_47.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_47.jpg)'
- en: 'The following program shows how to estimate LPSD for a given set of returns:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序展示了如何为给定的收益集估算LPSD：
- en: '[PRE30]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Similar to Sharpe ratio and Treynor ratio, the Sortino ratio is defined as
    follows:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 类似于夏普比率和特雷诺比率，索提诺比率的定义如下：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_48.jpg)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_48.jpg)'
- en: 'The following program would maximize Sortino ratio for a few given stocks:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序将最大化给定几只股票的索提诺比率：
- en: '[PRE31]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Here is the corresponding output:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 这是相应的输出：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_49.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_49.jpg)'
- en: 'Modigliani and Modigliani (1997) propose another performance measure. Their
    benchmark is a specified market index. Let''s use S&P500 index as an example.
    Assume that our portfolio has a higher risk and a higher return compared with
    the S&P500 market index:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: Modigliani 和 Modigliani（1997）提出了另一种绩效衡量方法。他们的基准是一个特定的市场指数。我们以标准普尔500指数为例。假设我们的投资组合相比标准普尔500市场指数具有更高的风险和更高的回报：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_50.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![构建含有n个股票的有效前沿](img/B06175_09_50.jpg)'
- en: 'Here is their two-step approach:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 这是他们的两步法：
- en: Form a new portfolio with two weights w for our original portfolio and (1-w)
    for a risk-free investment. The new portfolio would have the risk as the SP500
    market index:![Constructing an efficient frontier with n stocks](img/B06175_09_51.jpg)
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过为我们的原始投资组合设置两个权重w和(1-w)来形成一个新投资组合，该新投资组合的风险与标准普尔500市场指数相同：![构建含有n个股票的有效前沿](img/B06175_09_51.jpg)
- en: 'Actually, the weight of *w* will be given by the following formula:'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 实际上，*w*的权重将由以下公式给出：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_52.jpg)'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![构建一个由n只股票组成的有效前沿](img/B06175_09_52.jpg)'
- en: Calculate the portfolio mean returns by applying the following formula:![Constructing
    an efficient frontier with n stocks](img/B06175_09_53.jpg)
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下公式计算投资组合的平均回报：![构建一个由n只股票组成的有效前沿](img/B06175_09_53.jpg)
- en: 'The final judgment is whether this new risk-adjusted portfolio is bigger or
    less than S&P500 mean return. The following Python program achieves this:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 最终的判断标准是这个新的风险调整后的投资组合回报是否大于或小于标准普尔500指数的平均回报。以下Python程序实现了这一点：
- en: '[PRE32]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'The output is shown here:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_54.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![构建一个由n只股票组成的有效前沿](img/B06175_09_54.jpg)'
- en: 'There are different weighting schemes to estimate the portfolio returns. The
    commonly used ones are value-weighed, equal-weighted, and price-weighted. When
    estimating certain indices, the value-weighted is also called market capitalization
    weighted. For example, S&P500 returns are value-weighted and Dow Jones Industrial
    Average is price-weighed. The equal-weighted is the simplest one:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 有不同的加权方案来估算投资组合的回报。常用的有市值加权、等权重加权和价格加权。在估算某些指数时，市值加权也叫做市值加权法。例如，标准普尔500指数的回报是市值加权的，而道琼斯工业平均指数则是价格加权的。等权重加权是最简单的一种：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_55.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![构建一个由n只股票组成的有效前沿](img/B06175_09_55.jpg)'
- en: 'Here, ![Constructing an efficient frontier with n stocks](img/B06175_09_56.jpg)
    is the portfolio return at time *t*, ![Constructing an efficient frontier with
    n stocks](img/B06175_09_57.jpg) is the stock *i*''s return at time *t*, and *n*
    is the number of stocks in the portfolio. Here is a very simple example, assume
    that we have two stocks in our portfolio. Last year stock A had a return of 20%
    while stock B had a -10%, what is an equal-weighted return based on those two
    values? The answer is 5%. For a value-weighted index, the key is the weight ![Constructing
    an efficient frontier with n stocks](img/B06175_09_33.jpg), see the following
    formula:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![构建一个由n只股票组成的有效前沿](img/B06175_09_56.jpg)表示时间*t*时的投资组合回报，![构建一个由n只股票组成的有效前沿](img/B06175_09_57.jpg)表示股票*i*在时间*t*的回报，*n*是投资组合中的股票数量。这里有一个非常简单的例子，假设我们的投资组合中有两只股票。去年，股票A的回报为20%，而股票B的回报为-10%，那么基于这两个值的等权重回报是多少？答案是5%。对于市值加权指数，关键是权重![构建一个由n只股票组成的有效前沿](img/B06175_09_33.jpg)，请看下面的公式：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_58.jpg)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![构建一个由n只股票组成的有效前沿](img/B06175_09_58.jpg)'
- en: 'Here *vi* is the value of our investment for ith stock, ![Constructing an efficient
    frontier with n stocks](img/B06175_09_59.jpg) is the total value of our portfolio.
    Assume that we have a 2-stock portfolio. Last year, stock A (B) has a return of
    20% (-10%). If our investment for stocks A and B are 90% versus 10%, what is their
    value-weighted return last year? The answer is *17% (0.9*0.2+0.1*(-0.1))*. For
    a market index, such as S&P5000, *vi* will be the market capitalization of stock
    i and the summation of all 500 stocks'' market capitalizations will be the market
    value of the index portfolio. When estimating the value-weighed market index,
    the small stocks would have little impact since their weights are so tiny. Here
    is a simple example by using `yanMonthly.pkl`, downloadable at [http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl):'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的*vi*是我们对第i只股票的投资金额，![构建一个由n只股票组成的有效前沿](img/B06175_09_59.jpg)是投资组合的总价值。假设我们有一个由2只股票组成的投资组合。去年，股票A（B）的回报分别为20%（-10%）。如果我们对股票A和B的投资比例为90%与10%，那么它们的市值加权回报是多少？答案是*17%
    (0.9*0.2+0.1*(-0.1))*。对于像标准普尔500指数这样的市场指数，*vi*将是股票i的市值，所有500只股票市值的总和将是该指数投资组合的市场价值。在估算市值加权市场指数时，小市值股票的影响很小，因为它们的权重非常小。这里有一个简单的例子，使用`yanMonthly.pkl`文件，可以从[http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl)下载：
- en: '[PRE33]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Here is the output:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 这是输出结果：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_60.jpg)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![构建一个由n只股票组成的有效前沿](img/B06175_09_60.jpg)'
- en: 'Since there are just two stocks, we could manually calculate a few days for
    several weighting schemes. Let''s use the last observation, January 1973, as an
    example and assume that we have 100 shares of IBM and 200 shares of Walmart. The
    equal-weighted monthly return is *-0.08 (0.04-0.2)/2)*. For a value-weighted one,
    we estimate two weights and assume that we use the previous price to estimate
    those weights. The total value is *100*7.04 + 200*0.05= 714*. Thus *w1= 0.9859944
    (704/714)* and *w2=0.0140056*. The value-weighted return is 0.0366, that is, *0.9859944*0.04
    + 0.0140056*(-0.2)*. For a price-weighted portfolio, we have the same format as
    a value-weighted one. The major difference is how to define its weights:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 由于只有两只股票，我们可以手动计算几个不同权重方案的几天回报。我们以最后的观察数据，1973年1月为例，假设我们有100股IBM和200股沃尔玛股票。等权月度回报为
    *-0.08 (0.04-0.2)/2)*。对于价值加权回报，我们估算两个权重，假设我们使用前一个价格来估算这些权重。总值为 *100*7.04 + 200*0.05=
    714*。因此 *w1= 0.9859944 (704/714)* 和 *w2=0.0140056*。价值加权回报为0.0366，即 *0.9859944*0.04
    + 0.0140056*(-0.2)*。对于价格加权投资组合，格式与价值加权类似。主要的区别是如何定义其权重：
- en: '![Constructing an efficient frontier with n stocks](img/B06175_09_61.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![构建一个有效的前沿面，含n个股票](img/B06175_09_61.jpg)'
- en: Here, ![Constructing an efficient frontier with n stocks](img/B06175_09_62.jpg)
    is the price of *i*th stock. In a sense, a price-weighted portfolio could be viewed
    as we only have one share for each stock in our portfolio for the same 2-stock
    portfolio. Last year, stock A (B) has a return of 20% (-10%). If the price of
    stock A (B) is $10 ($90), then the price-weighted portfolio return would be -7%,
    that is, *0.2*(10/100)-0.1*(90/100)*. It is obvious that stocks with a higher
    unit price command a higher weight. Based on the preceding results for IBM and
    Walmart, the two weights for the price-weighted scheme are *0.9929478*; that is,
    *7.04/(7.04+0.05)* and *0.007052186*. Thus, the price-weighted portfolio return
    in that month is *0.03830747* and *0.9929478*0.04+0.007052186*(-0.2)*.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![构建一个有效的前沿面，含n个股票](img/B06175_09_62.jpg)是 *i* 股票的价格。从某种意义上说，价格加权投资组合可以看作是我们每只股票在投资组合中只有一股，且是同样的2只股票投资组合。去年，A股票（B股票）的回报分别是20%（-10%）。如果A股票（B股票）的价格分别为10美元（90美元），那么价格加权投资组合的回报将是-7%，即
    *0.2*(10/100)-0.1*(90/100)*。显然，价格较高的股票会有更高的权重。根据前述IBM和沃尔玛的结果，价格加权方案的两个权重是 *0.9929478*；即
    *7.04/(7.04+0.05)* 和 *0.007052186*。因此，当月的价格加权投资组合回报为 *0.03830747*，即 *0.9929478*0.04
    + 0.007052186*(-0.2)*。
- en: There are a few twists when estimating portfolio or index returns. The first
    one is whether returns include dividends and other distributions. For example,
    the `CRSP` database has `EWRETD` and `EWRETX`. `EWRETD` is defined as equal-weighed
    market returns based on stock returns including dividend, that is, total return.
    `EWRETX` is defined as equal-weighted market returns without dividends or other
    distributions. Similarly, for value-weighed returns, there exists `VWRETD` and
    `VWRETX`. The second twist is that it is common practice to use previous period's
    market capitalizations as weights instead of the current ones.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 估算投资组合或指数收益时会有一些曲折。第一个曲折是收益是否包含股息和其他分红。例如，`CRSP`数据库有`EWRETD`和`EWRETX`。`EWRETD`定义为基于股票收益包括股息的等权市场回报，即总回报。`EWRETX`定义为不包括股息或其他分红的等权市场回报。类似地，对于价值加权收益，有`VWRETD`和`VWRETX`。第二个曲折是，通常使用上一期的市值作为权重，而不是当前的市值。
- en: References
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Please refer to the following articles:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下文章：
- en: '*Markowitz, Harry, 1952, Portfolio* *Selection, Journal of Finance 8,77-91*,
    [http://onlinelibrary.wiley.com/doi/10.1111/j.1540-6261.1952.tb01525.x/full](http://onlinelibrary.wiley.com/doi/10.1111/j.1540-6261.1952.tb01525.x/full)'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Markowitz, Harry, 1952, 投资组合* *选择, 金融杂志 8,77-91*, [http://onlinelibrary.wiley.com/doi/10.1111/j.1540-6261.1952.tb01525.x/full](http://onlinelibrary.wiley.com/doi/10.1111/j.1540-6261.1952.tb01525.x/full)'
- en: '*Modigliani, Franco, 1997, Risk-Adjusted Performance, Journal of Portfolio
    Managemen, 45–54*'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Modigliani, Franco, 1997, 风险调整后的表现, 投资组合管理杂志, 45–54*'
- en: '*Sharpe, William F., 1994, the Sharpe Ratio, the Journal of Portfolio Management
    21 (1), 49–58*'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Sharpe, William F., 1994, Sharpe比率, 投资组合管理杂志 21 (1), 49–58*'
- en: '*Sharpe, W. F., 1966, Mutual Fund Performance, Journal of Business 39 (S1),
    119–138*'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Sharpe, W. F., 1966, 共同基金表现, 商业杂志 39 (S1), 119–138*'
- en: '*Scipy manual, Mathematical optim**ization: finding minima of functions*, [http://www.scipy-lectures.org/advanced/mathematical_optimization/](http://www.scipy-lectures.org/advanced/mathematical_optimization/)'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Scipy手册, 数学优化：寻找函数的最小值*, [http://www.scipy-lectures.org/advanced/mathematical_optimization/](http://www.scipy-lectures.org/advanced/mathematical_optimization/)'
- en: '*Sortino, F.A., Price, L.N.,1994, Performance measurement in a downside risk
    framework, Journal of Investing 3, 50–8*'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Sortino, F.A., Price, L.N.,1994, Performance measurement in a downside risk
    framework, Journal of Investing 3, 50–8*'
- en: '*Treynor, Jack L., 1965, How to Rate Management of Investment Funds, Harvard
    Business Review 43, pp. 63–75*'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Treynor, Jack L., 1965, How to Rate Management of Investment Funds, Harvard
    Business Review 43, pp. 63–75*'
- en: 'Appendix A – data case #5 - which industry portfolio do you prefer?'
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '附录 A – 数据案例 #5 - 你更喜欢哪个行业投资组合？'
- en: 'Please go through the following objectives:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 请完成以下目标：
- en: Understand the definitions of 49 industries.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 理解 49 个行业的定义。
- en: Learn how to download data from Prof. French's Data Library.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 学习如何从法国教授的数据库下载数据。
- en: Understand the utility function, see here.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 理解效用函数，见此处。
- en: Find out which industry is optimal for different types of investors.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找出哪种行业适合不同类型的投资者。
- en: Learn how to draw an indifference curve (for just one optimal portfolio).
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 学习如何绘制无差异曲线（仅针对一个最优投资组合）。
- en: 'Procedure:'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 步骤：
- en: Go to *Professor French's Data Library* at:[http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html).
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 *Professor French's Data Library*：[http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html)。
- en: 'Click `CSV` on the right-hand side of **49 Industry Portfolios**, see the following
    screenshot:![Appendix A – data case #5 - which industry portfolio do you prefer?](img/B06175_09_63.jpg)'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '点击 **49 Industry Portfolios** 右侧的 `CSV`，查看以下截图：![附录 A – 数据案例 #5 - 你更喜欢哪个行业投资组合？](img/B06175_09_63.jpg)'
- en: Estimate returns and variances for both value-weighted and equal-weighed industry
    portfolios.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 估算价值加权和等权行业投资组合的收益和方差。
- en: 'Estimate the utility function for three types of investors with A=1, 2, and
    4:![Appendix A – data case #5 - which industry portfolio do you prefer?](img/B06175_09_64.jpg)'
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '为三种类型的投资者（A=1、2和4）估算效用函数：![附录 A – 数据案例 #5 - 你更喜欢哪个行业投资组合？](img/B06175_09_64.jpg)'
- en: Here *U* is the utility function, *E(R)* is the expected portfolio return and
    we could use its mean to approximate, *A* is the risk-averse coefficient, and
    σ2 is the variance of the portfolio.
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这里 *U* 是效用函数，*E(R)* 是预期投资组合回报，我们可以使用其均值进行近似，*A* 是风险厌恶系数，σ2 是投资组合的方差。
- en: Choose one result, for example, the optimal value-weighted portfolio for an
    investor who has a value of 1 for A, draw an indifference curve.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个结果，例如，为风险偏好为 1 的投资者绘制最优价值加权投资组合的无差异曲线。
- en: Comment on your results.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对你的结果进行评论。
- en: From [http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/det_49_ind_port.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/det_49_ind_port.html),
    we could find the definition of those 49 industries.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 从 [http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/det_49_ind_port.html](http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/Data_Library/det_49_ind_port.html)，我们可以找到这
    49 个行业的定义。
- en: 'Appendix B – data case #6 - replicate S&P500 monthly returns'
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '附录 B – 数据案例 #6 - 复制 S&P500 月度回报'
- en: To finish this data case, your school has subscribed to the `CRSP` database.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 为完成这个数据案例，你所在的学校已经订阅了 `CRSP` 数据库。
- en: 'Objectives:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 目标：
- en: Understand the concepts of equal-weighted and value weighed market index.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 理解等权和价值加权市场指数的概念。
- en: Write a Python program to replicate sp500 monthly returns.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写 Python 程序来复制 S&P500 月度回报。
- en: Comment on your results.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对你的结果进行评论。
- en: Note
  id: totrans-218
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'Source of data: CRSP'
  id: totrans-219
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 数据来源：CRSP
- en: '`sp500monthly.pkl`'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`sp500monthly.pkl`'
- en: '`sp500add.pkl`'
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`sp500add.pkl`'
- en: '`stockMonthly.pkl`'
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`stockMonthly.pkl`'
- en: 'For the `sp500monthly.pkl`, see the following few observations:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 `sp500monthly.pkl`，请查看以下几点观察：
- en: '[PRE34]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'For `sp500add.pkl`, see the following few observations:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 `sp500add.pkl`，请查看以下几点观察：
- en: '[PRE35]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'For the last dataset called `stockMonthly.pkl`, see a few observations from
    it:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 对于最后一个名为 `stockMonthly.pkl` 的数据集，查看其中的几条观察：
- en: '[PRE36]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The output is shown here:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 输出结果如下：
- en: '[PRE37]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Exercises
  id: totrans-231
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: What is the assumption behind *don't put all your eggs in one basket*?
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*不要把所有的鸡蛋放在一个篮子里* 这一说法背后的假设是什么？'
- en: What are the measures of risk?
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 风险的衡量标准是什么？
- en: How do you measure the co-moment between two stock returns?
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何衡量两只股票回报之间的共同波动？
- en: Why it is argued that correlation is a better measure than covariance when we
    evaluate the co-movements between two stocks?
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为什么在评估两只股票之间的共同波动时，相关性被认为比协方差更为优越？
- en: For two stocks A and B, with two pairs of (σA, σB) and (βA,βB), which pair is
    important when comparing their expected returns?
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于两只股票 A 和 B，分别有两组（σA, σB）和（βA, βB），在比较它们的预期收益时，哪个组合更重要？
- en: Is it true that variance and correlation of historical returns possess the same
    sign?
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 历史回报的方差和相关性是否总是具有相同的符号？
- en: 'Find some inefficiency with the following code:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找出以下代码中的低效之处：
- en: '[PRE38]'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: For a given set of σA, σB, and correlation (ρ), write a Python program to test
    whether we have a solution or not.
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于给定的 σA、σB 和相关性（ρ），编写一个 Python 程序来测试我们是否有解。
- en: Note
  id: totrans-241
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Test the equation of ![Exercises](img/B06175_09_14.jpg)
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 测试这个方程！[练习](img/B06175_09_14.jpg)
- en: '![Exercises](img/B06175_09_65.jpg)'
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![练习](img/B06175_09_65.jpg)'
- en: What are the differences between covariance and correlation? Write a Python
    program to find out results for a given set of returns.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 方差和相关性之间有什么区别？编写一个 Python 程序来找出给定回报集的结果。
- en: The portfolio risk is defined here. What is the impact of correlation on a portfolio's
    risk?![Exercises](img/B06175_09_66.jpg)
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这里定义了投资组合风险。相关性对投资组合风险的影响是什么？![练习](img/B06175_09_66.jpg)
- en: For several stocks such as `MSFT`, `IBM`, `WMT`, `^GSPC`, `C`, `A`, and `AA`,
    estimate their variance-covariance and correlation matrices based on the last
    five-year monthly returns data, for example, over the last five years. Which two
    stocks are most strongly correlated?
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于多只股票，如 `MSFT`、`IBM`、`WMT`、`^GSPC`、`C`、`A` 和 `AA`，基于过去五年每月回报数据，估算它们的方差-协方差矩阵和相关性矩阵。哪两只股票的相关性最强？
- en: Based on the latest five-year monthly data and daily data, what are the correlations
    between `IBM` and `WMT`? Are they the same?
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于最新的五年每月数据和每日数据，`IBM` 和 `WMT` 之间的相关性是多少？它们是否相同？
- en: Generate a variance-covariance matrix for a market index and several stocks.
    Their tickers are `C`, `MSFT`, `IBM`, `WMT`, `AAPL`, `AF`, `AIG`, `AP`, and `^GSPC`.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为市场指数和几只股票生成一个方差-协方差矩阵。它们的股票代码是 `C`、`MSFT`、`IBM`、`WMT`、`AAPL`、`AF`、`AIG`、`AP`
    和 `^GSPC`。
- en: Is correlation constant between stocks over time?
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 股票之间的相关性是否随时间变化保持不变？
- en: Tip
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You could pick up a couple of stocks and then estimate correlations among them
    for several five-year windows.
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以选择几只股票，然后估算它们在若干个五年窗口中的相关性。
- en: Are larger stocks, measured by their market capitalization, more strongly correlated
    among themselves than the correlation of small stocks among themselves?
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 市值较大的股票，是否比市值较小的股票之间有更强的相关性？
- en: 'To form a portfolio, we have the following three stocks to choose from:'
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要形成一个投资组合，我们有以下三只股票可供选择：
- en: Is it possible to form a 2-stock portfolio with zero portfolio risk?
  id: totrans-254
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有可能形成一个零风险的 2 股票投资组合？
- en: What are the weights of those two stocks (to form a risk-free portfolio)?
  id: totrans-255
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这两只股票的权重是多少（以形成一个无风险投资组合）？
- en: '| Stock | Variance | Stock | Variance | Stock | Variance |'
  id: totrans-256
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| 股票 | 方差 | 股票 | 方差 | 股票 | 方差 |'
- en: '| --- | --- | --- | --- | --- | --- |'
  id: totrans-257
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- |'
- en: '| A | 0.0026 | B | 0.0418 | C | 0.0296 |'
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| A | 0.0026 | B | 0.0418 | C | 0.0296 |'
- en: 'The corresponding correlation (coefficient) matrix is given here:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 这里给出了相应的相关性（系数）矩阵：
- en: '|   | A | B | C |'
  id: totrans-260
  prefs: []
  type: TYPE_TB
  zh: '|   | A | B | C |'
- en: '| --- | --- | --- | --- |'
  id: totrans-261
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| A | 1.0 | -1.0 | 0.0 |'
  id: totrans-262
  prefs: []
  type: TYPE_TB
  zh: '| A | 1.0 | -1.0 | 0.0 |'
- en: '| B | -1.0 | 1.0 | 0.7 |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
  zh: '| B | -1.0 | 1.0 | 0.7 |'
- en: '| C | 0.0 | 0.7 | 1.0 |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
  zh: '| C | 0.0 | 0.7 | 1.0 |'
- en: When calculating variance or standard deviation, usually there are two definitions,
    based on population or based on a sample. The difference is the denominator. If
    based on population, we have the following formula:![Exercises](img/B06175_09_67.jpg)![Exercises](img/B06175_09_68.jpg)
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在计算方差或标准差时，通常有两种定义，基于总体或基于样本。区别在于分母。如果是基于总体，我们有以下公式：![练习](img/B06175_09_67.jpg)![练习](img/B06175_09_68.jpg)
- en: 'If based on a sample, we have the following formula:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 如果是基于样本，我们有以下公式：
- en: Find out whether `scipy.var()` and `spcipy.std()` functions are based on a sample
    or based on population.
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 了解 `scipy.var()` 和 `scipy.std()` 函数是基于样本还是基于总体。
- en: Write a Python program to estimate the expected portfolio returns for 20 stocks
    by using your own weights and the latest 10 year data.
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个 Python 程序，通过使用你自己的权重和最新的 10 年数据，估算 20 只股票的预期投资组合回报率。
- en: For 50 stocks, select at least five years of data. Estimate volatility for each
    stock, their average will be ![Exercises](img/B06175_09_74.jpg). Then form several
    equal-weighted 2-stock portfolios and estimate their volatilities. Their average
    will be our ![Exercises](img/B06175_09_75.jpg). Continue this way and ![Exercises](img/B06175_09_76.jpg)
    will be the average volatility for n-stock equal-weighted portfolios. Draw a graph
    with n, the number of n-stock portfolios, as the x axis and the volatility of
    the n-stock portfolio ![Exercises](img/B06175_09_76.jpg) as the y axis. Comment
    on it.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于50只股票，选择至少五年的数据。估算每只股票的波动率，它们的平均值将是![Exercises](img/B06175_09_74.jpg)。然后形成几个等权重的2只股票投资组合并估算它们的波动率。它们的平均值将是我们的![Exercises](img/B06175_09_75.jpg)。继续这个过程，![
- en: Find an appropriate definition for industry. Choosing seven stocks from each
    industry, estimate their correlation matrix. Then do the same thing on another
    industry. Comment on your results.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为行业找到一个合适的定义。从每个行业中选择七只股票，估算它们的相关矩阵。然后对另一个行业做相同的操作。对你的结果进行评论。
- en: Write a Python program to estimate the optimal portfolio construction by using
    10 stocks.
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个Python程序，使用10只股票估算最佳投资组合。
- en: Find the average of correlations for five industries, at least 10 stocks in
    each industry.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找五个行业的相关性平均值，每个行业至少10只股票。
- en: 'To estimate the volatility of a portfolio, we have two formulae: for a 2-stock
    portfolio and for an n-stock portfolio. Show that when n equals 2, we expand the
    formula to estimate the volatility of an n-stock portfolio; we end up with the
    same formula for a 2-stock portfolio.'
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了估算投资组合的波动率，我们有两个公式：一个是针对2只股票投资组合的公式，另一个是针对n只股票投资组合的公式。证明当n等于2时，我们可以展开公式来估算n只股票投资组合的波动率；最终得到的结果与2只股票投资组合的公式相同。
- en: Is the following statement correct? Prove or disapprove it.
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下说法是否正确？请证明或反驳它。
- en: Tip
  id: totrans-275
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Stock returns are uncorrelated.
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 股票收益是无相关的。
- en: 'Downloading one year IBM daily data and estimate its Sharpe ratio by using
    two methods: its definition, and write a `sharpe()` function in Python.'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载一年的IBM日数据，并使用两种方法估算其夏普比率：其定义，并编写一个`sharpe()`函数在Python中。
- en: 'Update `yanMonthly.pkl`, [http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl),
    see the following first and last several lines. Note that for stock, `VALUE` is
    monthly stock price, for Fama-French factors, `VALUE` is their factor, that is,
    their monthly portfolio returns:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新`yanMonthly.pkl`，[http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl)，查看以下的前几行和最后几行。请注意，对于股票，`VALUE`是每月的股票价格；对于法玛-弗伦奇因子，`VALUE`是它们的因子，即它们的每月投资组合回报：
- en: '[PRE39]'
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: For the Markowitz's optimization, only the first two moments are used. Why?
    What are the definitions of the third and fourth moments? What is the impact when
    those two moments are ignored? How do you include them?
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于Markowitz的优化，仅使用前两个矩 moments。这是为什么？第三和第四矩的定义是什么？忽略这两个矩时会产生什么影响？如何将它们包含在内？
- en: Write a Python program to estimate equal-weighed and value-weighted monthly
    returns for 10 stocks from January 2nd, 2012 to December 31st, 2013\. The data
    used is `yanMonthly.pkl`, [http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl).
    For value-weighed returns, the weight is the number of shares invested times the
    price of the previous month.
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个Python程序，估算2012年1月2日至2013年12月31日，10只股票的等权重和市值加权每月回报。使用的数据是`yanMonthly.pkl`，[http://canisius.edu/~yany/python/yanMonthly.pkl](http://canisius.edu/~yany/python/yanMonthly.pkl)。对于市值加权回报，权重为上月的股票数量与股票价格的乘积。
- en: 'For this question, assume that your school has subscribed to the **Center for
    Research in Security Prices** (**CRSP**) database. Replicate `VWRETD` and `EWRETD`
    in CRSP. Note that the monthly CRSP dataset should be used. A few observations
    from a dataset called `stockMonthly.pkl` are shown here:'
  id: totrans-282
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于这个问题，假设你的学校已订阅**证券价格研究中心**（**CRSP**）数据库。在CRSP中复制`VWRETD`和`EWRETD`。请注意，应使用每月的CRSP数据集。以下是名为`stockMonthly.pkl`的数据集中的一些观测值：
- en: '[PRE40]'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The output is shown here:'
  id: totrans-284
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 输出如下所示：
- en: '[PRE41]'
  id: totrans-285
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Write a Python program to complete Modigliani and Modigliani (1997) performance
    test.
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个Python程序，完成Modigliani和Modigliani（1997）的业绩测试。
- en: For several performance measures such as Sharpe ratio, Treynor ratio, and Sortino
    ratio, see here, the benefits and costs are compared by dividing them:![Exercises](img/B06175_09_69.jpg)![Exercises](img/B06175_09_70.jpg)![Exercises](img/B06175_09_71.jpg)
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于多个绩效衡量标准，如夏普比率、特雷诺比率和索提诺比率，请参见此处，通过将它们进行比较，福利与成本被分开：![习题](img/B06175_09_69.jpg)![习题](img/B06175_09_70.jpg)![习题](img/B06175_09_71.jpg)
- en: 'On the other hand, the utility function, see the following formula, also balances
    the benefits with the costs by choosing their difference:'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 另一方面，效用函数，参见以下公式，也通过选择它们的差值来平衡福利与成本：
- en: '![Exercises](img/B06175_09_72.jpg)'
  id: totrans-289
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![习题](img/B06175_09_72.jpg)'
- en: Compare those two approaches. Could we have a more general form to combine those
    two ways?
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 比较这两种方法。我们能否有一个更一般的形式来结合这两种方法？
- en: 'Estimating the Sharpe ratio, Treynor, and Sortino ratio for the Fama-French
    49 industries. The risk-free rate could be found at [http://finance.yahoo.com/bonds](http://finance.yahoo.com/bonds).
    Alternatively, the risk-free rate from `ffMonthly.pkl`, [http://canisius.edu/~yany/python/ffMonthly.pkl](http://canisius.edu/~yany/python/ffMonthly.pkl),
    could be used. The dataset used is `ff49industries.pkl`, which is downloadable
    at [http://canisius.edu/~yany/python/ff49industries.pkl](http://canisius.edu/~yany/python/ff49industries.pkl).
    A few lines are shown here:'
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 估算法马-法伦奇49个行业的夏普比率、特雷诺比率和索提诺比率。无风险利率可以在[http://finance.yahoo.com/bonds](http://finance.yahoo.com/bonds)找到。或者，可以使用来自`ffMonthly.pkl`的无风险利率，[http://canisius.edu/~yany/python/ffMonthly.pkl](http://canisius.edu/~yany/python/ffMonthly.pkl)。使用的数据集是`ff49industries.pkl`，可以从[http://canisius.edu/~yany/python/ff49industries.pkl](http://canisius.edu/~yany/python/ff49industries.pkl)下载。这里展示了几行：
- en: '[PRE42]'
  id: totrans-292
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Summary
  id: totrans-293
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we first explained various concepts related to portfolio theory,
    such as covariance and correlation for a pair of stocks and for a portfolio. After
    that, we discussed various risk measures for individual stocks or portfolios,
    such as the Sharpe ratio, Treynor ratio, and Sortino ratio, how to minimize portfolio
    risks based on those measures (ratios), how to set up an objective function, how
    to choose an efficient portfolio for a given set of stocks, and how to construct
    an efficient frontier.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 本章首先解释了与投资组合理论相关的各种概念，例如成对股票和投资组合的协方差和相关性。之后，我们讨论了个别股票或投资组合的各种风险衡量标准，如夏普比率、特雷诺比率和索提诺比率，如何基于这些衡量标准（比率）最小化投资组合风险，如何建立目标函数，如何为给定的股票集选择有效的投资组合，以及如何构建有效前沿。
- en: For the next chapter, [Chapter 10](ch10.html "Chapter 10. Options and Futures"),
    *Options and Futures*, we will explain some basic concepts first. Then, we will
    discuss the famous Black-Scholes-Merton options model. In addition, various trading
    strategies involving options will be discussed in detail.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 对于下一章，[第10章](ch10.html "第10章. 期权与期货")，*期权与期货*，我们将首先解释一些基本概念。接着，我们将讨论著名的布莱克-斯科尔斯-默顿期权模型。此外，还将详细讨论涉及期权的各种交易策略。
