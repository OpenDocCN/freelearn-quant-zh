- en: Applying the Referencing Framework in Excel
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's assume that a worksheet in Microsoft Excel is divided into over 1 million
    rows and over 16,000 columns. The rows are labeled **1**, **2**, **3**, and so
    on, up to **1,048,576**, and the columns are labeled **A**, **B**, **C**, and
    so on, up to **XFD**. The rows and columns intersect to form over 16 billion cells
    in one worksheet.
  prefs: []
  type: TYPE_NORMAL
- en: However, since a cell is identified by the columns and rows that intersect to
    form it, each cell has a unique identification, which is conventionally written
    as the intersecting column and row names. Thus, the **UV** column and row **59**
    form the **UV59** cell. There is no other **UV59** cell on that worksheet, of
    that workbook, on that computer. This feature forms the basis for the referencing
    framework in Excel. This chapter will talk about the various types of referencing
    frameworks and how to implement each one of them in order to simplify vast collections
    of data.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to the framework
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Relative referencing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Absolute referencing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mixed referencing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementing the referencing framework
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction to the framework
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The referencing framework ensures that you can use the contents of any cell
    simply by including its cell reference in a formula. The following screenshot
    is the simplest example of this. By typing `=D4` in cell **F5**, the contents
    of cell **D4**, `Happy day`, have been duplicated in cell **F5**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/516c5c5b-25c1-4cb5-97a6-7e91e4801910.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You can enter a formula in Excel by typing the values for each part of the
    formula directly into the cell, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/41c2e7f9-dd85-4f50-8b35-32067be52191.png)'
  prefs: []
  type: TYPE_IMG
- en: '`Cost of Sales` is `Units Sold` × `Unit Cost`, which in this case is `30` × `65,000`.
    The formula bar shows that we entered `=30*65000` to get `1,950,000`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The two major shortcomings of this method are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: It isn't clear where the figures have come from. Several months down the line,
    when you come to review your model, you don't want to have to think through the
    whole process again in order to determine the source of the input.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If the cells containing the values you have entered need to be modified in order
    to accommodate new and/or more accurate information, wherever those variables
    occur or have been used in formulas in your model, you would need to go and update
    them one by one accordingly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Relative referencing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To avoid the aforementioned shortcomings, you should enter the cell references
    of the cells containing the values, rather than typing the actual values, as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b2796f49-b051-4004-8bb5-13e0b41da597.png)'
  prefs: []
  type: TYPE_IMG
- en: The formula bar in the preceding screenshot shows that we entered `F5*I5`.
  prefs: []
  type: TYPE_NORMAL
- en: In this way, it is clear where the input is coming from. All the cells that
    have formulas that refer to those cells will be automatically updated.
  prefs: []
  type: TYPE_NORMAL
- en: Another advantage of referencing is that, by default, Excel registers the position
    of the cell references relative to the active cell. So, in the preceding example,
    **F5** is registered as four cells to the left, and **I5** is registered as one
    cell to the left of the active cell, **J5**.
  prefs: []
  type: TYPE_NORMAL
- en: The relevance of this is that, when you copy that formula to another location,
    Excel remembers the positions of the original cell references included in the
    formula, relative to the original active cell. Excel then adjusts the references
    accordingly in order to maintain those positions relative to the new active cell.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, if the formula is copied 15 cells down, the row part of the reference is
    adjusted by 15 rows down, and so `F5*I5` automatically becomes `F20*I20`. In this
    way, since the formula is the same, that is, `Units Sold` × `Unit Cost`, we can
    simply copy our formula down the list and still obtain the correct answers. This
    can be seen in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d7e5cd33-9202-40eb-8055-52d8019ea483.png)'
  prefs: []
  type: TYPE_IMG
- en: This wouldn't work in the example we saw in the previous section, where we entered
    the values directly into the active cell. If we copied down in that case, we would
    get the same value, `1,950,000`, all the way down the list.
  prefs: []
  type: TYPE_NORMAL
- en: This technique of referencing the cells, instead of their actual values, is
    called relative referencing.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are several different ways to copy to a range of cells, which are as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: The first way is to select the cell or range of cells to be copied, press *Ctrl
    + C*, select the range of cells to which you are going to copy, and then press
    *Enter* or *Ctrl + V*.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If you press *Ctrl + V*, Excel places a *Ctrl* icon at the bottom right of
    the last cell of the range. You can then click on the icon or simply press *Ctrl*
    and a box of **Paste Special** options will appear, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/91e39b08-35af-42d6-bc92-4c7c069498c8.png)'
  prefs: []
  type: TYPE_IMG
- en: You can then select, paste format, paste values, transpose, or perform any one
    of the other options.
  prefs: []
  type: TYPE_NORMAL
- en: This feature isn't available if you press *Enter* to paste.
  prefs: []
  type: TYPE_NORMAL
- en: 'The second way is built into Excel. There is a small black box that appears
    at the bottom right of the selected cell, called the **fill handle**. When you
    hover the cursor over the fill handle, it turns into a thick black cross. Select
    the cell with the value to be copied, and then hold the right mouse button down
    on the fill handle and drag it down the range of cells that you want to copy.
    Then, release the right mouse button. The following screenshot shows the fill
    handle of a cell in Excel:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/836911a2-b9a9-49c4-ac05-d4e950673e55.png)'
  prefs: []
  type: TYPE_IMG
- en: Alternatively, you could just double-click on the fill handle and all the cells
    below, up to the last row of the table. These will be filled by the original cell.
    You don't need to preselect the cells—all you need to do is press *Ctrl + C* for
    this method to work.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: However, the cells in the adjacent column, left or right, must be populated
    in order to indicate to Excel how far down you wish to fill the formula.
  prefs: []
  type: TYPE_NORMAL
- en: The last way to do this is as follows—starting with and including the cell with
    the formula to be copied, select the range of cells to be copied to, and then
    press *Ctrl + D*. All the cells that are selected will be populated with the formula.
    This method is my personal favorite and, along with double-clicking the fill handle,
    is the most elegant way to copy to a range of cells. You could also use this method
    to fill to the right by pressing *Ctrl + R*. You will find this very useful for
    filling formulas to the right, across the columns of the forecast years in your
    financial model.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Absolute referencing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sometimes, you will have a formula that contains a reference that you don't
    want Excel to modify when you copy the formula. For example, let's say we want to
    calculate commission on sales for each salesperson. This would be `Sales` × `Commission`.
  prefs: []
  type: TYPE_NORMAL
- en: As we move down the list, the row number changes so that the reference to the
    sales that are made by the salespersons moves from **H5** to **H6**, to **H7**,
    and eventually to **H20**, which is the last record in our list.
  prefs: []
  type: TYPE_NORMAL
- en: However, the same commission percentage, which is in cell **H2**, applies to
    all salespersons. Thus, when we copy down the list, we need to retain the cell
    reference, **H2**, and so we need to lock the cell reference or make it absolute.
  prefs: []
  type: TYPE_NORMAL
- en: We do this by putting the `$` sign before the column and row parts of the reference.
    By doing this, `H2` becomes `$H$2`.
  prefs: []
  type: TYPE_NORMAL
- en: Instead of typing them in, Excel allows you to press the *F4* key to put the
    `$` signs before the column and row references.
  prefs: []
  type: TYPE_NORMAL
- en: 'As you enter the formula, once you point to cell **H2** and it has registered
    in your formula, simply press the *F4* key and the dollar signs will appear, one
    before the `H` and one before the `2` to give `$H$2`. We will examine this in
    more detail via the following screenshots. The first screenshot shows the formula
    as it references `H2`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9e8ea58b-8471-45b5-afd3-1d531502f300.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following screenshot shows the same formula after you press *F4*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f11be92c-925d-4479-a02b-63f52ec8cde5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In the following screenshot, we can see that the formula has been entered in
    cell **K5** as `=H5*$H$2`, which becomes `46,800` when you press *Enter*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/241d3413-915f-42b2-aefc-6bf5ca9dec13.png)'
  prefs: []
  type: TYPE_IMG
- en: This means that when we copy the formula down the list from one row to the next,
    the reference to `Sales` will change accordingly, but the reference to `Commission`
    will be locked on cell **H2**.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the `Commission` on `Sales` for all salespersons:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/23d437e6-f038-4019-8f09-b89ea317d0e9.png)'
  prefs: []
  type: TYPE_IMG
- en: This is an example of absolute referencing.
  prefs: []
  type: TYPE_NORMAL
- en: As we mentioned previously, a cell reference is made up of the rows and columns
    that intersect to form that cell. Thus, if a cell is in column **G**, row **59**,
    its cell reference is **G59**; **G** being the column part and **59** being the
    row part of the cell reference. No two cells can have the same cell reference.
  prefs: []
  type: TYPE_NORMAL
- en: Mixed referencing occurs when you need to lock either the column part only,
    when you leave the row part of the reference relative, or lock the row part only,
    when you leave the column part of the reference relative. This is demonstrated
    in the following example in the *Mixed referencing* section.
  prefs: []
  type: TYPE_NORMAL
- en: You should take note of two things—first, that the referencing framework is
    only relevant when you want to copy a formula to another location. Second, its
    main function makes it possible for you to enter a formula once, and then copy
    it over a range that contains cells with formulas that have cell references with
    a similar positioning that's relative to the active cells.
  prefs: []
  type: TYPE_NORMAL
- en: While this framework allows you to save copious amounts of valuable time, it
    isn't mandatory, and if you find that you are struggling to understand this framework,
    you can ignore it and copy the formula manually down the list.
  prefs: []
  type: TYPE_NORMAL
- en: Mixed referencing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The following example, which is using the same `Sales Report` worksheet, seeks
    to compare sales that are obtained by using `MarkUps` of `15%`, `20%`, and `25%`.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this case, the sales is calculated as `Cost of Sales` × (1+`MarkUp %`).
    This is a screenshot of the layout for the markup:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9e8c7f7b-ae42-44d7-9684-427642b0e50a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Mixed referencing is required when you need to lock a reference in one direction
    only, either down **or** across to the right, but not both. In the following example,
    you will create the formula in cell `I5`, and then copy it down through rows **6**
    to **20** and across columns **J** and **K**. The following screenshot shows the
    calculation of `15%` MarkUp:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/275b42db-648e-436b-819b-5358c452c854.png)'
  prefs: []
  type: TYPE_IMG
- en: The base formula is `H5*(1+I4)`.
  prefs: []
  type: TYPE_NORMAL
- en: Note that there are two cell references in the formula, `H5` and `I4`, which
    you will need to consider individually.
  prefs: []
  type: TYPE_NORMAL
- en: Cell **H5** is the `Cost of Sales`. The column part is **H**, which we will
    look at when we consider copying to the right, across columns. The row part is
    **5**, which we will look at when we consider copying down the rows. When copying
    the formula down the rows, you want the cost of sales to change from one record
    to the next one down. In other words, the row part of the reference, **5**, shouldn't
    be locked—it should remain relative; that is, there shouldn't be a `$` sign in
    front of it.
  prefs: []
  type: TYPE_NORMAL
- en: When copying the formula across the columns, the cost of sales remains the same
    as you move from one `MarkUp %` to the next. In other words, the column part of
    the reference, **H**, should be locked with a `$` sign in front of it.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows how to work out the referencing pattern of the
    first reference:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/11358184-2561-41ab-8d96-0154fee10f60.png)'
  prefs: []
  type: TYPE_IMG
- en: Thus, our first reference is `$H5`.
  prefs: []
  type: TYPE_NORMAL
- en: Cell `I4` is `MarkUp %`, which is `15%`. The column part is **I**, which we
    will look at when we consider copying to the right across columns. The row part
    is **4**, which we will look at when we consider copying down the rows.
  prefs: []
  type: TYPE_NORMAL
- en: When copying the formula down the rows, you want the markup margin, which is
    `15%`, to remain the same from one record to the next one down. In other words,
    the row part of the reference, **4**, should be locked, and should have a `$`
    sign in front of it. When copying the formula across the columns, the markup should
    move from `15%` to `20%`, and so on. In other words, the column part of the reference,
    **I**, should be locked with a `$` sign in front of it.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows how to work out the referencing pattern of the
    second reference:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5ed51cd5-f959-4dcc-9f3f-fff5ac912e49.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Thus, our second reference will be `I$4` and the formula would then be `=$H5*(1+I$4)`.
    This results in the following output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e7b0e8af-74e8-4b98-a676-248b918c13f5.png)'
  prefs: []
  type: TYPE_IMG
- en: We will now do this for all the cells.
  prefs: []
  type: TYPE_NORMAL
- en: The *F4* key on your keyboard is a toggle key that cycles through four options. Using
    the cell reference `H5` as an example, pressing the *F4* key once will put the `$` sign
    before both the column and row parts to give `$H$5`. A second press will put the
    `$` sign in front of the row part only to give `H$5`. A third press will put the
    `$` sign in front of the column part only to give `$H5`. Finally, a fourth press
    on the *F4* key will return the reference to a relative reference, H5, with no
    `$` signs.
  prefs: []
  type: TYPE_NORMAL
- en: Now, copy the formula across and down.
  prefs: []
  type: TYPE_NORMAL
- en: 'It is always prudent to check that the copied formula gives the correct answer.
    You can do this by checking the cell at the bottom right of the range that you
    have copied. In this case, this is cell **K20**, which correctly refers to the
    cells **H20** and **K4**. The following screenshot shows the check to ensure that
    the formula was correctly constructed:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7f5a0a95-ca2b-42cb-be43-0f60337af4f1.png)'
  prefs: []
  type: TYPE_IMG
- en: Implementing the referencing framework
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that you are all caught up with the theory behind each type of referencing
    framework and know where to use each of them, let's apply that knowledge to a
    real-life scenario.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assume that you are a teacher and that you have the marks of the students in
    an entire class, and you need to sort and divide the data into different groups,
    based on the following criteria:'
  prefs: []
  type: TYPE_NORMAL
- en: Total marks scored by the student in all languages
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Total marks scored by the student in all sciences
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Overall marks scored
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The referencing framework really comes into its own in such scenarios. We can
    sort our data using the required criteria by following these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Open the `Marks.xlsx` file provided to you, which contains the grades of 66
    students who appeared for their midterms. The data will look similar to the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/4839b8b8-f5ab-4a55-ac68-93fb20b017e2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we will start sorting the data. By looking at the first criterion, we
    can see that the grades for languages are present in columns **B** through **E**.
    So, let''s input the formula for student 1 in the respective field, which in this
    case is **L2**. Since we want to calculate the sum of the marks, our formula will
    be `=B2+C2+D2+E2`, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b80839c0-4af3-4cdf-8f84-83b0b0f8c4e2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'This results in the following output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e69bb577-6e74-4691-adf2-90883353899a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, for student 2, we can simply click the fill handle in the bottom-right
    corner of the sum field and drag it down to the field below it, which results
    in the following output:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/742d7eaa-655b-4c47-8ab5-88500080462f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As we learned in the *Relative referencing* section, we can fill in all the
    cells with their respective values in several ways. We will use the most elegant
    way here, which is double-clicking the fill handle on the **L3** cell, which results
    in the following output:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b0c9f4c5-1ec0-462b-9ca5-1098ff85b96d.png)'
  prefs: []
  type: TYPE_IMG
- en: As we can see, all the cells have now been populated with their respective values
    automatically.
  prefs: []
  type: TYPE_NORMAL
- en: As an exercise, I will leave the `Marks obtained in Sciences` column blank so
    that you can try this out on your own.
  prefs: []
  type: TYPE_NORMAL
- en: 'Rinse and repeat for the `Total Marks obtained` column. Our final table should
    look similar to the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c737b7b3-ea79-449d-a29d-75085a7798ce.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, let''s say you want to find the percentage that each student scored. We
    can do that by using the following formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/26ec68b4-0c38-4be8-a39f-d829764a06af.png)'
  prefs: []
  type: TYPE_IMG
- en: For this, we will apply mixed referencing.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we will create an independent cell, **T5**, in which we will input the
    maximum marks that a student can score (`900`), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ac917812-05c5-456c-9ee4-bbdb7110142b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we will input the formula to calculate the percentage for student 1 in
    cell **O2**, as shown here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2dce2a37-6b9e-4546-9885-2c4c7b25b893.png)'
  prefs: []
  type: TYPE_IMG
- en: 'This results in the following output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b4e352e5-403f-4f45-a795-401c56953bba.png)'
  prefs: []
  type: TYPE_IMG
- en: As an exercise, use the fill handle to find the percentages for the remaining
    65 students.
  prefs: []
  type: TYPE_NORMAL
- en: 'One more cool thing you can do here is finding the student who scored the highest
    grades using the `=MAX()` function. Once everything has been done, our final worksheet
    should look similar to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/670e83c3-9dda-4923-8aa8-d1ed974e4bb3.png)'
  prefs: []
  type: TYPE_IMG
- en: As we can see, the referencing framework in Excel has immense capabilities,
    all of which can be implemented in various fields.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we have learned about the referencing framework in Excel. We
    learned about the three types of referencing; that is, relative, absolute, and
    mixed referencing; and when to use each of them. We understood that this concept
    can save us a lot of time in our Excel work, but is only relevant when we need
    to copy a cell or range of cells containing one or more cell references to another
    location. We also learned about the *F4* shortcut key and how it toggles between
    the different forms of referencing.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, *Understanding the Project and Building Assumptions*, we
    will cover the need to understand the purpose of any project that you work on and
    how to build assumptions, which are necessary to project our actual results for
    the next three to five years.
  prefs: []
  type: TYPE_NORMAL
