["```py\npip install pandas\nyfinance library is a convenient tool that allows you to access Yahoo! Finance’s historical stock price data. You can use the following code to download the data:\n\n```", "```py\n\n Here’s a step-by-step breakdown:\n\n*   `yfinance` for downloading stock data from Yahoo! Finance and `pandas` for data manipulation.\n*   `AAPL` for Apple, `GOOG` for Google, and `MSFT` for Microsoft.\n*   `2020-01-01` and `2022-12-31`, respectively.\n*   `pandas` DataFrame is created to store the downloaded data.\n*   `yf.download()` function, adds a new column to the downloaded data to store the ticker symbol, and appends this data to the main DataFrame.\n*   `reset_index()` function. This is done because when new DataFrames are concatenated, `pandas` keeps the original indices. Resetting the index ensures that we have a continuous index in the final DataFrame.\n*   `stock_data.csv` using the `to_csv()` function. The `index=False` argument is used to prevent `pandas` from saving the index as a separate column in the CSV file.\n\nNow, we will take this data and create visualizations with Power BI.\nWith the stock data you have, you can create several types of charts in Power BI. Here are a few examples:\n\n*   **Candlestick chart**: This chart is used to show price movement for the securities in the stock market. It contains information about the open, high, low, and closing prices of stock.\n*   **Stock chart**: A stock chart in a Power BI paginated report is specifically designed for financial or scientific data that uses up to four values per data point. These values align with the high, low, open, and close values that are used to plot financial stock data.\n\nThe following are some other custom visualizations available in Power BI:\n\n*   Mekko charts\n*   Hexbin scatterplot\n*   Word cloud\n*   Pulse charts\n*   Interactive chord diagrams\n\nTo create a candlestick chart in Power BI, follow these steps:\n\n1.  Open Power BI and connect to your dataset.\n2.  Select the candlestick chart visualization from the **Visualizations** pane.\n3.  Drag and drop the required fields onto the chart, such as date, high, low, open, and close prices.\n4.  The chart will automatically generate based on the data you have selected.\n\nTip\nYou might need to download the candlestick visualization from the web. Click on the ellipsis in the `candlestick`; it should show up as a free add-on. Please select it and add it to the **Visualizations** pane.\nRemember, the candlestick chart is a powerful tool that can help you understand market trends and identify potential opportunities:\n![Figure 2.3 – Illustration of a candlestick chart from stock data](img/B21008_02_3.jpg)\n\nFigure 2.3 – Illustration of a candlestick chart from stock data\nTo create a stock chart in Power BI using the data you’ve downloaded from `yfinance`, you can follow these steps:\n\n1.  `stock_data.csv`). You can do this by clicking on **Home** > **External Data** > **Get Data** > **Text/CSV**.\n2.  **Create a new chart**: Click on the **Report** view (the bar chart icon on the left), and then click on the line chart icon in the **Visualizations** pane.\n3.  **Add data to the chart**: In the **Fields** pane, drag and drop the required fields onto the chart. For a basic stock chart, you would typically use the following values:\n    *   **Date** for the axis\n    *   **Open**, **High**, **Low**, and **Close** as values\n    *   **Ticker** for the legend (optional)\n4.  **Customize the chart**: You can further customize your chart by clicking on the paint roller icon in the **Visualizations** pane. Here, you can change things such as colors, add a title, modify axis settings, and more.\n5.  **Save your report**: Once you’re happy with your chart, don’t forget to save your report by clicking on **File** > **Save**.\n\nRemember, these are just basic steps to create a simple line chart for stock data. Power BI offers many other types of charts and advanced features that you can explore to create more complex and insightful visualizations:\n![Figure 2.4 – Illustration of a stock chart in Power BI using the stock data](img/B21008_02_4.jpg)\n\nFigure 2.4 – Illustration of a stock chart in Power BI using the stock data\nTip\nRemember to format and label your charts clearly to make them easy to understand. You can also add filters to allow viewers to drill down into specific periods or companies.\nFinally, you can ask ChatGPT for insights and interpretations based on the visualizations you’ve created. For example, you might ask why there was a spike in patent filings in a particular year, or how a company’s R&D spending compares to its competitors.\nIn the next section, we’ll look at a different walkthrough, this time incorporating ChatGPT insights with Power BI.\nWalk-through use case – analyzing financial ratios using Power BI and ChatGPT\nThe following is an example that you can try to emulate. It is a simple illustration of how you can integrate Power BI and ChatGPT. (Note: this example is courtesy of Amer Mahmood, who posted this article on medium.com).\nIn this example, we will create a report in Power BI and feed the data to ChatGPT, asking for insights. Some steps need to be completed before we start:\n\n1.  Install Python and enable Python in Power BI:\n    1.  First, install Python, if you have not done so already. Please visit the official website ([https://www.python.org/downloads/](https://www.python.org/downloads/)) to download it. We recommend versions 3.9 and 3.10.\n    2.  Once Python has been installed, enable Python scripting in Power BI. To do so, open Power BI Desktop. Then, click **File** > **Options** and go to **Settings** > **Options** > **Python scripting**. Select the checkbox and click **OK**.\n    3.  Next, set the Python path in Power BI. Go to **File** > **Options** and then to **Settings** > **Options** > **Python scripting**. Here, click **Detect**. This selects the Python installation path automatically. You can also do this manually by clicking on the ellipsis (**…**) and selecting the Python executable file.\n    4.  Restart Power BI Desktop for the changes you made to take effect.\n2.  Follow these steps to set up ChatGPT using the ChatGPT API:\n    1.  First, you will need to obtain an API key from Open AI. Navigate to the Open AI website ([https://openai.com](https://openai.com)) and create a (personal) account.\n    2.  Next, ask for and get an API key. You will use this in all your integration projects.\n\nTip\nThese API keys are not free. When you sign up with Open AI, you get about $18 worth of tokens for use with your API Key. After that, you are billed (pay-as-you-go). The details are available on the Open AI site under **Pricing** ([https://openai.com/pricing](https://openai.com/pricing)).\n\n1.  The ChatGPT API has SDKs and libraries available in several programming languages. Select **Python**. We will use Python extensively in this book and recommend it.\n2.  Install the SDK with a package manager such as `pip`:\n\n    ```", "```py\n\n1.  Now, we need to create a dataset to analyze. Follow these steps:\n    1.  Use Excel to create a sample dataset similar to the following. Name it `Tech Stocks`:\n\n  **Current Ratio**\n |\n  **Debt** **to Equity**\n |\n  **Gross** **Margin %**\n |\n  **Price** **to Book**\n |\n  **Price** **to Earnings**\n |\n  **Return on** **Equity %**\n |\n\n  0.94\n |\n  1.96\n |\n  42.96\n |\n  40.75\n |\n  24.79\n |\n  147.94\n |\n\n  2.38\n |\n  0.12\n |\n  53.11\n |\n  4.63\n |\n  20.5\n |\n  23.62\n |\n\n  0.89\n |\n  2.45\n |\n  58.65\n |\n  5.81\n |\n  73.28\n |\n  8.73\n |\n\n  2.2\n |\n  0.22\n |\n  78.63\n |\n  3.63\n |\n  20.33\n |\n  18.52\n |\n\n  1.93\n |\n  0.43\n |\n  66.85\n |\n  10.21\n |\n  27.92\n |\n  39.31\n |\n\n  3.52\n |\n  0.54\n |\n  63.34\n |\n  26.01\n |\n  133.88\n |\n  17.93\n |\n\n1.  Create a simple report in Power BI Desktop by connecting this dataset to Power BI.  Go to the **Modeling** tab via the left column. This is what should appear:\n\n![Figure 2.5 – A view of the Modeling tab in Power BI](img/B21008_02_5.jpg)\n\nFigure 2.5 – A view of the Modeling tab in Power BI\n\n1.  Select the third icon from the left in the ribbon to **Transform** the data.\n2.  Add **Run Python script** to the **Applied** **Steps** section.\n3.  Now, we can put the code in the next section directly into Power BI and run it.\n\n1.  Now, we must call the ChatGPT API from Power BI. Here, we will integrate ChatGPT with Power BI using the Power Query Editor in Power BI and writing an executable Python code. The code is as follows:\n    1.  To start, import the necessary Python libraries:\n\n        ```", "```py\n\n    2.  Next, add your Open AI key to the code:\n\n        ```", "```py\n\n    3.  To pass data to the API, loop through each row of the dataset and create a single string:\n\n        ```", "```py\n\n    4.  Now, build the API request so tha–t it includes the row-level data and makes a chat completion request for the API. Once we’ve done this, we can process the response and write it back to the report:\n\n        ```", "```py\n\n    When we run this script, the Python code loops through each row of the Power BI table and uses the report data to construct the prompt for ChatGPT. This prompt is passed to ChatGPT with the API response being written back to the Power BI DataFrame and table one row (company) at a time.\n\n    Keep in mind that the dataset is a built-in `pandas` DataFrame-like structure that allows the Power BI developer to access and manipulate data from the Power BI table using Python.\n\n    The result of the ChatGPT response can be rendered as a visual in the Power BI report you’ve created. It should look like this:\n\n![Figure 2.6 – Power BI dashboard showing ChatGPT insights](img/B21008_02_6.jpg)\n\nFigure 2.6 – Power BI dashboard showing ChatGPT insights\nYou can use this format to pass through any number of datasets and leverage insights using ChatGPT. Try using this with existing reports in Power BI.\nNext, we’ll summarize the key takeaways from this chapter.\nSummary\nIn this chapter, we learned about Power BI in finance and that it is a powerful tool for financial analysis, offering features such as data modeling, visualization, and integration with ChatGPT for enhanced insights.\nWe followed this up with a section on data modeling and visualization techniques. We explained why clean and well-structured data modeling is essential for effective financial analysis in Power BI. This involves data cleansing, establishing relationships, implementing validation, and utilizing calculated columns and measures. We detailed how choosing the right visualizations is crucial for communicating financial information effectively, understanding the characteristics of the data, and leveraging visuals such as line charts, bar charts, pie charts, and tables for clear and concise representation.\nThen, we learned about ChatGPT integration with Power BI. Integrating ChatGPT with Power BI allows users to have contextual conversations and seek insights related to financial data. We also learned how to develop ChatGPT models that interpret user queries and generate actionable insights for improved financial analysis.\nNext, we listed some best practices, which included the following:\n\n*   Ensuring data security and privacy by anonymizing sensitive information and implementing access control\n*   Continuously refining and improving data models, visualizations, and ChatGPT integration based on user feedback and evolving needs\n*   Planning and designing financial dashboards with a focus on clarity, interactivity, and relevant KPIs\n\nFinally, we listed the benefits of Power BI – how Power BI provides real-time, interactive, and visually appealing dashboards that enable stakeholders to gain valuable insights into financial performance, analyze trends, identify opportunities, and make data-driven decisions.\nGet ready to shift gears in [*Chapter 3*](B21008_03.xhtml#_idTextAnchor065) as we delve deep into the electrifying intersection of ChatGPT, AI, and the financial world, all through the lens of Tesla. We’ll kickstart your journey by unveiling how ChatGPT can decode intricate data and transform it into actionable investment insights. Ready to disrupt conventional wisdom? We’ll reveal Tesla’s unique data sources and KPIs, offering you an edge in your financial decisions. Take a spin through the world of sentiment analysis as we dissect news articles and earnings call transcripts to gauge market sentiment like never before. Whether you’re an investor or a planner, our AI-driven trading strategies will have something tailored just for you. We’ll dazzle you with Power BI visualizations that make complex financial metrics as easy to read as your car’s dashboard. And because fairness matters, we’ll guide you on how to ensure your AI models are unbiased.\n\n```"]