- en: Chapter 11. Value at Risk
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第11章：风险价值（VaR）
- en: 'In finance, implicitly or explicitly, rational investors always consider a
    trade-off between risk and returns. Usually, there is no ambiguity to measure
    returns. However, in terms of risk, we have numerous different measures such as
    using variance and standard deviation of returns to measure the total risk, individual
    stocks'' beta, or portfolio beta to measure market risk. In the previous chapters,
    we know that the total risk has two components: market risk and firm-specific
    risks. To balance between the benefit of return and the cost of risk, many measures
    can be applied, such as the Sharpe ratio, Treynor ratio, Sortino ratio, and M2
    performance measure (Modigliani and Modigliani performance measure). All of those
    risk measures or ratios have a common format: a trade-off between benefits expressed
    as risk-premium and risk expressed as a standard deviation, or beta, or **Lower
    Partial Standard Deviation** (**LPSD**). On the other hand, those measures do
    not consider a probability distribution. In this chapter, a new risk measure called
    **Value at Risk** (**VaR**) will be introduced and applied by using real-world
    data. In particular, the following topics will be covered:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融领域，理性投资者在隐性或显性地，总是考虑风险与回报之间的权衡。通常，衡量回报没有歧义。然而，在衡量风险方面，我们有许多不同的度量标准，如使用收益的方差和标准差来衡量总风险，个股的贝塔值，或投资组合贝塔值来衡量市场风险。在前几章中，我们知道总风险有两个组成部分：市场风险和公司特定风险。为了平衡回报的收益和风险的成本，可以应用多种度量方法，如夏普比率、特雷诺比率、索提诺比率和M2绩效度量（莫迪利安尼与莫迪利安尼绩效度量）。所有这些风险度量或比率都有一个共同的格式：即回报的收益（以风险溢价表示）和风险（以标准差、贝塔值或**下偏标准差**（**LPSD**）表示）之间的权衡。另一方面，这些度量并未考虑概率分布。在本章中，将介绍一个新的风险度量——**风险价值**（**VaR**），并通过使用现实世界的数据来应用它。特别地，将涵盖以下主题：
- en: Introduction to VaR
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VaR介绍
- en: Review of density and cumulative functions of a normal distribution
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正态分布的密度函数和累积分布函数回顾
- en: Method I—Estimating VaR based on the normality assumption
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 方法一—基于正态性假设估算VaR
- en: Conversion from 1-day risk to n-day risk, one-day VaR versus n-day VaR
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从1天风险转换为n天风险，一天VaR与n天VaR的比较
- en: Normality tests
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 正态性检验
- en: Impact of skewness and kurtosis
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 偏度和峰度的影响
- en: Modified VaR measure by using including skewness and kurtosis
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过包含偏度和峰度来修正VaR度量
- en: Method II—Estimating a VaR based on historical returns
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 方法二—基于历史收益估算VaR
- en: Linking two methods by using Monte Carlo simulation
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用蒙特卡洛模拟将两种方法联系起来
- en: Backtesting and stress testing
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回测和压力测试
- en: Introduction to VaR
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VaR介绍
- en: 'Up to now, we have several ways to evaluate risk for an individual stock or
    a portfolio, such as variance, standard deviation of returns to measure the total
    risk, or beta to measure the market risk of a portfolio or individual stocks.
    On the other hand, many CEOs prefer a simple measure called **Value at Risk**
    (**VaR**), which has the simple definition given here:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 目前为止，我们有几种方法来评估个股或投资组合的风险，比如使用收益的方差和标准差来衡量总风险，或者用贝塔值来衡量投资组合或个股的市场风险。另一方面，许多CEO更倾向于使用一个简单的指标，称为**风险价值**（**VaR**），它有一个简单的定义：
- en: '*"The maximum loss with a confidence level over a predetermined period."*'
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*“在预定时间段内，具有一定置信水平的最大损失。”*'
- en: 'From the preceding definition, it has three explicit factors plus one implied
    one. The implied factor or variable is our current position, or the value of our
    current portfolio or individual stock(s). The preceding statement offers the maximum
    possible loss in the future and this is the first factor. The second one is over
    a specific time period. Those two factors are quite common. However, the last
    factor is quite unique: with a confidence level or probability. Here are a few
    examples:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的定义来看，它有三个明确的因素，再加上一个隐含的因素。隐含因素或变量是我们当前的位置，或者说我们当前投资组合或个股的价值。前述陈述提供了未来可能的最大损失，这是第一个因素。第二个因素是在特定的时间段内。这两个因素是相当常见的。然而，最后一个因素是非常独特的：它带有置信水平或概率。以下是几个例子：
- en: '**Example #1**: On February 7, 2017, we own 300 shares of International Business
    Machine''s stocks worth $52,911\. The maximum loss tomorrow, that is, February
    8, 2017, is $ 1,951 with a 99% confidence level.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**示例 #1**：在2017年2月7日，我们持有300股国际商业机器公司的股票，市值为$52,911。明天，即2017年2月8日，最大损失为$1,951，置信水平为99%。'
- en: '**Example #2**: Our mutual fund has a value of $10 million today. The maximum
    loss over the next 3 months is $0.5 million at a 95% confidence level.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**示例 #2**：我们今天的共同基金价值为1000万美元。在接下来的三个月里，基于95%的置信水平，最大损失为50万美元。'
- en: '**Example #3**: The value of our bank is $200 million. The VaR of our bank
    is $10m with a 1% probability over the next 6 months.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**示例 #3**：我们银行的价值为2亿美元。我们银行的VaR为1000万美元，具有1%的概率，时间跨度为接下来的6个月。'
- en: 'Usually, there are two methods to estimate a VaR. The first method is based
    on the assumption that our security or portfolio returns follow a normal distribution,
    while the second method depends on the ranking of the historical returns. Before
    discussing the first method, let''s review the concepts with respect to a normal
    distribution. The density of a normal distribution is defined here:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，有两种方法来估算VaR。第一种方法基于假设我们的证券或投资组合回报遵循正态分布，而第二种方法依赖于历史回报的排名。在讨论第一种方法之前，我们先复习一下正态分布的相关概念。正态分布的密度在这里定义：
- en: '![Introduction to VaR](img/B06175_11_05.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![VaR简介](img/B06175_11_05.jpg)'
- en: 'Here, *f(x)* is the density function, *x* is an input variable, *μ* is the
    mean and *σ* is the standard deviation. One function called `spicy.stats.norm.pdf()`
    could be used to estimate the density. The function has three input values: *x*,
    *μ*, and *σ*. The following code calls this function and verifies the results
    manually according to the preceding formula:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*f(x)*是密度函数，*x*是输入变量，*μ*是均值，*σ*是标准差。可以使用一个叫做`spicy.stats.norm.pdf()`的函数来估算密度。该函数有三个输入值：*x*、*μ*和*σ*。以下代码调用此函数，并根据前面的公式手动验证结果：
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'In the preceding code, we import the `sqrt()`, `exp()` functions plus pi to
    make our code simpler. Setting μ=0, and σ=1, the preceding general normal distribution
    density function collapses to a standard normal distribution; see its corresponding
    density function:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码中，我们导入了`sqrt()`、`exp()`函数以及π，以简化我们的代码。设置μ=0，σ=1，前面的正态分布密度函数简化为标准正态分布；请看其对应的密度函数：
- en: '![Introduction to VaR](img/B06175_11_06.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![VaR简介](img/B06175_11_06.jpg)'
- en: 'The default values for the second and third input values for the `spicy.stats.norm.pdf()`
    function are zero and 1, respectively. In other words, with just one input value,
    it represents a standard normal distribution; see the following code and how to
    manually verify it:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`spicy.stats.norm.pdf()`函数的第二个和第三个输入值的默认值分别为0和1。换句话说，只需要一个输入值，它就代表了标准正态分布；请查看以下代码并了解如何手动验证：'
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The following code generates a graph for a standard normal distribution where
    the `spicy.stats.norm.pdf()` function takes just one input:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码生成了标准正态分布的图形，其中`spicy.stats.norm.pdf()`函数只接受一个输入值：
- en: '[PRE2]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The graph is shown here:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是图形展示：
- en: '![Introduction to VaR](img/B06175_11_01.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![VaR简介](img/B06175_11_01.jpg)'
- en: 'For the VaR estimation, usually we would choose two confidence levels of 95%
    and 99%. For the 95% (99%) confidence level, we actually look at the left tail
    with a 5% (1%) probability. The following graph illustrates the concept of VaR
    based on a standard normal distribution with a 95% confidence level:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 对于VaR估算，通常我们会选择95%和99%两个置信水平。对于95%（99%）置信水平，我们实际上关注的是左尾的5%（1%）概率。以下图表展示了基于标准正态分布和95%置信水平的VaR概念：
- en: '[PRE3]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To generate a graph, three functions are applied. The purpose of the `matplotlib.pyplot.annotate()`
    function is used to generate a text or an arrow with a text description at the
    end of the arrow. The `str()` function will convert a number into a string. `matplotlib.pyplot.fill_between()`
    will fill the specified area. The output graph is shown here:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 要生成图形，应用了三个函数。`matplotlib.pyplot.annotate()`函数的作用是生成一个文本或带有文本描述的箭头。`str()`函数将数字转换为字符串。`matplotlib.pyplot.fill_between()`将填充指定区域。输出的图形如下所示：
- en: '![Introduction to VaR](img/B06175_11_02.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![VaR简介](img/B06175_11_02.jpg)'
- en: 'Based on the assumption of normality, we have the following general form to
    estimate VaR:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 基于正态分布假设，我们有以下一般形式来估算VaR：
- en: '![Introduction to VaR](img/B06175_11_07.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![VaR简介](img/B06175_11_07.jpg)'
- en: 'Here, *VaR* is our value at risk, *position* is the current market value of
    our portfolio, *μperiod* is the expected period return, *z* is a cut-off point
    depending on the confidence level, and σ is the volatility of our portfolio. For
    a normal distribution, *z*=2.33 for a 99% confidence level, and z=1.64 for a 95%
    confidence level. Since we could use `scipy.stats.norm.ppf()` to get the z value,
    the preceding equation could be rewritten as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*VaR* 是我们的风险价值，*position* 是我们投资组合的当前市场价值，*μperiod* 是预期的期间回报，*z* 是一个根据置信水平确定的临界值，σ
    是我们投资组合的波动性。对于正态分布，*z*=2.33 对应于 99% 的置信水平，而 z=1.64 对应于 95% 的置信水平。由于我们可以使用 `scipy.stats.norm.ppf()`
    来获取 z 值，因此前述方程可以重写为：
- en: '![Introduction to VaR](img/B06175_11_08.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_08.jpg)'
- en: 'Compare the preceding two equations. A careful reader should notice that the
    signs in front of z are different. For the preceding equation, it has a positive
    sign instead of the negative one shown in the previous equation. The reason is
    that the z value estimated by applying `scipy.stats.norm.ppf()` would be negative;
    see the following code:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 比较前述两个方程。仔细的读者应该注意到，z 前的符号是不同的。对于前面的方程，它有一个正号，而不是前一个方程中的负号。原因是，应用 `scipy.stats.norm.ppf()`
    估算出的 z 值会是负数；请参见以下代码：
- en: '[PRE4]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'When the time period is short, such as 1 day, we could ignore the impact of
    *μperiod*. Therefore, we have the following simplest form:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 当时间周期较短，如 1 天时，我们可以忽略 *μperiod* 的影响。因此，我们有以下最简单的形式：
- en: '![Introduction to VaR](img/B06175_11_09.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_09.jpg)'
- en: 'The following program shows the 5% VaR of a hypothetical profit-and-loss probability
    density function:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序显示了一个假设的盈亏概率密度函数的 5% VaR：
- en: '[PRE5]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The related graph is shown here:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 相关图表如下：
- en: '![Introduction to VaR](img/B06175_11_03.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_03.jpg)'
- en: 'Here is the simplest example to estimate the maximum loss tomorrow. Assume
    that we have 1,000 shares of IBM''s stock on February 7, 2017\. What is the maximum
    loss tomorrow with a confidence level of 99%? To estimate the standard deviation
    of daily returns, we use the last 5 years'' data. Actually, this is a decision
    variable. We could use 1-year data or multiple-year data. Each approach has its
    advantages and disadvantages. The standard deviation estimated based on a longer
    period would be more stable because we have a much larger sample size. However,
    some information in the remote past would definitely be outdated:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这是估算明天最大损失的最简单示例。假设我们在 2017 年 2 月 7 日拥有 1,000 股 IBM 的股票。以 99% 的置信水平，明天的最大损失是多少？为了估算每日回报的标准差，我们使用过去
    5 年的数据。实际上，这是一个决策变量。我们可以使用 1 年的数据或多年的数据。每种方法都有其优缺点。基于较长时间段估算的标准差会更稳定，因为我们有更大的样本量。然而，远过去的一些信息肯定会过时：
- en: '[PRE6]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The objective of printing the first line of the data is to show the closing
    price is indeed on 2/7/2017\. The value of our holding is $168,543 and its 1-day
    VaR is $4,604\. The second example is about the VaR over a 10-day period. To convert
    a variance (standard deviation) on daily returns to an n-day variance (standard
    deviation), we have the following formulas:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 打印数据第一行的目的是为了显示收盘价确实是在 2017 年 2 月 7 日。我们的持仓价值为 168,543 美元，其 1 日 VaR 为 4,604
    美元。第二个示例是关于 10 天期间的 VaR。要将每日回报的方差（标准差）转换为 n 天的方差（标准差），我们有以下公式：
- en: '![Introduction to VaR](img/B06175_11_10.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_10.jpg)'
- en: 'For example, the annual volatility is equal to the daily volatility times the
    square root of 252 ![Introduction to VaR](img/B06175_11_35.jpg). In order to convert
    a daily mean return to an n-day mean return, we have the following formula:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，年波动率等于日波动率乘以 252 的平方根 ![VaR 介绍](img/B06175_11_35.jpg)。为了将每日平均回报转换为 n 天的平均回报，我们有以下公式：
- en: '![Introduction to VaR](img/B06175_11_11.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_11.jpg)'
- en: 'Based on daily returns, we have the following general formulas for VaR with
    a confidence level to estimate an n-day VaR:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 基于每日回报，我们有以下一般公式来估算 n 天 VaR 的置信水平：
- en: '![Introduction to VaR](img/B06175_11_12.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![VaR 介绍](img/B06175_11_12.jpg)'
- en: 'The following code shows the VaR for holding 50 shares of Wal-Mart stocks,
    on the last day of 2016, over a 10-day period with a confidence level of 99%:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码显示了在 2016 年最后一天，持有 50 股沃尔玛股票，在 99% 置信水平下的 10 天 VaR：
- en: '[PRE7]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'On December 31, 2016, the value of our holding is $2,650\. Our maximum loss
    is $205 in the next 10 days with a confidence level of 99%. In the preceding program,
    based on daily returns, we estimate both daily mean return and the standard deviation.
    Then we convert them into a 10-day mean return and 10-day volatility. On the other
    hand, actually we could calculate a 10-day return directly. After 10-day returns
    available, the `scipy.mean()` and `scipy.std()` functions could be applied directly.
    In other words, we don''t need to convert a daily mean and daily standard deviation
    into a 10-day mean and 10-day standard deviation. The related code is given here.
    To save space, the first 11 lines are not repeated:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 2016年12月31日，我们的持仓价值为$2,650。我们在接下来的10天内的最大损失为$205，置信水平为99%。在前面的程序中，我们基于日收益率估算了日均收益和标准差。然后我们将其转换为10天的平均收益和10天的波动率。另一方面，实际上我们可以直接计算10天的收益率。在10天收益率可用后，可以直接应用`scipy.mean()`和`scipy.std()`函数。换句话说，我们不需要将日均收益和日标准差转换为10天均值和10天标准差。相关代码如下。为了节省空间，前11行没有重复：
- en: '[PRE8]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Our new result shows that the VaR is $209.11 compared with $205.03\. The percentage
    of the underestimation is -0.01951126, about -2%. The following code estimate
    the VaR for the Fama-French five value-weighted industry portfolios with a monthly
    frequency. The dataset is available at the author''s website, [http://canisius.edu/~yany/python/ff5VWindustryMonthly.pkl](http://canisius.edu/~yany/python/ff5VWindustryMonthly.pkl).
    Those five industries are Consumer, Manufacture, High Tech, Health, and Other.
    The first and last several lines are shown here:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的新结果显示，VaR为$209.11，相比之下，原值为$205.03。低估的百分比为-0.01951126，约为-2%。以下代码估算了Fama-French五个按市值加权的行业组合的VaR，数据频率为月度。数据集可以在作者的官网获取，链接：[http://canisius.edu/~yany/python/ff5VWindustryMonthly.pkl](http://canisius.edu/~yany/python/ff5VWindustryMonthly.pkl)。这五个行业分别是消费品、制造业、高科技、健康和其他。以下是前几行和最后几行代码：
- en: '[PRE9]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The following program estimates their VaR with $1,000 invested in each industry
    portfolio with a 99% confidence level over the next period. Since the frequency
    is monthly, the fixed period will be the next month:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序估算了将$1,000投资于每个行业组合的VaR，置信水平为99%，计算的是下一个周期的风险。由于数据频率为月度，因此固定周期为下一个月：
- en: '[PRE10]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The VaR for those five industries are $122.95, $128.58, $129.92, $130.02, and
    $149.85, respectively, for an equal holding of $1,000 invested in each industry.
    Comparing those values, we could see that the Consumer industry has the lowest
    risk while the industry defined as Other would have the highest maximum possible
    loss.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这五个行业，VaR分别为$122.95、$128.58、$129.92、$130.02和$149.85，假设每个行业投资$1,000。通过比较这些值，我们可以看到，消费品行业的风险最低，而被定义为“其他”的行业具有最高的最大可能损失。
- en: Normality tests
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正态性检验
- en: 'The first method to estimate VaR is based on a vital assumption that individual
    stock or portfolio returns follow a normal distribution. However, in the real
    world, we know that stock returns or portfolio returns do not necessarily follow
    a normal distribution. The following program tests whether Microsoft returns satisfy
    this assumption by using 5-year daily data:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个估算VaR的方法是基于一个重要的假设，即个别股票或组合的收益符合正态分布。然而，在现实世界中，我们知道股票收益或组合收益不一定符合正态分布。以下程序通过使用5年的日数据，检验微软的收益是否满足这个假设：
- en: '[PRE11]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Our null hypothesis is that Microsoft stock daily returns following a normal
    distribution. Based on the preceding result, the null hypothesis is rejected since
    the F-value is much higher than the critical value of 1.089 if we choose a 1%
    significance level. Even if we reject the hypothesis based on just one stock,
    some might argue that portfolio returns might satisfy this assumption. The next
    program tests whether S&P500 daily returns follow a normal distribution. The ticker
    symbol for S&P500 from Yahoo!Finance is `^GSPC`:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的原假设是微软股票的日收益符合正态分布。根据前面的结果，我们拒绝原假设，因为F值远高于临界值1.089（假设显著性水平为1%）。即使我们基于单只股票拒绝了这个假设，也有人可能会认为组合的收益可能符合这一假设。下一个程序检验S&P500的日收益是否符合正态分布。S&P500的股票代码是`^GSPC`，可以通过Yahoo!Finance获取：
- en: '[PRE12]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: From the preceding results, we reject the normality assumption for S&P500\.
    In other words, the market index, represented by S&P500 daily returns, does not
    follow a normal distribution.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的结果来看，我们拒绝了S&P500的正态性假设。换句话说，由S&P500日收益表示的市场指数不符合正态分布。
- en: Skewness and kurtosis
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 偏度和峰度
- en: 'Based on the normality assumption, a VaR estimation considers only the first
    two moments: mean and variance. If stock returns truly follow a normal distribution,
    those two moments would fully define their probability distribution. From the
    preceding sections, we know that this is not true. The first remedy is to include
    other higher moments in addition to the first two moments. The third and fourth
    moments are called skewness and kurtosis. For a stock or portfolio with n returns,
    skewness is estimated by the following formula:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 基于正态性假设，VaR估算只考虑前两个矩：均值和方差。如果股票回报真的遵循正态分布，这两个矩将完全定义它们的概率分布。从前面的章节可以知道，这并不成立。第一种修正方法是除了前两个矩之外，加入其他更高阶的矩。第三和第四阶矩分别称为偏度和峰度。对于一个具有n个回报的股票或投资组合，偏度通过以下公式估算：
- en: '![Skewness and kurtosis](img/B06175_11_13.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![偏度和峰度](img/B06175_11_13.jpg)'
- en: 'Here, *skewness* is the skewness, *Ri* is the *i*th return, ![Skewness and
    kurtosis](img/B06175_11_36.jpg) is the mean return, *n* is the number of returns,
    and σ is the standard deviation of returns. The kurtosis reflects the impact of
    extreme values because a power of 4 is very high. The kurtosis is usually estimated
    by the following formula is:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*偏度*是偏度，*Ri*是第*i*个回报，![偏度和峰度](img/B06175_11_36.jpg)是平均回报，*n*是回报的数量，σ是回报的标准差。峰度反映了极端值的影响，因为四次方的值非常高。峰度通常通过以下公式估算：
- en: '![Skewness and kurtosis](img/B06175_11_14.jpg)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![偏度和峰度](img/B06175_11_14.jpg)'
- en: 'For a standard moral distribution, it has a zero mean, unit variance, zero
    skewness, and its kurtosis is 3\. Because of this, sometimes kurtosis is defined
    as the preceding equation minus 3:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 对于标准正态分布，它的均值为零，方差为1，偏度为零，峰度为3。因此，有时峰度被定义为前面的公式减去3：
- en: '![Skewness and kurtosis](img/B06175_11_15.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![偏度和峰度](img/B06175_11_15.jpg)'
- en: 'Some textbooks distinguish those two definitions as kurtosis and excess kurtosis.
    However, others simply label the preceding formula as kurtosis as well. Thus,
    when we conduct a test to see whether the kurtosis of a time series is zero, we
    have to know which benchmark is used. The following program generates 5 million
    random numbers from a standard deviation and applies four functions to estimate
    those four moments, that is, mean, standard deviation, skewness, and kurtosis:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 一些教科书将这两种定义区分为峰度和超额峰度。然而，也有一些教科书简单地将前面的公式也标记为峰度。因此，当我们进行检验以查看时间序列的峰度是否为零时，我们必须知道使用的是哪个基准。以下程序生成了500万随机数来自标准差，并应用四个函数来估算这四个矩，即均值、标准差、偏度和峰度：
- en: '[PRE13]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Since the kurtosis is close to zero for random numbers drawn from a standard
    normal distribution, the `scipy.stats.kurtosis()` function should be based on
    *Equation (11)* instead of *Equation (10)*.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 由于从标准正态分布中抽取的随机数的峰度接近零，`scipy.stats.kurtosis()`函数应基于*公式（11）*而不是*公式（10）*。
- en: Modified VaR
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修正VaR
- en: 'From the previous discussion, we know that based on the assumption, that stock
    returns follow a normal distribution. Because of this, the skewness and kurtosis
    of returns are both assumed to be zero. However, in the real world, skewness and
    excess kurtosis of many stock returns are not zero. As a consequence, the modified
    VaR was developed to utilize those four moments instead of just two; see the following
    definition:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面的讨论中我们知道，基于假设，股票回报服从正态分布。因此，回报的偏度和峰度都假设为零。然而，在现实世界中，许多股票回报的偏度和超额峰度并不为零。因此，开发了修正VaR，利用这四个矩而不仅仅是两个；请参见以下定义：
- en: '![Modified VaR](img/B06175_11_16.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![修正VaR](img/B06175_11_16.jpg)'
- en: 'Here, *z* is the value based on a normal distribution, *S* is the skewness,
    *K* is kurtosis, *t* is an intermediate variable, and the `scipy.stats.ppf()`
    function would offer a z-value for a given confidence level. The following program
    offers two VaRs based on the normality assumption and based on the preceding formula,
    that is, using all four moments. The number of shares is 500 at the end of year
    2016\. The stock tested is **Walmart** (**WMT**). The confidence level is 99%
    for a 1-day VaR:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*z*是基于正态分布的值，*S*是偏度，*K*是峰度，*t*是一个中间变量，`scipy.stats.ppf()`函数为给定的置信水平提供一个z值。以下程序提供了基于正态性假设和基于前述公式（即使用所有四个矩）计算的两种VaR。年末时持有的股票数量为500只，测试的股票是**沃尔玛**（**WMT**）。1天VaR的置信水平为99%：
- en: '[PRE14]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Based on the last two lines, we have a VaR of $876.84 based on the normality
    and the modified VaR has a value of $1,500\. The percentage difference of those
    two is 42%. This result suggests that ignoring the skewness and kurtosis would
    understate VaR enormously.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 根据最后两行，我们得出基于正态分布的 VaR 为 $876.84，修正后的 VaR 为 $1,500。两者之间的百分比差异为 42%。这一结果表明，忽略偏度和峰度将极大低估
    VaR。
- en: VaR based on sorted historical returns
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 基于排序的历史收益 VaR
- en: 'We know that stock returns do not necessarily follow a normal distribution.
    An alternative is to use sorted returns to evaluate a VaR. This method is called
    VaR based on historical returns. Assume that we have a daily return vector called
    *ret*. We sort it from the smallest to the highest. Let''s call the sorted return
    vector *sorted_ret*. For a given confidence level, the one-period VaR is given
    here:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们知道，股票收益不一定遵循正态分布。另一种方法是使用排序后的收益来评估 VaR。这种方法称为基于历史收益的 VaR。假设我们有一个名为 *ret* 的每日收益向量。我们将其从最小到最大排序。我们将排序后的收益向量称为
    *sorted_ret*。对于给定的置信水平，一期 VaR 计算公式如下：
- en: '![VaR based on sorted historical returns](img/B06175_11_17.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![基于排序的历史收益VaR](img/B06175_11_17.jpg)'
- en: 'Here, *position* is our wealth (value of our portfolio), *confidence* is the
    confidence level and n is the number of returns. The `len()` function shows the
    number of observations and the `int()` function takes the integer part of an input
    value. For example, if the length of the return vector is 200 and the confidence
    level is 99%, then the second value (200*0.01) of the sorted returns, from the
    smallest to the highest, times our wealth, will be our VaR. Obviously, if we have
    a longer time series, that is, more return observations, our final VaR would be
    more accurate. For owning 500 shares of Walmart, what is the maximum loss with
    a 99% confidence level the next day? First, let''s look at several ways to sort
    our data. The first one uses the `numpy.sort()` function:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*position* 是我们的财富（投资组合的价值），*confidence* 是置信水平，n 是收益的数量。`len()` 函数显示观察值的数量，`int()`
    函数取输入值的整数部分。例如，如果收益向量的长度是 200，且置信水平为 99%，那么排序后的收益向量中第二个值（200*0.01），从最小到最大，再乘以我们的财富，就是我们的
    VaR。显然，如果我们有更长的时间序列，也就是更多的收益观察值，我们的最终 VaR 将更加准确。比如拥有 500 股沃尔玛股票，99% 的置信水平下，第二天的最大损失是多少？首先，让我们看看几种排序数据的方法。第一种方法使用
    `numpy.sort()` 函数：
- en: '[PRE15]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Here is the second way to sort by using Python''s `pandas` module:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 这是使用 Python `pandas` 模块进行排序的第二种方法：
- en: '[PRE16]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'For an easy comparison, those three datasets are put side by side. The left
    panel shows the original dataset. The middle one shows the result sorted by column
    `A` first in ascending order, then by column `B` in descending order. The right
    panel shows the result sorted by columns `A` then `B`, both in ascending order:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 为了方便比较，这三个数据集并排放置。左侧面板显示原始数据集。中间面板显示按列 `A` 升序排序后，再按列 `B` 降序排序的结果。右侧面板显示按列 `A`
    和 `B` 都升序排序的结果：
- en: '![VaR based on sorted historical returns](img/B06175_11_04.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![基于排序的历史收益VaR](img/B06175_11_04.jpg)'
- en: 'The next two programs compare two methods used to estimate VaR: based on the
    normality and based on sorting. To make our programs easier to understand, the
    time period is just 1 day:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的两个程序比较了两种估算 VaR（风险价值）的方法：基于正态分布的方法和基于排序的方法。为了让我们的程序更易理解，时间段仅为 1 天：
- en: '[PRE17]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The formula used in the preceding program is *VaR=position*z*sigma*. The result
    tells us that the holding is $26,503 and its 1-day VaR is $648 with a 99% confidence
    level. The following program estimates the VaR for the same stock based on sorting:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 上面程序中使用的公式是 *VaR=position*z*sigma*。结果告诉我们，持仓为 $26,503，1 天 VaR 为 $648，置信水平为 99%。以下程序基于排序估算同一股票的
    VaR：
- en: '[PRE18]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The result shows that the 1-day VaR is $817\. Recall that the VaR based on
    the normality is $648\. If the second method is more accurate, the first method
    underestimates our potential loss by 20%. This is a huge number in terms of risk
    evaluation! The following codes are for an n-day period based on sorting:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 结果显示，1 天 VaR 为 $817。回想一下，基于正态分布的 VaR 为 $648。如果第二种方法更准确，第一种方法将我们的潜在损失低估了 20%。在风险评估中，这个差异非常巨大！以下代码是基于排序的
    n 天期的 VaR：
- en: '[PRE19]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: There are two tricks in the preceding program. The first one is the summation
    of a daily log return will be a 10-day log return. Then we convert a log return
    to a percentage return. The second trick is how to generate a 10-day return. First,
    we generate groups by using the `int()` function, that is, `int(i/nDays)`. Since
    `nDays` has a value of 10, `int(i/10)` would generate 10 zeros, ten ones, ten
    twos, and so on. The VaRs based on the three methods are $2,788, $2,223, and $1,301,
    respectively. Obviously, there are some issues with method 3\. One of the concerns
    is that for n-day periods, we have only 428 observations, that is, the size of
    our sample might be too small. If we choose a 99% confidence interval, we have
    to choose the fourth lowest return in our calculation. This would definitely cause
    some issues here.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的程序中有两个技巧。第一个技巧是将每日对数收益率的总和转化为10天的对数收益率。然后，我们将对数收益率转换为百分比收益率。第二个技巧是如何生成10天的收益率。首先，我们使用`int()`函数生成组，即`int(i/nDays)`。由于`nDays`的值为10，`int(i/10)`会生成10个零、10个一、10个二，依此类推。基于三种方法的VaR分别为$2,788、$2,223和$1,301。显然，第三种方法存在一些问题。一个问题是，对于n天的周期，我们只有428个观察值，也就是说样本的大小可能太小。如果我们选择99%的置信区间，则必须选择计算中的第四低收益。这肯定会导致一些问题。
- en: Simulation and VaR
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模拟与VaR
- en: In the previous sections, we have learned that there are two ways to estimate
    VaR for an individual stock or for a portfolio. The first method depends on the
    assumption that stock returns follow a normal distribution. The second one uses
    the sorted historical returns. What is the link between those two methods? Actually,
    Monte Carlo simulation could be served as a link. First, let's look at the first
    method based on the normality assumption. We have 500 Walmart shares on the last
    day of 2016\. What is the VaR tomorrow if the confidence level is 99%?
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们学习了两种估算单只股票或投资组合VaR的方法。第一种方法假设股票收益符合正态分布。第二种方法使用排序后的历史收益。那么这两种方法之间有什么联系呢？实际上，蒙特卡洛模拟可以作为它们之间的桥梁。首先，让我们来看一下基于正态假设的第一种方法。我们在2016年最后一天持有500股沃尔玛股票。如果明天的置信区间为99%，那么明天的VaR是多少？
- en: '[PRE20]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The VaR is $641.29 for tomorrow with a confidence level of 99%. Here is how
    Monte Carlo simulation works. First, we calculate the mean and standard deviation
    based on daily returns. Since stock returns are assumed to follow a normal distribution,
    we could generate 5,000 returns with the same mean and standard deviation. If
    our confidence level is 99%, then the 50th return from the lowest sorted returns
    would be our cut-off point, *5000*0.01=50*. The code is shown here:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 明天的VaR为$641.29，置信水平为99%。下面是蒙特卡洛模拟的工作原理。首先，我们基于每日收益计算均值和标准差。由于假设股票收益符合正态分布，我们可以生成5,000个收益，均值和标准差相同。如果我们的置信水平为99%，那么从按升序排列的收益中，位于第50个的收益将是我们的截断点，*5000*0.01=50*。以下是代码：
- en: '[PRE21]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Monte Carlo Simulation offers a quite similar value of $627.34 compared with
    $641.29 based on the formula.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 与基于公式的$641.29相比，蒙特卡洛模拟给出的值为$627.34，差异相对较小。
- en: VaR for portfolios
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 投资组合的VaR
- en: 'In [Chapter 9](ch09.html "Chapter 9. Portfolio Theory"), *Portfolio Theory*,
    it was shown that when putting many stocks in our portfolio, we could reduce or
    eliminate firm-specific risk. The formula to estimate an n-stock portfolio return
    is given here:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第9章](ch09.html "第9章 投资组合理论")中，*投资组合理论*展示了当我们将多只股票放入投资组合时，可以降低或消除公司特定的风险。估算n只股票投资组合收益率的公式如下：
- en: '![VaR for portfolios](img/B06175_11_18.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合的VaR](img/B06175_11_18.jpg)'
- en: 'Here *Rp,t* is the portfolio return at time *t*, *wi* is the weight for stock
    *i*, and *Ri*, *t* is the return at time *t* for stock *i*. When talking about
    the expected return or mean, we have a quite similar formula:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这里的*Rp,t*是时刻*t*的投资组合收益，*wi*是股票*i*的权重，*Ri,t*是股票*i*在时刻*t*的收益。谈到预期收益或均值时，我们有一个非常相似的公式：
- en: '![VaR for portfolios](img/B06175_11_19.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合的VaR](img/B06175_11_19.jpg)'
- en: 'Here, ![VaR for portfolios](img/B06175_11_37.jpg) is the mean or expected portfolio
    return, ![VaR for portfolios](img/B06175_11_38.jpg) is the mean or expected return
    for stock *i*. The variance of such an n-stock portfolio is given here:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，![投资组合的VaR](img/B06175_11_37.jpg)是平均或预期的投资组合收益率，![投资组合的VaR](img/B06175_11_38.jpg)是股票*i*的平均或预期收益率。这样一个n只股票投资组合的方差公式如下：
- en: '![VaR for portfolios](img/B06175_11_20.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合的VaR](img/B06175_11_20.jpg)'
- en: 'Here, ![VaR for portfolios](img/B06175_11_39.jpg) is the portfolio variance,
    σi,j is covariance between stocks i and j; see the following formula:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，![投资组合的VaR](img/B06175_11_39.jpg)是投资组合方差，σi,j是股票i和股票j之间的协方差；请参见以下公式：
- en: '![VaR for portfolios](img/B06175_11_21.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合的VaR](img/B06175_11_21.jpg)'
- en: 'The correlation between stocks *i* and *j*, *ρi,j*, is defined here:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 股票*i*与股票*j*之间的相关性*ρi,j*定义如下：
- en: '![VaR for portfolios](img/B06175_11_22.jpg)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![投资组合的VaR](img/B06175_11_22.jpg)'
- en: 'When stocks are not positively perfectively correlated, combining stocks would
    reduce our portfolio risk. The following program shows that the VaR of the portfolio
    is not simply the summation or weighted VaR of individual stocks within the portfolio:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 当股票之间没有完全正相关时，组合股票会降低我们的投资组合风险。以下程序显示，投资组合的VaR不仅仅是单个股票VaR的简单加总或加权VaR：
- en: '[PRE22]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The VaR for our current portfolio of $5 million is $109,356\. However, the summation
    of the VaR for those three stocks based on our weights is $147,190\. This result
    verifies the diversification effect by choosing different stocks.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们当前投资组合的VaR为$109,356。然而，基于权重计算的这三只股票的VaR总和为$147,190。这个结果验证了通过选择不同股票来实现的分散化效应。
- en: Backtesting and stress testing
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 回测与压力测试
- en: 'In finance, a stress test could be viewed as an analysis or simulation designed
    to determine the ability of a given financial instrument, such as a VaR to deal
    with an economic crisis. Since the first method to estimate a VaR is based on
    the assumption that stock returns following a normal distribution, its accuracy
    depends how far, in the real world, stock returns deviate from this assumption.
    A key component to the implementation of model-based risk management is model
    validation. That is, we need some way to determine whether the model chosen is
    accurate and performs consistently. This step is quite important both to firms
    and their regulators. According to Lopez (2000), we have the following table:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在金融领域，压力测试可以看作是一种分析或模拟，旨在确定特定金融工具（如VaR）在经济危机中的应对能力。由于估算VaR的首个方法基于股票回报服从正态分布的假设，其准确性取决于股票回报在现实中偏离这一假设的程度。模型验证是基于模型的风险管理实施的关键组成部分。也就是说，我们需要某种方法来确定所选择的模型是否准确且一致地执行。对于公司及其监管机构而言，这一步非常重要。根据Lopez（2000年）的研究，以下是表格：
- en: '| Name | Objectives | Methods |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 名称 | 目标 | 方法 |'
- en: '| --- | --- | --- |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Backtesting | Compare observed outcomes with a model''s expected output |
    Forecast evaluation established empirical issue with a large academic literature
    |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 回测 | 将观察到的结果与模型的预期输出进行比较 | 预测评估确立了一个具有大量学术文献的经验问题 |'
- en: '| Stress testing | Examples a model''s expected outcomes under extreme conditions
    |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 压力测试 | 在极端条件下展示模型的预期结果 |'
- en: Projection analysis
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 投影分析
- en: Outlier analysis
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 异常值分析
- en: Scenario analysis and case studies
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 情景分析与案例研究
- en: '|'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: Table 11.1 Backtesting versus stress testing
  id: totrans-132
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 表11.1 回测与压力测试
- en: 'Assume that we use just 1 year''s data to estimate 1-day VaR with a 99% confidence
    level for holding 1,000 shares of IBM on February 7, 2017\. The program is shown
    here:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们仅使用1年的数据来估算2017年2月7日持有1,000股IBM的1天VaR，置信度为99%。程序如下所示：
- en: '[PRE23]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Based on the preceding result, our holding is $122,599 and the maximum loss
    next day is $3,187\. Remember that the confidence level is 99% and it means that
    during this 1-year period, we should expect about 2.5 violations (0.01*252). The
    value of 252 is the number of trading days within 1 year. The following program
    shows the number of violations:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 根据之前的结果，我们的持仓为$122,599，下一天的最大损失为$3,187。请记住，置信度为99%，这意味着在这一年期间，我们应预期约2.5次违例（0.01*252）。252是指一年中的交易日数。以下程序显示了违例的次数：
- en: '[PRE24]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Again, we expect to see 2.5 violations based on our model. However, we have
    four. Based on a 99% confidence level, we expected that returns worse than -2.599%
    should be around 1%. Unfortunately, based on 1 year's data, this ratio is 1.58%.
    If based on 55 years' historical data for this specific stock, the frequency of
    worse returns than this ratio is more than double, 3.66% versus 1%. This indicates
    that the underlying model underestimates the potential maximum loss.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们期望根据模型看到2.5次违例。然而，实际违例次数为4次。基于99%的置信度，我们预期回报低于-2.599%的情况应该约为1%。不幸的是，基于1年的数据，这一比例为1.58%。如果基于55年的历史数据，对于这只特定股票，回报低于该比例的频率超过了2倍，分别为3.66%与1%。这表明基础模型低估了潜在的最大损失。
- en: Expected shortfall
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 预期损失
- en: 'In the previous sections, we have discussed many issues related to VaR, such
    as its definition and how to estimate it. However, one major concern with VaR
    is that it depends on the shape of the distribution of the underlying security
    or portfolio. If the assumption of normality is close to hold, then VaR is a reasonable
    measure. Otherwise, we might underestimate the maximum loss (risk) if we observe
    a fat tail. Another problem is that the shape of the distribution after a VaR
    is hit is ignored. If we have a fatter left tail than a normal distribution describes,
    then our VaR would underestimate the true risk. The opposite is true: if the left
    tail is thinner than the normal distribution, our VaR would overestimate the true
    risk. **Expected shortfall** (**ES**) is the expected loss if a VaR is hit, and
    it is defined here:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们讨论了与VaR相关的许多问题，如其定义和如何估算。然而，VaR的一个主要问题是它依赖于基础证券或投资组合的分布形态。如果正态分布的假设接近成立，那么VaR是一个合理的度量。否则，如果我们观察到胖尾现象，我们可能会低估最大损失（风险）。另一个问题是，VaR触及后分布的形态被忽略了。如果我们有比正态分布描述的更胖的左尾，那么我们的VaR会低估真实风险。反之，如果左尾比正态分布更薄，我们的VaR则会高估真实风险。**预期损失**（**ES**）是在VaR触及时的预期损失，其定义如下：
- en: '![Expected shortfall](img/B06175_11_23.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![预期损失](img/B06175_11_23.jpg)'
- en: 'Here, *ES* is the expected shortfall and α is our significant level, such as
    1% or 5%. Based on the assumption of normality, for our Python presentation, we
    have the following formula:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*ES*是预期损失，α是我们的显著性水平，如1%或5%。基于正态分布假设，对于我们的Python示例，我们有以下公式：
- en: '![Expected shortfall](img/B06175_11_24.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![预期损失](img/B06175_11_24.jpg)'
- en: 'The expected shortfall could be estimated in the following way:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 预期损失可以通过以下方式估算：
- en: '![Expected shortfall](img/B06175_11_25.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![预期损失](img/B06175_11_25.jpg)'
- en: 'The following program shows how to generate returns from a normal distribution,
    then estimates both the VaR and ES:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 以下程序展示了如何从正态分布中生成回报，然后估算VaR和ES：
- en: '[PRE25]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Similarly, we could derive the formula to estimate the expected shortfall based
    on historical returns. In a sense, the expected shortfall is the average loss
    based on returns with a lower value than the VaR threshold. Assume that we have
    n return observations. The expected shortfall could be defined as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们可以推导出基于历史回报估计预期损失（Expected Shortfall，简称ES）的公式。从某种意义上说，预期损失是基于低于VaR阈值的回报的平均损失。假设我们有n个回报观测值，预期损失可以定义如下：
- en: '![Expected shortfall](img/B06175_11_26.jpg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![预期损失](img/B06175_11_26.jpg)'
- en: Here, *ES* is the expected shortfall, *position* is the value of our portfolio,
    *m* is the number of observations which are worse than our cut-off point specified
    by the given confidence level, *Ii* is a dummy variable which takes a value of
    1 for returns less than *Rcutoff* and zero otherwise, *Ri* is the *i*th return,
    *Rcutoff* is the cutoff return determined by a given confidence level, n is the
    number of total return observations, m is the number of returns less than the
    cutoff return. For example, if we have 1,000 observations and the confidence level
    is 99%, then the cutoff return will be the 10th observation of the returns sorted
    from the lowest to the highest. The expected shortfall will be the average loss
    of those 10 worst scenarios.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*ES*是预期损失，*position*是我们的投资组合的价值，*m*是比给定置信水平指定的截断点更差的回报观测数，*Ii*是一个虚拟变量，当回报小于*Rcutoff*时其值为1，否则为0，*Ri*是第*i*个回报，*Rcutoff*是由给定置信水平确定的截断回报，n是所有回报观测的总数，m是小于截断回报的回报数。例如，如果我们有1,000个回报观测，且置信水平为99%，则截断回报将是按从低到高排序的回报中的第10个观测值。预期损失将是这10个最差情境的平均损失。
- en: 'Assume that on the last day of 2016, we own 500 shares of Walmart stocks. Assume
    that we care about the next day''s maximum loss with a confidence level of 99%.
    Based on the ranking of historical returns, what is the VaR and the expected shortfall?
    The following code offers an answer:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 假设在2016年最后一天，我们持有500股沃尔玛股票。假设我们关心的是次日最大损失，并且置信水平为99%。根据历史回报的排名，VaR和预期损失是多少？以下代码给出了答案：
- en: '[PRE26]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Since there are 11 returns are less the 12th returns, the expected shortfall
    will be the average of those 12 returns times our portfolio market value on the
    evaluation day:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 由于有11个回报低于第12个回报，预期损失将是这些12个回报的平均值，乘以评估日的投资组合市值：
- en: Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 附录A – 数据案例7 – 个别股票和投资组合的VaR估算
- en: 'There are three objectives of this dataset:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 本数据集有三个目标：
- en: Understand the concepts and methodology related to a VaR
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解与VaR相关的概念和方法
- en: Estimate a VaR for individual stocks
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 估算个股的VaR
- en: Estimate a VaR for a portfolio
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 估算投资组合的VaR
- en: 'The question is: What are your VaRs for each stock and for an equal-weighted
    portfolio over 10 days for a 99% confidence interval? Assume that the data period
    is from February 7, 2012 to February 7, 2017 and you have a $1m investment (position
    in Equation 1):'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 问题是：在99%的置信区间下，对于每只股票和一个等权重投资组合，10天的VaR是多少？假设数据期间为2012年2月7日到2017年2月7日，并且你有100万美元的投资（公式1中的*position*）：
- en: '| i | Company name | Ticker | Industry |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| i | 公司名称 | 股票代码 | 行业 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| 1 | Microsoft Corporation | MSFT | Application software |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 1 | 微软公司 | MSFT | 应用软件 |'
- en: '| 2 | Apple Inc. | AAPL | Personal computer |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 苹果公司 | AAPL | 个人计算机 |'
- en: '| 3 | Home Depot, Inc. | HD | Home improvement services |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 家得宝公司 | HD | 家装服务 |'
- en: '| 4 | Citigroup Inc. | C | Money Center Banks |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 花旗集团公司 | C | 大型银行 |'
- en: '| 5 | Wal-Mart Stores, Inc. | WMT | Discount, variety stores |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 沃尔玛公司 | WMT | 折扣与杂货店 |'
- en: '| 6 | General Electric Corporation | GE | Technology |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 6 | 通用电气公司 | GE | 技术 |'
- en: 'The concrete steps are given here:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 具体步骤如下：
- en: Retrieve the daily data from Yahoo! Finance.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Yahoo! Finance获取日数据。
- en: Estimate the daily returns.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 估算日收益。
- en: Apply the following formula to estimate the VaR:![Appendix A – data case 7 –
    VaR estimation for individual stocks and a portfolio](img/B06175_11_27.jpg)
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用以下公式估算VaR：![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_27.jpg)
- en: Estimate the VaR based on sorted historical returns.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据排序的历史收益估算VaR。
- en: If possible, use VBA, R, SAS, or Matlab to automate the process.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果可能，使用VBA、R、SAS或Matlab自动化该过程。
- en: 'The most commonly used parameters for the VaR are 1% and 5% probabilities (99%
    and 95% confidence levels) and 1-day and 2-week horizons. Based on the assumption
    of normality, we have the following general form:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: VaR最常用的参数为1%和5%的概率（99%和95%的置信水平），以及1天和2周的时间范围。基于正态性假设，我们得到以下通用公式：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_28.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_28.jpg)'
- en: 'Here, *position* is the current market value of our portfolio, *µperiod* is
    the expected period return, *z* is the cut-off point depending on a confidence
    level, and σ is the volatility. For a normal distribution, z=2.33 for a 99% confidence
    level and z=1.64 for a 95% confidence level. When the time period is short, such
    as 1 day, we could ignore the impact of *µperiod*. Thus, we have the simplest
    form:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，*position*是我们投资组合的当前市场价值，*µperiod*是预期的周期收益，*z*是根据置信水平决定的截断点，σ是波动性。对于正态分布，z=2.33对应99%的置信水平，z=1.64对应95%的置信水平。当时间范围很短，如1天时，我们可以忽略*µperiod*的影响。因此，我们得到最简单的形式：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_29.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_29.jpg)'
- en: Estimate the VaR based on the normality assumption.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 根据正态性假设估算VaR。
- en: 'If the underlying security follows a normal distribution, the VaR formula will
    be as follows:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 如果基础证券遵循正态分布，则VaR公式如下：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_30.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_30.jpg)'
- en: 'For 99% and 95% confidence levels, *Equation (5)* becomes the following formulas:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 对于99%和95%的置信水平，*公式（5）*变为以下公式：
- en: '| Confidence level | Formula |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| 置信水平 | 公式 |'
- en: '| --- | --- |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 99% | ![Appendix A – data case 7 – VaR estimation for individual stocks and
    a portfolio](img/B06175_11_40.jpg) |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| 99% | ![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_40.jpg) |'
- en: '| 95% | ![Appendix A – data case 7 – VaR estimation for individual stocks and
    a portfolio](img/B06175_11_41.jpg) |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 95% | ![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_41.jpg) |'
- en: 'Estimation of an n-day VaR depends on how to calculate the n-day return and
    standard deviation. Transformations are based on the following equation between
    the variances of different frequencies:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: n天VaR的估算取决于如何计算n天的收益和标准差。变换基于以下公式，不同频率之间的方差关系：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_31.jpg)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个股与投资组合的VaR估算](img/B06175_11_31.jpg)'
- en: 'For example, the annual volatility is equal to the daily volatility times the
    square root of 252 ![Appendix A – data case 7 – VaR estimation for individual
    stocks and a portfolio](img/B06175_11_42.jpg). Based on the daily return, we have
    the following general formulas for the VaR with a 99% or a 95% confidence level:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，年波动率等于每日波动率乘以252的平方根 ![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_42.jpg)。基于日收益率，我们得出以下一般公式，用于99%或95%置信水平的VaR估算：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_32.jpg)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_32.jpg)'
- en: 'Here, ![Appendix A – data case 7 – VaR estimation for individual stocks and
    a portfolio](img/B06175_11_43.jpg) is the expected daily returns, n is the number
    of days, ![Appendix A – data case 7 – VaR estimation for individual stocks and
    a portfolio](img/B06175_11_44.jpg) is the daily volatility, ![Appendix A – data
    case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_45.jpg)
    is an n-day volatility, confident is the confidence level, such as 99% or 95%,
    and p is the position. If we don''t know the expected returns and we assume the
    expected mean return is the same as the realized mean return, then we have the
    following formulas instead:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_43.jpg)是预期的每日收益率，n是天数，![附录A
    – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_44.jpg)是每日波动率，![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_45.jpg)是n天的波动率，confidence是置信水平，如99%或95%，而p是头寸。如果我们不知道预期收益率，并且假设预期的均值收益率与实际的均值收益率相同，那么我们有以下公式：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_33.jpg)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_33.jpg)'
- en: 'For the confidence levels of 99% and 95%, we have the following:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 对于99%和95%的置信水平，我们有以下内容：
- en: '![Appendix A – data case 7 – VaR estimation for individual stocks and a portfolio](img/B06175_11_34.jpg)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![附录A – 数据案例7 – 个别股票和投资组合的VaR估算](img/B06175_11_34.jpg)'
- en: References
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'Please refer to the following articles:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 请参考以下文章：
- en: '*Jorion, Philippe, Value at Risk, 2nd edition, McGraw-Hill, 2001*'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Jorion, Philippe, 风险价值（Value at Risk）, 第二版, McGraw-Hill, 2001*'
- en: '*Lopez, Jose A., 2000, An Academic Perspective on Backtesting and Stress-Testing
    Presentation for Credit Risk Models and the Future of Capital Management, Federal
    Reserve Bank of San Francisco*, [http://www.frbsf.org/economic-research/files/lopezbktesting.pdf](http://www.frbsf.org/economic-research/files/lopezbktesting.pdf)'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Lopez, Jose A., 2000, 关于回测和压力测试的学术视角——信用风险模型和资本管理的未来，旧金山联邦储备银行演讲*，[http://www.frbsf.org/economic-research/files/lopezbktesting.pdf](http://www.frbsf.org/economic-research/files/lopezbktesting.pdf)'
- en: '*Wikiperia*, *Value at Risk*, [https://en.wikipedia.org/wiki/Value_at_risk](https://en.wikipedia.org/wiki/Value_at_risk)'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Wikiperia*, *风险价值（Value at Risk）*, [https://en.wikipedia.org/wiki/Value_at_risk](https://en.wikipedia.org/wiki/Value_at_risk)'
- en: Exercises
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: What is the simplest definition of a VaR? What are the differences between a
    VaR and variance and standard deviation and beta?
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: VaR的最简单定义是什么？VaR、方差、标准差和贝塔值之间有什么区别？
- en: Assume that we have a plan to form a two-stock portfolio. The confidence level
    is 99% and number of period is 10 days. If the VaR for the first stock is x while
    the VaR for the second stock is y, is the portfolio VaR the weighted individual
    stock's VaR, that is, *VaR(portfolio) = wA*x + wB*y*, where *WA* is the weight
    for stock *A* while *wB* is the weight for stock B? Explain.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设我们有一个计划，形成一个两只股票的投资组合。置信水平为99%，周期数为10天。如果第一只股票的VaR为x，而第二只股票的VaR为y，那么投资组合的VaR是否为加权个别股票的VaR，即*VaR(投资组合)
    = wA*x + wB*y*，其中*WA*是股票*A*的权重，而*wB*是股票B的权重？请解释。
- en: Do IBM's returns follow a normal distribution? Are their skewness and kurtosis
    zero and 3 (excess kurtosis is zero)?
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: IBM的回报是否符合正态分布？它们的偏度和峰度值是否分别为零和三（过度峰度为零）？
- en: What are the values of skewness and kurtosis for a normal distribution? Generate
    n random numbers by using `rnorm()` to support your conclusion.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正态分布的偏度和峰度值是多少？通过使用`rnorm()`生成n个随机数来支持你的结论。
- en: Write a Python function to estimate mean, standard deviation, skewness, and
    kurtosis of a given ticker; for example, `moments4("ticker",begdate,enddate)`.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个Python函数，估算给定股票代码的均值、标准差、偏度和峰度；例如，`moments4("ticker", begdate, enddate)`。
- en: Assuming that we own 134 shares of Microsoft; what is the total value today?
    What is the maximum loss tomorrow with a 95% confidence level? What is the value
    if our holding period is 1 month instead of 1 day?
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设我们持有134股微软股票；今天的总价值是多少？在95%置信水平下，明天的最大损失是多少？如果我们的持有期是1个月而不是1天，价值是多少？
- en: Repeating the last question of 11.4 by using a monthly return instead of a daily
    return, is the answer different from that in 11.4?
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用月度收益代替日度收益重复11.4中的最后一个问题，答案是否与11.4中的不同？
- en: Our portfolio has 100 shares of IBM, and 300 shares of Microsoft. What is the
    VaR with a 99% confidence level for our 1-day holding period?
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们的投资组合有100股IBM股票和300股微软股票。在99%的置信水平下，持有期为1天时的VaR是多少？
- en: To estimate a VaR for Dell over 1 month, we could convert the daily VaR to a
    monthly VaR or calculate the VaR from the monthly data directly. Are they different?
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了估算戴尔公司1个月的VaR，我们可以将日VaR转换为月VaR，或者直接根据月度数据计算VaR。两者有区别吗？
- en: When we estimate a VaR, we could use different time periods, such as over the
    past year or past 5 years. Does this make a difference? Use a few tickers to explore
    and comment on your results.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们估算VaR时，可以使用不同的时间周期，例如过去1年或过去5年。这会有区别吗？使用几个股票代码进行探索并评论结果。
- en: Comment on the different VaR approaches, such as those based on the normality
    assumption, historical returns, and the modified VaR.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 评论不同的VaR方法，例如基于正态假设、历史收益和修正VaR的方法。
- en: If a fund has a 10% invested in IBM, 12% with Google, and the rest with Walmart,
    what is the volatility of the portfolio?
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果一个基金投资了10%的IBM，12%的谷歌，其余部分投资于沃尔玛，投资组合的波动率是多少？
- en: If the weights are 10% for IBM stocks, 12% for Dell, 20% for Walmart, and the
    rest of them for a long-term Treasury 10-year bond, what is the volatility of
    the portfolio?
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果IBM股票的权重为10%，戴尔为12%，沃尔玛为20%，其余部分为长期10年期国债，那么投资组合的波动率是多少？
- en: Based on 11.11, if the portfolio value is $10 million, what is the VaR with
    a 99% confidence level over the next 6 months?
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于11.11，如果投资组合的价值为1000万美元，那么在接下来的6个月内，99%置信水平下的VaR是多少？
- en: 'Use a 99% confidence level and 10 trading days as your holding period to estimate
    a VaR based on the historical returns method: 100 shares IBM, 200 shares Citigroup,
    200 shares Microsoft, and 400 shares Walmart.'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用99%置信水平和10个交易日作为持有期，基于历史收益法估算VaR：100股IBM，200股花旗，200股微软和400股沃尔玛。
- en: Is it true that a VaR based on a normality assumption is usually less than a
    VaR based on historical returns?
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于正态分布假设的VaR通常小于基于历史收益的VaR，这是真的吗？
- en: Tip
  id: totrans-215
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You could use a rolling window to a stock to show your result (answer). Alternatively,
    you could use several stocks.
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以使用滚动窗口对股票进行处理来显示你的结果（答案）。或者，你可以使用多只股票。
- en: Based on the code for the skewness, write a Python function for kurtosis. Compare
    your function with the function of `scipy.stats.kurtosis()`.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于偏度的代码，编写一个Python函数来计算峰度。将你的函数与`scipy.stats.kurtosis()`函数进行比较。
- en: If our holding period is not 1 day, what is the format (formulas) to estimate
    a VaR based on our historical returns?
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们的持有期不是1天，如何根据历史收益估算VaR？公式是什么？
- en: If the holding period is 2 weeks (10 trading days), how do you estimate a VaR
    based on the historical return data?
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果持有期为2周（10个交易日），如何根据历史收益数据估算VaR？
- en: What is the maximum possible loss (VaR) if our holdings for IBM, Dell, and Walmart
    stocks are 100, 200, and 500 shares, respectively? The confidence level is 99%
    and the holding period is 2 weeks.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们的持有IBM、戴尔和沃尔玛的股票分别是100股、200股和500股，99%的置信水平和2周的持有期下，最大可能损失（VaR）是多少？
- en: Write a Python program to generate a VaR using historical value. The structure
    of the function will be `VaR_historical(ticker, confidence_level, n_days)`.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编写一个Python程序，使用历史数据生成VaR。函数的结构将是`VaR_historical(ticker, confidence_level, n_days)`。
- en: Summary
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'In this chapter, an important risk measure called the **Value at Risk** (**VaR**)
    was discussed in detail. To estimate the VaR for individual stocks or portfolios,
    the two most popular methods are explained: based on the normality assumption
    and based on the sorting of historical returns. In addition, we have discussed
    the modified VaR method which considers the third and fourth moments in addition
    to the first two moments of returns. In [Chapter 12](ch12.html "Chapter 12. Monte
    Carlo Simulation"), *Monte Carlo Simulation*, we explain how to apply simulation
    to finance, such as simulating stock price movements and returns, replicating
    the Black-Scholes-Merton options model, and pricing some exotic options.'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，详细讨论了一种重要的风险度量方法——**风险价值**（**VaR**）。为了估算单只股票或投资组合的VaR，解释了两种最流行的方法：基于正态性假设的方法和基于历史收益排序的方法。此外，我们还讨论了修改版VaR方法，该方法除了考虑收益的前两阶矩，还考虑了第三阶和第四阶矩。在[第12章](ch12.html
    "第12章. 蒙特卡罗模拟")，*蒙特卡罗模拟*，我们解释了如何将模拟应用于金融领域，例如模拟股票价格波动和收益，复制Black-Scholes-Merton期权模型，以及定价一些复杂期权。
