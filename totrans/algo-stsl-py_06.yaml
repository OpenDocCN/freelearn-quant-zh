- en: '6'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Trading Edge is a Number, and Here is the Formula
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will unveil one of the most well-guarded secrets in the
    finance industry: behind the curtain is not an old man, but a simple formula.
    Then, we will decompose this formula into two distinct modules: signal and money
    management.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Within the signal module, we will explore how to time entries and exits, and
    the properties of the two strategy types that seem to provide a trading edge;
    trend following and mean reversion. We will continue this discussion in *Chapter
    7*, *Improve Your Trading Edge*, before covering the money management module in
    more depth in *Chapter 8*, *Position Sizing: Money is Made in the Money Management
    Module*.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Along the way, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The trading edge formula: arithmetic and geometric gain expectancy'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A trading edge is not a story
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Regardless of the asset class, there are only two strategies
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can access color versions of all images in this chapter via the following
    link: [https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf).
    You can also access source code for this chapter via the book''s GitHub repository:
    [https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt](https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt)'
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter and the rest of the book, we will be working with the `pandas`,
    `numpy`, `yfinance`, and `matplotlib` libraries. So, please remember to import
    them first:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The trading edge formula
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Information is not knowledge."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Albert Einstein, patent clerk
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Who said that science fiction hasn't found its way into the austere world of
    finance? Ask any hedge fund manager about their edge and you will enter a world
    of crusaders against corporate cabals, financial Sherlock Holmeses patiently piecing
    the information puzzle together, and visionaries investing in the next new [insert
    the next disruptive technological buzzword here…].
  prefs: []
  type: TYPE_NORMAL
- en: Everyone in the trading business will say that you need an edge to make money.
    Yet, they will never tell you how to build a sustainable one, presumably for fear
    that dissemination could erode theirs. Understandably, the trading edge has been
    this mysterious secret sauce.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are only three common types of edge: technological, information, and
    statistical, which will be considered over the next few sections.'
  prefs: []
  type: TYPE_NORMAL
- en: Technological edge
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Any retail trader today has access to more information and computing power than
    any top-tier institutional investor 10 years ago. Anyone with a little bit of
    Python skill can scrape data off the internet and process it via machine learning
    or artificial intelligence much faster than any traditional research department.
    A hedge fund-grade cloud infrastructure costs less than 50 dollars per month.
    Anyone can learn how to code, analyze data, trade, invest, and manage a portfolio
    for free on YouTube, Quora, or any other learning platform. Technology has brought
    democracy to the world of finance.
  prefs: []
  type: TYPE_NORMAL
- en: Everyone wants to be Jim Simons, but no one wants to take care of the plumbing.
    As shown in *Figure 6.1*, when asked what the number-one problem facing programmatic
    traders is, a third of responses were relating to data processing and storage
    and server management. This shows that the main hurdle remains technology for
    many aspiring algorithmic traders, who need an entire engineering team to automate
    their trading. Market participants need to be expert system engineers to ensure
    continuous connectivity. Then, they have to polish their development skills to
    write code that not only machines but more importantly humans can read.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_01.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.1: Bottlenecks to trading automation: for many aspiring algorithmic
    traders, the main hurdle continues to be technology'
  prefs: []
  type: TYPE_NORMAL
- en: 'The first iteration of a strategy is like the stone imprisoning Michelangelo''s
    David. It takes a lot of patient carving to reveal the ephebe. When written poorly,
    it takes a lot more time to disentangle the other Italian cultural heritage: spaghetti.
    After all this is taken care of, market participants can finally focus on designing
    alpha-generating strategies. Then come a whole other set of difficulties: scaling
    in/out, risk management, all the juicy stuff this book is about. The transmutation
    of billion-dollar ideas into bug-free code is still a daunting technological hurdle.
    Bottom line, it takes enormous work to make money work for you.'
  prefs: []
  type: TYPE_NORMAL
- en: A simple analogy would be the personal computer industry circa Apple 1\. Everyone
    wanted to play Space Invaders. Only a rare die-hard bunch of people were willing
    to build their own computers to play games. Today, every other Bitcoin enthusiast
    wants to learn algorithmic trading. Very few people are willing to put in the
    sweat, blood, and tears to build their own platform. This book will give you the
    building blocks to build your own strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Information edge
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The industry has traditionally operated on the belief that information gives
    an edge. This has been either privileged information, like getting access to top
    management and better treatment by analysts, or its more sinister cousin, inside
    information. Any information edge gets arbitraged away fast.
  prefs: []
  type: TYPE_NORMAL
- en: The information edge never really made a difference in the first place. If all
    it took to beat the Street was a better information edge, then, in theory, the
    animal kingdom of big trading houses with their parliaments of analysts, schools
    of Ph.D.s, prides of fund managers, murders of traders, drifts of sell-side researchers,
    herds of brokers, and kaleidoscopes of expert opinions, with corporate access
    on speed-dial and enough money to bail out half a continent would consistently
    outperform the market. In practice, venerable institutions have limped behind
    low-tech, plain-vanilla index funds for every year on record. Information gives
    only a temporary edge that gets arbitraged increasingly quickly over time. Information
    wants to be democratized.
  prefs: []
  type: TYPE_NORMAL
- en: Statistical edge
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A statistical edge does not get arbitraged away easily. It exists and persists
    by design. It is not "what" but "how" you trade that matters. In the next sections,
    we will look at ways to build a robust statistical trading edge. We will not try
    and tell you how to pick stocks differently, but how to squeeze more juice out
    of those you have already picked.
  prefs: []
  type: TYPE_NORMAL
- en: A trading edge is not a story
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"If you can''t measure it, you can''t improve it."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Peter Drucker
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'A trading edge is not a story. A trading edge is a number, and the formula
    is composed of a few functions:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Arithmetic gain expectancy: In execution trader English, this is how often
    you win multiplied by how much you make on average minus how often you lose times
    how much you lose on average. This function is the classic arithmetic expectancy,
    present in every middle school introduction to statistics and absent in a Finance
    MBA. When talking about trading edges or gain expectancy, market participants
    default to the arithmetic gain expectancy. It is easy to grasp and calculate.
    The simplicity of this formula imposes itself, even to those who do not understand
    its sophistication.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Geometric gain expectancy (George): Profits and losses compound geometrically.
    Geometric gain expectancy is mathematically closer to the expected robustness
    of a strategy.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The Kelly criterion is a position sizing algorithm that optimizes the geometric
    growth rate of a portfolio. Kelly has a fascinating history, starting with the
    18^(th) century mathematician Daniel Bernoulli, re-discovered by J.L. Kelly Jr.,
    and popularized by the legendary Edward Thorp. Kelly uses the same ingredients
    as the previous expectancies but cooks them a bit differently.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Over this chapter and the next one, we will use a rudimentary strategy to show
    how the formulae work. Think of it as Turtle Trader for dummies. Firstly, we recycle
    the 50/20 turtle with Softbank (9984.T) without simulating slippage or transaction
    costs. The code is recycled from *Chapter 5*, *Regime Definition*. First, we redefine
    some functions.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: We then run Softbank through the Turtle for dummies strategy, calculate returns,
    and print out two charts.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The code takes the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Use logarithmic returns: Log returns are easier to manipulate than arithmetic
    ones. Arithmetic sums do not compound, whereas logarithmic ones do. The cumulative
    returns are calculated with the `apply(np.exp)` method.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Strategy entry/exit: Entries and exits are delayed by one bar using the `shift()`
    method.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The following chart shows the closing price in black and the trailing stop
    loss in a red dashed line. On a secondary axis, we have the long/short positions:
    –1 for short and +1 for long positions. The solid blue line is the cumulative
    returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_02.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.2: Turtle for dummies: long and short entries, cumulative returns'
  prefs: []
  type: TYPE_NORMAL
- en: 'This strategy seems to be working in its primitive format. The second chart
    shows the daily and cumulative profits and losses. Flat lines are when there is
    no active position:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_03.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.3: Softbank daily and cumulative profit and loss (P&L)'
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will calculate the rolling profits, losses, and expectancies and plot
    them in a graph.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Copy the daily returns in `win_roll` and `loss_roll` to have a uniform-length
    series. Assign N/A to the losses on the `win_roll` series and vice versa with
    profits for the `loss_roll` series.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Instantiate the window size and rolling count to calculate both the win rate
    and loss rate.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The rolling sum method does not accommodate missing values. So, we use the `fillna(0)`
    method to replace missing values with `0` to calculate moving averages. Populate
    the dataframe and plot.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/B17704_06_04.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.4: Softbank rolling trading edge, geometric expectancy, Kelly'
  prefs: []
  type: TYPE_NORMAL
- en: 'The strategy has a positive trading edge, but once again please do not try
    this at home—it is too simplistic to be deployed in real-money production and
    is for educational purposes only. Those three lines on the chart are a variation
    on the same theme. The ingredients are the same, but the cooking is a bit different.
    The key takeaway is: nothing happens until the gain expectancy turns positive.
    Sharpe, Sortino, Jensen, Treynor, and information ratios are all well and good,
    but they come after the gain expectancy is positive.'
  prefs: []
  type: TYPE_NORMAL
- en: 'All of these formulae can be decomposed into two modules:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Signal module**: Win/loss rate. These are the returns generated from entry
    and exit signals.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Money management module**: Average profit/loss. These are contributions generated
    from returns multiplied by bet sizes.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This demystifies the trading edge as something that can be engineered from
    the ground up. Market participants pretend they have superior knowledge of the
    future thanks to their analytical superpowers and machine learning crystal balls.
    Meanwhile, casinos publicly advertise randomness. Still, the former have lumpy
    returns, and the latter consistently print money day-in, day-out. This is not
    a coincidence. The former believe knowledge is an edge, while casinos engineer
    their edge. The job of every market participant is therefore to optimize their
    trading edge. Over the next few chapters, we will consider how to engineer these
    modules and maximize the trading edge, starting with the signal module, before
    moving onto the money management module and position sizing in *Chapter 8*, *Position
    Sizing: Money is Made in the Money Management Module*.'
  prefs: []
  type: TYPE_NORMAL
- en: So, without further ado, let's start with the signal module.
  prefs: []
  type: TYPE_NORMAL
- en: 'Signal module: entries and exits'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '"You''ve got to know when to hold ''em,'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: know when to fold 'em,
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: know when to walk away,
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: and know when to run."
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Kenny Rogers, The Gambler
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Let''s start gently by strangling a classical myth once and for all: "you will
    make money as long as you are right 51% of the time." Wrong. By their own admission,
    the industry''s top performers with decades-long track records often claim unimpressive
    long-term win rates. Conversely, LTCM boasted an exceptionally high win rate until
    its liquidation and dissolution in 2000\.'
  prefs: []
  type: TYPE_NORMAL
- en: You will make money so long as you have a positive trading edge. The first thing
    we need to engineer is the signal module. As we saw in *Chapter 1*, *The Stock
    Market Game*, false positives cannot be eradicated. Randomness is here to stay.
    Every basket comes with a few bad apples. The key is to design policies to spot
    those bad apples, deal with them before they spoil the basket, and move on.
  prefs: []
  type: TYPE_NORMAL
- en: 'Entries: stock picking is vastly overrated'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '"The beatings will continue until the morale improves."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Captain Bligh, HMS Bounty
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The stock market is the only competitive sport where people like to hand out
    medals before the race starts. The industry is built on the cult of the stock
    picker. Everyone loves to talk about their top stock picks. 90% of the energy
    of market participants is focused on making the right calls. Unfortunately, the
    same 90% of market participants will fail to beat their benchmark 5 years in a
    row.
  prefs: []
  type: TYPE_NORMAL
- en: 'In quants trader jargon, this is called correlation. When correlation endures
    year after year for every year on record, r-squared, *causality* in quants vernacular,
    goes to 1\. In execution trader English, insanity is when the average frustrated
    market participant puts more and more energy and resources into stock picking
    and yet consistently fails year after year. Bottom line, 90% of market participants
    predictably fail because they consistently focus on the wrong thing: entry. Maybe
    it is time we entertained the possibility of a different approach.'
  prefs: []
  type: TYPE_NORMAL
- en: 'According to Professor Jeremy Siegel, the long-term average return of the stock
    market is +7%. That leaves little room for pleasantries on the short side. Ideas
    are cheap and plentiful. Every single human being has a bag full of million-dollar
    ideas. The difference between ideas and profits is called execution. As we saw
    in *Part I*, *The Inner Game: Demystifying Short Selling*, many market participants
    fail on the short side because they enter when ideas germinate, not when they
    are fully ripe for the picking. Underperformance is the financial equivalent of
    the indigestion we get when we eat fruits that have not ripened yet.'
  prefs: []
  type: TYPE_NORMAL
- en: This book will not give you a silver bullet methodology. The purpose of this
    book is to introduce a probabilistic view of the markets so that you can become
    a statistically better version of yourself. This book is merely a cookbook for
    the ingredients you bring to the table. Fundamental, technical, and quantitative
    short-sellers have all made money, but they could not have succeeded without getting
    probabilities on their side first.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are two times when you need to be cognizant of probabilities: stock selection
    and entry. In execution trader English, this means there are two times when you
    should listen to what the markets have to say before pulling the trigger.'
  prefs: []
  type: TYPE_NORMAL
- en: First, you need to short stocks that are either in sideways or bear regimes.
    Shorting stocks in a bull regime is like standing on the tracks expecting freight
    trains to stop one after the other. In *Chapter 5, Regime Definition*, we learned
    an objective way to reclassify stocks according to their regime. Since short selling
    is a relative game (stocks' prices dropping in absolute is a laggard indicator),
    regime change often takes the form of sector rotation in the equities market.
    Yesterday's darlings are tomorrow's dogs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The second time when you need to be aware of probabilities is entry. Market
    participants coming from the long side like to buy on breakouts. The same logic
    does not translate well on the short side. Remember that almost all market participants
    are in the markets to buy long. Some people have been waiting on the sideline
    for an opportunity to buy on dips. Fast-falling markets are often followed by
    rapid bear market rallies. There is a short window when probabilities are in favor
    of short sellers.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The best time to enter a short position is when a bear market rally rolls over.
    We will go over the aikido of the short squeeze in *Part III*, *The Long/Short
    Game: Building a Long/Short Product*.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: We saw earlier a visual representation of gain expectancy. In the following
    chapters, we will look at techniques designed to increase your trading edge. They
    extend beyond short selling. Some may not apply to your style or strategy.
  prefs: []
  type: TYPE_NORMAL
- en: 'Exits: the transmutation of paper profits into real money'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The only soldiers who walk into battle without an exit strategy are called kamikaze
    soldiers. They do not expect to come back alive. Since you probably do not expect
    your trading to look like a suicide mission, the best time to develop an exit
    strategy is before you "get boxed in," by entering a position.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the financial services industry, the only thing cheaper than toilet paper
    are back-tests and simulation print-outs. This is just paper money. No one gets
    hurt. Real money is the only thing that matters. Let''s take the idea one step
    further. The only time when you know how much "real money" was made, or lost,
    is after closing a trade. Anything before that is called paper profit. Bottom
    line: exits matter.'
  prefs: []
  type: TYPE_NORMAL
- en: We have all been conditioned to believe that our initial choices are what matter
    the most. If we have the right internship, graduate from the right university,
    or choose the right first job, then our careers will be smooth. Life, however,
    is what happens to us when we have other plans. We often underestimate the role
    of luck in our lives. Being at the right place at the right time has made a lot
    of lucky people rich. Those individuals however rarely succeed on their first
    attempt. They try, fail, and pivot until something finally clicks.
  prefs: []
  type: TYPE_NORMAL
- en: Since market participants like to buy and hold, marriage is arguably a sensible
    metaphor. Every marriage starts with an optimistic "happily ever after," yet roughly
    half of them end up as a divorce statistic. Getting married is easy. Getting divorced
    is a life-altering event. If you have not considered the eventuality before getting
    married, then it will be emotionally and financially devastating. Bad marriages
    can be saved. Bad divorces can't. Bad entries can be salvaged. Bad exits can't.
    This is when the P&L gets printed.
  prefs: []
  type: TYPE_NORMAL
- en: As you will see in the coming chapters, 5 of the 7 steps to increase your trading
    edge deal with losses. Another good analogy is personal finance. There are two
    ways you can increase your savings. Either you maintain your current spending
    and go for a better-paying job, or you restrict your expenses and save the difference.
    The former works well if you have a stable high salary.
  prefs: []
  type: TYPE_NORMAL
- en: If your earnings are entirely variable, then you would be wiser to maintain
    a low fixed cost base and pocket whatever difference you glean from the markets.
    You will get the same big paydays as the other players, but the difference is
    you will not need them to stay afloat. In financial creole, this focus on expenses
    is called "cutting your losses short."
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of the asset class, there are only two strategies
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Jack Schwager often points out that there is no universal holy grail. Market
    wizards come in all shapes and forms, sometimes even with contradicting strategies.
    They have one thing in common though. They excel at managing risk and controlling
    losses. They consistently focus on the downside. Winning positions take care of
    themselves. Market participants' job is to take care of losers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Market participants usually define themselves by "what" they trade (asset class,
    markets, time horizon), rarely *"how"* they trade. Regardless of the asset class,
    there are only two types of strategies: trend following and mean reversion. The
    reason why there are only two strategies is not entries but exits. How you choose
    to close a trade determines your dominant trading style. The mean reversion camp
    closes early when inefficiencies are corrected. The trend-following crowd loves
    to ride their winners. A classic example is value versus growth. Value investors
    buy undervalued stocks and then pass the baton to growth investors who ride them
    into the sunset.'
  prefs: []
  type: TYPE_NORMAL
- en: For example, a mean reversion market participant would buy a stock at a **Price
    to Book Ratio** (**PBR**) of 0.5, close the position when PBR reverts back to
    1, and move on. A trend follower would buy the same name at the same valuation
    but would ride it deep into euphoric territory. They would eventually close the
    position after this once-obscure, under-researched name would finally make it
    to the "Strong Buy" lists of tier 1 investment banks and predictably underperform
    thereafter.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some readers may argue that value investors are more the mean reversion kind
    and growth managers the trend following type. That is usually true but not always
    the case. The best counterexample and probably the ultimate value trend follower
    is Warren Buffett. He invests in undervalued businesses that he intends to hold
    ad perpetuum. Your positions are not Philippe Patek watches. You do not hold them
    for future generations. At some point, you will close your positions. Only three
    things can happen: the price goes up, down, or nowhere. You either lose, make,
    or waste money. You need a scenario for each case. You need a plan to realize
    profits, mitigate losses, and deal with freeloaders. Our objective is to engineer
    a better statistical trading edge. If there are only two strategy types, then
    it is important to spend time understanding how they behave, their payoffs, and
    risks, and whether they are mutually exclusive or compatible.'
  prefs: []
  type: TYPE_NORMAL
- en: Trend following
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '"Money is made in the sitting and waiting."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Jesse Livermore
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**Trend following** strategies rely on the capital appreciation of a few big
    winners. systematic **Commodities Trading Advisors** (**CTAs**) look for breakouts
    and place protective trailing stop losses. Technical analysts look for entry points
    and ride the upside. Even fundamental stock pickers qualify as trend followers.
    Instead of price action, they follow improvement in fundamentals, earnings momentum,
    or even news flow. Bottom line, whether they consciously admit it or not, the
    default mode for market participants is trend following. Since trend following
    is the dominant model for market participants, we use a rudimentary trend following
    strategy (turtle for dummies) in this book.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This is what the P&L distribution of trend followers looks like:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_05.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.5: Classic trend-following long/short P&L distribution'
  prefs: []
  type: TYPE_NORMAL
- en: 'We can observe the following properties:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Low win rate**: Somewhere between 30 to 50%. The mode, the peak number of
    trades, is in the loss-making section of the distribution. For every Alphabet,
    Amazon, or Apple, there are countless Nestcapes, Ataris, or MySpaces.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Alpha generation**: Trend-following strategies rely on the capital appreciation
    of a few winners to offset numerous small losses. This introduces a lag between
    profits unfolding over time, and losses promptly denting the equity curve. Losses
    are quickly dealt with while winners take time to mature.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Positive skew**: A right-tailed P&L distribution gives a favorable tail ratio.
    Winners are bigger than losers. The above chart is a visual representation of
    the time-honored "cut your losers, ride your winners." Again, it takes time to
    achieve those outsized returns. Meanwhile, the equity curve has to deal with the
    frog smudge along the way.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cyclicality**: Markets do not trend all the time. Styles come in and out
    of favor. When a style does not work, losses start mounting. Successful trend
    followers are prompt to recognize their mistakes and keep individual losses small.
    When their style is in favor, they ride the trends into the sunset.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Relatively low turnover**: Turnover is a function of cyclicality. When markets
    are trending up or down, there is no need to do anything. Money is made in the
    sitting and waiting, as legendary trader Jesse Livermore used to say. When a style
    goes out of favor, turnover will increase as more frogs will be churned.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Volatility**: This is a consequence of cyclicality. Market participants go
    through periods of lackluster returns.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Trend followers kiss a lot of frogs. The risk is that the cumulative smudge
    of all the delicious batrachians may not outweigh the fairness of a few princesses.
    The risk with trend-following strategies is in the aggregate weight of losses
    over profits.
  prefs: []
  type: TYPE_NORMAL
- en: The most pertinent risk metric for trend-following strategies is to compare
    cumulative profits and losses. This is the gain-to-pain ratio, also commonly known
    as the profit factor or profitability factor, favored by the prophet Jack Schwager.
    It states that when cumulative profits in the numerator exceed losses, the ratio
    is above 1, and vice versa for loss-making strategies. This is yet another version
    of the arithmetic gain expectancy, as a ratio instead of a delta.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: The above code calculates the rolling and cumulative gain-to-pain/profit ratio.
    The structure is symmetrical, so let's concentrate on rolling profits.
  prefs: []
  type: TYPE_NORMAL
- en: Instantiate a `profit_roll` dataframe by copying the returns series. Assign
    `0` to losses. This will preserve the shape of the dataframe.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Calculate a rolling sum using the `rolling` method. Fill `#N/A` missing values
    using the `fillna` method.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the `rolling_profits` and `rolling_losses` functions, calculate `profit_ratio`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `rolling` functions are followed by the cumulative versions. The `expanding()`
    method does synthetically the same thing as the popular `cumsum()` method. The
    only difference is that `expanding()` does not reset to `0` when stumbling upon
    missing values, unlike `cumsum()`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/B17704_06_06.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.6: Softbank cumulative returns and profit ratios: rolling and cumulative'
  prefs: []
  type: TYPE_NORMAL
- en: The above chart plots the rolling and cumulative profit ratios side by side
    with the signals. The profit ratio nosedives as signals are choppy. Conversely,
    the profit ratio rises in trending markets.
  prefs: []
  type: TYPE_NORMAL
- en: Trend-following strategies post impressive but volatile performance. They go
    through long periods of underwhelming performance, which take their toll on the
    emotional capital of managers and investors. Their main challenge is to keep cumulative
    losses small. Profits only look big to the extent that losses are kept small.
  prefs: []
  type: TYPE_NORMAL
- en: To illustrate this phenomenon, one of the original turtle traders used to say
    that, with a 30%+ win rate, they took on positions expecting them to fail. This
    subtle shift in mindset made them more vigilant about risk management.
  prefs: []
  type: TYPE_NORMAL
- en: Mean reversion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Mean reversion** strategies compound numerous small profits. They rely on
    the premise that extremes eventually revert to the mean. They arbitrage market
    inefficiencies. Mean reversion strategies essentially capture the time it takes
    for inefficiencies to correct. For example, the price of a warrant may look cheap
    compared to its underlying stock. Over time, prices will converge, and the gap
    will close. They often have low-volatility, consistent performance. They perform
    well during established markets: bull, bear, or sideways. The markets of predilection
    for mean reversion strategies are typically sideways phases where prices oscillate
    in semi-predictable fashions. They may find bull or bear phases more challenging,
    but there is ample empirical evidence of talented managers performing in those
    markets. Again, risk management is what separates the pros from the tourists.'
  prefs: []
  type: TYPE_NORMAL
- en: Mean reversion strategies perform poorly during regime changes. For example,
    long high beta, short low beta will do wonders in a bull market but will give
    back a lot of performance as the regime transitions to sideways and bear. The
    darlings of the last bull market sometimes lead the way down in the ensuing bear
    market. They also perform poorly during tail events. Short gamma funds performed
    well for years until they spectacularly blew up in three weeks during the 2008
    GFC.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_07.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.7: Classic long/short mean reversion P&L distribution'
  prefs: []
  type: TYPE_NORMAL
- en: 'The characteristics of mean reversion strategies are:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Alpha generation**: Mean reversion strategies have high turnovers. They **compound**
    small profits quickly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Negative skew**: Left-tailed P&L distribution. Unfavorable tail ratio: losers
    are bigger than winners. The above chart is a visual representation of the time-honored
    adage "you can''t go broke taking profits." It turns out you probably can if losses
    are too big. Mean reversion strategies arbitrage inefficiencies. Trades are closed
    when inefficiencies are corrected. Sometimes, those inefficiencies persist. Since
    the original premise is that inefficiencies are bound to correct anyways, stop
    losses are not enforced. This leads to rare but devastating blows.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**High win rate**: Often above 50%. Markets are not efficient all the time
    on all time frames.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Moderate to high turnover**: In practice, inefficiencies appear more frequently
    than the **Efficient Market Hypothesis** (**EMH**) and subsequent academic theories
    generally suggest.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Consistent low-volatility small profits**: Mean reversion strategies arbitrage
    multiple small inefficiencies during stable market regimes.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Potentially devastating left-tail losses**: Mean reversion strategies perform
    in established markets where inefficiencies correct. They fail during regime changes
    when past inefficiencies persist. Interestingly enough, trend-following strategies
    start to perform well right around the time mean reversion strategies falter.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Slow recovery**: Mean reversion strategies bank small profits but post big
    losses. It takes a lot of small wins to offset a few big losses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'As we saw earlier, mean reversion strategies post consistent small profits
    but suffer rare but game-ending setbacks. The risk for mean reversion strategies
    is in the tail. A few devastating losses have the power to sink the ship. After
    all, the captain of the Titanic had a 99% win rate. The most relevant measure
    of risk is therefore the ratio of the biggest profits to the worst losses, or
    tail ratio:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The code includes the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: '`cumul_returns`: In this function, `returns` refer to the log returns `np.log(px/px.shift())`.
    Calculate the cumulative returns using the `cumsum()` method and fill the missing
    values.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Calculate rolling left and right tails using the `quantile` method.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This series is a bit jumpy—0 in the denominator returns an error, hence the
    error setting to `ignore`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set upper and lower bounds to avoid infinite numbers on each side.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The resulting chart shows cumulative returns and the rolling and cumulative
    tail ratios.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_06_08.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6.8: Softbank, cumulative returns, and tail ratios: rolling and cumulative'
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, we calculated a 5% tail ratio both on a cumulative and rolling
    basis. As you can see, the tail ratio can veer to infinity or zero quite quickly.
    This is why it should be range-bound via the limit. Note that the tail ratio is
    a lot less responsive than the profit ratio we saw earlier. This ratio does not
    apply to trend following strategies. It is so consistently high that the limit
    had to be lowered to the 5th and 95th percentile to be visible. This goes to illustrate
    that those strategies really have different risk profiles.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's recap. The mysterious, mystical, mythical, magical trading edge is nothing
    but a little formula we learned back in school called gain expectancy. Now, it
    turns out that strategies with a positive trading edge tend to fall into two buckets.
    This happens regardless of time frames, asset classes, instrument, and market
    phases. Market participants expect inefficiencies to either correct and revert
    to the mean, or to persist and form trends. Those strategies are mutually exclusive.
    They have opposite payoffs and risk profiles.
  prefs: []
  type: TYPE_NORMAL
- en: We then took time to understand the properties of each strategy type so that
    we can come up with better ways to engineer a superior trading edge. Now that
    we understand how those strategies behave, the next step is to roll up our sleeves,
    pop the hood, and tune up the signal engine.
  prefs: []
  type: TYPE_NORMAL
