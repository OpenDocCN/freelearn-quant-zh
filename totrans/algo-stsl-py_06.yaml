- en: '6'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Trading Edge is a Number, and Here is the Formula
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will unveil one of the most well-guarded secrets in the
    finance industry: behind the curtain is not an old man, but a simple formula.
    Then, we will decompose this formula into two distinct modules: signal and money
    management.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: 'Within the signal module, we will explore how to time entries and exits, and
    the properties of the two strategy types that seem to provide a trading edge;
    trend following and mean reversion. We will continue this discussion in *Chapter
    7*, *Improve Your Trading Edge*, before covering the money management module in
    more depth in *Chapter 8*, *Position Sizing: Money is Made in the Money Management
    Module*.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: 'Along the way, we will cover the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The trading edge formula: arithmetic and geometric gain expectancy'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A trading edge is not a story
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Regardless of the asset class, there are only two strategies
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can access color versions of all images in this chapter via the following
    link: [https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf).
    You can also access source code for this chapter via the book''s GitHub repository:
    [https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt](https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt)'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter and the rest of the book, we will be working with the `pandas`,
    `numpy`, `yfinance`, and `matplotlib` libraries. So, please remember to import
    them first:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The trading edge formula
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Information is not knowledge."'
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  id: totrans-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Albert Einstein, patent clerk
  id: totrans-16
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Who said that science fiction hasn't found its way into the austere world of
    finance? Ask any hedge fund manager about their edge and you will enter a world
    of crusaders against corporate cabals, financial Sherlock Holmeses patiently piecing
    the information puzzle together, and visionaries investing in the next new [insert
    the next disruptive technological buzzword here…].
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: Everyone in the trading business will say that you need an edge to make money.
    Yet, they will never tell you how to build a sustainable one, presumably for fear
    that dissemination could erode theirs. Understandably, the trading edge has been
    this mysterious secret sauce.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: 'There are only three common types of edge: technological, information, and
    statistical, which will be considered over the next few sections.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: Technological edge
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Any retail trader today has access to more information and computing power than
    any top-tier institutional investor 10 years ago. Anyone with a little bit of
    Python skill can scrape data off the internet and process it via machine learning
    or artificial intelligence much faster than any traditional research department.
    A hedge fund-grade cloud infrastructure costs less than 50 dollars per month.
    Anyone can learn how to code, analyze data, trade, invest, and manage a portfolio
    for free on YouTube, Quora, or any other learning platform. Technology has brought
    democracy to the world of finance.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，任何零售交易者都可以获取比任何顶级机构投资者在10年前更多的信息和计算能力。任何有一点Python技能的人都可以从互联网上爬取数据，并通过机器学习或人工智能更快地处理它，比任何传统研究部门都快。一个与对冲基金级别相当的云基础设施成本不到50美元每月。任何人都可以免费在YouTube、Quora或任何其他学习平台上学习如何编码、分析数据、交易、投资和管理投资组合。技术已经将民主带入了金融世界。
- en: Everyone wants to be Jim Simons, but no one wants to take care of the plumbing.
    As shown in *Figure 6.1*, when asked what the number-one problem facing programmatic
    traders is, a third of responses were relating to data processing and storage
    and server management. This shows that the main hurdle remains technology for
    many aspiring algorithmic traders, who need an entire engineering team to automate
    their trading. Market participants need to be expert system engineers to ensure
    continuous connectivity. Then, they have to polish their development skills to
    write code that not only machines but more importantly humans can read.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 每个人都想成为吉姆·西蒙斯，但没有人想管管道。正如*图6.1*所示，当被问及程序化交易者面临的头号问题时，有三分之一的回答涉及数据处理和存储以及服务器管理。这表明，对于许多有抱负的算法交易者来说，主要障碍仍然是技术，他们需要一个完整的工程团队来自动化他们的交易。市场参与者需要成为专业的系统工程师，以确保持续的连接性。然后，他们必须提高他们的开发技能，编写不仅机器能够读懂，而且更重要的是人类能够读懂的代码。
- en: '![](img/B17704_06_01.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_01.png)'
- en: 'Figure 6.1: Bottlenecks to trading automation: for many aspiring algorithmic
    traders, the main hurdle continues to be technology'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图6.1：交易自动化的瓶颈：对于许多有抱负的算法交易者来说，主要障碍仍然是技术
- en: 'The first iteration of a strategy is like the stone imprisoning Michelangelo''s
    David. It takes a lot of patient carving to reveal the ephebe. When written poorly,
    it takes a lot more time to disentangle the other Italian cultural heritage: spaghetti.
    After all this is taken care of, market participants can finally focus on designing
    alpha-generating strategies. Then come a whole other set of difficulties: scaling
    in/out, risk management, all the juicy stuff this book is about. The transmutation
    of billion-dollar ideas into bug-free code is still a daunting technological hurdle.
    Bottom line, it takes enormous work to make money work for you.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 策略的第一次迭代就像困住米开朗基罗的大卫的石头。需要耐心的雕刻才能显现少年形象。写得不好时，解开另一个意大利文化遗产——意大利面的时间要更长。在这一切得到解决之后，市场参与者最终可以专注于设计产生阿尔法的策略。然后出现了另一套难题：缩放进出、风险管理，这本书涵盖了所有有趣的内容。将亿万美元的想法转化为无错代码仍然是一道艰巨的技术障碍。底线是，要让钱为你工作需要付出巨大的努力。
- en: A simple analogy would be the personal computer industry circa Apple 1\. Everyone
    wanted to play Space Invaders. Only a rare die-hard bunch of people were willing
    to build their own computers to play games. Today, every other Bitcoin enthusiast
    wants to learn algorithmic trading. Very few people are willing to put in the
    sweat, blood, and tears to build their own platform. This book will give you the
    building blocks to build your own strategy.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的类比可以是Apple 1时代的个人电脑行业。每个人都想玩太空入侵。只有极少数人愿意自己组装计算机来玩游戏。今天，每个比特币爱好者都想学习算法交易。很少有人愿意付出汗水、鲜血和泪水来建立自己的平台。这本书将为您提供构建自己策略的基础。
- en: Information edge
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 信息优势
- en: The industry has traditionally operated on the belief that information gives
    an edge. This has been either privileged information, like getting access to top
    management and better treatment by analysts, or its more sinister cousin, inside
    information. Any information edge gets arbitraged away fast.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 该行业传统上一直认为信息能带来优势。这要么是特权信息，比如获得高层管理和分析师更好的对待，要么是它更阴险的表兄弟，内幕信息。任何信息优势都会很快被套利掉。
- en: The information edge never really made a difference in the first place. If all
    it took to beat the Street was a better information edge, then, in theory, the
    animal kingdom of big trading houses with their parliaments of analysts, schools
    of Ph.D.s, prides of fund managers, murders of traders, drifts of sell-side researchers,
    herds of brokers, and kaleidoscopes of expert opinions, with corporate access
    on speed-dial and enough money to bail out half a continent would consistently
    outperform the market. In practice, venerable institutions have limped behind
    low-tech, plain-vanilla index funds for every year on record. Information gives
    only a temporary edge that gets arbitraged increasingly quickly over time. Information
    wants to be democratized.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 信息优势从来没有真正产生过影响。如果战胜街头所需的仅仅是更好的信息优势，那么理论上，拥有分析师议会、博士学位学校、基金经理的骄傲、交易员的谋杀、卖方研究员的漂移、经纪人的群体以及专家意见的万花筒的大型交易机构，通过速拨电话获得企业联系并有足够的资金来拯救半个大陆的能力，将会一直超越市场。实际上，尊崇的机构在记录中的每一年都远远落后于低科技、普通香草指数基金。信息只提供了一个随时间越来越快地被套利的暂时优势。信息希望被民主化。
- en: Statistical edge
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 统计优势
- en: A statistical edge does not get arbitraged away easily. It exists and persists
    by design. It is not "what" but "how" you trade that matters. In the next sections,
    we will look at ways to build a robust statistical trading edge. We will not try
    and tell you how to pick stocks differently, but how to squeeze more juice out
    of those you have already picked.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 统计优势不容易被套利掉。它通过设计存在并持续存在。重要的不是你交易的“什么”，而是你交易的“如何”才重要。在接下来的章节中，我们将探讨构建强大的统计交易优势的方法。我们不会试图告诉你如何不同地挑选股票，而是如何从已经选择的股票中挤出更多的果汁。
- en: A trading edge is not a story
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 交易边缘并非一个故事。
- en: '"If you can''t measure it, you can''t improve it."'
  id: totrans-33
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '"如果你不能衡量它，你就不能改善它。"'
- en: ''
  id: totrans-34
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Peter Drucker
  id: totrans-35
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: – 彼得·德鲁克
- en: 'A trading edge is not a story. A trading edge is a number, and the formula
    is composed of a few functions:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 交易边缘并非一个故事。交易边缘是一个数字，公式由几个函数组成：
- en: 'Arithmetic gain expectancy: In execution trader English, this is how often
    you win multiplied by how much you make on average minus how often you lose times
    how much you lose on average. This function is the classic arithmetic expectancy,
    present in every middle school introduction to statistics and absent in a Finance
    MBA. When talking about trading edges or gain expectancy, market participants
    default to the arithmetic gain expectancy. It is easy to grasp and calculate.
    The simplicity of this formula imposes itself, even to those who do not understand
    its sophistication.'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 算术增益期望：在执行交易员的英语中，这是你赢的次数乘以你平均赚多少减去你输的次数乘以你平均输多少。这个函数是经典的算术期望，存在于每一个初中统计学介绍中，却不在金融MBA中。当谈论交易优势或增益期望时，市场参与者默认使用算术增益期望。这个公式易于理解和计算。这个公式的简单性自然而然地占据了主导地位，即使对于那些不理解其复杂性的人也是如此。
- en: '[PRE1]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Geometric gain expectancy (George): Profits and losses compound geometrically.
    Geometric gain expectancy is mathematically closer to the expected robustness
    of a strategy.'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 几何增益期望（George）：利润和损失以几何方式复利。几何增益期望在数学上更接近策略的预期稳健性。
- en: '[PRE2]'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The Kelly criterion is a position sizing algorithm that optimizes the geometric
    growth rate of a portfolio. Kelly has a fascinating history, starting with the
    18^(th) century mathematician Daniel Bernoulli, re-discovered by J.L. Kelly Jr.,
    and popularized by the legendary Edward Thorp. Kelly uses the same ingredients
    as the previous expectancies but cooks them a bit differently.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 凯利准则是一种优化投资组合几何增长率的头寸大小算法。凯利具有引人入胜的历史，始于18世纪的数学家丹尼尔·伯努利，由J.L.凯利 Jr.重新发现，并由传奇人物爱德华·索普推广。凯利使用与之前期望相同的成分，但做法略有不同。
- en: '[PRE3]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Over this chapter and the next one, we will use a rudimentary strategy to show
    how the formulae work. Think of it as Turtle Trader for dummies. Firstly, we recycle
    the 50/20 turtle with Softbank (9984.T) without simulating slippage or transaction
    costs. The code is recycled from *Chapter 5*, *Regime Definition*. First, we redefine
    some functions.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章和下一章中，我们将使用一个基本策略来展示这些公式是如何工作的。把它看作是适用于白痴的海龟交易员。首先，我们重新利用50/20海龟策略来交易Softbank（9984.T），不考虑滑点或交易成本。代码是从*第5章*，*制度定义*中回收的。首先，我们重新定义一些函数。
- en: '[PRE4]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We then run Softbank through the Turtle for dummies strategy, calculate returns,
    and print out two charts.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们通过白痴的海龟策略运行Softbank，计算回报，并打印出两个图表。
- en: '[PRE5]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The code takes the following steps:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 代码执行以下步骤：
- en: 'Use logarithmic returns: Log returns are easier to manipulate than arithmetic
    ones. Arithmetic sums do not compound, whereas logarithmic ones do. The cumulative
    returns are calculated with the `apply(np.exp)` method.'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用对数收益：对数收益比算术收益更易于处理。算术总数不会累积，而对数总数会。累积收益使用`apply(np.exp)`方法计算。
- en: 'Strategy entry/exit: Entries and exits are delayed by one bar using the `shift()`
    method.'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 策略入/出场：使用`shift()`方法延迟一个柱来进行入场和出场。
- en: 'The following chart shows the closing price in black and the trailing stop
    loss in a red dashed line. On a secondary axis, we have the long/short positions:
    –1 for short and +1 for long positions. The solid blue line is the cumulative
    returns:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了以黑色表示的收盘价和以红色虚线表示的移动止损。在次要轴上，我们有多空头寸：空头为-1，多头为+1。实线蓝色表示累积收益：
- en: '![](img/B17704_06_02.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_02.png)'
- en: 'Figure 6.2: Turtle for dummies: long and short entries, cumulative returns'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.2：Dummy 的海龟：多头和空头进出场，累积收益
- en: 'This strategy seems to be working in its primitive format. The second chart
    shows the daily and cumulative profits and losses. Flat lines are when there is
    no active position:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这个策略似乎在其原始格式下起效果。第二张图显示了每日和累积盈亏。平线表示没有活跃头寸时：
- en: '![](img/B17704_06_03.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_03.png)'
- en: 'Figure 6.3: Softbank daily and cumulative profit and loss (P&L)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.3：Softbank 每日及累积盈亏（P&L）
- en: Next, we will calculate the rolling profits, losses, and expectancies and plot
    them in a graph.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将计算滚动利润、损失和期望值，并将它们绘制成图表。
- en: '[PRE6]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Copy the daily returns in `win_roll` and `loss_roll` to have a uniform-length
    series. Assign N/A to the losses on the `win_roll` series and vice versa with
    profits for the `loss_roll` series.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将每日收益复制到`win_roll`和`loss_roll`中，使其具有统一长度的序列。将`win_roll`序列的损失值设为 N/A，将`loss_roll`序列的收益值设为反之。
- en: Instantiate the window size and rolling count to calculate both the win rate
    and loss rate.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实例化窗口大小和滚动计数以计算胜率和败率。
- en: The rolling sum method does not accommodate missing values. So, we use the `fillna(0)`
    method to replace missing values with `0` to calculate moving averages. Populate
    the dataframe and plot.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 滚动求和方法不适用于缺失值。因此，我们使用`fillna(0)`方法将缺失值替换为`0`来计算移动平均值。填充数据框并绘图。
- en: '![](img/B17704_06_04.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_04.png)'
- en: 'Figure 6.4: Softbank rolling trading edge, geometric expectancy, Kelly'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.4：Softbank 滚动交易边缘，几何期望值，凯利
- en: 'The strategy has a positive trading edge, but once again please do not try
    this at home—it is too simplistic to be deployed in real-money production and
    is for educational purposes only. Those three lines on the chart are a variation
    on the same theme. The ingredients are the same, but the cooking is a bit different.
    The key takeaway is: nothing happens until the gain expectancy turns positive.
    Sharpe, Sortino, Jensen, Treynor, and information ratios are all well and good,
    but they come after the gain expectancy is positive.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 这个策略具有正的交易边缘，但请不要在家里尝试这个——它太简单，不能用于实际交易，仅供教育目的。图表上的这三条线是相同主题的变体。成分相同，但烹饪方式有点不同。关键是：直到盈利期望变为正数之前什么也不会发生。夏普比率、索提诺比率、詹森比率、特雷纳比率和信息比率都很好，但它们在盈利期望变为正数后才起作用。
- en: 'All of these formulae can be decomposed into two modules:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些公式都可以分解为两个模块：
- en: '**Signal module**: Win/loss rate. These are the returns generated from entry
    and exit signals.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信号模块**：胜率/败率。这些是由入场和出场信号生成的收益。'
- en: '**Money management module**: Average profit/loss. These are contributions generated
    from returns multiplied by bet sizes.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**资金管理模块**：平均利润/亏损。这些是由投注大小乘以收益生成的贡献。'
- en: 'This demystifies the trading edge as something that can be engineered from
    the ground up. Market participants pretend they have superior knowledge of the
    future thanks to their analytical superpowers and machine learning crystal balls.
    Meanwhile, casinos publicly advertise randomness. Still, the former have lumpy
    returns, and the latter consistently print money day-in, day-out. This is not
    a coincidence. The former believe knowledge is an edge, while casinos engineer
    their edge. The job of every market participant is therefore to optimize their
    trading edge. Over the next few chapters, we will consider how to engineer these
    modules and maximize the trading edge, starting with the signal module, before
    moving onto the money management module and position sizing in *Chapter 8*, *Position
    Sizing: Money is Made in the Money Management Module*.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这揭开了交易优势的神秘面纱，将其视为可以从头开始设计的东西。市场参与者假装拥有未来的优越知识，归功于他们的分析超能力和机器学习水晶球。与此同时，赌场公开宣传随机性。然而，前者的回报是零散的，而后者每天都稳定盈利。这不是巧合。前者认为知识是一种优势，而赌场则设计他们的优势。因此，每个市场参与者的工作就是优化他们的交易优势。在接下来的几章中，我们将考虑如何设计这些模块并最大化交易优势，从信号模块开始，然后转向*第8章*中的资金管理模块和头寸大小的问题，*头寸大小：财富创造于资金管理模块中*。
- en: So, without further ado, let's start with the signal module.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，话不多说，让我们开始信号模块。
- en: 'Signal module: entries and exits'
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 信号模块：进场和出场
- en: '"You''ve got to know when to hold ''em,'
  id: totrans-70
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “你必须知道何时坚持，
- en: know when to fold 'em,
  id: totrans-71
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 知道何时放弃，
- en: know when to walk away,
  id: totrans-72
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 知道何时退缩，
- en: and know when to run."
  id: totrans-73
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 也要知道何时退缩。”
- en: ''
  id: totrans-74
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Kenny Rogers, The Gambler
  id: totrans-75
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: – 肯尼·罗杰斯，《赌徒》
- en: 'Let''s start gently by strangling a classical myth once and for all: "you will
    make money as long as you are right 51% of the time." Wrong. By their own admission,
    the industry''s top performers with decades-long track records often claim unimpressive
    long-term win rates. Conversely, LTCM boasted an exceptionally high win rate until
    its liquidation and dissolution in 2000\.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从温和地打击一个古典神话开始：“只要你51%的时间是正确的，你就会赚钱。”错了。按照他们自己的说法，行业顶尖表现者拥有数十年的业绩记录，通常声称长期的赢利率并不令人印象深刻。相反，LTCM在2000年解散前自豪地宣称拥有异常高的赢利率。
- en: You will make money so long as you have a positive trading edge. The first thing
    we need to engineer is the signal module. As we saw in *Chapter 1*, *The Stock
    Market Game*, false positives cannot be eradicated. Randomness is here to stay.
    Every basket comes with a few bad apples. The key is to design policies to spot
    those bad apples, deal with them before they spoil the basket, and move on.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 只要你有一个积极的交易优势，你就能赚钱。我们需要设计的第一件事就是信号模块。正如我们在*第1章*中看到的，*股票市场游戏*，假阳性是无法根除的。随机性会一直存在。每个篮子里都有一些坏苹果。关键是设计政策来发现这些坏苹果，在它们破坏篮子之前处理它们，并继续前进。
- en: 'Entries: stock picking is vastly overrated'
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 进场：选股被高度高估了
- en: '"The beatings will continue until the morale improves."'
  id: totrans-79
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “鞭打将继续，直到士气好转。”
- en: ''
  id: totrans-80
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Captain Bligh, HMS Bounty
  id: totrans-81
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: – 布莱舰长，赏金号
- en: The stock market is the only competitive sport where people like to hand out
    medals before the race starts. The industry is built on the cult of the stock
    picker. Everyone loves to talk about their top stock picks. 90% of the energy
    of market participants is focused on making the right calls. Unfortunately, the
    same 90% of market participants will fail to beat their benchmark 5 years in a
    row.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 股票市场是唯一一个人们喜欢在比赛开始之前颁发奖牌的竞技运动。这个行业是建立在股票选择者的崇拜之上的。每个人都喜欢谈论他们的最佳股票选择。90%的市场参与者的精力都集中在做出正确的决定上。不幸的是，同样90%的市场参与者连续5年都无法击败他们的基准。
- en: 'In quants trader jargon, this is called correlation. When correlation endures
    year after year for every year on record, r-squared, *causality* in quants vernacular,
    goes to 1\. In execution trader English, insanity is when the average frustrated
    market participant puts more and more energy and resources into stock picking
    and yet consistently fails year after year. Bottom line, 90% of market participants
    predictably fail because they consistently focus on the wrong thing: entry. Maybe
    it is time we entertained the possibility of a different approach.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在量化交易员的行话中，这被称为相关性。当相关性在记录的每一年中持续存在时，即使只有一年，r-平方，量化术语中的*因果关系*，都会接近1。在执行交易员的英语中，疯狂就是平均受挫的市场参与者将更多的精力和资源投入到选股中，然而年复一年地一直失败。总之，90%的市场参与者可预测地失败，因为他们一直专注于错误的事情：进场。也许是时候考虑采用不同的方法了。
- en: 'According to Professor Jeremy Siegel, the long-term average return of the stock
    market is +7%. That leaves little room for pleasantries on the short side. Ideas
    are cheap and plentiful. Every single human being has a bag full of million-dollar
    ideas. The difference between ideas and profits is called execution. As we saw
    in *Part I*, *The Inner Game: Demystifying Short Selling*, many market participants
    fail on the short side because they enter when ideas germinate, not when they
    are fully ripe for the picking. Underperformance is the financial equivalent of
    the indigestion we get when we eat fruits that have not ripened yet.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 根据杰里米·西格尔教授的说法，股市的长期平均回报率为+7%。这在空头方面留下了很少的空间来愉快交流。想法很廉价且充足。每个人都有一袋价值百万美元的想法。想法与利润之间的区别称为执行。正如我们在*第一部分*——*内部游戏：解密空头交易*中看到的那样，许多市场参与者在空头方面失败，因为他们是在想法萌芽时进入市场的，而不是在它们成熟可采摘时。表现不佳相当于我们吃未成熟水果时的消化不良。
- en: This book will not give you a silver bullet methodology. The purpose of this
    book is to introduce a probabilistic view of the markets so that you can become
    a statistically better version of yourself. This book is merely a cookbook for
    the ingredients you bring to the table. Fundamental, technical, and quantitative
    short-sellers have all made money, but they could not have succeeded without getting
    probabilities on their side first.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 本书不会给你提供银弹式的方法论。本书的目的是介绍市场的概率视角，以便你可以成为一个统计上更好的自己。这本书只是为你提供菜谱，用来处理你带到桌子上的材料。基本面、技术和量化空头都赚过钱，但他们在获得概率优势之前是不可能成功的。
- en: 'There are two times when you need to be cognizant of probabilities: stock selection
    and entry. In execution trader English, this means there are two times when you
    should listen to what the markets have to say before pulling the trigger.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 有两个时机你需要注意概率：股票选择和进场。用执行交易员的术语来说，这意味着在扣动扳机之前有两个时机你应该听听市场的声音。
- en: First, you need to short stocks that are either in sideways or bear regimes.
    Shorting stocks in a bull regime is like standing on the tracks expecting freight
    trains to stop one after the other. In *Chapter 5, Regime Definition*, we learned
    an objective way to reclassify stocks according to their regime. Since short selling
    is a relative game (stocks' prices dropping in absolute is a laggard indicator),
    regime change often takes the form of sector rotation in the equities market.
    Yesterday's darlings are tomorrow's dogs.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，你需要卖空那些处于横盘或熊市阶段的股票。在牛市中做空股票就像站在铁轨上，期待一列又一列的货运火车停下来一样。在*第5章，制度定义*中，我们学会了根据它们的制度重新分类股票的客观方法。由于做空是一个相对的游戏（股票价格下跌绝对是一种落后的指标），制度变化经常以股票市场的部门轮换的形式出现。昨日的宠儿就是明日的狗。
- en: The second time when you need to be aware of probabilities is entry. Market
    participants coming from the long side like to buy on breakouts. The same logic
    does not translate well on the short side. Remember that almost all market participants
    are in the markets to buy long. Some people have been waiting on the sideline
    for an opportunity to buy on dips. Fast-falling markets are often followed by
    rapid bear market rallies. There is a short window when probabilities are in favor
    of short sellers.
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二个需要关注概率的时机是进入市场。来自多方的市场参与者喜欢在突破时买入。但同样的逻辑在空头方面并不适用。请记住，几乎所有的市场参与者都在市场上做多。一些人一直在等待机会在市场低点买入。快速下跌的市场通常会紧随着迅速的熊市反弹。在短暂的时间内，概率会有利于空头。
- en: 'The best time to enter a short position is when a bear market rally rolls over.
    We will go over the aikido of the short squeeze in *Part III*, *The Long/Short
    Game: Building a Long/Short Product*.'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 进入空头头寸的最佳时机是在熊市反弹结束时。我们将在*第三部分*——*长/短游戏：打造长/短产品*中详细讨论空头挤压的合气道。
- en: We saw earlier a visual representation of gain expectancy. In the following
    chapters, we will look at techniques designed to increase your trading edge. They
    extend beyond short selling. Some may not apply to your style or strategy.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前看到了利润期望的可视化表示。在接下来的章节中，我们将研究旨在增加您交易优势的技术。它们不仅限于空头交易。有些可能不适用于你的风格或策略。
- en: 'Exits: the transmutation of paper profits into real money'
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 离场：纸上利润如何转化为真实资金
- en: The only soldiers who walk into battle without an exit strategy are called kamikaze
    soldiers. They do not expect to come back alive. Since you probably do not expect
    your trading to look like a suicide mission, the best time to develop an exit
    strategy is before you "get boxed in," by entering a position.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: 'In the financial services industry, the only thing cheaper than toilet paper
    are back-tests and simulation print-outs. This is just paper money. No one gets
    hurt. Real money is the only thing that matters. Let''s take the idea one step
    further. The only time when you know how much "real money" was made, or lost,
    is after closing a trade. Anything before that is called paper profit. Bottom
    line: exits matter.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: We have all been conditioned to believe that our initial choices are what matter
    the most. If we have the right internship, graduate from the right university,
    or choose the right first job, then our careers will be smooth. Life, however,
    is what happens to us when we have other plans. We often underestimate the role
    of luck in our lives. Being at the right place at the right time has made a lot
    of lucky people rich. Those individuals however rarely succeed on their first
    attempt. They try, fail, and pivot until something finally clicks.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: Since market participants like to buy and hold, marriage is arguably a sensible
    metaphor. Every marriage starts with an optimistic "happily ever after," yet roughly
    half of them end up as a divorce statistic. Getting married is easy. Getting divorced
    is a life-altering event. If you have not considered the eventuality before getting
    married, then it will be emotionally and financially devastating. Bad marriages
    can be saved. Bad divorces can't. Bad entries can be salvaged. Bad exits can't.
    This is when the P&L gets printed.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: As you will see in the coming chapters, 5 of the 7 steps to increase your trading
    edge deal with losses. Another good analogy is personal finance. There are two
    ways you can increase your savings. Either you maintain your current spending
    and go for a better-paying job, or you restrict your expenses and save the difference.
    The former works well if you have a stable high salary.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: If your earnings are entirely variable, then you would be wiser to maintain
    a low fixed cost base and pocket whatever difference you glean from the markets.
    You will get the same big paydays as the other players, but the difference is
    you will not need them to stay afloat. In financial creole, this focus on expenses
    is called "cutting your losses short."
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of the asset class, there are only two strategies
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Jack Schwager often points out that there is no universal holy grail. Market
    wizards come in all shapes and forms, sometimes even with contradicting strategies.
    They have one thing in common though. They excel at managing risk and controlling
    losses. They consistently focus on the downside. Winning positions take care of
    themselves. Market participants' job is to take care of losers.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: 'Market participants usually define themselves by "what" they trade (asset class,
    markets, time horizon), rarely *"how"* they trade. Regardless of the asset class,
    there are only two types of strategies: trend following and mean reversion. The
    reason why there are only two strategies is not entries but exits. How you choose
    to close a trade determines your dominant trading style. The mean reversion camp
    closes early when inefficiencies are corrected. The trend-following crowd loves
    to ride their winners. A classic example is value versus growth. Value investors
    buy undervalued stocks and then pass the baton to growth investors who ride them
    into the sunset.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 市场参与者通常通过他们交易的“什么”（资产类别、市场、时间跨度）来定义自己，而很少涉及到他们是以何种方式交易。无论资产类别如何，策略类型只有两种：趋势跟随和均值回归。只有两种策略的原因不是入场，而是出场。你如何选择结束一笔交易决定了你的主导交易风格。均值回归派在不效率得到纠正时就提前平仓。趋势跟随者喜欢乘胜追击。一个典型的例子是价值投资与成长投资。价值投资者购买低估股票，然后将接力棒交给成长投资者，由他们将股票持续走高。
- en: For example, a mean reversion market participant would buy a stock at a **Price
    to Book Ratio** (**PBR**) of 0.5, close the position when PBR reverts back to
    1, and move on. A trend follower would buy the same name at the same valuation
    but would ride it deep into euphoric territory. They would eventually close the
    position after this once-obscure, under-researched name would finally make it
    to the "Strong Buy" lists of tier 1 investment banks and predictably underperform
    thereafter.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，一个均值回归的市场参与者会以**市净率**（**PBR**）为0.5的价格买入一只股票，当市净率回到1时平仓，然后离场。而趋势跟随者会以相同的估值买入同样的股票，但会一路持有至狂喜区域。他们最终会在这只曾经默默无闻、未被充分研究的股票被列入一流投资银行的“强力买入”列表后平仓，然后可预见地表现不佳。
- en: 'Some readers may argue that value investors are more the mean reversion kind
    and growth managers the trend following type. That is usually true but not always
    the case. The best counterexample and probably the ultimate value trend follower
    is Warren Buffett. He invests in undervalued businesses that he intends to hold
    ad perpetuum. Your positions are not Philippe Patek watches. You do not hold them
    for future generations. At some point, you will close your positions. Only three
    things can happen: the price goes up, down, or nowhere. You either lose, make,
    or waste money. You need a scenario for each case. You need a plan to realize
    profits, mitigate losses, and deal with freeloaders. Our objective is to engineer
    a better statistical trading edge. If there are only two strategy types, then
    it is important to spend time understanding how they behave, their payoffs, and
    risks, and whether they are mutually exclusive or compatible.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 一些读者可能会认为价值投资者更像是均值回归类型，而成长经理更像是趋势跟随类型。这通常是正确的，但并非总是如此。最好的反例，也可能是终极价值趋势跟随者，是沃伦·巴菲特。他投资于他打算永久持有的低估企业。你的头寸不是百达翡丽手表。你不会为未来的几代人持有它们。在某个时刻，你会平仓。只有三种可能：价格上涨、下跌或不变。你要么亏损、赚钱或浪费钱。你需要为每种情况制定一个方案。你需要一个计划来实现利润，减轻损失，并处理吃白食者。我们的目标是打造一个更好的统计交易优势。如果只有两种策略类型，那么花时间了解它们的行为方式、回报和风险，以及它们是否相互排斥或兼容，就显得非常重
- en: Trend following
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 趋势跟随
- en: '"Money is made in the sitting and waiting."'
  id: totrans-104
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '"财富在于坐等。"'
- en: ''
  id: totrans-105
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Jesse Livermore
  id: totrans-106
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: – 杰西·利弗莫尔
- en: '**Trend following** strategies rely on the capital appreciation of a few big
    winners. systematic **Commodities Trading Advisors** (**CTAs**) look for breakouts
    and place protective trailing stop losses. Technical analysts look for entry points
    and ride the upside. Even fundamental stock pickers qualify as trend followers.
    Instead of price action, they follow improvement in fundamentals, earnings momentum,
    or even news flow. Bottom line, whether they consciously admit it or not, the
    default mode for market participants is trend following. Since trend following
    is the dominant model for market participants, we use a rudimentary trend following
    strategy (turtle for dummies) in this book.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '**趋势跟随**策略依赖于少数几个大赢家的资本增值。系统化的**商品交易顾问**（**CTAs**）寻找突破点并设定保护性的追踪止损。技术分析师寻找入场点并跟随上涨。即使是基本面股票选择者也算是趋势跟随者。他们不是关注价格走势，而是关注基本面改善、盈利势头，甚至是新闻流。归根结底，无论他们是否自觉承认，市场参与者的默认模式都是趋势跟随。由于趋势跟随是市场参与者的主导模式，我们在本书中使用了一种简单的趋势跟随策略（乌龟指标）。'
- en: 'This is what the P&L distribution of trend followers looks like:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是趋势跟随者的损益分布：
- en: '![](img/B17704_06_05.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_05.png)'
- en: 'Figure 6.5: Classic trend-following long/short P&L distribution'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: 'We can observe the following properties:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '**Low win rate**: Somewhere between 30 to 50%. The mode, the peak number of
    trades, is in the loss-making section of the distribution. For every Alphabet,
    Amazon, or Apple, there are countless Nestcapes, Ataris, or MySpaces.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Alpha generation**: Trend-following strategies rely on the capital appreciation
    of a few winners to offset numerous small losses. This introduces a lag between
    profits unfolding over time, and losses promptly denting the equity curve. Losses
    are quickly dealt with while winners take time to mature.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Positive skew**: A right-tailed P&L distribution gives a favorable tail ratio.
    Winners are bigger than losers. The above chart is a visual representation of
    the time-honored "cut your losers, ride your winners." Again, it takes time to
    achieve those outsized returns. Meanwhile, the equity curve has to deal with the
    frog smudge along the way.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cyclicality**: Markets do not trend all the time. Styles come in and out
    of favor. When a style does not work, losses start mounting. Successful trend
    followers are prompt to recognize their mistakes and keep individual losses small.
    When their style is in favor, they ride the trends into the sunset.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Relatively low turnover**: Turnover is a function of cyclicality. When markets
    are trending up or down, there is no need to do anything. Money is made in the
    sitting and waiting, as legendary trader Jesse Livermore used to say. When a style
    goes out of favor, turnover will increase as more frogs will be churned.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Volatility**: This is a consequence of cyclicality. Market participants go
    through periods of lackluster returns.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Trend followers kiss a lot of frogs. The risk is that the cumulative smudge
    of all the delicious batrachians may not outweigh the fairness of a few princesses.
    The risk with trend-following strategies is in the aggregate weight of losses
    over profits.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: The most pertinent risk metric for trend-following strategies is to compare
    cumulative profits and losses. This is the gain-to-pain ratio, also commonly known
    as the profit factor or profitability factor, favored by the prophet Jack Schwager.
    It states that when cumulative profits in the numerator exceed losses, the ratio
    is above 1, and vice versa for loss-making strategies. This is yet another version
    of the arithmetic gain expectancy, as a ratio instead of a delta.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The above code calculates the rolling and cumulative gain-to-pain/profit ratio.
    The structure is symmetrical, so let's concentrate on rolling profits.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: Instantiate a `profit_roll` dataframe by copying the returns series. Assign
    `0` to losses. This will preserve the shape of the dataframe.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Calculate a rolling sum using the `rolling` method. Fill `#N/A` missing values
    using the `fillna` method.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the `rolling_profits` and `rolling_losses` functions, calculate `profit_ratio`.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `rolling` functions are followed by the cumulative versions. The `expanding()`
    method does synthetically the same thing as the popular `cumsum()` method. The
    only difference is that `expanding()` does not reset to `0` when stumbling upon
    missing values, unlike `cumsum()`.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`rolling` 函数后跟着累积版本。`expanding()` 方法在合成上与流行的 `cumsum()` 方法相同。唯一的区别是，当遇到缺失值时，`expanding()`
    不会重置为 `0`，而 `cumsum()` 会重置为 `0`。'
- en: '![](img/B17704_06_06.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_06.png)'
- en: 'Figure 6.6: Softbank cumulative returns and profit ratios: rolling and cumulative'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.6：Softbank 累积回报和利润比率：滚动和累积
- en: The above chart plots the rolling and cumulative profit ratios side by side
    with the signals. The profit ratio nosedives as signals are choppy. Conversely,
    the profit ratio rises in trending markets.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 上图将滚动和累积利润比率与信号并列绘制在一起。随着信号的波动，利润比率急剧下降。相反，在趋势性市场中，利润比率上升。
- en: Trend-following strategies post impressive but volatile performance. They go
    through long periods of underwhelming performance, which take their toll on the
    emotional capital of managers and investors. Their main challenge is to keep cumulative
    losses small. Profits only look big to the extent that losses are kept small.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 追随趋势的策略表现出令人印象深刻但波动较大的绩效。它们经历了长时间的低迷表现，这对管理者和投资者的情绪资本产生了影响。它们的主要挑战是保持累积损失的小额化。利润只有在损失保持较小的情况下才会显得巨大。
- en: To illustrate this phenomenon, one of the original turtle traders used to say
    that, with a 30%+ win rate, they took on positions expecting them to fail. This
    subtle shift in mindset made them more vigilant about risk management.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明这一现象，最初的海龟交易员之一曾经说过，以 30% 以上的胜率，他们承担了预期失败的仓位。这种微妙的心态转变使他们对风险管理更加警惕。
- en: Mean reversion
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 均值回归
- en: '**Mean reversion** strategies compound numerous small profits. They rely on
    the premise that extremes eventually revert to the mean. They arbitrage market
    inefficiencies. Mean reversion strategies essentially capture the time it takes
    for inefficiencies to correct. For example, the price of a warrant may look cheap
    compared to its underlying stock. Over time, prices will converge, and the gap
    will close. They often have low-volatility, consistent performance. They perform
    well during established markets: bull, bear, or sideways. The markets of predilection
    for mean reversion strategies are typically sideways phases where prices oscillate
    in semi-predictable fashions. They may find bull or bear phases more challenging,
    but there is ample empirical evidence of talented managers performing in those
    markets. Again, risk management is what separates the pros from the tourists.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '**均值回归** 策略可以将大量小额利润累积起来。它们依赖于极端情况最终回归平均值的前提。它们套利市场的非效率。均值回归策略实质上捕捉了市场非效率修正所需的时间。例如，一份认股权证的价格可能相对于其基础股票来说便宜。随着时间的推移，价格将会趋同，并且差距将会缩小。它们通常具有低波动性、持续稳定的绩效。它们在建立的市场中表现良好：牛市、熊市或横盘市。均值回归策略的偏好市场通常是价格以半可预测方式振荡的横盘阶段。它们可能会发现牛市或熊市阶段更具挑战性，但有大量的经验数据显示有才华的管理者在这些市场中表现出色。同样，风险管理是专业人士和外行之间的分水岭。'
- en: Mean reversion strategies perform poorly during regime changes. For example,
    long high beta, short low beta will do wonders in a bull market but will give
    back a lot of performance as the regime transitions to sideways and bear. The
    darlings of the last bull market sometimes lead the way down in the ensuing bear
    market. They also perform poorly during tail events. Short gamma funds performed
    well for years until they spectacularly blew up in three weeks during the 2008
    GFC.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 均值回归策略在制度变化期间表现不佳。例如，在牛市中，做多高 beta、做空低 beta 将取得很好的效果，但随着制度过渡到横盘和熊市，这些策略将大幅失去收益。上一次牛市的宠儿有时会在随后的熊市中率先下跌。它们在尾部事件中也表现不佳。做空伽马基金多年来表现良好，直到在
    2008 年全球金融危机期间的三周内惨遭失败。
- en: '![](img/B17704_06_07.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_07.png)'
- en: 'Figure 6.7: Classic long/short mean reversion P&L distribution'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.7：经典的多空均值回归 P&L 分布
- en: 'The characteristics of mean reversion strategies are:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 均值回归策略的特点包括：
- en: '**Alpha generation**: Mean reversion strategies have high turnovers. They **compound**
    small profits quickly.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Alpha 生成**：均值回归策略具有较高的周转率。它们可以迅速积累小额利润。'
- en: '**Negative skew**: Left-tailed P&L distribution. Unfavorable tail ratio: losers
    are bigger than winners. The above chart is a visual representation of the time-honored
    adage "you can''t go broke taking profits." It turns out you probably can if losses
    are too big. Mean reversion strategies arbitrage inefficiencies. Trades are closed
    when inefficiencies are corrected. Sometimes, those inefficiencies persist. Since
    the original premise is that inefficiencies are bound to correct anyways, stop
    losses are not enforced. This leads to rare but devastating blows.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**负偏斜**：左偏 P&L 分布。不利的尾部比率：亏损大于盈利。上述图表是时间荣耀的格言“拿利润你不会破产”（you can''t go broke
    taking profits）的视觉表现。事实证明，如果亏损太大，你可能会破产。均值回归策略利用效率低下进行套利。当效率低下得到纠正时，交易被关闭。有时，这些效率低下会持续存在。由于最初的前提是效率低下无论如何都会得到纠正，所以不会执行止损。这导致了罕见但毁灭性的打击。'
- en: '**High win rate**: Often above 50%. Markets are not efficient all the time
    on all time frames.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高胜率**：通常超过 50%。市场并非始终在所有时间段都是高效的。'
- en: '**Moderate to high turnover**: In practice, inefficiencies appear more frequently
    than the **Efficient Market Hypothesis** (**EMH**) and subsequent academic theories
    generally suggest.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**中高周转率**：实际上，效率低下的情况比**有效市场假说**（**EMH**）和随后的学术理论通常建议的更频繁出现。'
- en: '**Consistent low-volatility small profits**: Mean reversion strategies arbitrage
    multiple small inefficiencies during stable market regimes.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**稳定低波动小利润**：均值回归策略在稳定市场环境中利用多个小的效率低下进行套利。'
- en: '**Potentially devastating left-tail losses**: Mean reversion strategies perform
    in established markets where inefficiencies correct. They fail during regime changes
    when past inefficiencies persist. Interestingly enough, trend-following strategies
    start to perform well right around the time mean reversion strategies falter.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**潜在毁灭性的左尾损失**：均值回归策略在效率得到纠正的成熟市场中表现良好。在制度变革时，过去的效率低下仍然存在时，它们失败了。有趣的是，随着均值回归策略的衰退，趋势跟随策略开始表现良好。'
- en: '**Slow recovery**: Mean reversion strategies bank small profits but post big
    losses. It takes a lot of small wins to offset a few big losses.'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**缓慢的复苏**：均值回归策略积累小利润但产生大损失。需要很多小的胜利来抵消少数大的损失。'
- en: 'As we saw earlier, mean reversion strategies post consistent small profits
    but suffer rare but game-ending setbacks. The risk for mean reversion strategies
    is in the tail. A few devastating losses have the power to sink the ship. After
    all, the captain of the Titanic had a 99% win rate. The most relevant measure
    of risk is therefore the ratio of the biggest profits to the worst losses, or
    tail ratio:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前看到的，均值回归策略持续产生一致的小利润，但遭受罕见但游戏终结性的挫折。均值回归策略的风险在于尾部。几次毁灭性的损失有能力击沉船只。毕竟，泰坦尼克号的船长有
    99% 的胜率。因此，最相关的风险度量是最大利润与最糟糕损失的比率，或尾部比率：
- en: '[PRE8]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The code includes the following steps:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 代码包括以下步骤：
- en: '`cumul_returns`: In this function, `returns` refer to the log returns `np.log(px/px.shift())`.
    Calculate the cumulative returns using the `cumsum()` method and fill the missing
    values.'
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`cumul_returns`：在此函数中，`returns`是指对数收益`np.log(px/px.shift())`。使用`cumsum()`方法计算累积收益并填充缺失值。'
- en: Calculate rolling left and right tails using the `quantile` method.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`quantile`方法计算滚动左尾和右尾。
- en: This series is a bit jumpy—0 in the denominator returns an error, hence the
    error setting to `ignore`.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此系列有点跳跃——分母为 0 会返回错误，因此将错误设置为`ignore`。
- en: Set upper and lower bounds to avoid infinite numbers on each side.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置上下限以避免两侧的无限数。
- en: The resulting chart shows cumulative returns and the rolling and cumulative
    tail ratios.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 所得到的图表显示了累积收益和滚动和累积尾部比率。
- en: '![](img/B17704_06_08.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_06_08.png)'
- en: 'Figure 6.8: Softbank, cumulative returns, and tail ratios: rolling and cumulative'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6.8：Softbank、累积收益和尾部比率：滚动和累积
- en: As you can see, we calculated a 5% tail ratio both on a cumulative and rolling
    basis. As you can see, the tail ratio can veer to infinity or zero quite quickly.
    This is why it should be range-bound via the limit. Note that the tail ratio is
    a lot less responsive than the profit ratio we saw earlier. This ratio does not
    apply to trend following strategies. It is so consistently high that the limit
    had to be lowered to the 5th and 95th percentile to be visible. This goes to illustrate
    that those strategies really have different risk profiles.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您所看到的，我们计算了累积和滚动基础上的5%尾部比率。正如您所看到的，尾部比率很快就会偏向无穷大或零。这就是为什么应该通过极限将其限制在范围内。请注意，尾部比率不像我们之前看到的利润比率那样反应迅速。该比率不适用于趋势跟踪策略。它的一致性非常高，以至于极限必须降低到第5和第95百分位才能看到。这说明了这些策略确实具有不同的风险特征。
- en: Summary
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: Let's recap. The mysterious, mystical, mythical, magical trading edge is nothing
    but a little formula we learned back in school called gain expectancy. Now, it
    turns out that strategies with a positive trading edge tend to fall into two buckets.
    This happens regardless of time frames, asset classes, instrument, and market
    phases. Market participants expect inefficiencies to either correct and revert
    to the mean, or to persist and form trends. Those strategies are mutually exclusive.
    They have opposite payoffs and risk profiles.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下。那神秘的、神秘的、神话般的、神奇的交易优势不过是我们在学校学到的一个叫做收益期望的小公式。现在，事实证明，具有正向交易优势的策略往往分为两大类。这种情况不论时间跨度、资产类别、工具和市场阶段如何。市场参与者期待非效率性要么纠正并恢复到平均水平，要么持续并形成趋势。这些策略是互斥的。它们具有相反的回报和风险特征。
- en: We then took time to understand the properties of each strategy type so that
    we can come up with better ways to engineer a superior trading edge. Now that
    we understand how those strategies behave, the next step is to roll up our sleeves,
    pop the hood, and tune up the signal engine.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们花时间了解了每种策略类型的特性，以便我们能够想出更好的方法来设计一个更优越的交易优势。现在我们了解了这些策略的行为方式，下一步是卷起袖子，打开引擎盖，调整信号引擎。
