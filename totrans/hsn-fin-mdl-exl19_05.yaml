- en: Formulas and Functions - Completing Modeling Tasks with a Single Formula
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 公式和函数 - 用单个公式完成建模任务
- en: One of the first things that makes Excel more than a glorified electronic calculator
    is its use of functions and formulas. This feature allows Excel to combine a number
    of mathematical tasks—some of which can be quite complex—into a single function.
    In this chapter, you will learn how to use formulas and will understand a selection
    of the most widely used functions.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 使 Excel 不仅仅是一个赞美的电子计算器的第一件事之一是它使用函数和公式的功能。这个特性允许 Excel 将许多数学任务（其中一些可能非常复杂）合并成一个单一的函数。在本章中，您将学习如何使用公式，并了解一些最广泛使用的函数。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '本章将涵盖以下主题:'
- en: Understanding functions and formulas
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解函数和公式
- en: Working with lookup functions
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用查找函数
- en: Utility functions
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实用函数
- en: Pivot tables and charts
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 透视表和图表
- en: Pitfalls to avoid
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 避免的陷阱
- en: Understanding functions and formulas
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解函数和公式
- en: In order to enter either a formula or a function, you must first type `=`. A
    **formula** is a statement that includes one or more operands (+, -, /, *, and
    ^), such as `=34+7` or `=A3-G5` (this formula subtracts the contents of cell `G5`
    from the contents of cell `A3`). A function can also be included as part of a
    formula, such as `=SUM(B3:B7)*A3`.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 为了输入公式或函数，你必须先键入 `=`。**公式**是包含一个或多个运算符（+，-，/，* 和 ^）的语句，例如 `=34+7` 或 `=A3-G5`（这个公式从单元格
    `G5` 的内容中减去单元格 `A3` 的内容）。一个函数也可以作为公式的一部分，例如 `=SUM(B3:B7)*A3`。
- en: A **function** is a command that contains a series of instructions for Excel
    to carry out. A function contains one or more arguments, inviting the user to
    specify the input cell or range of cells on which the instructions are to be carried
    out, for example, `MATCH(A5, F4:F23,false)`.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**函数**是包含一系列指令的命令，供 Excel 执行。一个函数包含一个或多个参数，邀请用户指定要执行指令的输入单元格或单元格范围，例如，`MATCH(A5,
    F4:F23,false)`。'
- en: A function can include a formula as part of an argument, such as `=IF(A4*B4>C4,D4,E4)`.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 函数可以包含一个公式作为参数的一部分，例如 `=IF(A4*B4>C4,D4,E4)`。
- en: However, the distinction between them is often ignored and the term formula
    is used to indicate either a formula or function.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，它们之间的区别通常被忽略，并且术语“公式”用来表示公式或函数。
- en: To enter a formula, we start with the `=` sign followed by the name of a function
    and then open brackets. While in edit mode, an on-screen guide is displayed just
    below the text, showing the arguments to be specified. Each argument is separated
    from the next with a comma and the first argument appears in bold font as it is
    the active argument. Once you have specified the input for an argument, press
    the comma (*,*) key. The bold highlight moves onto the next argument as that is
    now the active argument. When all inputs have been specified, we close the brackets
    to end the formula.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 要输入公式，我们以 `=` 符号开始，然后是函数的名称，然后是开括号。在编辑模式下，屏幕下方会显示一个屏幕指南，显示需要指定的参数。每个参数之间用逗号分隔，第一个参数以粗体字显示，因为它是活动参数。一旦指定了参数的输入，按逗号键（*，*）。粗体突出显示移动到下一个参数，因为它现在是活动参数。当所有输入都已指定时，我们关闭括号以结束公式。
- en: Working with lookup functions
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用查找函数
- en: Lookup functions are some of the most widely used functions in Excel. Generally,
    the intention is to fetch a value from one table (the source) to the active cell
    in which you are typing the formula (the target). Essentially, the function guides
    Excel to identify a row and column in the source table. The intersection of that
    row and column will give you the source cell whose value you want to extract.
    For example, say you have a sales report that includes data for various products
    sold within a specified period and you wish to populate a field, `Product Cost`,
    with the cost of each of the products in your report.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 查找函数是 Excel 中使用最广泛的函数之一。通常，意图是从一个表（源）中获取一个值到你正在输入公式的活动单元格（目标）。基本上，该函数指导 Excel
    标识源表中的行和列。该行和列的交叉点将为您提供要提取其值的源单元格。例如，假设您有一个包含在指定期间内销售的各种产品数据的销售报告，您希望在报告中填写一个字段，`产品成本`，并填入每个产品的成本。
- en: 'The following screenshot is a sample sales report showing details of daily
    sales including `Product`, `Salesperson`, and other details:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的屏幕截图是一个示例销售报告，显示了每日销售的详细信息，包括 `产品`，`销售人员` 和其他详细信息：
- en: '![](img/dc2b348c-2839-4b36-8cde-9e7a249f556e.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc2b348c-2839-4b36-8cde-9e7a249f556e.png)'
- en: '`Unit Cost` for each product can be obtained from a products database.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 每个产品的`单价`可以从产品数据库中获取。
- en: 'You could use a lookup function to locate the individual products in the products
    database and then retrieve the associated cost. We will also refer to this table,
    `Products Database`, as our source table. The following screenshot is a sample
    `Products Database` table showing the product codes and unit costs of each product:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用查找函数来定位产品数据库中的各个产品，然后检索相关成本。我们也将这个表称为我们的源表，`产品数据库`。以下截图是一个示例`产品数据库`表，显示了每个产品的产品代码和单价：
- en: '![](img/6bff9976-d417-4a43-a5d4-a047176605c6.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6bff9976-d417-4a43-a5d4-a047176605c6.png)'
- en: In order to ensure that your lookup selects the correct item, you must use a
    unique lookup value that appears in both tables, a value that will uniquely identify
    each record. People could have the same name, so you would use employee IDs rather
    than employee names; similarly, product names could be duplicated, so you would
    use `Product Code` instead.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保你的查找选择了正确的项目，你必须使用一个在两个表中都出现的唯一查找值，一个能够唯一标识每个记录的值。人们可能有相同的名字，所以你应该使用员工ID而不是员工姓名；同样，产品名称可能重复，所以你应该使用`产品代码`。
- en: There are a number of lookup functions, each of them having particular scenarios
    to which they are best suited. We will have a look at some of the more popular
    ones.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多查找函数，每个函数都有特定的适用场景。我们将看一些较为流行的函数。
- en: The VLOOKUP function
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`VLOOKUP`函数'
- en: 'The arguments for `VLOOKUP` are shown in the following screenshot:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '`VLOOKUP`的参数如下截图所示：'
- en: '![](img/b2fc7b77-55ca-435b-9e48-09e82d9cb945.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b2fc7b77-55ca-435b-9e48-09e82d9cb945.png)'
- en: Any argument enclosed in square brackets, `[]`, is optional; therefore, if no
    value is entered for that argument, a default value is taken. Values must be entered
    for all other arguments; otherwise, the formula will result in an error.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 方括号`[]`括起来的任何参数都是可选的；因此，如果没有为该参数输入任何值，则会采用默认值。必须为所有其他参数输入值；否则，公式将导致错误。
- en: For the `VLOOKUP` function, the optional argument is `range_lookup`. This requires
    you to select `True` if you are looking for an approximate match for your lookup
    value or `False` if you are looking for an exact match. Excel allows you to substitute
    `1` for `True` and `0` for `False`. If no value is selected, then the argument
    defaults to `False`.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`VLOOKUP`函数，可选参数是`range_lookup`。这需要你选择`True`，如果你正在寻找查找值的近似匹配，或者选择`False`，如果你正在寻找确切的匹配。Excel允许你将`1`替换为`True`，将`0`替换为`False`。如果未选择任何值，则参数默认为`False`。
- en: This function tells Excel to find the lookup value in the first column from
    the left of the lookup array that you specify. Note that this may not be the first
    column of the source table.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这个函数告诉Excel在你指定的查找数组中从左边的第一列中找到查找值。请注意，这可能不是源表的第一列。
- en: 'In our example, the lookup value is a product code; therefore, for the first
    record in our sales report, the lookup value is `BN001`, which is in cell **D5**. The
    following screenshot shows the construction of the `VLOOKUP` formula in the `Sales
    Report` table:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，查找值是一个产品代码；因此，对于我们销售报告中的第一条记录，查找值是`BN001`，位于单元格**D5**。下面的截图显示了在`销售报告`表中构建`VLOOKUP`公式：
- en: '![](img/1e6d3587-70ec-4921-922d-d82d4d73a07b.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1e6d3587-70ec-4921-922d-d82d4d73a07b.png)'
- en: 'Our lookup array must start from column **C** in the `Products Database` table
    as this is where the `Product Code` field lies—note that this is the second column
    of the `Products Database` table. Excel will then locate the position of the lookup
    value in this first column, as shown in the following screenshot:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的查找数组必须从`产品数据库`表的第**C**列开始，因为这是`产品代码`字段所在的地方——请注意，这是`产品数据库`表的第二列。然后Excel将在此第一列中定位查找值的位置，如下截图所示：
- en: '![](img/466d78a8-02cf-41d2-a9ba-a88c97445980.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/466d78a8-02cf-41d2-a9ba-a88c97445980.png)'
- en: From the preceding screenshot, we can see that product `BN001` is in row **11**
    of the `Products Database` table, in the `Product Code` field.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 从上述截图中，我们可以看到产品`BN001`在`产品数据库`表的第**11**行，在`产品代码`字段中。
- en: 'The next argument is the `column_index_num` (column index number) value, which
    refers to the position of the source field in the lookup array, starting from
    the unique field as column **1**. The **source field** is the field from which
    you want to retrieve data. In our example, the source field is `Unit Cost`, which
    is column **D**, the second column of our lookup array. This gives us `col_index_num`
    of `2`:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个参数是 `column_index_num`（列索引号）值，它指的是从唯一字段开始的查找数组中源字段的位置。**源字段** 是您要检索数据的字段。在我们的示例中，源字段是
    `Unit Cost`，即 `D` 列，我们查找数组的第二列。这给了我们 `col_index_num` 为 `2`：
- en: '![](img/c4e4ec7b-9472-4784-bd45-2e759040cbec.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c4e4ec7b-9472-4784-bd45-2e759040cbec.png)'
- en: 'In this way, we have identified column **D** and row **11** for the source
    cell. Excel will then retrieve the data from cell **D11** (`65,000`) and place
    it in our target cell in the `Sales Report` table:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 这样，我们已经确定了源单元格的列 **D** 和行 **11**。然后，Excel 将从单元格 **D11**（`65,000`）检索数据，并将其放置在我们的目标单元格中
    `销售报告` 表中：
- en: '![](img/e5670fc6-ffc3-4dc9-82f8-fa60e81bf45f.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e5670fc6-ffc3-4dc9-82f8-fa60e81bf45f.png)'
- en: Once you have completed your formula and successfully extracted the unit cost for
    the first record in our `Sales Report` table, copy the formula down the column
    for the other records in the `Sales Report` table.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 完成公式并成功提取我们 `销售报告` 表中第一条记录的单位成本后，将公式复制到 `销售报告` 表中其他记录的列中。
- en: The INDEX function
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: INDEX 函数
- en: 'The `INDEX` and `MATCH` functions are usually used together. The `INDEX` function
    has the arguments to specify the row and column of the source cell. In order to
    make the formula dynamic, you substitute `MATCH` for the `INDEX` argument, for
    the row, column, or both. This is a very powerful formula that has arguments for
    both arrays and simple formulas:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '`INDEX` 和 `MATCH` 函数通常一起使用。 `INDEX` 函数具有用于指定源单元格行和列的参数。为了使公式动态化，您将 `MATCH`
    替换为 `INDEX` 参数，用于行、列或两者。这是一个非常强大的公式，具有用于数组和简单公式的参数：'
- en: '![](img/8e6034e9-edc7-4f1c-b8db-999490989795.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8e6034e9-edc7-4f1c-b8db-999490989795.png)'
- en: The first line of arguments of the `INDEX` formula is for the array range. Array
    formulas return a range of values as opposed to just one—as is the case with simple
    formulas. We will touch on array formulas later in this book, but for now, we
    will concentrate on simple formulas.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '`INDEX` 公式的参数的第一行用于数组范围。数组公式返回一系列值，而不仅仅是一个值——这与简单公式的情况不同。我们将在本书后面讨论数组公式，但现在我们将集中在简单公式上。'
- en: The second line of arguments is for the reference form. The first argument requires
    the reference that is similar to the lookup array in `VLOOKUP`. In simple index
    formulas, this could be restricted to a range of cells within one column (or within
    one row).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 参数的第二行用于引用形式。第一个参数需要与 `VLOOKUP` 中的查找数组相似的引用。在简单的索引公式中，这可以限制为一个列内的单元格范围（或者一个行内的单元格范围）。
- en: 'If you restrict the index reference to one column, you have effectively identified
    the column of the source cell. In our example, we have selected cells `D5` to
    `D13` as our reference:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 如果将索引引用限制为一列，则实际上已经确定了源单元格的列。在我们的示例中，我们选择了单元格 `D5` 到 `D13` 作为我们的参考：
- en: '![](img/60699711-ede2-4e32-9420-111dfb3257d1.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/60699711-ede2-4e32-9420-111dfb3257d1.png)'
- en: The next argument is `row_num`. In order to substitute it for the `row` argument,
    you will need to embed the `MATCH` function within the `INDEX` function, which
    is still active. To do this, just start typing the new function after the comma.
    As long as you have not yet entered the final parentheses for a function, Excel
    recognizes that the formula is still active, so there is no need to type `=` again.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个参数是 `row_num`。为了将其替换为 `row` 参数，您需要将 `MATCH` 函数嵌入到仍然活动的 `INDEX` 函数中。要做到这一点，只需在逗号后开始键入新函数。只要您尚未为函数输入最终括号，Excel
    就会认识到公式仍然活动，因此无需再次键入 `=`。
- en: The MATCH function
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MATCH 函数
- en: The first argument in the `MATCH` function is the `lookup_value` argument, which
    you look for in the lookup array. In this case, however, there is no restriction
    as to the location of the lookup array. We are using the same lookup value as
    in the `VLOOKUP` example, `BN001`, in cell **D5** of the `Sales Report` worksheet.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '`MATCH` 函数中的第一个参数是 `lookup_value` 参数，它在查找数组中查找。但在这种情况下，对于查找数组的位置没有限制。我们在 `销售报告`
    工作表的单元格 **D5** 中使用与 `VLOOKUP` 示例相同的查找值 `BN001`。'
- en: 'Here, again, as shown in the following screenshot, you can restrict the lookup
    array to one column. In our example, we know that the match for our lookup values
    are under the `Product Code` field in column **C** of the `Products Database`
    worksheet. We therefore select cells `C5` to `C13` as our lookup array:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 再次在以下截图中显示，您可以将查找数组限制为一列。在我们的示例中，我们知道我们的查找值的匹配项在“产品数据库”工作表的第 **C** 列的`产品代码`字段下。因此，我们选择单元格
    `C5` 到 `C13` 作为我们的查找数组：
- en: '![](img/ee564412-ae6a-4074-9f60-5b4b05a94948.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ee564412-ae6a-4074-9f60-5b4b05a94948.png)'
- en: Note that the `MATCH` lookup array must start from the same worksheet row as
    the reference in the `INDEX` function. In our example, they both start from worksheet
    row **5**. You end the match formula with `match_type`, which is the same as `range_lookup`
    in the `VLOOKUP` function. You need to specify whether you want an approximate
    match, less than (`1`), greater than the lookup value (`-1`), or an exact match
    (`0`).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`MATCH` 查找数组必须从与 `INDEX` 函数中的引用相同的工作表行开始。在我们的示例中，它们都从工作表行 **5** 开始。您用 `match_type`
    结束匹配公式，其与 `VLOOKUP` 函数中的 `range_lookup` 相同。您需要指定是否要近似匹配、小于（`1`）、大于查找值（`-1`）或精确匹配（`0`）。
- en: The `MATCH` function returns an integer that corresponds to the position of
    the row within the lookup array in which the lookup value is found. This should
    not be mistaken for the worksheet row number.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '`MATCH` 函数返回一个整数，该整数对应于在查找数组中找到查找值的行的位置。这不应与工作表行号混淆。'
- en: In our example, the `MATCH` function will return the number `7` because the
    lookup value, `BN001`, is found in the 7^(th) row of our lookup array—worksheet
    row **11**. As soon as you close the final bracket of the `MATCH` formula, Excel
    takes you back to the `INDEX` function.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例中，`MATCH` 函数将返回数字 `7`，因为查找值 `BN001` 在我们的查找数组——工作表行 **11** 的第 7 行中找到。一旦您关闭
    `MATCH` 公式的最后一个括号，Excel 就会带您回到 `INDEX` 函数。
- en: The next argument is `column_num`. As we have already determined the column
    number by restricting our reference to one column, we can ignore this argument.
    The final argument, `area_num`, is for more complex situations where we introduce
    a third dimension after row and column, such as multiple tables with the same
    field layouts. Again, we can ignore this argument as we will not be using it.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个参数是 `column_num`。由于我们已经通过限制我们的引用到一列来确定了列号，因此我们可以忽略此参数。最后一个参数 `area_num` 用于更复杂的情况，例如在行和列之后引入第三维，比如具有相同字段布局的多个表。同样，我们可以忽略此参数，因为我们不会使用它。
- en: Having identified row **7** and column **D**, we now have the source cell, **D11**,
    which returns the value of `65000`. You will note that `INDEX` and `MATCH` overcome
    the restriction in `VLOOKUP`, where the unique field must be the first column
    of the lookup array.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 找到了第 **7** 行和第 **D** 列后，现在我们有了源单元格 **D11**，其返回值为 `65000`。您会注意到 `INDEX` 和 `MATCH`
    克服了 `VLOOKUP` 中的限制，其中唯一字段必须是查找数组的第一列。
- en: As a result, many users prefer to use `INDEX` and `MATCH`, even where `VLOOKUP`
    would work. Those who are intimidated by the function combination of `INDEX` and
    `MATCH` prefer to stick to `VLOOKUP` and would rather change the order of table
    columns to make it suitable for `VLOOKUP`.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，许多用户更喜欢使用 `INDEX` 和 `MATCH`，即使 `VLOOKUP` 也可以工作。那些被 `INDEX` 和 `MATCH` 的函数组合吓倒的人更喜欢坚持使用
    `VLOOKUP`，他们宁愿改变表列的顺序以使其适用于 `VLOOKUP`。
- en: The CHOOSE function
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '`CHOOSE` 函数'
- en: 'The `CHOOSE` function allows you to create a list of values or actions to perform
    and then select which value to use or action to perform, by choosing a number
    corresponding to the position of the values or actions in the list. The syntax
    for `CHOOSE`—as shown in the following screenshot—has two arguments: `index_num`,
    then the list of values or actions shown as `value1`, `value2`, and so on.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '`CHOOSE` 函数允许您创建一个值或要执行的操作列表，然后通过选择列表中值或操作的位置来选择要使用的值或要执行的操作。`CHOOSE` 的语法如下截图所示，有两个参数：`index_num`，然后是作为
    `value1`、`value2` 等显示的值或操作的列表。'
- en: 'This screenshot shows the arguments of the `CHOOSE` function:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 此截图显示了 `CHOOSE` 函数的参数：
- en: '![](img/3ff352b8-3034-4a55-b1e7-569a51682d75.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3ff352b8-3034-4a55-b1e7-569a51682d75.png)'
- en: 'In the example shown here, we want to show the results separately from the
    average and median of the product unit costs in the `Products Database` worksheet.
    We first set up data validation in an empty cell, so that the values of `1` or
    `2` can be selected by clicking the drop-down arrow that appears beside the cell.
    The cell with the data validation will be `index_num` of the `CHOOSE` formula.
    This is a screenshot of the data validation:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们希望将产品单位成本的平均值和中位数分别显示在`Products Database`工作表中。 我们首先在一个空单元格中设置数据验证，以便通过单击旁边出现的下拉箭头来选择值`1`或`2`。
    具有数据验证的单元格将是`CHOOSE`公式的`index_num`。 这是数据验证的屏幕截图：
- en: '![](img/332851f0-fc38-4b48-b4bd-83b6fe1a7223.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/332851f0-fc38-4b48-b4bd-83b6fe1a7223.png)'
- en: 'We then list the actions to choose from. In this case, we have the average
    or the median. If we list them in that order, then if `index_num` shows `1`, the
    average will be selected, and if it shows `2`, then median will be selected. The
    following screenshot shows the complete `CHOOSE` formula:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们列出要选择的操作。 在这种情况下，我们有平均值或中位数。 如果我们按照这个顺序列出它们，那么如果`index_num`显示`1`，则将选择平均值，如果显示`2`，则将选择中位数。
    以下屏幕截图显示完整的`CHOOSE`公式：
- en: '![](img/0943a2fe-fb65-43dc-ac62-bdcc6e1f2286.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0943a2fe-fb65-43dc-ac62-bdcc6e1f2286.png)'
- en: 'When the index number is `1`, the `AVERAGE` function is selected, and it returns
    the value `43,444.44`. This is a screenshot of the `CHOOSE` function with `Index_Num`
    as `1`:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 当索引编号为`1`时，选择`AVERAGE`函数，并返回值`43,444.44`。 这是`CHOOSE`函数的屏幕截图，其中`Index_Num`为`1`：
- en: '![](img/2f951ce8-2884-4b96-9641-e2699cbe8fbe.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2f951ce8-2884-4b96-9641-e2699cbe8fbe.png)'
- en: 'When the index number is `2`, the `MEDIAN` function is selected, and it returns
    the value `45,000.00`. This is a screenshot of the `CHOOSE` function with `Index_Num`
    as `2`:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 当索引编号为`2`时，选择`MEDIAN`函数，并返回值`45,000.00`。 这是`CHOOSE`函数的屏幕截图，其中`Index_Num`为`2`：
- en: '![](img/0dc323a8-9f54-4f3b-bf5a-485c774610ac.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0dc323a8-9f54-4f3b-bf5a-485c774610ac.png)'
- en: Implementing the CHOOSE function
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实施`CHOOSE`函数
- en: Let's assume that you are tracking the financial records of your company and
    your boss wants you to deliver two reports every week, containing the total amount
    of sales that you made for a particular week and the total amount of purchases
    you made toward the company's stores. How would you go about it?
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 假设您正在跟踪公司的财务记录，并且您的老板希望您每周提交两份报告，其中包含您在特定周的销售总额和您对公司商店的购买总额。 你会怎么做？
- en: 'You can always select all of the instances of sales and then calculate the
    sum of them. Once that is done, you have to again select all instances of purchases
    made and find the sum of purchases too. Having to do so frequently would be really
    time-consuming and boring. Here''s where the `CHOOSE` function comes into play!
    We can implement a simple model that does everything for you in one click, using
    the following steps:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以随时选择所有销售实例，然后计算它们的总和。 一旦完成，您必须再次选择所有购买实例，并找到购买的总和。 这样频繁地做会非常耗时和乏味。 这就是`CHOOSE`函数发挥作用的地方！
    我们可以实现一个简单的模型，一键完成所有操作，以下是使用以下步骤：
- en: 'Load all of the required values that you need to account for and compile them
    into a table, as seen here:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载您需要核算的所有必需值并编制成表格，如下所示：
- en: '![](img/f11400ae-fbd1-4910-9d50-552f213993f1.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f11400ae-fbd1-4910-9d50-552f213993f1.png)'
- en: 'We will now start writing the `CHOOSE` function:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们将开始编写`CHOOSE`函数：
- en: '![](img/8b73489c-8ead-49bb-8b56-406ee1c90be5.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8b73489c-8ead-49bb-8b56-406ee1c90be5.png)'
- en: 'The first value we need to enter is the cell where we have put the options,
    which, in our case, is `F4`:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要输入的第一个值是我们放置选项的单元格，对我们来说是`F4`：
- en: '![](img/80b6ae9c-b0ed-46db-bfbb-5c6eb9e595b8.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/80b6ae9c-b0ed-46db-bfbb-5c6eb9e595b8.png)'
- en: 'Now, we will assign two options to `F4`, `1` and `2`, using data validation.
    We will now edit the formula so that if we select `1`, the cell where the formula
    is input will display the sum of all of the sales made for that week, and if we
    select `2`, it will display the sum of all of the purchases. So, first we will
    select all of the cells in the `Sales` column, `C6` to `C14`, and input it into
    the formula cell as `SUM(C6:C14)`, as seen here:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将为`F4`分配两个选项，`1`和`2`，使用数据验证。 现在我们将编辑公式，以便如果我们选择`1`，则输入公式的单元格将显示该周所有销售额的总和，如果我们选择`2`，它将显示所有购买的总和。
    所以，我们首先将选择`Sales`列中的所有单元格，从`C6`到`C14`，并将其输入到公式单元格中，如下所示：`SUM(C6:C14)`。
- en: '![](img/00b805d0-57fa-4435-9af5-03ec789cd996.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00b805d0-57fa-4435-9af5-03ec789cd996.png)'
- en: 'Next, we will select all of the cells in the `Purchases` column and input those
    into the next field of the formula as `SUM(D6:D14)`, as follows:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将选择`Purchases`列中的所有单元格，并将它们输入到公式的下一个字段中作为`SUM(D6:D14)`，如下所示：
- en: '![](img/914ff6b7-0cd4-42b4-9e5f-b265ba164761.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](img/914ff6b7-0cd4-42b4-9e5f-b265ba164761.png)'
- en: 'This results in the following output:'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这导致以下输出：
- en: '![](img/3e183e29-4bc1-4bc1-9c39-8286ac740884.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3e183e29-4bc1-4bc1-9c39-8286ac740884.png)'
- en: Now, as seen in the preceding screenshot, when `1` is selected, the cost of
    sales becomes visible, which, in our case, is `315,455.00`.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如前面的屏幕截图所示，当选择`1`时，销售成本变得可见，这在我们的情况下是`315,455.00`。
- en: 'If we select `2`, we will get the cost of purchases, as seen here:'
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们选择`2`，我们将得到购买成本，如下所示：
- en: '![](img/1bfeaf48-b523-4654-813e-3ff10410dc27.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1bfeaf48-b523-4654-813e-3ff10410dc27.png)'
- en: This is just a basic scenario in which the function can come in handy. This
    will be particularly useful when you have large amounts of data that needs to
    be filtered and sorted.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个基本的场景，函数可以派上用场。当您需要对大量需要进行过滤和排序的数据时，这将非常有用。
- en: Utility functions
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实用函数
- en: Utility functions can be used on their own. However, they come into their own
    when embedded in other, more complex functions. In such cases, they expand the
    scope and functionality of the enclosing function by providing access to more
    conditions or variables.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 实用函数可以单独使用。但是，在嵌入到其他更复杂的函数中时，它们才能充分发挥作用。在这种情况下，它们通过提供对更多条件或变量的访问来扩展封闭函数的范围和功能。
- en: Some examples of utility functions are `IF`, `AND`, `OR`, `MAX`, `MIN`, and `MATCH`.
    We will now look at a few of them here.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 一些实用函数的示例是`IF`、`AND`、`OR`、`MAX`、`MIN`和`MATCH`。我们现在将在这里看一些。
- en: The IF function
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: IF函数
- en: 'This is one of the most widely used functions in Excel. It can be used on its
    own or as part of another formula. The `IF` function checks whether a condition
    is met, then returns one value if it is and another value if it isn''t. The syntax
    contains three arguments:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 这是Excel中最常用的函数之一。它可以单独使用或作为另一个公式的一部分。`IF`函数检查条件是否满足，然后如果满足，则返回一个值，否则返回另一个值。语法包含三个参数：
- en: '`logical_test`: The logical test is a statement that returns a value of `true`
    if the condition is met, or `false` if the condition is not met.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`logical_test`：逻辑测试是一个语句，如果满足条件则返回`true`，如果不满足条件则返回`false`。'
- en: '`value_if_true`: This argument allows you to specify which value you wish to
    be returned if the condition is met and the result of the logical test is `true`.'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_if_true`：此参数允许您指定在满足条件并且逻辑测试的结果为`true`时要返回的值。'
- en: '`value_if_false`: This argument allows you to specify which value you wish
    to be returned if the condition is not met and the result of the logical test
    is `false`.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`value_if_false`：此参数允许您指定如果条件未满足且逻辑测试的结果为`false`时要返回的值。'
- en: 'Say you want to reward your salespersons with `2%` of sales whenever the profit
    exceeds `300,000`. You could write an `IF` formula to automate this. The logical
    test would be the statement—profit is greater than `300,000`. In the following
    example, for the first record, this is `K5>K2`. The statement will either be `true`
    or `false`. If the result is `true`, the value to return is then `Sales` × `Commission`
    (`2%`). In our example, this is `H5*H2`. If the result is `false`, then the value
    returned will be `0`. The following screenshot is an illustration of the `IF`
    formula:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你想要以`300,000`利润超过时销售额的`2%`奖励你的销售人员。你可以编写一个`IF`公式来自动执行此操作。逻辑测试将是该语句——利润大于`300,000`。在以下示例中，对于第一条记录，这是`K5>K2`。该语句将是`true`或`false`。如果结果是`true`，则返回值将是`Sales`
    × `Commission`（`2%`）。在我们的示例中，这是`H5*H2`。如果结果是`false`，则返回的值将为`0`。以下屏幕截图是`IF`公式的示例：
- en: '![](img/704e5d46-0e56-43b1-b6b4-613727813bb3.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/704e5d46-0e56-43b1-b6b4-613727813bb3.png)'
- en: The MAX and MIN functions
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: MAX和MIN函数
- en: These functions are used to select either the maximum (`MAX`) or minimum (`MIN`)
    from a list of values. With a bit of imagination, you can put the `MAX` or `MIN` formulas
    to very efficient use.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 这些函数用于从值列表中选择最大值（`MAX`）或最小值（`MIN`）。稍加想象，您可以非常高效地使用`MAX`或`MIN`公式。
- en: For example, in your financial model, `Cash Balance` can turn out to be positive
    or negative. A positive balance would be posted to the `Cash In Hand` account
    on the asset side of the balance sheet, while a negative balance would be shown
    as `Overdraft` under current liabilities. If we simply related `Cash In Hand`
    or `Overdraft` to `Cash Balance`, then we could either have a negative balance
    displayed as `Cash In Hand` or a positive balance displayed as `Overdraft`.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在你的财务模型中，`现金余额`可能是正数或负数。正余额将被记在资产负债表的资产侧的`手头现金`账户下，而负余额将显示为流动负债下的`透支`。如果我们简单地将`手头现金`或`透支`与`现金余额`相关联，那么我们可能会将负余额显示为`手头现金`，或者将正余额显示为`透支`。
- en: 'A way around this is to use the `MAX` and `MIN` formulas as shown in the following
    screenshot:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 解决这个问题的一种方法是使用`MAX`和`MIN`公式，如下所示的屏幕截图：
- en: '![](img/c8e3384a-e5f0-4545-8afc-aa9d796f5431.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c8e3384a-e5f0-4545-8afc-aa9d796f5431.png)'
- en: In the preceding screenshot, we are asking the `MAX` formula to display the
    greater value of `Cash Balance` and `0`. A positive cash balance will always be
    greater than `0` and will hence be displayed as `Cash In Hand`. However, whenever
    the cash balance is negative, since this will always be less than `0`, `Cash In
    Hand` will display `0`.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述屏幕截图中，我们要求`MAX`公式显示`现金余额`和`0`的较大值。正现金余额始终大于`0`，因此将显示为`手头现金`。然而，每当现金余额为负数时，由于这总是小于`0`，`手头现金`将显示`0`。
- en: 'The following screenshot is an illustration of the `MIN` function:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 以下屏幕截图是`MIN`函数的示例：
- en: '![](img/479cbc93-ef16-4523-b9b2-b787b8428b88.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](img/479cbc93-ef16-4523-b9b2-b787b8428b88.png)'
- en: In this case, we use the `MIN` formula to ensure that only negative cash balances
    will be displayed as `Overdraft`, since a negative cash balance will always be
    less than `0`.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们使用`MIN`公式确保只有负现金余额将显示为`透支`，因为负现金余额始终小于`0`。
- en: 'By copying the formulas, we can see how the cash balances have been neatly
    and accurately classified as `Cash In Hand` and `Overdraft`, as shown in the following
    screenshot, which shows the full result after applying the `MAX` and `MIN` formulas:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 通过复制公式，我们可以看到现金余额已被整齐而准确地分类为`手头现金`和`透支`，如下所示的完整结果屏幕截图：
- en: '![](img/8fde2d17-cb1e-4ebb-8111-1f6db349471e.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8fde2d17-cb1e-4ebb-8111-1f6db349471e.png)'
- en: Implementing the functions
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现函数
- en: 'We will now implement the `MAX` and `MIN` functions to the `Marks.xlsx` file used
    in [Chapter 4](e28955dc-8534-4e5a-b235-2973ac690e86.xhtml), *Applying the Referencing
    Framework in Excel*. We will use the `MAX` function to find the highest score
    in the class and the `MIN` function to find the lowest using the following steps:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在将`MAX`和`MIN`函数应用于[第四章](e28955dc-8534-4e5a-b235-2973ac690e86.xhtml)中使用的`Marks.xlsx`文件，*在Excel中应用引用框架*。我们将使用`MAX`函数来找到班级中最高的分数，并使用`MIN`函数来找到最低分，步骤如下：
- en: 'First, we will create two independent cells that we will use to display the
    highest and lowest scores, as follows:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将创建两个独立的单元格，用于显示最高分和最低分，如下所示：
- en: '![](img/6ea3287e-629c-4702-8069-ee6dfb1ee964.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6ea3287e-629c-4702-8069-ee6dfb1ee964.png)'
- en: 'Now, to find the student with the highest score, we will find the biggest value
    in the `Percentage` column, by using the following formula:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，要找出分数最高的学生，我们将使用以下公式找到`百分比`列中的最大值：
- en: '![](img/df2a2153-c00a-4d58-8002-1abdc83a7e42.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/df2a2153-c00a-4d58-8002-1abdc83a7e42.png)'
- en: 'This results in the following output:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下输出：
- en: '![](img/a4087180-7c7e-4bce-88ee-f5b1629fa6a0.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a4087180-7c7e-4bce-88ee-f5b1629fa6a0.png)'
- en: 'Similarly, we need to find the minimum marks scored by a student by using the
    following formula:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 类似地，我们需要使用以下公式找出学生的最低分数：
- en: '![](img/a3b08655-390d-4e70-9d37-a4eb9dadd1f8.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a3b08655-390d-4e70-9d37-a4eb9dadd1f8.png)'
- en: 'This results in the following output:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下输出：
- en: '![](img/161b9eae-a42c-4c4f-99b5-d22fc1d5d3b2.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/161b9eae-a42c-4c4f-99b5-d22fc1d5d3b2.png)'
- en: This shows how useful these functions can be, especially when you have a huge
    number of entries to sort through.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 这展示了这些函数有多么有用，尤其是当你有大量条目需要整理时。
- en: Pivot tables and charts
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据透视表和图表
- en: Pivot tables are one of the most powerful tools in Excel. A pivot table can
    summarize little or large amounts of data into a compact form, which reveals trends
    and relationships that were not apparent from looking at the original data.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 数据透视表是Excel中最强大的工具之一。数据透视表可以将少量或大量数据汇总成简洁的形式，从而揭示原始数据中看不出的趋势和关系。
- en: The pivot table allows you to introduce conditions based on the original data
    so that you can view the summarized data from different perspectives. It does
    all of this without you having to type any formulas. Most users are under the
    impression that pivot table reports are complex and difficult to prepare; but
    in reality, the complexity is behind the scenes and taken care of by Excel. All
    you have to do is follow a few simple guidelines and you will be able to produce
    complex pivot tables with ease.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 透视表允许您根据原始数据引入条件，以便您可以从不同角度查看汇总数据。它所有这些都不需要您输入任何公式。大多数用户认为透视表报告复杂且难以准备；但实际上，复杂性在幕后由
    Excel 处理。您只需要遵循一些简单的指导方针，就能轻松生成复杂的透视表。
- en: The first step is to ensure that your data is in the proper Excel table format,
    bearing in mind that you may have to work with data prepared by someone else.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是确保您的数据处于正确的 Excel 表格格式中，要记住您可能需要处理由他人准备的数据。
- en: 'Excel identification and navigation shortcuts depend on your table being in
    the proper format. Most actions require the specification of the target range.
    Excel can correctly identify the required range and isolate the field headers,
    but only if the data is in the proper table format, which can be seen in the following
    screenshot:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: Excel 的识别和导航快捷键取决于您的表格是否处于正确的格式中。大多数操作都需要指定目标范围。Excel 可以正确识别所需范围并分离字段标题，但前提是数据必须处于正确的表格格式中，如下图所示：
- en: '![](img/30f514da-6c3f-41db-8d7b-d56575f7d5ad.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![](img/30f514da-6c3f-41db-8d7b-d56575f7d5ad.png)'
- en: In database terminology, each column of the table represents a field, and each
    row (apart from the first row) represents a record. The first row of the table
    should contain the field headers. There should be no empty cells in the table
    and no duplicate records.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据库术语中，表的每一列代表一个字段，每一行（除了第一行）代表一条记录。表的第一行应包含字段标题。表中不应该有空单元格，也不应该有重复记录。
- en: Excel is very efficient at detecting data types and handling different forms
    of date format, including `15/01/2019`, `15-Jan-19`, `15-01-2019`, `01-15-2019`,
    and `2019-01-15`, among others. However, Excel is very sensitive and any slight
    anomaly in the data may produce erratic results. For example, if you inadvertently
    type a leading space before the date—as in the image on the left-hand side of
    the following screenshot—Excel treats it as a `General` data type.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Excel 在检测数据类型和处理不同形式的日期格式方面非常高效，包括`15/01/2019`、`15-Jan-19`、`15-01-2019`、`01-15-2019`和`2019-01-15`等。然而，Excel
    非常敏感，数据中的任何轻微异常都可能导致不稳定的结果。例如，如果您在日期之前无意中键入一个前导空格—就像以下截屏图左侧的图像一样—Excel 会将其视为`General`数据类型。
- en: 'The image on the right-hand side of the following screenshot shows the same
    text without the leading space; therefore, Excel correctly recognizes it as a
    date and automatically assigns the `Date` format to the cell:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 下图右侧的图像显示了相同的文本，没有前导空格；因此，Excel 正确识别它为日期，并自动将`Date`格式分配给单元格：
- en: '![](img/cd765230-a9ec-46f6-99cf-f8ebe3f84dc1.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cd765230-a9ec-46f6-99cf-f8ebe3f84dc1.png)'
- en: The reason for explaining this in detail is because pivot tables have a special
    relationship with date and other data types. If a date field is included in your
    table, the pivot table will recognize it and allow you to group the dates into
    days, months, quarters, and years. However, if just one cell of the date field
    has an anomaly—like in the preceding example—the pivot table will not recognize
    it as a date and the group option will be unavailable. Once your data has been
    cleaned up and prepared, you are ready to create a pivot table. Ensure that the
    cursor is in any cell within the table, then press *Insert* and select PivotTable
    from the Tables group. The Create PivotTable dialog box is launched. You will
    be required to select a range and then a location for the pivot table report.
    Excel will usually intelligently guess the correct range for the pivot table;
    but if it doesn't, you can manually select the required range.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 详细解释这一点的原因是透视表与日期和其他数据类型有特殊关系。如果表中包含日期字段，透视表将识别它并允许您将日期分组为日、月、季度和年。然而，如果日期字段中只有一个单元格有异常—就像前面的例子一样—透视表将不会将其识别为日期，并且组选项将不可用。一旦您的数据已经清理和准备好，您就可以创建一个透视表。确保光标在表中的任何单元格中，然后按下*插入*并从“表”组中选择“透视表”。创建透视表对话框会被启动。您将需要选择一个范围，然后选择透视表报告的位置。Excel
    通常会智能猜测透视表的正确范围；但如果没有，您可以手动选择所需的范围。
- en: 'Although you can place the pivot table on the same sheet as the source data,
    this can sometimes become congested. By default, Excel will create the pivot table
    on a new worksheet. Again, you can override this, if you wish, and specify a location
    on either the same or another worksheet:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然您可以将数据透视表放在与源数据相同的工作表上，但有时这可能会变得拥挤。默认情况下，Excel将在新工作表上创建数据透视表。如果需要，您可以再次覆盖此设置，并指定在相同或另一个工作表上的位置：
- en: '![](img/9a22f642-5052-4848-934a-0ed0ff780620.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9a22f642-5052-4848-934a-0ed0ff780620.png)'
- en: When you press OK, a pivot table will be created. Initially, only the field
    list will be populated with the names of all of the fields in your table, which
    will be arranged vertically with checkboxes beside them. Below that, there are
    four boxes, titled **Filters**, **Columns**, **Rows**, and **Values**. You build
    the table by dragging the field names to the boxes as desired.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“确定”后，将创建一个数据透视表。最初，仅填充字段列表，其中包含表格中所有字段的名称，这些名称将垂直排列，并在其旁边有复选框。在下面，有四个框，标题分别为**筛选器**、**列**、**行**和**数值**。您可以根据需要将字段名称拖到框中来构建表格。
- en: 'Before you start building your table, it would help if you try and envisage
    the layout you desire. The **Values** box is best suited for numerical fields,
    so you would drag the `Sales` field to this box, resulting in the updated table
    shown in the following screenshot, which shows how the **Values** field is displayed
    in the pivot table:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建表格之前，设想所需的布局会有所帮助。**数值**框最适合数值字段，因此您将`销售`字段拖到此框中，结果将显示在下面的更新表格中，该表格显示了如何在数据透视表中显示**数值**字段：
- en: '![](img/10e54fa6-9ce1-4be6-a87a-a2fd3b63b73f.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](img/10e54fa6-9ce1-4be6-a87a-a2fd3b63b73f.png)'
- en: 'As you have not yet specified a condition or criteria, Excel simply totals
    the **Values** field and calls it `Sum of Sales`. You may then wish to display
    the sales per salesperson for each product. The following screenshot shows sales
    per salesperson:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 由于您尚未指定条件或标准，Excel简单地合计**数值**字段并将其命名为`销售总额`。然后，您可能希望显示每个产品的每个销售人员的销售额。以下截图显示了每个销售人员的销售额：
- en: '![](img/c380e04f-d7de-4f79-bd62-f43be2c392f4.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c380e04f-d7de-4f79-bd62-f43be2c392f4.png)'
- en: 'For the previous screenshot, the field list would look like this:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 对于上述截图，字段列表将如下所示：
- en: '![](img/409daabb-eab8-43ac-8b36-90dd55701676.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/409daabb-eab8-43ac-8b36-90dd55701676.png)'
- en: 'Alternatively, you may wish to show the sales of products per salesperson,
    as shown in the following screenshot:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可能希望按销售人员显示产品的销售额，如以下截图所示：
- en: '![](img/f50f0b1a-fffd-40f7-b254-ed0736acd04a.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f50f0b1a-fffd-40f7-b254-ed0736acd04a.png)'
- en: 'Notice that the positions of the `Product` and `Salesperson` fields are reversed
    in the rows box, as shown in the following screenshot:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在行框中，`产品`和`销售人员`字段的位置是相反的，如以下截图所示：
- en: '![](img/a3398334-dec6-4d86-ad17-965da1edab1d.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a3398334-dec6-4d86-ad17-965da1edab1d.png)'
- en: 'An alternative layout could be achieved by displaying the products horizontally.
    This can be done by dragging the product field to the **Columns** box instead
    of the **Rows** box:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种布局可以通过横向显示产品来实现。这可以通过将产品字段拖到**列**框而不是**行**框中来完成：
- en: '![](img/f3b234c6-74c5-4a08-ad0d-3eb61f81c31c.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f3b234c6-74c5-4a08-ad0d-3eb61f81c31c.png)'
- en: 'Doing that results in this:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 这样做会得到以下结果：
- en: '![](img/72a926f1-a29d-4db4-9be8-b270d1e85d82.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/72a926f1-a29d-4db4-9be8-b270d1e85d82.png)'
- en: 'Another variation to the layout is to show sales by product, then show the
    salesperson as a filter:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 布局的另一种变体是按产品显示销售额，然后将销售人员作为筛选器显示：
- en: '![](img/46090795-1ef8-441b-99b2-c0a42b2ce08b.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/46090795-1ef8-441b-99b2-c0a42b2ce08b.png)'
- en: 'This results in the following:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 这将导致以下结果：
- en: '![](img/a011ee5e-a3cd-4b1c-97d6-9c5567800ac8.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a011ee5e-a3cd-4b1c-97d6-9c5567800ac8.png)'
- en: By clicking the drop-down arrow beside the `Salesperson (All)` filter, you can
    selectively display the results for any of the salespersons, any combination of
    them, or all of the salespersons.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 单击`销售人员（全部）`筛选器旁边的下拉箭头，您可以选择性地显示任何销售人员、任何组合或所有销售人员的结果。
- en: Apart from showing the sales totals, you can also show sales as a percentage
    of the overall total or of average sales. In this way, you can show the contribution
    of a product or salesperson to the overall sales.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 除了显示销售总额外，您还可以将销售额显示为整体总额或平均销售额的百分比。通过这种方式，您可以显示产品或销售人员对总销售额的贡献。
- en: 'The following screenshot shows product sales in total and as percentages of
    gross sales. In order to achieve this, simply drag the `Sales` field to the **Values**
    box again so that it now appears twice. Right-click on the `Sum of Sales 2` column
    to reveal a drop-down menu, then select **Show Values**, and then finally select
    **Grand Total** from the second menu that appears. An illustration of product
    sales in total and as percentages of gross sales is shown in the following screenshot:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了产品销售额的总数以及作为总销售额百分比。为了实现这一点，只需将`销售额`字段再次拖放到**值**框中，以便它现在出现两次。右键单击`销售额
    2`列以显示下拉菜单，然后选择**显示值**，最后从出现的第二个菜单中选择**总计**。产品销售额的总数和作为总销售额百分比的说明显示在以下截图中：
- en: '![](img/73c0c5e0-826f-4a43-b920-bef2d93e3ba0.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/73c0c5e0-826f-4a43-b920-bef2d93e3ba0.png)'
- en: The previous table shows sales by salespersons and as percentages of gross sales.
    This is actually a second pivot table that uses the same range but using the table
    on cell `E3` of the sheet housing the original pivot table. The **Show Values
    as...** menu has a wide range of options demonstrating the flexibility of pivot
    tables.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 前一个表显示了销售人员的销售额以及作为总销售额百分比。这实际上是第二个数据透视表，它使用相同的范围，但使用原始数据透视表所在工作表的单元格`E3`上的表格。**显示为...**菜单具有各种选项，展示了数据透视表的灵活性。
- en: If, in trying out the various options, you mess up your table, you can simply
    discard it and create another one. Hopefully, this time, you would have learned
    from your mistakes and shifted up a notch in your experience of creating and working
    with pivot tables. Sometimes, people understand reports better when they are supported
    by diagrams and charts.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在尝试各种选项时，你搞乱了表格，你可以简单地丢弃它并创建另一个。希望这一次，你能从错误中吸取教训，并在创建和使用数据透视表的经验中进步一步。有时，人们在报告得到图表和图示的支持时能更好地理解报告。
- en: 'To create a pivot chart, select your pivot table, select **Analyze** from the
    pivot table tools context-sensitive menu, then select **Pivot Chart**. A wide
    range of chart types will be displayed. Select one and a pivot chart appears beside
    your pivot table:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 创建数据透视图图表，选择你的数据透视表，从数据透视表工具的上下文菜单中选择**分析**，然后选择**数据透视图图表**。将显示各种类型的图表。选择其中一种，数据透视图图表将出现在你的数据透视表旁边：
- en: '![](img/bfd1cacd-2ba6-4e69-b518-0ab3a5ec9533.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bfd1cacd-2ba6-4e69-b518-0ab3a5ec9533.png)'
- en: 'The chart is dynamic so that if you filter your table to reflect, say, one
    salesperson, `Iyabo`, the chart automatically updates to reflect only Iyabo''s
    results. This screenshot shows a pivot table and a pivot chart that have been
    filtered to show just Iyabo''s sales:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图表是动态的，因此如果您将表格过滤以反映，例如，一个销售人员，`伊亚博`，图表将自动更新以仅反映伊亚博的结果。此截图显示了已经过滤以仅显示伊亚博销售的数据透视表和数据透视图图表：
- en: '![](img/be201944-1988-4375-ad67-89d6a075c59b.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/be201944-1988-4375-ad67-89d6a075c59b.png)'
- en: Implementing pivot tables
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实施数据透视表
- en: 'In the `Marks.xlsx` file, we have the percentages of all of the students. Now,
    let''s say we want to find out who the top 10 students are, so that we can award
    them during our class function. Enter the pivot table using the following steps:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在`Marks.xlsx`文件中，我们有所有学生的百分比。现在，假设我们想找出前10名学生是谁，这样我们就可以在班级活动中奖励他们。按照以下步骤进入数据透视表：
- en: Navigate to the `Top scores` worksheet in the file, which contains all of the
    students and their percentages in a table.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到文件中的`Top scores`工作表，其中包含所有学生及其百分比的表格。
- en: 'Now, to create a pivot table, we will select all of the columns in the table
    and create a pivot table using the **PivotTable** option in the menu:'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，要创建数据透视表，我们将选择表中的所有列，并使用菜单中的**数据透视表**选项创建数据透视表：
- en: '![](img/7986c9ab-8bc0-4579-ba76-b61241676972.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7986c9ab-8bc0-4579-ba76-b61241676972.png)'
- en: 'This results in the following table:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下表格：
- en: '![](img/27e09561-fb8d-4905-9123-83bb5afcbad4.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/27e09561-fb8d-4905-9123-83bb5afcbad4.png)'
- en: 'Since we want to find out the top 10 scores, we can use a built-in filter in
    the **PivotTable** filters. To reveal the following drop-down list, click on the
    filter icon in the corner of the **Row Labels** column:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于我们想找出前10名成绩，我们可以在**数据透视表**筛选器中使用内置筛选器。单击**行标签**列角落的筛选器图标，以显示以下下拉列表：
- en: '![](img/0e8d2567-9905-4152-a087-69b8cbc0aafd.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0e8d2567-9905-4152-a087-69b8cbc0aafd.png)'
- en: 'Navigate to **Value filters** and select the **Top 10...** option from there,
    as follows:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**值筛选器**，然后从中选择**前10...**选项，如下所示：
- en: '![](img/6f5a0338-56b1-4215-9d59-f428afc994d5.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6f5a0338-56b1-4215-9d59-f428afc994d5.png)'
- en: 'This reveals the following window:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示以下窗口：
- en: '![](img/1a15fb36-e9dc-47bc-ba20-a5eadcc92257.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1a15fb36-e9dc-47bc-ba20-a5eadcc92257.png)'
- en: Here, you can choose how many values you want to display, from which column
    you want to filter the top 10, and many more options.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以选择要显示多少个值，您想要从哪一列过滤前10个值，以及许多其他选项。
- en: 'Make sure that everything in the window looks similar to the preceding screenshot
    and click on **OK**. Doing so leads to the following output:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保窗口中的所有内容看起来与前面的截图类似，并单击**确定**。这样做会导致以下输出：
- en: '![](img/b50fd30d-a880-48c2-9a57-07ae31fc5dcd.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b50fd30d-a880-48c2-9a57-07ae31fc5dcd.png)'
- en: As seen here, we can see the students who scored the highest grades. But we
    need them in descending order of their percentages, so that the highest scorer
    is displayed first.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 正如在这里所见，我们可以看到获得最高成绩的学生。但是我们需要按百分比的降序排列它们，以便首先显示最高分者。
- en: 'For this, we will again click on the filter icon and navigate to **More Sort
    Options...**, as shown here:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对此，我们将再次点击过滤器图标，并导航到**更多排序选项...**，如下所示：
- en: '![](img/c4744b99-391d-46d9-af11-273ce10dc240.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c4744b99-391d-46d9-af11-273ce10dc240.png)'
- en: 'This results in the following window:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下窗口：
- en: '![](img/2a9ed612-9a95-4f0f-b3c6-bb1c62d15b71.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2a9ed612-9a95-4f0f-b3c6-bb1c62d15b71.png)'
- en: 'Here, we will now sort the students into descending order, based on the sum
    of percentages, as shown here:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这里，我们将根据百分比总和将学生按降序排序，如下所示：
- en: '![](img/6370ee69-0f88-4d12-802c-2c5e70268874.png)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6370ee69-0f88-4d12-802c-2c5e70268874.png)'
- en: 'This results in the following output:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下输出：
- en: '![](img/8e7a41e9-6415-4499-ad06-1b72f260b04d.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8e7a41e9-6415-4499-ad06-1b72f260b04d.png)'
- en: Hence, we have the results of the top 10 students in the class! This shows how
    powerful a pivot table can be when used right.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们得到了班上前10名学生的结果！这表明了当正确使用数据透视表时，它可以多么强大。
- en: Pitfalls to avoid
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 要避免的陷阱
- en: In constructing your formulas, it is easy to get carried away and, very soon,
    the formula becomes very complex and unfriendly. While it is desirable to keep
    formulas compact, they should be simple and easy for a third party to follow.
    If necessary, break up the formula into two or more parts so that it becomes easier
    to follow while retaining the original effect.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建您的公式时，很容易一发不可收拾，很快，公式就变得非常复杂和难以理解。虽然保持公式紧凑是可取的，但它们应该简单且易于第三方跟随。如有必要，将公式分解为两个或更多部分，以使其更易于跟踪，同时保留原始效果。
- en: 'Alternatively, you can use *Alt + Enter* to force part of the formula to the
    next line. This will not affect the result of the formula, but it will make the
    formula easier to understand. Consider the following example:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可以使用*Alt + Enter*将公式的一部分强制转换到下一行。这不会影响公式的结果，但会使公式更容易理解。考虑以下示例：
- en: '[PRE0]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This complex formula can be broken down to three parts with the use of *Alt
    + Enter*, as follows:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 使用*Alt + Enter*，可以将这个复杂的公式分解为三个部分，如下所示：
- en: '[PRE1]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: As we can see, this makes it easier to decipher.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，这使得解密更加容易。
- en: Protect sheets
  id: totrans-197
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 保护工作表
- en: If you are going to share your model with others, it is important that you protect
    your formulas against inadvertent modifications that can render the model useless.
    In order to do this, first highlight the cells without formulas that you want
    to modify, press *Ctrl + 1* to open the **Format Cells** dialog box, go to the
    Protection tab, check Locked, and click OK. This will unlock the cells that may
    be modified.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您打算与他人共享您的模型，则重要的是保护您的公式，以防止意外修改导致模型无法使用。为此，请首先突出显示要修改的没有公式的单元格，按*Ctrl + 1*打开**格式单元格**对话框，转到“保护”选项卡，选中“锁定”，然后单击“确定”。这将解锁可以修改的单元格。
- en: Now, go to the Review tab, then select Protect Sheet. The Protect Sheet dialog
    box appears. Enter a password to unprotect it if desired, then click OK. Now,
    the cells with formulas, which are protected, can only be viewed but not modified.
    You should enter a particular value only once. If you need to enter the same value
    in another location, simply refer to the original cell where the first entry was
    made. Any subsequent occurrences of the same value should also refer to the original
    entry rather than to any of the secondary cells containing the same value.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，转到“审阅”选项卡，然后选择“保护工作表”。保护工作表对话框出现。如果需要，输入密码以取消保护，然后单击“确定”。现在，受保护的具有公式的单元格只能查看但不能修改。您应该仅输入特定值一次。如果需要在另一个位置输入相同的值，请简单地参考第一个输入的原始单元格。任何后续出现的相同值也应参考原始输入，而不是任何包含相同值的次要单元格。
- en: For example, an interest rate of 15% is first entered on sheet 1, cell **B5**.
    If interest is required in sheet 2, cell **D16**, rather than typing 15% again,
    you simply refer to sheet 1, cell **B5**, by typing `=`, then entering sheet 1, cell
    **B5**. If interest appears again on sheet 3, cell **J13**, theoretically, you
    could refer to sheet 2, cell **D16**. However, in order to preserve a simple audit
    trail, the reference should be to the original entry of that value, sheet 1, cell **B5**.
    Try and use only one formula per row.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，15%的利率首先输入到表1的单元格**B5**中。如果在表2的单元格**D16**中需要利息，而不是再次输入15%，您只需引用表1的单元格**B5**，键入`=
    `，然后输入表1的单元格**B5**。如果利息再次出现在表3的单元格**J13**中，理论上，您可以引用表2的单元格**D16**。然而，为了保持一个简单的审计追踪，应该将引用指向该值的原始输入，即表1的单元格**B5**。尽量每行只使用一个公式。
- en: Use your knowledge of relative, absolute, and mixed cell referencing to construct
    your formulas so that you can enter it in one cell, then copy or fill the formulas
    across the other years. The fewer times you have to enter a formula, the lower
    the chances of making a mistake are.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 利用您对相对、绝对和混合单元格引用的了解，构建您的公式，以便您可以在一个单元格中输入它，然后将公式复制或填充到其他年份中。您输入公式的次数越少，出错的机会就越低。
- en: Summary
  id: totrans-202
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned about the power of formulas and functions and how
    we can use them to speed up our modeling and make it more interesting. We also
    worked through examples of some of the more common functions such as the `VLOOKUP`,  `MATCH`,
    and `CHOOSE` functions.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了公式和函数的威力，以及如何利用它们加快建模速度并使其更加有趣。我们还通过一些常见函数的示例进行了演示，例如`VLOOKUP`、`MATCH`和`CHOOSE`函数。
- en: In the next chapter, we will look at one of the features that forms the backbone
    of Excel—the referencing framework. Understanding this framework and knowing how
    to apply its principles will help you to speed up your work and improve your productivity.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将研究 Excel 中构成其支柱的功能之一——引用框架。了解这个框架并知道如何应用其原则将有助于加快您的工作速度并提高您的生产力。
