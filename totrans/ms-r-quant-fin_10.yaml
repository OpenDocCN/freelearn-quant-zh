- en: Chapter 10. Technical Analysis, Neural Networks, and Logoptimal Portfolios
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章 技术分析、神经网络与对数最优投资组合
- en: 'In this chapter we give a brief introduction to different methods that may
    help to improve the performance of your portfolio: technical analysis, neural
    networks and log-optimal portfolios. The common idea behind these methods is that
    past price movements may help in forecasting future trends. In other words, we
    implicitly assume that prices do not follow a Markov process (for example random
    walk), but they have some kind of long lasting memory, hence patterns from the
    past may reoccur also in the future, all in all markets are not efficient.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们简要介绍了几种可能有助于提升投资组合表现的方法：技术分析、神经网络和对数最优投资组合。这些方法的共同理念是，过去的价格波动可能有助于预测未来的趋势。换句话说，我们隐含地假设价格并不遵循马尔可夫过程（例如随机游走），而是具有某种长期的记忆，因此，过去的模式也可能在未来重现，总之，市场并非完全有效。
- en: In the first part we introduce the most common tools of technical analysis and
    present some indicative examples of how to program them in the R environment.
    In the second part we outline the concept of neural networks and their design
    by R's built-in function. Technical analysis and neural network are applied on
    the bitcoin database, thus we focus on a single asset and investigate for reliable
    signals of buying and selling. Finally, in the third part we discuss the so called
    log-optimal portfolio strategies that enable us to optimize our portfolio of several
    assets (in our example some NYSE stocks) for the long run.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一部分，我们介绍了技术分析中最常用的工具，并展示了一些如何在R环境中编程实现这些工具的示例。在第二部分，我们概述了神经网络的概念以及如何通过R的内置函数进行设计。技术分析和神经网络被应用于比特币数据库，因此我们聚焦于单一资产，研究可靠的买卖信号。最后，在第三部分，我们讨论了所谓的对数最优投资组合策略，这些策略使我们能够优化多个资产的投资组合（在我们的示例中是一些纽约证券交易所的股票）以实现长期收益。
- en: The main goal of this chapter is just to give a helicopter view on the concepts,
    the most common tools that are used and to provide some examples of their programming.
    Therefore we would like to underline here that, by need of being concise, we only
    intend to give you some insight into the field and to entice you to check the
    references, learn more and try further tools yourself.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的主要目标是提供一个关于这些概念的宏观视角，介绍最常用的工具，并提供一些编程示例。因此，我们在此特别强调，由于篇幅所限，我们仅打算为您提供一些领域的洞见，并激发您查阅相关文献，进一步学习并尝试更多工具。
- en: Market efficiency
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 市场效率
- en: Markets are efficient to the extent that all information is built into the current
    prices. The weak form of market efficiency requires that the latest price already
    incorporates all the information which can be obtained from the chart of past
    prices and trading volumes. Clearly, if markets were efficient at least in this
    weak sense, returns would be totally independent over time and strategies based
    on technical analysis, neural networks and the logoptimal portfolio theory would
    be completely worthless, see *Hull (2009)*, *Model of the behavior of stock prices*.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 市场的效率意味着所有信息都已经反映在当前的价格中。市场效率的弱形式要求最新的价格已经包含了从过去的价格图表和交易量中可以获得的所有信息。显然，如果市场在至少这种弱形式上是有效的，那么收益将是完全独立的，基于技术分析、神经网络和对数最优投资组合理论的策略将毫无价值，见*Hull
    (2009)*，*股价行为模型*。
- en: However, the efficiency of a given market is purely an empirical question. You
    can never be sure that asset returns in the real world are really completely independent
    in time. Therefore, you should not take market efficiency as a fact but you are
    encouraged to test it on your own by inventing and implementing new technically
    inspired strategies. If your strategy calibrated on past trading data proves to
    be robust enough and works well in the future, then the market will generously
    honor your efforts by enhancing the risk/return profile of your portfolio, and,
    as a result, you will earn an extra profit. Studies have shown that emerging currency
    markets, for instance, are less efficient due to illiquidity and to central bank
    interventions, see *Tajaddini-Crack (2012)*; whereas most technicist strategies
    do not hold on the more developed American stock market *Bajgrowicz-Scaillet (2012)*,
    *Zapranis-Prodromos (2012)*. Furthermore, the same studies indicate that when
    technical trading is successful, its combination with fundamental analysis is
    even more so. *Zwart et al. (2009)*.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，某一市场的效率完全是一个经验性问题。你永远无法确定资产回报在现实世界中是否真的是完全独立的。因此，你不应将市场效率视为事实，而应该鼓励你自己进行测试，发明并实施新的技术启发式策略。如果你基于过去的交易数据调整的策略证明足够稳健，并且在未来表现良好，那么市场将通过提高你投资组合的风险/回报比来慷慨地回报你的努力，最终你将获得额外的利润。研究表明，例如，发展中的货币市场由于流动性差和央行干预，其效率较低，参见*Tajaddini-Crack
    (2012)*；而大多数技术分析策略在更成熟的美国股市中并不奏效，参见*Bajgrowicz-Scaillet (2012)*，*Zapranis-Prodromos
    (2012)*。此外，同样的研究表明，当技术交易成功时，将其与基本面分析结合使用效果会更好，参见*Zwart et al. (2009)*。
- en: 'Despite being sort of an apocrypha still today, technical analysis is widely
    used even among fundamental investors. This is mainly due to its self-fulfilling
    nature: as market players know that more and more of their peers are using the
    TA tools they keep an eye on them, too. If, for instance, a 200-day moving average
    is breached on a main index chart, it is likely to make the headlines and cause
    a selling wave.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管今天仍被视为一种“伪经”，技术分析在基本面投资者中仍然广泛使用。这主要是因为它具有自我实现的特性：市场参与者知道越来越多的同行在使用技术分析工具，因此他们也会关注这些工具。如果例如一个主要指数图表上的200日移动平均线被突破，它很可能会成为头条新闻，并引发一波卖盘。
- en: Technical analysis
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术分析
- en: '**Technical analysis** (**TA**) can help you achieve better results if you
    do not overestimate its predictive power. Technical analysis is especially good
    at predicting short-term trends and at indicating market sentiment. Fundamental
    investors (and one of the writers of this chapter) use them to choose their buy-in
    and sell-out point: given their fundamentally backed view on the direction of
    the market technical analysis is a valuable help in choosing the short-term optimum.
    It can also eliminate such common trading flaws as badly chosen position size
    (indication on the strength of the trend), shaky hands (only sell when there is
    a sign) and inability to press the button (but when there is a sign, do sell).'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**技术分析** (**TA**) 可以帮助你取得更好的结果，但前提是不要高估其预测能力。技术分析尤其擅长预测短期趋势和指示市场情绪。基本面投资者（以及本章的其中一位作者）使用它们来选择买入和卖出的时机：基于他们对市场方向的基本面观点，技术分析在选择短期最佳时机上是一个宝贵的工具。它还可以避免一些常见的交易缺陷，如选错仓位大小（趋势强度的指示）、犹豫不决（只有在有信号时才卖出）以及无法果断操作（但当有信号时，就应该卖出）。'
- en: 'Three golden rules to remember before we jump to technicalities:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们深入技术细节之前，需要记住的三条黄金规则：
- en: '**Each market has its own mix of tools that work**: For example head-and-shoulders
    mostly appear on stock charts whereas support-resistance levels temper the trading
    on forex markets, and within the markets each asset can be specific. Therefore,
    as a rule of thumb, use tailor-made sets of indicators and neural networks specific
    to the actual asset you are looking at.'
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**每个市场都有自己有效的工具组合**：例如，头肩形态大多出现在股票图表中，而支撑和阻力水平则调节外汇市场的交易，在各个市场中，每个资产可能都有其特定性。因此，作为经验法则，使用量身定制的指标集和神经网络，针对你所关注的具体资产。'
- en: '**No pain, no gain**: Keep in mind that there is no holy grail, if one achieves
    to sustain winning on 60% of the trades then she has found a viable and well-rewarding
    trading strategy.'
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**不劳无获**：请记住，没有什么是灵丹妙药，如果一个人能够在60%的交易中持续获利，那么她就找到了一个可行且回报丰厚的交易策略。'
- en: '**Avoid impulsive trading**: Maybe this is the most important above all. It
    might hurt that you lost on your last trade but do not let it influence your future
    decisions. Trade only when there is a sign. If you consider opening a live trade
    account read extensively on money management (handling risk and position size,
    leverage) and on psychology of trading (greed, fear, hope, regret).'
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**避免冲动交易**：也许这比一切都更重要。你可能因为上次交易的亏损而感到痛苦，但不要让它影响你未来的决策。只有在有信号时才进行交易。如果你考虑开设实盘交易账户，广泛阅读有关资金管理（风险管理、仓位大小、杠杆）以及交易心理学（贪婪、恐惧、希望、后悔）的资料。'
- en: The TA toolkit
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 技术分析工具包
- en: Technical analysis abounds of tools but most of them can be categorized into
    four main groups. We advise you to use the old ones as these are more followed
    by professionals and are more likely to trigger price movements themselves (being
    self-fulfilling) besides being usually more user-friendly.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 技术分析充满了各种工具，但大多数可以分为四大类。我们建议你使用那些经典工具，因为这些工具被专业人士更为广泛地采用，更有可能触发价格波动（即自我实现），此外，它们通常也更易于使用。
- en: '**Support-resistance and price channels**: Price levels often influence trading:
    strategic levels may act either as support, keeping price levels from falling
    below, or as resistance, an obstacle to further rises. Parallel lines applied
    to the primary conditions of a trend (bottoms for an increasing trend, tops for
    a decreasing trend) define price channels - they are tools of the top-bottom analysis,
    just like the next category, the chart patterns. As these are usually harder to
    program we do not deal with them in detail.'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**支撑-阻力和价格通道**：价格水平往往会影响交易：战略性水平可能作为支撑，防止价格跌破，或作为阻力，阻碍价格进一步上涨。将平行线应用于趋势的主要条件（上升趋势的底部，下降趋势的顶部）可以定义价格通道——这些是顶部-底部分析的工具，就像下一个类别的图表形态一样。由于这些通常更难编程，我们不会详细讨论它们。'
- en: '**Chart patterns – Head-and-shoulders, saucers**: sound familiar? Perhaps,
    due to their easily recognizable nature, chart patterns are the most widely known
    tools of technical analysis. They have three categories: trend makers (mast, flag),
    trend breakers (double tops) and decision point signals (triangles). These, too,
    are rather intuitive, hardly programmable, and thus fall out of the scope of this
    chapter.'
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**图表形态——头肩形、碟形**：听起来熟悉吗？或许因为它们容易识别，图表形态成为了技术分析中最广为人知的工具。它们分为三类：趋势形成者（旗帜、旗形）、趋势反转者（双顶）和决策点信号（三角形）。这些形态也非常直观，几乎无法编程，因此超出了本章的范围。'
- en: '**Candle patterns**: As candlestick charts are the most widespread technicists
    started to spot signals on these and have given those names like morning star,
    three white soldiers or the famous key reversal. More than any other TA tool,
    they are significant only if combined with other signals, in most cases strategic
    price levels. They can be a combination of two-five candles.'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**蜡烛图形态**：由于蜡烛图是最广泛使用的图表，技术分析师开始在其中发现信号，并为这些信号命名，例如晨星、三白兵或著名的关键反转。与其他任何技术分析工具相比，蜡烛图形态只有在与其他信号结合时才具有意义，在大多数情况下是与战略性价格水平相结合。它们可以是由两到五根蜡烛组成的组合。'
- en: '**Indicators**: This is the type we will deal with the most in the following
    pages. Easy to program, technical indicators serve as basis of **high frequency
    trading** (**HFT**), a strategy based on algorithmic decisions and rapid market
    orders. These indicators have four categories: momentum-based, trend follower,
    money flow (based on volume) and volatility-based.'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**指标**：这是我们将在接下来的章节中最常涉及的一种类型。技术指标易于编程，是**高频交易**（**HFT**）的基础，后者是一种基于算法决策和快速市场订单的策略。这些指标分为四类：动量型、趋势跟踪型、资金流（基于成交量）和波动性型。'
- en: In this chapter we are going to present a strategy that combines elements from
    types (3) and (4), we will be looking for potential trend changes by the help
    of indicators and signal key reversals there.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍一种结合了（3）和（4）类元素的策略，我们将通过指标帮助寻找潜在的趋势变化，并在关键反转处识别信号。
- en: Markets
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 市场
- en: Although everyone should explore by her own the TA tools that best work on the
    respective markets some general observations can be formulated.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管每个人应该根据自己的情况探索适合各自市场的技术分析工具，但一些通用的观察还是可以总结出来的。
- en: '**Stocks** usually form nice chart patterns and are sensitive to candle patterns
    and to strategic moving average crossings, too. Asymmetric information is an important
    issue, although less than in the case of commodities, for instance, and unpredictable
    spikes can alter the course of the prices at news releases.'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**股票**通常会形成漂亮的图表形态，并且对蜡烛图形态以及战略性移动平均线交叉非常敏感。信息不对称是一个重要问题，尽管比起商品市场，它的影响较小，但不可预测的价格波动仍然能在新闻发布时改变价格走势。'
- en: '**FX** is traded continuously around the globe and is strongly decentralized
    which implies two things. First, no overall volume data is available, so one should
    have a general idea about the liquidity of the markets to weigh the importance
    of price changes – for example in summer liquidity is lower, therefore even a
    smaller buy-in can generate volatility. Second, different people trade at different
    times and each of them has different habits. In EURJPY, for instance, during the
    US and European trading hours the tens and round numbers tend to be psychological
    supports, whereas there is a switch to the 8s during the Asian trading (8 being
    a lucky number). From a TA toolkit perspective: no characteristic chart patterns
    besides triangles and masts, important support-resistance levels and price channels,
    zone-thinking, stuck-launch dynamics and Fibonacci proportions are mostly used.'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**外汇（FX）**在全球范围内持续交易，并且高度去中心化，这意味着两件事。首先，没有整体交易量数据，因此人们应该对市场的流动性有一个大致的了解，以评估价格变化的重要性——例如在夏季，流动性较低，因此即使是较小的买入也能引发波动。其次，不同的人在不同的时间进行交易，每个人的习惯也不同。例如在EURJPY市场，在美国和欧洲的交易时段，十位数和整数通常是心理支撑位，而在亚洲交易时段则会转向8（8是一个幸运数字）。从技术分析工具的角度来看：除了三角形和旗形，重要的支撑-阻力位、价格通道、区间思维、突破启动动态和斐波那契比例通常被使用。'
- en: Plotting charts - bitcoin
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绘制图表 - 比特币
- en: Charting programs, if not provided by brokerages in the trading program, can
    get expensive and not always provide sophisticated TA tools. To circumvent this
    problem you can use R to trace your charts and can program all the indicators
    you like – if they are not yet built in.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如果交易程序没有提供图表工具，图表程序可能会很贵，并且并不总是提供复杂的技术分析工具。为了解决这个问题，你可以使用R来追踪你的图表，并且可以编程实现你喜欢的所有指标——如果它们还没有内置的话。
- en: 'Let''s look at an example now: plotting charts for bitcoin. Bitcoin is a crypto
    currency that got popular in the summer of 2014 where its price was up to $1162
    from below $1 and is traded on many freshly founded and therefore rudimentary
    exchanges. This posed a problem to many small investors: how to trace the chart?
    And, even if they were okay with BitStamp''s uneasy platform, granular data was
    only available in spreadsheet format and is still today.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来看一个例子：绘制比特币的图表。比特币是一种加密货币，2014年夏天其价格从不到1美元上涨至1162美元，并且在许多新成立的、因此还很初级的交易所中交易。这给许多小投资者带来了一个问题：如何追踪图表？即使他们能忍受BitStamp平台的不便，细粒度数据也仅以电子表格格式提供，直到今天仍然如此。
- en: You can source data from [http://bitcoincharts.com/](http://bitcoincharts.com/).
    Herein we included a code that draws in live data and thus acts as if it was a
    live charting tool. With this useful trick you can avoid paying hundreds of dollars
    for a professional software. We plot candlestick charts (also called OHLC), the
    commonly used type. Before we start here is a graphic that explains how they work.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从[http://bitcoincharts.com/](http://bitcoincharts.com/)获取数据。在这里，我们包含了一段代码，它会实时绘制数据，因此就像是一个实时图表工具。通过这个有用的技巧，你可以避免花费数百美元购买专业软件。我们绘制的是蜡烛图（也称为OHLC图），这是最常用的图表类型。在开始之前，这里有一张图解释它们是如何工作的。
- en: '![Plotting charts - bitcoin](img/2078OT_10_01.jpg)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![绘制图表 - 比特币](img/2078OT_10_01.jpg)'
- en: Here we provide the program code of the live data fetcher that draws OHLC chart.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这里提供了用于获取实时数据并绘制OHLC图表的程序代码。
- en: 'We will use the `RCurl` package to get data from the Internet. First let''s
    have a look at the following function:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用`RCurl`包从互联网上获取数据。首先，让我们来看一下以下函数：
- en: '[PRE0]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'First we use the `getURL` function from the `RCurl` package to read the whole
    website as a string:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用`RCurl`包中的`getURL`函数将整个网站作为字符串读取：
- en: '[PRE1]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: If we have a look at the HTML code we can easily find the bitcoin price we are
    looking for. The function returns it as a numeric value.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们查看HTML代码，就可以轻松找到我们要找的比特币价格。该函数将其作为数字值返回。
- en: '[PRE2]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Or we can grab the exact same information with the help of the XML package,
    which was created to parse HTML and XML files and to extract information:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 或者我们也可以通过XML包获取完全相同的信息，XML包是用来解析HTML和XML文件并提取信息的：
- en: '[PRE3]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This practice of getting price data is of course only for demonstration purposes.
    Live price data should be provided by our broker (for which we can still use R).
    Now let''s see, how to draw a live candle chart:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 获取价格数据的这一做法当然仅用于演示目的。实时价格数据应由我们的经纪商提供（我们仍然可以使用R语言）。现在，让我们来看一下如何绘制实时蜡烛图：
- en: '[PRE4]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To fully understand this code some time and some programming experience is
    probably needed. To summarize the algorithm does the following: in an infinite
    loop, reads price data and stores it in a matrix with four rows as OHLC. Every
    time the last column of this matrix is recalculated to assure that *H* is the
    highest and *L* is the lowest price observed in that time interval. When the time
    determined by the `time_frame_in_minutes` variable is reached matrix columns roll,
    the oldest observations (first column) are dropped, and each column is replaced
    by the next one. The first column is then filled with NAs except the O (open)
    price, which is considered as the close price of the previous column, so the chart
    is continuous.'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 要完全理解这段代码，可能需要一些时间和编程经验。简而言之，算法做了以下几件事：在一个无限循环中，读取价格数据并将其存储在一个包含四行的矩阵中，作为OHLC（开盘价、最高价、最低价、收盘价）。每当该矩阵的最后一列被重新计算时，会确保*H*为该时间间隔内观察到的最高价格，*L*为最低价格。当由`time_frame_in_minutes`变量确定的时间到达时，矩阵的列会滚动，最旧的观察数据（第一列）会被丢弃，每一列会被下一列替换。然后，第一列会被填充为NA，除了O（开盘价）外，其它值会被填充为NA，而O价格被视为前一列的收盘价，这样图表就能连续显示。
- en: The remaining code is only for drawing the candles with the "polygon" method.
    (We can do it with built-in functions as well, as we will see later.)
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 剩余的代码只是用于通过“多边形”方法绘制蜡烛图。（我们也可以使用内置函数来实现，稍后会看到。）
- en: 'Let''s call this function and see what happens:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们调用这个函数，看看会发生什么：
- en: '[PRE5]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: See more on data manipulation in [Chapter 4](ch04.html "Chapter 4. Big Data
    – Advanced Analytics"), *Big Data – Advanced Analytics*.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 查看更多关于数据操作的内容，请参考[第4章](ch04.html "第4章. 大数据 – 高级分析")，*大数据 – 高级分析*。
- en: Built-in indicators
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 内置指标
- en: R has many built-in indicators, such as the **simple moving average** (**SMA**),
    the **exponential moving average** (**EMA**), the **relative strength indicator**
    (**RSI**), and the famous MACD. These constitute an integral part of technical
    analysis, their main goal is to visualize a relative benchmark so that you could
    get an idea whether your asset is overbought, relatively well-performing or at
    a strategic level compared to some reference period. Here you find a brief explanation
    to what each of them does, and how you can put them on your chart.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: R语言有许多内置指标，如**简单移动平均**（**SMA**）、**指数移动平均**（**EMA**）、**相对强弱指数**（**RSI**）和著名的MACD。这些构成了技术分析的核心部分，它们的主要目的是通过可视化相对基准，帮助你了解你的资产是否被过度买入、相对表现良好，或者与某个参考时期相比处于战略水平。这里简要解释了每个指标的作用，以及如何将它们添加到你的图表中。
- en: SMA and EMA
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SMA和EMA
- en: 'Moving averages are the simplest among all indicators: they show the average
    price level for you on a rolling basis. For example, if you trace the 15-candle
    SMA, it will give you the average price level of the 15 preceding candles. Obviously,
    if your current candle''s time is up and a new candle starts, the SMA will calculate
    a new average leaving out the previously first candle and taking in the newest
    one instead. The difference between SMA and EMA is that SMA weighs all candles
    equally whereas EMA gives exponential weights – hence the name: it overweighs
    current candles to previous ones. This is a good approach if you want a benchmark
    that is more tied to current price levels and that reacts more quickly where there
    are shifts in price levels. These are overlay indicators that are directly plotted
    on the chart.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 移动平均是所有指标中最简单的：它们显示了基于滚动数据的平均价格水平。例如，如果你追踪15根蜡烛的SMA，它将给你前15根蜡烛的平均价格水平。显然，如果当前蜡烛的时间到了并且开始新的一根蜡烛，SMA将重新计算一个新的平均值，去掉之前的第一根蜡烛，加入最新的一根蜡烛。SMA和EMA的区别在于，SMA对所有蜡烛的权重相等，而EMA则赋予蜡烛指数权重——因此得名：它对当前蜡烛的权重高于之前的蜡烛。如果你想要一个更紧密联系当前价格水平并能快速反应价格变动的基准，这是一个不错的做法。这些是直接绘制在图表上的叠加指标。
- en: RSI
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: RSI
- en: 'The relative strength index is a band-indicator: its value can vary between
    0 and 100 with three bands within this range. With an RSI between 0 to 30 the
    asset is oversold, between 70 to 100 it is overbought. RSI endeavors to judge
    upon price variations'' intensity by using the relative strength ratio: average
    price of up closes divided by the average price of down closes (aka green candles''
    average close per red candles'' average close). The average''s summing period
    may vary, 70 is the most used.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 相对强弱指数（RSI）是一种带状指标：其值在0到100之间变化，并且在这个范围内有三个带区。当RSI在0到30之间时，表示资产被超卖；当RSI在70到100之间时，表示资产被超买。RSI试图通过使用相对强弱比率来判断价格变化的强度：即上涨收盘的平均价格除以下跌收盘的平均价格（也就是绿蜡烛的平均收盘价除以红蜡烛的平均收盘价）。该平均值的计算周期可以有所不同，70是最常用的。
- en: '![RSI](img/2078OT_10_02.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![RSI](img/2078OT_10_02.jpg)'
- en: As the formula suggests this indicator often gives signals, mostly in strong
    trends. As prices might remain at overbought or oversold levels use this indicator
    carefully, always in combination with some other type of indicator, or chart pattern
    like a trend breaker, also called failure swing. You might also consider diminishing
    your position size or looking for warning signs if, for instance, it shows that
    the asset you are long on is overbought.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如公式所示，这个指标通常在强趋势中发出信号。由于价格可能会维持在超买或超卖水平，因此使用此指标时需要小心，最好与其他类型的指标或图表形态（如趋势反转，也称为失败摆动）结合使用。如果例如它显示你持有的资产处于超买状态，你也可以考虑减少仓位或寻找警示信号。
- en: 'Here you can see how to trace this indicator and a moving average:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这里你可以看到如何绘制这个指标和一个移动平均线：
- en: '[PRE6]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![RSI](img/2078OT_10_03.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![RSI](img/2078OT_10_03.jpg)'
- en: By looking at the above chart we can conclude that during this period the market
    became rather oversold as the RSI tended to remain at low territories and it has
    hit the extreme levels several times.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 从上面的图表来看，我们可以得出结论，在这段时间内，由于RSI趋向保持在低位区域，并且多次触及极限水平，市场变得相当超卖。
- en: MACD
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: MACD
- en: '**MACD** (Mac Dee) stands for **Moving Average Convergence-Divergence**. It
    is a combination of a slow (26-candles) and a quick (12 candles) exponential moving
    average, a trend follower indicator: it gives signals rarely, but these tend to
    be more accurate. MACD gives signals when the quick EMA crosses the slow one.
    This is a buy if the quick crosses from below and a sell if it crosses from above
    (the 12-canlde average price being lower than the 26-candle, long-term average).
    The position of the EMA(12) marks the general direction of the trend – for example
    if it is above the EMA(26) the market is bullish. Important restriction: MACD
    gives false alarms in ranges, use only in strong trends. Some use the direction
    of the changes of the distance between the two lines, too, plotted in red or green
    histograms: once there are four bars in the same color, the strength of the trend
    is confirmed.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**MACD**（Mac Dee）代表**移动平均收敛-发散**。它是一个由慢速（26根蜡烛）和快速（12根蜡烛）指数移动平均线组成的趋势跟踪指标：它发出信号的频率较低，但这些信号往往更为准确。当快速EMA穿越慢速EMA时，MACD发出信号。如果快速EMA从下方穿越慢速EMA，则为买入信号；如果快速EMA从上方穿越慢速EMA，则为卖出信号（12根蜡烛的平均价格低于26根蜡烛的长期平均价格）。EMA(12)的位置标志着趋势的整体方向——例如，如果它位于EMA(26)之上，则市场处于看涨状态。重要的限制：MACD在区间整理时会发出虚假信号，只应在强趋势中使用。有些人还使用两条线之间距离变化的方向，这通常通过红色或绿色的直方图绘制：当同色的条形图有四根时，趋势的强度得到确认。'
- en: 'For technical analysis, you can use different R-packages: `quantmod`, `ftrading`,
    `TTR`, and so on. We mostly rely on `quantmod`. Here you can see how to trace
    the MACD on a previously saved dataset, named `Bitcoin.csv`:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 对于技术分析，你可以使用不同的R包：`quantmod`、`ftrading`、`TTR`等。我们主要依赖`quantmod`。在这里，你可以看到如何在一个之前保存的数据集（名为`Bitcoin.csv`）上绘制MACD：
- en: '[PRE7]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![MACD](img/2078OT_10_04.jpg)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![MACD](img/2078OT_10_04.jpg)'
- en: You can see the MACD under the chart, in the strong downwards trend it gives
    valid signals.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在图表下方看到MACD，在强烈的下行趋势中，它发出了有效的信号。
- en: 'Candle patterns: key reversal'
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 蜡烛图形态：关键反转
- en: Now that you got a general grasp of R's TA features let us program a rather
    easy strategy. The following script recognizes key reversals, a candlestick pattern,
    at strategic price levels.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你对R语言的技术分析功能有了大致了解，让我们编写一个相对简单的策略。以下脚本可以识别关键反转，这是一种蜡烛图形态，出现在关键价格水平。
- en: 'To do this, we applied the following dual rationale: first, we gave a discretional
    definition to what a strategic price level is. For instance, we recognized as
    mature increasing trend the price movement whose bottoms are monotonously increasing
    (bottom being the candle body''s lowest point) and whose current MA(25) level
    is higher than the MA(25) measured 25 candles before. We underline here that this
    does not constitute part of the standard TA tools and that its parameters have
    been chosen to best fit the actual chart we deal with, that of bitcoin. If you
    would like to apply it to other assets we advise you to adjust it to provide the
    best fit. This is not a trend recognition algorithm on itself: it only serves
    as part of our signal system.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们应用了以下双重逻辑：首先，我们给战略价格水平提供了一个主观定义。例如，我们将价格走势的底部单调上升（底部指的是蜡烛体的最低点）且当前的 MA(25)
    水平高于 25 根蜡烛之前的 MA(25) 水平的价格运动识别为成熟的上升趋势。在此我们强调，这并不构成标准的技术分析工具的一部分，其参数已根据我们所处理的实际图表（比特币图表）选择。如果您想将其应用于其他资产，建议您调整这些参数，以便获得最佳匹配。这本身并不是一个趋势识别算法：它仅作为我们信号系统的一部分。
- en: 'If this algorithm recognized a strategic price level in a mature trend that
    would be likely to break down if a candle pattern appeared, we started to look
    for key reversals. The key reversal is a trend breaker candlestick pattern, it
    occurs when the previous trend''s last candle that points to the same direction
    as the trend itself (it is green for a rising trend, red for a falling one), but
    suddenly prices turn and the next candle points in the opposite direction of the
    trend with a bigger candle body than the previous one. The trend breaker candle
    should start at least as high as the previous one, or, if the quotes are not continuous,
    a bit above the close for a rising trend, and a bit below for a falling one. See
    our graphic below for a key reversal in a rising trend:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果该算法在成熟趋势中识别到一个可能会因蜡烛图模式出现而突破的战略价格水平，我们便开始寻找关键反转。关键反转是一种趋势反转的蜡烛图模式，它发生在之前趋势的最后一根蜡烛与趋势本身的方向一致（上升趋势为绿色，下降趋势为红色），但价格突然转向，下一根蜡烛的方向与趋势相反，并且其蜡烛体比前一根更大。趋势反转蜡烛应该至少与前一根蜡烛一样高，或者如果报价不连续，对于上升趋势来说略高于前一根蜡烛的收盘价，下降趋势则略低于前一根收盘价。请参见我们下面的图形，展示了上升趋势中的关键反转：
- en: '![Candle patterns: key reversal](img/2078OT_10_05.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![蜡烛图模式：关键反转](img/2078OT_10_05.jpg)'
- en: Here you find the code of the function that recognizes this pattern.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是识别该模式的函数代码。
- en: Earlier in the bitcoin section we used the polygon method to create candle charts
    manually. Here we are using the quantmod package and the `chartSeries` function
    to do the same more easily wrapped in the OHLC function to make it more flexible.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在比特币部分中，我们之前使用多边形方法手动创建蜡烛图。在这里，我们使用了 `quantmod` 包和 `chartSeries` 函数来更轻松地完成相同的工作，并通过
    OHLC 函数使其更加灵活。
- en: '[PRE8]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The following function takes the time series and two indices (*i* and *j*)
    as arguments, and decides, weather it is an increasing trend from i to j or not:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 以下函数将时间序列和两个索引（*i* 和 *j*）作为参数，并判断从 i 到 j 是否为上升趋势：
- en: '[PRE9]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'First: if the MA(25) is not increasing then it is not an increasing trend so
    we return FALSE.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 首先：如果 MA(25) 没有增加，那么就不是上升趋势，因此我们返回 FALSE。
- en: '[PRE10]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: In this simple algorithm a candle is called a **valley**, if the bottom of the
    candle body is lower than the previous one and the next one. If the valleys make
    a monotonous non-decreasing series we have an increasing trend.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个简单的算法中，如果蜡烛体的底部低于前一根和后一根蜡烛的底部，那么该蜡烛被称为**谷底**。如果这些谷底形成一个单调不减的序列，那么我们就有一个上升趋势。
- en: '[PRE11]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This was the trend recognition. Let's see the trend reversal. First we use the
    previous function to check the conditions of the increasing trend. Then we check
    the last two candles for the reversal pattern. That's it.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是趋势识别。接下来是趋势反转。首先，我们使用之前的函数检查上升趋势的条件。然后我们检查最后两根蜡烛图是否符合反转模式。就这样。
- en: '[PRE12]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: We are out of the woods. Now we can use this in real data. We simply read the
    bitcoin data and run the trend reversal recognition on it. If there is a reversed
    trend with at least 10 candles we plot it.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们走出困境了。现在，我们可以在实际数据中使用它。我们只需读取比特币数据并运行趋势反转识别。如果出现反转趋势并且至少有 10 根蜡烛图，我们就会绘制它。
- en: '[PRE13]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Evaluating the signals and managing the position
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 信号评估与仓位管理
- en: Our code successfully recognizes four key reversals, including the historical
    turning point in the bitcoin price giving us a nice short selling signal. We can
    conclude that the signaling was successful, the only thing left to do is to use
    them wisely.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的代码成功识别了四个关键反转点，包括比特币价格的历史转折点，为我们提供了一个不错的卖空信号。我们可以得出结论，信号是成功的，剩下的就是明智地使用它们。
- en: 'Aware of the fundamentals of bitcoin (its acceptance as money undermined, ousting
    from such previously core markets as China), one could have made a nice profit
    whilst following the signal (the last candle on the chart) which is as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 了解比特币的基本原理（其作为货币的接受度受到削弱，并被从此前的核心市场如中国驱逐），如果跟随信号（图表上的最后一根蜡烛），你本可以获得不错的利润，信号如下：
- en: '![Evaluating the signals and managing the position](img/2078OT_10_06.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![评估信号和管理仓位](img/2078OT_10_06.jpg)'
- en: TA is useful while setting take profits and stop losses, in other words managing
    your position. If you chose to sell at the signal, you could have set these as
    follows.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 技术分析在设定止盈和止损时非常有用，换句话说，它有助于管理你的仓位。如果你选择在信号处卖出，你可以按以下方式设定这些点位。
- en: The system signals that you might want to sell at $1023,9 on December 5, 2013,
    in the last candle of the above chart, highlighted with an arrow on the next chart.
    You decide to proceed and open a position. Since bitcoin prices fluctuate quite
    much, especially after an exponentially increasing previous trend, you decide
    to put your stop loss to the historical high, to 1163, because you don't want
    false spikes to close you out of the position.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 系统信号显示你可能想在2013年12月5日的最后一根蜡烛图上卖出，价格为$1023.9，接下来的图表中用箭头标出。你决定继续并开盘。由于比特币价格波动较大，尤其是在之前的趋势呈指数增长后，你决定将止损设置在历史高点1163，因为你不想让虚假的波动导致你被迫平仓。
- en: On the next chart, here below, you can see that this approach is justified,
    after the fall in prices volatility increases significantly and shadows grow.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在下方的图表中，你可以看到这种方法是合理的，在价格下跌后，波动性显著增加，影线也变得更长。
- en: '![Evaluating the signals and managing the position](img/2078OT_10_07.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![评估信号和管理仓位](img/2078OT_10_07.jpg)'
- en: By the end of 2013 a supposed trend line can be traced if you connect the tops
    of the candles bodies (in white, drawn manually). This seems to hold and a lower
    trendline forms on the bottoms, with a lower slope, giving a triangle. We say
    that a triangle is valid on a chart if the price leaves it before it reaches 3/4
    of its length.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 到2013年底，如果你连接蜡烛图实体的顶部（用白色手工绘制），可以画出一条假设的趋势线。这条线似乎有效，且在底部形成了另一条趋势线，坡度更低，形成了一个三角形。我们说，当价格在达到三角形长度的3/4之前突破其边界时，图表上的三角形有效。
- en: 'This is what happens: on December 26, 2013 the daily chart breaks the line
    upwards with a big green candle (pointed at by an arrow). The MACD crosses, giving
    a strong bullish signal, and we close the position on the top of the body, at
    747.0 – if not before. So, we earned $276.9, or a 27% return on the trade.'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 发生的情况是：2013年12月26日，日线图突破了趋势线，并形成了一根大绿蜡烛（箭头指示的地方）。MACD线交叉，发出了强烈的看涨信号，我们在蜡烛实体顶部平仓，价格为747.0——如果没有提前平仓的话。因此，我们赚取了$276.9，或27%的交易回报。
- en: A word on money management
  id: totrans-92
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 资金管理说明
- en: 'Let''s look at the risk profile of this trade to show how technical analysis
    can be used to manage your exposure. The best way to do so is to calculate your
    risk-reward ratio, given by the below formula:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看这个交易的风险配置，展示如何利用技术分析来管理你的风险暴露。做到这一点的最佳方法是计算风险回报比，公式如下：
- en: '![A word on money management](img/2078OT_10_08.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![资金管理说明](img/2078OT_10_08.jpg)'
- en: 'The denominator is easy to define, this is the possible loss on the position,
    (1163.0-1023.9) = $139.1 in the case of the activation of the stop loss. The numerator,
    the possible gain can be approximated by a Fibonacci retracement, a tool that
    uses the golden section to predict possible price reversions, particularly useful
    in this exponential trend. You can see it below on a graph from [https://bitcoinwisdom.com/](https://bitcoinwisdom.com/):'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 分母很容易定义，这是仓位上的可能损失，（1163.0-1023.9）= $139.1，假设止损被激活。分子，即可能的收益，可以通过斐波那契回撤来估算，这是一种使用黄金分割预测价格可能反转的工具，特别适用于这种指数趋势。你可以在[https://bitcoinwisdom.com/](https://bitcoinwisdom.com/)的图表中看到它：
- en: '![A word on money management](img/2078OT_10_09.jpg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![资金管理说明](img/2078OT_10_09.jpg)'
- en: If you take the height of the trend as 100%, you can expect prices to touch
    Fibonacci levels when the trend breaks. Since a key reversal is a strong sign,
    let's take the 38.2%, which equals $747.13, so we expect prices to go down there.
    So the numerator of the risk-reward ratio is (1023.9-747.1) = $276.8, giving a
    final result of 276.8 /139.1 = 1.99, meaning that there is an ex-ante profit potential
    of $1.99 per one dollar at risk. This is a just fine potential, the trade should
    be approved.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 如果将趋势的高度视为100%，你可以预期价格在趋势突破时会触及斐波那契水平。由于关键反转是一个强烈信号，我们选择38.2%的位置，即747.13美元，因此我们预期价格会跌至该点。风险/收益比的分子是（1023.9
    - 747.1）= 276.8美元，最终结果为276.8 / 139.1 = 1.99，意味着每冒1美元的风险，就有1.99美元的预期利润。这是一个相当不错的潜力，交易应该被批准。
- en: Whenever you consider entering into a position, calculate how much you risk
    compared to how much you expect to gain. If it is below 3/2, the position is not
    the best, if below 1, you should forget the trade altogether. The possible ways
    to improve your risk/reward ratio are a tighter stop loss or the choice of a stronger
    sign. Technical analysis provides you with useful risk management tactics if you
    wish to be successful at trading, do not forget about them.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 每当你考虑进入一个仓位时，计算一下你所面临的风险与预期收益的比值。如果比值低于3/2，那么这个仓位并不是最优的；如果比值低于1，你应该完全放弃这笔交易。改善风险/收益比的可能方式包括设置更紧的止损或选择更强的信号。如果你希望在交易中取得成功，技术分析提供了一些有用的风险管理策略，不要忽视它们。
- en: Wraping up
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: Technical analysis, and particularly the presented chartist approach, is a highly
    intuitive, graphical way of analyzing financial assets. It uses support-resistance
    levels, chart- and candle patterns and indicators to predict future price movements.
    R enabled us to fetch live data for free and plot it as an OHLC chart, plot indicators
    on it and receive automated signs for key reversals, a candlestick pattern. We
    used one of these to show how a real position could have been managed manually
    and have shown that the appeal of TA is that it not only tells you when to open
    a position but also when to close it and calculate the strength of the signal
    by using risk management practices.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 技术分析，特别是所展示的图表分析方法，是一种高度直观的、图形化的金融资产分析方式。它利用支撑/阻力位、图表和蜡烛图形态以及指标来预测未来的价格走势。R语言使我们能够免费获取实时数据，并将其绘制为OHLC图表，添加指标，并接收自动化信号以识别关键反转信号、蜡烛图形态。我们用这些信号之一展示了如何手动管理一个实际的仓位，并证明了技术分析的吸引力在于它不仅告诉你何时开仓，还能告诉你何时平仓，并通过风险管理实践计算信号的强度。
- en: Neural networks
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 神经网络
- en: 'After remaining a long time in academic circles due to their advanced mathematical
    background, **neural networks** (**NN**) rapidly grew in popularity as more practically
    usable formats are available – like the built-in function of R. NNs are artificial
    intelligence adaptive software that can detect complex patterns in data: it is
    just like an old trader who has a good market intuition but cannot always explain
    to you why he is convinced you should go short on the **Dow Jones Industrial Average
    index** (**DIJA**).'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 由于其先进的数学背景，**神经网络**（**NN**）在学术界停留了很长时间，后来随着更实用的格式的出现——例如R语言内置函数，**神经网络**迅速获得了普及。神经网络是可以适应的人工智能软件，能够在数据中检测复杂模式：它就像一位经验丰富的老交易员，具备良好的市场直觉，但并不总是能够向你解释为什么他坚信你应该做空**道琼斯工业平均指数**（**DIJA**）。
- en: 'The network architecture consists of a number of nodes connected by links.
    Networks usually have 3 or 4 layers: input, hidden and output layers, and in each
    layer several neurons can be found. The number of first layer''s nodes corresponds
    to the number of the model''s explanatory variables, while the last layer''s equals
    to the number of the response variables (usually 2 neurons in case of binary target
    variable or 1 neuron in case of continuous target variable). The model''s complexity
    and forecast ability is determined by the number of nodes in the hidden layer(s).
    Normally, each node of one layer has connections to all the other nodes of the
    next layer, and these edges (see the figure) represent weights. Every neuron receives
    inputs from the previous layer and, by the use of a non-linear function, it transforms
    to the next layer''s input.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 网络架构由多个节点通过连接相互连接组成。网络通常有3层或4层：输入层、隐藏层和输出层，每一层可以包含多个神经元。第一层的节点数对应模型的解释变量的数量，而最后一层的节点数等于响应变量的数量（对于二元目标变量通常为2个神经元，对于连续目标变量通常为1个神经元）。模型的复杂性和预测能力由隐藏层的节点数决定。通常，一个层的每个节点与下一层的所有其他节点都有连接，这些连接（见图）代表权重。每个神经元从上一层接收输入，并通过非线性函数将其转换为下一层的输入。
- en: A feed-forward NN with one hidden layer can be useful almost in case of any
    kind of complex problems *(Chauvin-Rumelhart, 1995)*, that is why it often used
    by researchers. (*Sermpinis et al., 2012*; *Dai et al, 2012*) *Atsalakis-Valavanis
    (2009)* pointed out, that the **multi-layer precepton** (**MLP**) model that belongs
    to the family of **feed-forward neural networks** (**FFNN**) can be the most effective
    to forecast financial time series. The next graph depicts the structure of a 3
    layer MLP neural network, according to *(Dai et al, 2012)*.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 一个具有单一隐藏层的前馈神经网络几乎可以在任何复杂问题中发挥作用 *(Chauvin-Rumelhart, 1995)*，这也是为什么它被研究人员广泛使用的原因。(*Sermpinis
    et al., 2012*；*Dai et al., 2012*) *Atsalakis-Valavanis (2009)* 指出，属于**前馈神经网络**（**FFNN**）家族的**多层感知器**（**MLP**）模型可能是预测金融时间序列最有效的模型。下图展示了根据
    *(Dai et al., 2012)* 提出的一个三层MLP神经网络的结构。
- en: '![Neural networks](img/2078OT_10_10.jpg)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![神经网络](img/2078OT_10_10.jpg)'
- en: The connection weights (the values of the edges) are assigned initial values
    first. The error between the predicted and actual output values is back-propagated
    via the network for updating the weights. The supervised learning procedure then
    attempts to minimize the error (usually MSE, RMSE or MAPE) between the desired
    and forecasted outputs. Since the network with certain number of neurons in the
    hidden layer can learn any relationship on the learning data (even the outliers
    and noise), by halting the learning algorithm early the prevention of the over-learning
    is possible. The learning process of the network stops when the test segment has
    reached its minimum. Then, with the given parameter the network has to be run
    on the validation segment, see (Wang et al., 2012).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 连接权重（边的值）首先被赋予初始值。预测值与实际输出值之间的误差通过网络进行反向传播，以更新权重。监督学习过程然后尝试最小化期望输出和预测输出之间的误差（通常是MSE、RMSE或MAPE）。由于具有一定数量隐藏层神经元的网络可以学习学习数据上的任何关系（即使是异常值和噪声），通过提前停止学习算法，可以防止过度学习。网络的学习过程在测试集达到最小值时停止。然后，使用给定的参数，网络必须在验证集上运行，见（Wang
    et al., 2012）。
- en: 'There are many practical problems to solve when you create and perform your
    own neural network, for example, the selection of appropriate network topology,
    the selection and the transformation of input variables, the reduction of output
    variance and most importantly the mitigation of over fitting which refers to the
    situation when the error on the training set is very small, but when we fit the
    network on new data the error is large. It means that the network has just memorized
    the training examples but was not successful in understanding the general structure
    of the relationships. In order to avoid overfitting, we need to split the data
    into three subsets: train, validation, test. The training set usually accounting
    for the 60-70% of the total data is used for learning and fitting the network
    parameters. The validation data set (10-20%) is used for minimizing the overfitting
    effect and tuning the parameters, for example to choose the number of hidden nodes
    in a NN. The test data (10-20%) set is used only for testing the final solution
    in order to confirm the predictive power of the network.'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建和执行自己的神经网络时，有许多实际问题需要解决，例如选择合适的网络拓扑结构、选择和转换输入变量、减少输出方差，以及最重要的是缓解过拟合问题。过拟合是指当训练集上的误差非常小，但当我们在新数据上拟合网络时误差较大。这意味着网络仅仅记住了训练样本，而没有成功理解关系的总体结构。为了避免过拟合，我们需要将数据拆分为三个子集：训练集、验证集和测试集。训练集通常占总数据的60-70%，用于学习和拟合网络参数。验证数据集（10-20%）用于最小化过拟合效应并调整参数，例如选择神经网络中的隐藏节点数量。测试数据集（10-20%）仅用于测试最终解决方案，以确认网络的预测能力。
- en: Forecasting bitcoin prices
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 预测比特币价格
- en: Let us see how it works in practice. This example applies trading strategies
    based on the forecasting of the closing prices of Bitcoin. The period between
    3 August 2013 and 8 May 2014 were selected for analysis. There were totally 270
    data points in the dataset and the first 240 data points was used as the training
    sample while the remaining 30 points was used as the testing sample (the forecasting
    models were tested on the last one months of this time series of 9 months).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看它在实践中的运作方式。此示例应用了基于比特币收盘价预测的交易策略。分析选择了2013年8月3日到2014年5月8日之间的时间段。数据集共有270个数据点，前240个数据点作为训练样本，剩下的30个数据点作为测试样本（预测模型在该9个月时间序列的最后一个月上进行了测试）。
- en: First we load the dataset from `Bitcoin.csv` which can be found on the website
    of the book.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们从`Bitcoin.csv`中加载数据集，该文件可以在书籍的官方网站上找到。
- en: '[PRE14]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: In the second step we calculate the log returns and install the `TTR` library
    in order to generate technical indicators.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二步中，我们计算对数收益，并安装`TTR`库来生成技术指标。
- en: '[PRE15]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The six technical indicators selected for modeling have been widely and successfully
    used by researchers and professional traders as well.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 为建模选定的六个技术指标已被研究人员和专业交易员广泛且成功地使用。
- en: '[PRE16]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: We create the Input and Target matrix for training and validation dataset. The
    training and validation dataset include the closing prices and technical indicators
    between August 3, 2013 (700) and April 8, 2014 (940).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为训练和验证数据集创建输入和目标矩阵。训练和验证数据集包括2013年8月3日（700）到2014年4月8日（940）之间的收盘价和技术指标。
- en: '[PRE17]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Now, we install and load the `caret` package order to split our learning dataset.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们安装并加载`caret`包来划分我们的学习数据集。
- en: '[PRE18]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: We split the learning dataset in 90-10% (train-validation) ratio.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将学习数据集按90-10%的比例（训练-验证）进行划分。
- en: '[PRE19]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: We install and load the `nnet` package.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 我们安装并加载了`nnet`包。
- en: '[PRE20]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The appropriate parameters (number of neurons in hidden layer, learning rate)
    are selected by means of the grid search process. The network's input layer comprise
    six neurons (in accordance with the number of explanatory variables), whereas
    networks of 5, 12, …, 15 neurons were tested in the hidden layer. The network
    has one output: the daily yield of the bitcoin. The models were tested at low
    learning rates (0.01, 0.02, 0.03) in the learning process. The convergence criterion
    used was a rule that the learning process would be halted if the 1000th iteration
    has been reached. The network topology with the lowest RMSE in the test set was
    chosen as optimal.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 通过网格搜索过程选择合适的参数（隐藏层中的神经元数量、学习率）。网络的输入层包含六个神经元（与解释变量的数量一致），而隐藏层则测试了包含5、12、…、15个神经元的网络。网络有一个输出：比特币的日收益率。模型在较低的学习率（0.01、0.02、0.03）下进行测试。使用的收敛标准是：如果达到第1000次迭代，则停止学习过程。选择在测试集上具有最低RMSE的网络拓扑作为最优模型。
- en: '[PRE21]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: In this step, we create the Input and Target matrix for the test dataset. The
    test dataset include the closing prices and technical indicators between April
    8, 2013 (940) and May 8, 2014 (969).
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一步，我们为测试数据集创建了输入矩阵和目标矩阵。测试数据集包括2013年4月8日（940）到2014年5月8日（969）之间的收盘价格和技术指标。
- en: '[PRE22]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Finally, we fit the best neural network model on test data.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们在测试数据上拟合了最佳的神经网络模型。
- en: '[PRE23]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: We repeat and average the model 20 times in order to eliminate the outlier networks.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 我们重复并平均该模型20次，以消除异常网络。
- en: '[PRE24]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: We calculate the result of the buy-and-hold benchmark strategy and neural network
    on the test dataset.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我们计算了“买入持有”基准策略和神经网络在测试数据集上的结果。
- en: '[PRE25]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: We plot the investment value according to the benchmark and the neural network
    strategy on the test dataset (1 month).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我们根据基准和神经网络策略在测试数据集（1个月）上绘制了投资价值曲线。
- en: '[PRE26]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![Forecasting bitcoin prices](img/2078OT_10_11.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![预测比特币价格](img/2078OT_10_11.jpg)'
- en: Evaluation of the strategy
  id: totrans-137
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 策略评估
- en: We note that in this illustrative example NN strategy has outperformed the "buy-and-hold"
    strategy in terms of the realized return. With neural network we achieved a return
    of 20% in a month, while with the passive buy and hold strategy it was only 3%.
    However, we didn't take into account the transaction costs, the bid-ask spreads
    and the price impacts and these factors may reduce the neural network's profit
    significantly.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们注意到，在这个示例中，神经网络策略在实现的回报率上超越了“买入持有”策略。通过神经网络，我们在一个月内获得了20%的回报，而采用被动的买入持有策略仅为3%。然而，我们没有考虑到交易成本、买卖差价和价格影响，这些因素可能会显著降低神经网络的利润。
- en: Logoptimal portfolios
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 日志最优投资组合
- en: Contrary to the previous points, let us suppose that there are a finite number
    of risky assets available on the market. These assets are traded continuously
    without any transaction costs. The investor analyses historical market data and
    based on this, can reset her portfolio at the end of each day. How can she maximize
    her wealth in the long run? If returns are independent in time, then markets are
    efficient in the weak sense and the time series of returns have no memory. If
    returns are also identically distributed (i.i.d), the optimal strategy is to set
    portfolio weights for example, according to the Markowitz model (see *Daróczi
    et al. 2013*) and to keep portfolio weights fixed over the whole time horizon.
    In this setting, any rearrangements would have negative effects on the portfolio
    value in the long run.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 与前面的观点相反，假设市场上有有限数量的风险资产。这些资产在没有任何交易成本的情况下进行持续交易。投资者分析历史市场数据，并基于这些数据，在每一天结束时重新调整她的投资组合。她如何在长期内最大化财富？如果回报在时间上是独立的，那么市场在弱意义上是有效的，回报的时间序列没有记忆。如果回报也是独立同分布（i.i.d.），则最优策略是根据例如马科维茨模型（见*Daróczi
    et al. 2013*）设定投资组合权重，并在整个时间范围内保持这些权重不变。在这种情况下，任何调整都将对长期的投资组合价值产生负面影响。
- en: Now, let us suspend the assumption of longitudinal independency, hence let us
    allow for hidden patterns in the asset returns, therefore markets are not efficient
    and it is worth analyzing historical price movements. The only assumption we keep
    is that asset returns are generated by a stationary and ergodic process. It can
    be shown that the best choice is the so called **logoptimal portfolio**, see *Algoet-Cover
    (1988)*. More precisely, there are no other investment strategies which have asymptotically
    higher expected return than the logoptimal portfolio. The problem is that in order
    to determine logoptimal portfolios one should know the generating process.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们暂时放弃纵向独立性的假设，允许资产回报中存在隐藏的模式，因此市场不是有效的，分析历史价格变动是有意义的。我们保留的唯一假设是，资产回报由一个平稳且遍历的过程生成。可以证明，最佳的选择是所谓的**对数最优投资组合**，参见*Algoet-Cover
    (1988)*。更精确地说，没有其他投资策略在渐近过程中能获得比对数最优投资组合更高的预期回报。问题在于，为了确定对数最优投资组合，必须知道生成过程。
- en: But, what can we do in a more realistic setting when we know nothing about the
    nature of the underlying stochastic process? A strategy is called **universally
    consistent** if it ensures that asymptotically the average growth rate approximates
    that of the logoptimal strategy for any (!) generating process being stationary
    and ergodic. It is surprising, but universally consistent strategies exist, see
    *Algoet-Cover (1988)*. Thus, the basic idea is to search for patterns in the past
    that are similar to the most recently observed pattern, and building on this,
    to forecast the future returns and to optimize the portfolio relative to this
    forecast. The concept of similarity can be defined in different ways, therefore
    we can use different approaches, for example partitioning estimator, core function
    based estimator and nearest neighbor estimator. For illustration purposes, in
    the next point we present a simple universally consistent strategy which is based
    on the core function approach according to *Györfi et al. (2006)*.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，在我们对基础随机过程的性质一无所知的情况下，如何在更现实的环境中进行操作呢？如果一种策略能够确保在渐近过程中，平均增长率趋近于对任何（！）生成过程为平稳且遍历的情况下，*对数最优策略*的增长率，则称该策略为**普遍一致**。这虽然令人惊讶，但确实存在普遍一致的策略，参见*Algoet-Cover
    (1988)*。因此，基本思想是寻找过去的模式，这些模式与最近观察到的模式相似，并在此基础上预测未来的回报，并优化相对于该预测的投资组合。相似性的概念可以通过不同的方式来定义，因此我们可以采用不同的方法，例如划分估计器、基于核心函数的估计器和最近邻估计器。为便于说明，下一节我们将展示一个简单的普遍一致策略，该策略基于*Györfi等人（2006）*的核心函数方法。
- en: A universally consistent, non-parametric investment strategy
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一种普遍一致的非参数投资策略
- en: 'Let us suppose that there are d different stocks traded on the market. Vector
    ***b*** containing portfolio weights can be rearranged every day. We suppose that
    portfolio weights are nonnegative (short selling is not allowed) and the sum of
    the weights is always 1 (the portfolio must be self-financing). Vector ***x***
    contains price relatives ![A universally consistent, non-parametric investment
    strategy](img/2078OT_10_12.jpg) where *P* stands for the closing price on the
    *i*th day. The investor''s initial wealth is *S[0]*, hence her wealth at the end
    of the *n*th period is as follows:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 假设市场上有d只不同的股票进行交易。包含投资组合权重的向量***b***可以每天重新排列。我们假设投资组合权重是非负的（不允许卖空），并且权重的总和始终为1（投资组合必须是自我融资的）。向量***x***包含价格相对值
    ![一种普遍一致的非参数投资策略](img/2078OT_10_12.jpg)，其中*P*代表第*i*天的收盘价。投资者的初始财富为*S[0]*，因此她在第*n*期末的财富如下：
- en: '![A universally consistent, non-parametric investment strategy](img/2078OT_10_19.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![一种普遍一致的非参数投资策略](img/2078OT_10_19.jpg)'
- en: where ![A universally consistent, non-parametric investment strategy](img/2078OT_10_20.jpg)
    is the scalar product of the two vectors, n is the number of the days we followed
    the investment strategy, *W[n]* is the average log return over the *n* days and
    ***B*** represents all the ***b*** vectors applied. Therefore, the task is to
    determine a reallocation rule in a way that *W[n]* be maximal in the long run.
    Here we present a simple universally consistent strategy which disposes this attractive
    property. Let *J[n]* denote the set of days which are similar to the most recently
    observed day in terms of the Euclidean distance. It is determined by the formula
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，![一个普遍一致的、非参数的投资策略](img/2078OT_10_20.jpg) 是两个向量的标量积，n 是我们跟随投资策略的天数，*W[n]*
    是 *n* 天内的平均对数回报，***B*** 表示所有应用的 ***b*** 向量。因此，任务是确定一种重新分配规则，使得 *W[n]* 在长期内最大化。这里，我们展示了一种简单的普遍一致策略，具有这种吸引人的特性。设
    *J[n]* 表示与最近观察到的那一天在欧几里得距离上相似的日期集合。它由以下公式确定：
- en: '![A universally consistent, non-parametric investment strategy](img/2078OT_10_15.jpg)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![一个普遍一致的、非参数的投资策略](img/2078OT_10_15.jpg)'
- en: 'where *r[l]* is the maximum allowed distance (radium) selected by the *l*th
    expert. The logoptimal portfolio according to the *l*th expert on day *n* can
    be expressed in the following way:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，*r[l]* 是由第 *l* 位专家选择的最大允许距离（半径）。根据第 *l* 位专家在第 *n* 天的对数最优投资组合可以用以下方式表示：
- en: '![A universally consistent, non-parametric investment strategy](img/2078OT_10_21.jpg)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![一个普遍一致的、非参数的投资策略](img/2078OT_10_21.jpg)'
- en: In order to get a well-balanced and robust strategy we define different experts
    (portfolio managers) with different radium, and we allocate our wealth to different
    experts according to a weight vector ***q***. Weights can be equal; or can depend
    on the previous performance of the experts or on other characteristics. This way
    we combine the opinion of several experts and our wealth on the *n*th day is
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得一个均衡且稳健的策略，我们定义了不同的专家（投资组合经理），他们具有不同的半径，并根据权重向量***q***将财富分配给不同的专家。权重可以相等，也可以根据专家的历史表现或其他特征来确定。通过这种方式，我们结合了多个专家的意见，我们在第
    *n* 天的财富为：
- en: '![A universally consistent, non-parametric investment strategy](img/2078OT_10_22.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![一个普遍一致的、非参数的投资策略](img/2078OT_10_22.jpg)'
- en: 'Let us suppose that we are an expert and we follow the above strategy between
    1997 and 2006 on the market of four NYSE stocks (aph, alcoa, amerb, and coke)
    plus a U.S. treasury bond and we use a moving time-window of one year. Data can
    be collected for example from here: [http://www.cs.bme.hu/~oti/portfolio/data.html](http://www.cs.bme.hu/~oti/portfolio/data.html).
    Let us first read the data in.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们是专家，并且在1997到2006年期间，跟随上述策略，投资于四只纽约证券交易所的股票（aph, alcoa, amerb, 和coke）以及美国国债，并使用一年期的滚动时间窗口。数据可以从以下链接获取：[http://www.cs.bme.hu/~oti/portfolio/data.html](http://www.cs.bme.hu/~oti/portfolio/data.html)。首先，我们将数据读入。
- en: '[PRE27]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This function calculates the expected value of the portfolio in line with the
    portfolio weights depending on the radium (*r*) we set in advance.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数根据我们预先设置的半径（*r*）计算与投资组合权重相关的预期价值。
- en: '[PRE28]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: This function calculates the optimal portfolio weights for a particular day.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 该函数计算特定日期的最优投资组合权重。
- en: '[PRE29]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Now we optimize the portfolio weight for all the days we found similar. At the
    same time we also calculate the actual value of our investment portfolio for each
    day.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们对所有找到的相似日期进行投资组合权重优化。同时，我们还计算了每一天投资组合的实际价值。
- en: '[PRE30]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Finally, let us plot the investment value in time.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们绘制随时间变化的投资价值。
- en: '[PRE31]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'We got the following graph:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到以下图表：
- en: '![A universally consistent, non-parametric investment strategy](img/2078OT_10_18.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![一个普遍一致的、非参数的投资策略](img/2078OT_10_18.jpg)'
- en: Evaluation of the strategy
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略评估
- en: We can see on the above graph that our log-optimal strategy outperformed the
    passive benchmark of keeping portfolio weights equal and fixed over time. However,
    it is notable that not only the average return, but also the volatility of the
    investment value is much higher in the former case.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 从上面的图表中可以看到，我们的对数最优策略优于始终保持投资组合权重相等且固定的被动基准策略。然而，值得注意的是，在前一种情况下，不仅平均回报率较高，投资价值的波动性也要大得多。
- en: It is mathematically proven that there exist non-parametric investment strategies
    which are able to effectively reveal hidden patterns in the realized returns and
    to exploit them in order to achieve an "almost" optimal growth rate in the investor's
    wealth. For this, we do not have to know the underlying process; the only assumption
    is that the process is stationary and ergodic. However, we cannot be sure that
    this assumption holds in reality. It is also important to emphasize that these
    strategies are optimal only in the asymptotic sense, but we know little about
    the short run characteristics of the potential paths.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 数学上已证明，存在一些非参数化的投资策略，这些策略能够有效地揭示已实现回报中的隐藏模式，并利用它们实现投资者财富的“几乎”最优增长率。为了这一目标，我们不需要知道基础过程；唯一的假设是该过程是平稳的且是遍历的。然而，我们不能确定这一假设在现实中是否成立。同样重要的是要强调，这些策略仅在渐近意义上是最优的，但我们对潜在路径的短期特征知之甚少。
- en: Summary
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'In this chapter we overviewed not only technical analysis but also some corresponding
    strategies, like neural networks and log-optimal portfolios. These methods are
    similar in the sense that when applying them, we implicitly suppose that past
    situations may reappear in the future; therefore we took the courage to challenge
    the concept of market efficiency and to build up an active trading strategy. In
    this setting, we discussed the problems of forecasting the price of a single asset
    (bitcoin), optimizing the timing of our trading, and also optimizing our portfolio
    of several risky assets (NYSE stocks) in a dynamic manner. We demonstrated that
    some simple algorithms based on the toolkit available in R can produce significant
    extra profit relative to the passive strategy of buying-and-holding. We also note
    however, that a comprehensive performance analysis focuses not only on the average
    returns, but also on the corresponding risks. Therefore, we suggest that when
    optimizing your strategy take care of the downturns, the volatility and other
    risk measures as well. And, of course, you must be aware of the limitations of
    the presented methods: you cannot be sure to know the return generating process;
    if you trade frequently, you have to pay a lot of transaction costs; and the more
    you get rich, the more you suffer from the adverse price impact and so on. However,
    we do hope you got new inspirations and useful hints to develop your own sophisticated
    trading strategy.'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 本章不仅概述了技术分析，还讨论了一些相应的策略，如神经网络和log-optimal投资组合。这些方法在某种意义上是相似的：应用它们时，我们隐含地假设过去的情况可能会在未来重现；因此，我们大胆挑战市场效率的概念，建立了一个主动交易策略。在这种框架下，我们讨论了预测单一资产（比特币）价格、优化交易时机以及动态优化多个风险资产（纽约证券交易所股票）投资组合的问题。我们展示了一些基于R工具包的简单算法，相比于被动的买入并持有策略，它们能够产生显著的额外收益。然而，我们也注意到，一个全面的绩效分析不仅要关注平均回报，还要考虑相应的风险。因此，我们建议在优化策略时，注意市场下行、波动性以及其他风险度量。当然，您还必须意识到所呈现方法的局限性：您不能确定已知的回报生成过程；如果频繁交易，您需要支付大量的交易成本；而且，随着财富的增加，您会遭遇更多的不利价格影响等等。然而，我们确实希望您能够获得新的启发和有用的提示，以便发展出您自己的复杂交易策略。
- en: References
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: Algoet, P.; Cover, T. (1988) Asymptotic optimality, asymptotic equipartition
    properties of logoptimal investments, Annals of Probability, 16, pp. 876-898
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Algoet, P.; Cover, T. (1988) 渐近最优性，log-optimal投资的渐近等分性质，《概率年刊》，16，第876-898页
- en: Atsalakis, G. S. Valavanis, K. P. (2009) Surveying stock market forecasting
    techniques-Part II. Soft computing methods. Expert Systems with Applications,
    36(3), pp. 5932-5941
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Atsalakis, G. S. Valavanis, K. P. (2009) 股票市场预测技术调查-第二部分：软计算方法。《应用专家系统》，36(3)，第5932-5941页
- en: 'Bajgrowicz, P; Scaillet, O. (2012) Technical trading revisited: False discoveries,
    persistence tests, and transaction costs, Journal of Financial Economics, Vol.
    106, pp. 473-491'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Bajgrowicz, P; Scaillet, O. (2012) 技术性交易再探：虚假发现、持久性测试与交易成本，《金融经济学杂志》，第106卷，第473-491页
- en: 'Chauvin, Y.; Rumelhart, D. E. (1995) Back propagation: Theory, architectures,
    and applications. New Jersey: Lawrence Erlbaum associates.'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Chauvin, Y.; Rumelhart, D. E. (1995) 反向传播：理论、架构与应用。新泽西州：劳伦斯·厄尔鲍姆协会。
- en: Dai, W.; Wu, J-Y.; Lu, C-J. (2012) Combining nonlinear independent component
    analysis and neural network for the prediction of Asian stock market indexes.
    Expert Systems with Application, 39(4), pp. 4444-4452
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Dai, W.; Wu, J-Y.; Lu, C-J. (2012) 结合非线性独立成分分析与神经网络预测亚洲股市指数。《应用专家系统》，39(4)，第4444-4452页
- en: Daróczi, G. et al. (2013) Introduction to R for Quantitative Finance, Packt
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Daróczi, G. 等 (2013) 《定量金融的R语言入门》，Packt  '
- en: Györfi, L.; Lugosy, G.; Udina, F. (2006) Non-parametric Kernel-based sequential
    investment strategies, International Journal of Theoretical and Applied Finance,
    10, pp. 505-516
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Györfi, L.; Lugosy, G.; Udina, F. (2006) 非参数核基序列投资策略，《理论与应用金融国际期刊》，第10卷，第505-516页  '
- en: Sermpinis, G.; Dunis, C.; Laws, J.; Stasinakis, C. (2012) Forecasting and trading
    the EUR/USD exchange rate with stochastic Neural Network combination and time-varying
    leverage. Decision Support Systems, 54(1), pp. 316-329
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Sermpinis, G.; Dunis, C.; Laws, J.; Stasinakis, C. (2012) 利用随机神经网络组合和时变杠杆预测和交易欧元/美元汇率，《决策支持系统》，第54卷（第1期），第316-329页  '
- en: Tajaddini, R.; Falcon Crack, T. (2012) Do momentum-based trading strategies
    work in emerging currency markets?, Journal of International Financial Markets,
    Institutions & Money, Vol. 22, pp. 521-537
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Tajaddini, R.; Falcon Crack, T. (2012) 动量型交易策略在新兴货币市场中的有效性，《国际金融市场、机构与货币期刊》，第22卷，第521-537页  '
- en: Wang, J. J.; Wang, J. Z.; Zhang, Z. G.; Guo, S. P. (2012) Stock index forecasting
    based on a hybrid model. Omega, 40(6), pp. 758-766
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Wang, J. J.; Wang, J. Z.; Zhang, Z. G.; Guo, S. P. (2012) 基于混合模型的股票指数预测，《欧米茄》，第40卷（第6期），第758-766页  '
- en: 'Zapranis, A.; T. E. Prodromos (2012) A novel, rule-based technical pattern
    identification mechanism: Identifying and evaluating saucers and resistant levels
    in the US stock market, Expert Systems with Applications, Vol. 39, pp. 6301-6308'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zapranis, A.; T. E. Prodromos (2012) 一种新颖的基于规则的技术模式识别机制：识别和评估美国股市中的盘形和支撑位，《专家系统与应用》，第39卷，第6301-6308页
- en: Zwart, G.; Markwat, T.; Swinkels, L.; van Dijk, D. (2009) The economic value
    of fundamental and technical information in emerging currency markets, Journal
    of International Money and Finance, Vol. 28\. pp. 581-604
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Zwart, G.; Markwat, T.; Swinkels, L.; van Dijk, D. (2009) 新兴货币市场中基本面和技术信息的经济价值，《国际货币与金融期刊》，第28卷，第581-604页  '
