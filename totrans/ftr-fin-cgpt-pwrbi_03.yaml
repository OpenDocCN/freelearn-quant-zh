- en: '2'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Creating Financial Narratives with Power BI and ChatGPT
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter provides a brief overview of Microsoft Power BI and its applications
    in finance. We will also cover a list of the benefits of Power BI and its uses
    in finance. Then, we will consider the importance of data modeling in financial
    analysis and provide tips for creating effective financial visualizations. Finally,
    we will cover best practices for data modeling, visualization, and ChatGPT integration.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: A brief overview of Power BI and its applications in finance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The importance of structuring data in financial analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Visualization techniques in Power BI
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating financial dashboards with Power BI
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Best practices for data modeling, visualization, and ChatGPT integration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Walk-through use case – analyzing financial data using Power BI
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Walk-through use case – analyzing financial ratios using Power BI and ChatGPT
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By the end of this chapter, you should have a good understanding of what Microsoft
    Power BI can do in terms of visualizing financial information and how we can leverage
    ChatGPT and AI to enhance these with powerful insights.
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are a few technical issues that you will need to address if you are to
    follow along and understand/try the examples yourself. You will require the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Access to a stable and reasonably fast internet connection.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A newer version of Microsoft Power BI on your desktop. Microsoft sells one of
    its Office versions with Power BI included. Pricing varies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Python 3.5 or above installed on your desktop. Look for the latest stable version.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A basic understanding of visualizations using Power BI – simple reports and
    charts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A basic understanding of Python scripting and the use of packages in Python.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An account with Open AI. You must also understand what “API” means.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A basic understanding of finance. You must be acquainted with company balance
    sheets and income statements and understand the difference between the two.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With this set of knowledge and tools, we are confident that you will understand
    the chapters to follow.
  prefs: []
  type: TYPE_NORMAL
- en: A brief overview of Power BI and its applications in finance
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This section is an introduction to Power BI and its applications in finance.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI is a powerful data analytics and visualization tool developed by Microsoft.
    It has gained popularity in recent years due to its ease of use, versatility,
    and ability to handle substantial amounts of data.
  prefs: []
  type: TYPE_NORMAL
- en: In finance, Power BI can be used to analyze and visualize financial data to
    provide deeper insights into a company’s financial performance. Finance professionals
    can connect to a wide range of data sources, including spreadsheets, databases,
    and cloud-based applications, to create dynamic and visual reports that can be
    shared across the organization.
  prefs: []
  type: TYPE_NORMAL
- en: One key application of Power BI in finance is creating financial dashboards.
    Power BI enables finance professionals to create interactive dashboards that provide
    a real-time view of a company’s financial performance. Dashboards can include
    **key performance indicators** (**KPIs**) such as revenue, gross margin, and operating
    expenses, as well as visualizations such as line charts, bar charts, and pie charts.
    These dashboards provide a quick and easy way for decision-makers to understand
    the financial health of the organization and make informed decisions.
  prefs: []
  type: TYPE_NORMAL
- en: Another application of Power BI is analyzing financial statements. Power BI
    can be used to analyze financial statements such as income statements, balance
    sheets, and cash flow statements. By visualizing financial data in this way, finance
    professionals can identify trends and patterns that might otherwise be difficult
    to spot. For example, they can analyze revenue and expenses by department or location
    or identify changes in working capital over time.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI can also be used for forecasting and budgeting. Finance professionals
    can create predictive models that forecast financial outcomes, such as revenue
    and expenses, based on historical data. This can help finance professionals make
    more accurate predictions and create better budgets. By identifying trends and
    patterns in the data, they can also adjust budgets in real time, making more informed
    decisions about resource allocation.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI is also useful for identifying opportunities for cost savings. By analyzing
    financial data in Power BI, finance professionals can identify areas where costs
    can be reduced or eliminated. For example, they can identify inefficiencies in
    the supply chain or reduce excess inventory. By reducing costs, they can help
    increase profitability and drive business growth.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, Power BI enables finance professionals to collaborate with other departments.
    By sharing interactive dashboards and reports, teams can make data-driven decisions
    that align around common goals and drive business growth.
  prefs: []
  type: TYPE_NORMAL
- en: Overall, Power BI is a valuable tool for finance professionals that can help
    them gain insights from complex financial data and make data-driven decisions
    that drive business growth. By visualizing and analyzing financial data in this
    way, finance professionals can identify trends, spot opportunities, and make informed
    decisions that help their organizations succeed.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we’ll review the benefits of combining Power BI with ChatGPT
    insights.
  prefs: []
  type: TYPE_NORMAL
- en: The benefits of combining Power BI with ChatGPT insights
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this section, we will review the benefits of combining Power BI with ChatGPT
    insights.
  prefs: []
  type: TYPE_NORMAL
- en: A big advantage of using Power BI in financial analysis is improved data accuracy.
    Power BI enables finance professionals to connect to various data sources and
    analyze data in real time. This means that the data is always up-to-date and accurate,
    which improves the accuracy of financial analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI also provides a range of visualization options that allow finance professionals
    to present complex financial data in a clear and consumable way. By visualizing
    data in this way, decision-makers can quickly understand trends, patterns, and
    relationships between different financial metrics.
  prefs: []
  type: TYPE_NORMAL
- en: Furthermore, Power BI enables teams to work together on financial analysis by
    sharing reports and dashboards. This means that multiple stakeholders can collaborate
    on financial analysis, share insights, and make better-informed decisions. This
    can help finance professionals break down silos and work more effectively with
    other parts of the organization.
  prefs: []
  type: TYPE_NORMAL
- en: Since Power BI can handle substantial amounts of data, it makes it ideal for
    financial analysis. As companies grow and generate more financial data, Power
    BI can scale to meet the needs of the organization.
  prefs: []
  type: TYPE_NORMAL
- en: It can be a time-saving tool because, with Power BI, finance professionals can
    quickly create reports and dashboards that provide insights into financial performance.
    Compare this to traditional methods of financial analysis, such as manual data
    entry and spreadsheet analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI enables the creation of interactive dashboards. They provide a real-time
    view of financial performance. Dashboards can include KPIs, visualizations, and
    other data that provide a quick and easy way for decision-makers to understand
    the financial health of the organization. By visualizing financial data in this
    way, finance professionals can identify trends and patterns that might otherwise
    be difficult to spot. For example, they can identify areas where costs can be
    reduced or identify growth opportunities. By making data-driven decisions, organizations
    can better align around common goals and drive business success.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI can be used to create predictive models that forecast financial outcomes.
    By identifying trends and patterns in the data, finance professionals can make
    more accurate predictions and create better budgets.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI can be a cost-effective solution for financial analysis as it is part
    of Microsoft Power Platform, which includes Power Apps and Power Automate, and
    is available as a cloud-based service or as an on-premises solution. This means
    that organizations can choose the deployment option that best meets their needs
    and budget.
  prefs: []
  type: TYPE_NORMAL
- en: ChatGPT, and its **large language model** (**LLM**) base, extend the already
    excellent capabilities of Power BI. There are multiple areas of potential synergy
    between Power BI and ChatGPT.
  prefs: []
  type: TYPE_NORMAL
- en: ChatGPT insights can be used to predict future trends and patterns based on
    past financial data. Power BI can then be used to visualize these insights and
    provide a more in-depth understanding of financial performance quickly.
  prefs: []
  type: TYPE_NORMAL
- en: Using ChatGPT’s **natural language processing** (**NLP**) capabilities, the
    insights it provides can be used to process unstructured data such as customer
    feedback, social media posts, and emails. Power BI can then be used to visualize
    this data in a way that provides insights into customer behavior and preferences.
  prefs: []
  type: TYPE_NORMAL
- en: ChatGPT insights can be used to provide insights into customer behavior and
    preferences, which can then be used to inform financial decision-making. Power
    BI can then be used to visualize this data in a way that makes it easy for decision-makers
    to understand.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI can be used to connect to various data sources, including ChatGPT insights.
    This enables finance professionals to combine insights from multiple sources and
    create a more comprehensive view of financial performance. Furthermore, by combining
    these tools, teams can work together on financial analysis, share insights, and
    make better-informed decisions. Another use of combining ChatGPT and Power BI
    is in automating many of the tasks associated with financial analysis. This can
    include tasks such as data preparation, data cleansing, and report creation. By
    automating these tasks, finance professionals can spend more time on analysis
    and decision-making.
  prefs: []
  type: TYPE_NORMAL
- en: Overall, the combination of Power BI and ChatGPT insights provides finance professionals
    with a powerful set of tools that can be used to gain insights into financial
    performance. By visualizing and analyzing financial data in this way, decision-makers
    can identify trends, spot opportunities, and make informed decisions that help
    their organizations succeed.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we’ll talk about the importance of structuring data in
    financial analysis.
  prefs: []
  type: TYPE_NORMAL
- en: The importance of structuring data in financial analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will look at the importance of structuring data when performing
    financial analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'Power BI offers several techniques for structuring financial data, including
    data modeling, data shaping, and data transformation:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Data modeling**: As we stated previously, data modeling is the process of
    creating a data model or schema that defines the relationships between different
    data points. In Power BI, data modeling involves creating a model using the Power
    Pivot data modeling engine. This allows finance professionals to define relationships
    between tables, create calculated columns and measures, and create hierarchies.
    A well-designed data model can make it easier to analyze financial data and gain
    insights. Data modeling forms a critical aspect of financial analysis. It enables
    finance professionals to transform raw data into useful insights that can inform
    financial decisions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data shaping**: Data shaping is the process of filtering, sorting, and aggregating
    data to make it more useful for analysis. In Power BI, data shaping is accomplished
    using Power Query Editor, which provides a graphical interface for shaping data,
    including filtering data, removing columns, and merging tables. By shaping the
    data, finance professionals can eliminate irrelevant data and focus on the data
    that is most relevant to their analysis.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data transformation**: Data transformation is the process of converting data
    from one form into another. In Power BI, data transformation can be accomplished
    using Power Query Editor, which provides a wide range of transformation options,
    including splitting columns, merging tables, and pivoting data. By transforming
    data, finance professionals can create new insights and visualizations that were
    not previously possible.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`DATESYTD`, `TOTALYTD`, and `SAMEPERIODLASTYEAR`. Time intelligence can be
    used to analyze trends, identify seasonality, and forecast future performance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom visuals**: Power BI provides a wide range of custom visuals that can
    be used to create more engaging and informative visualizations. Custom visuals
    include charts, gauges, and maps, as well as more specialized visuals such as
    bullet charts and Gantt charts. By using custom visuals, finance professionals
    can create visualizations that are tailored to their specific needs and requirements.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: So, Power BI offers a range of techniques for structuring financial data, including
    data modeling, data shaping, and data transformation. These techniques can be
    used to create a well-designed data model, eliminate irrelevant data, analyze
    trends over time, and create more engaging and informative visualizations. By
    using these techniques, finance professionals can gain a more comprehensive understanding
    of financial performance and make more informed decisions.
  prefs: []
  type: TYPE_NORMAL
- en: To effectively use Power BI for financial analysis, it is essential to understand
    how to connect data sources and create relationships between tables. This process
    allows users to create powerful reports and visualizations that provide valuable
    insights into financial performance.
  prefs: []
  type: TYPE_NORMAL
- en: The first step in using Power BI for financial analysis is to connect to the
    data sources that contain the financial data. When connecting to a data source
    in Power BI, there are several options available, including importing data, connecting
    directly to a database, or using a custom data connector. Power BI can connect
    to a large number of data sources, including Excel files, CSV files, SQL databases,
    and cloud-based sources such as Azure and Salesforce. Once the data sources are
    connected, the next step is to import the data into Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: Importing data into Power BI
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Importing data into Power BI is a straightforward process. Users can select
    the tables they want to import and then click on the **Load** button. Power BI
    will import the data and create a table for each source. Once the data has been
    imported, the next step is to create relationships between tables.
  prefs: []
  type: TYPE_NORMAL
- en: Creating relationships between tables is a crucial step in using Power BI for
    financial analysis. Relationships allow users to create reports and visualizations
    that show the relationship between different sets of data. To create relationships
    between tables, users need to understand the concept of a relationship key.
  prefs: []
  type: TYPE_NORMAL
- en: A relationship key is a unique identifier that is used to link two tables together.
    For example, if we are analyzing sales data and inventory data, we might use the
    product ID as the relationship key. The product ID is a unique identifier that
    is assigned to each product, and it can be used to link the sales table and the
    inventory table together.
  prefs: []
  type: TYPE_NORMAL
- en: Power BI provides several tools to establish relationships, including the diagram
    view, which allows for a visual representation of the data model and relationships.
    In this view, tables can be dragged and dropped to create relationships, and fields
    can be selected as keys for establishing relationships.
  prefs: []
  type: TYPE_NORMAL
- en: To create a relationship between two tables in Power BI, users need to select
    the **Manage Relationships** option from the **Home** tab. They can then select
    the tables they want to link together and choose the columns they want to use
    as the relationship key. Once the relationship has been created, users can use
    it to create powerful reports and visualizations that show the relationship between
    different sets of data.
  prefs: []
  type: TYPE_NORMAL
- en: In addition to the diagram view, Power BI also provides the relationship view,
    which allows for more advanced management of relationships. In this view, users
    can define relationship properties, such as cardinality and cross-filtering, to
    ensure that the relationships are properly defined and functioning as intended.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s look at an example to understand how to create relationships between
    tables in Power BI. Suppose we are analyzing the financial performance of a retail
    company, and we have data from two sources: sales data and inventory data. The
    sales data is in an Excel file, and the inventory data is in a SQL database. We
    want to create a report that shows the relationship between sales and inventory
    levels.'
  prefs: []
  type: TYPE_NORMAL
- en: In this case, we would start by connecting to the Excel file and the SQL database
    in Power BI. We would then import the sales data and the inventory data into Power
    BI. Once the data has been imported, we can create a relationship between the
    sales table and the inventory table by selecting the **Manage Relationships**
    option and choosing the product ID column as the relationship key.
  prefs: []
  type: TYPE_NORMAL
- en: Once the relationship has been created, we can create a report that shows the
    relationship between sales and inventory levels. For example, we could create
    a report that shows sales by product category, with a visual that shows inventory
    levels for each category. We could then use the relationship between the sales
    table and the inventory table to show how changes in inventory levels affect sales.
  prefs: []
  type: TYPE_NORMAL
- en: In conclusion, connecting data sources and creating relationships between tables
    is a crucial step in using Power BI for financial analysis. By connecting data
    sources and creating relationships, finance professionals can create powerful
    reports and visualizations that provide valuable insights into financial performance.
    By using the Power BI data modeling engine, finance professionals can easily create
    relationships between tables and analyze complex financial data.
  prefs: []
  type: TYPE_NORMAL
- en: This leads us to the next section, where we’ll look at visualization techniques
    in Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: Visualization techniques in Power BI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we noted earlier, Power BI offers a wide range of visualization techniques
    to help users effectively communicate insights from their data. These include
    standard charts such as bar charts, line charts, and scatterplots, as well as
    more advanced visuals such as heat maps, tree maps, and gauges. Power BI also
    allows for custom visualizations to be created using JavaScript or R. In addition
    to these visuals, Power BI provides options for interactivity, such as drill-down
    and filtering, to enable users to explore their data and gain deeper insights.
    Overall, Power BI’s visualization capabilities allow for clear and impactful communication
    of data-driven insights.
  prefs: []
  type: TYPE_NORMAL
- en: Selecting appropriate visualizations for financial data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Selecting appropriate visualizations is an important aspect of creating effective
    financial dashboards and reports in Power BI. Here are five considerations to
    keep in mind when choosing visualizations for financial data:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Determine the purpose of the visualization**: What story are you trying to
    tell with your data? Are you looking to compare values, show trends over time,
    or display proportions? The purpose of the visualization will dictate the type
    of chart or graph that is most appropriate.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Consider the nature of the data**: The type of data being visualized is also
    important. For example, a stacked bar chart may be appropriate for comparing revenue
    from different product lines, but not for displaying a time series of revenue
    growth over multiple years.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Focus on simplicity**: While it can be tempting to use complex visualizations
    to show off your data analysis skills, simplicity is often more effective. Choose
    visuals that are easy to understand and communicate the intended message.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use color effectively**: Color can be a powerful tool in visualizing financial
    data, but it can also be overwhelming if not used appropriately. Use color sparingly
    and intentionally to draw attention to key data points or highlight trends.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Utilize interactivity**: Power BI allows for interactivity, such as drill-down
    and filtering, which can be particularly useful for financial data. Consider how
    users will want to interact with the data and provide appropriate options.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here is a list of some common visualizations for financial data:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bar charts**: Used for comparing values across categories'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Line charts**: Used for showing trends over time'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pie charts**: Used for showing proportions or percentages'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Area charts**: Like line charts but with shaded areas to represent the magnitude
    of the values'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Heat maps**: Used for displaying large amounts of data in a visual format,
    with color coding indicating the magnitude of the values'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ultimately, the appropriate visualization will depend on the specific financial
    data being analyzed and the story you are trying to tell with that data. By considering
    the purpose of the visualization, the nature of the data, and other factors such
    as simplicity and interactivity, you can create impactful and informative financial
    dashboards and reports in Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: Tips for creating effective financial visualizations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here are a few tips for creating effective financial visualizations with Power
    BI:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Understand your audience**: Before creating any visualizations, it’s important
    to understand who your audience is and what information they need. Consider what
    questions they may have and what insights they are looking for.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keep it simple**: Avoid cluttering visualizations with unnecessary information.
    Focus on the key data points that will provide the most valuable insights.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use the right chart types**: Different chart types are suited for different
    types of data. It’s important to choose the appropriate chart type to effectively
    communicate the data. For example, line charts are ideal for showing trends over
    time, while bar charts are better suited for comparing different categories of
    data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Utilize color**: Color can be a powerful tool in visualizations to highlight
    key data points or trends. However, it’s important to use color effectively and
    not overdo it, as too many colors can be overwhelming.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use data labels**: Data labels can provide additional context and clarity
    to visualizations. Use them to highlight important data points or provide additional
    information.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Provide context**: Visualizations should provide context to the data being
    displayed. This can be achieved through the use of axis labels, titles, and annotations.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Consider interactivity**: Power BI offers a range of interactive features,
    such as drill-down and filtering. Consider how these features can be used to provide
    deeper insights into the data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Utilize branding**: Branding can be used to make visualizations more professional
    and cohesive. Use company colors, logos, and fonts to help tie visualizations
    into the overall brand.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Test and iterate**: Visualizations should be tested and iterated upon to
    ensure they effectively communicate the desired insights. Solicit feedback from
    stakeholders and make adjustments as needed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keep it up to date**: Visualizations should be updated regularly to ensure
    they reflect the most current data and insights.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By following these tips, you can create effective and impactful financial visualizations
    with Power BI that provide valuable insights to your audience.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s look at an example of how Power BI can be used in analyzing sales data
    for a company’s products, using the information detailed in the previous sections.
    Let’s say you’re analyzing sales data for a company’s products. You’ve pulled
    in data from multiple sources, cleaned and transformed it using Power BI’s data
    modeling capabilities, and now you want to create a visualization to help you
    better understand the data.
  prefs: []
  type: TYPE_NORMAL
- en: You have decided to create a bar chart to compare the sales performance of each
    product. You choose to color code the bars based on the product category to help
    differentiate them. You also add data labels to each bar to show the exact sales
    amount for each product.
  prefs: []
  type: TYPE_NORMAL
- en: To provide context, you add axis labels for the sales amount and the product
    names. You also add a title to the chart to give a clear indication of what it
    represents.
  prefs: []
  type: TYPE_NORMAL
- en: As you review the chart, you notice that one product category is significantly
    outperforming the others. To investigate further, you use Power BI’s interactive
    features to drill down into the data for that category and discover that a particular
    product is responsible for the majority of the sales.
  prefs: []
  type: TYPE_NORMAL
- en: By creating this visualization, you were able to quickly identify which products
    were performing well and which needed improvement, and easily drill down into
    the data to gain deeper insights.
  prefs: []
  type: TYPE_NORMAL
- en: This is just one example of how Power BI can be used to create effective financial
    visualizations that provide valuable insights.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we learned about visualization techniques in Power BI and how
    these visuals can provide a graphic and understandable view of financial data.
    In the next section, we’ll talk a bit more about the process of creating financial
    dashboards with Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: Creating financial dashboards with Power BI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Planning and designing a financial dashboard in Power BI involves a few key
    steps to ensure that the dashboard meets the needs of its users.
  prefs: []
  type: TYPE_NORMAL
- en: The first step is to determine the purpose of the dashboard and what key metrics
    and KPIs should be included. This will depend on the specific needs of the organization
    or business unit.
  prefs: []
  type: TYPE_NORMAL
- en: The second step is to gather the necessary data and organize it in a way that
    makes sense for the dashboard. This may involve connecting to multiple data sources
    and transforming the data into a format that is suitable for analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Once the data has been organized, the next step is to select appropriate visualizations
    to display the data. This involves considering the types of data being displayed
    and choosing visualizations that are both visually appealing and easy to interpret.
  prefs: []
  type: TYPE_NORMAL
- en: The next step is to design the layout of the dashboard. This involves determining
    which visualizations should be placed where, and how they should be arranged to
    create an effective and visually appealing dashboard.
  prefs: []
  type: TYPE_NORMAL
- en: For a dashboard to be a self-service visualization, it is necessary to make
    the dashboard more interactive and user-friendly. Consider adding interactive
    elements such as drilldowns, filters, and slicers. These elements allow users
    to explore the data in more detail and customize the dashboard to meet their specific
    needs.
  prefs: []
  type: TYPE_NORMAL
- en: Once the dashboard has been designed, it is important to test it thoroughly
    and refine it as necessary. This may involve gathering feedback from users and
    making adjustments to the layout, visualizations, and interactive elements to
    ensure that the dashboard meets the needs of its users.
  prefs: []
  type: TYPE_NORMAL
- en: When planning and designing a financial dashboard in Power BI, it is important
    to keep the end user in mind and design the dashboard to meet their specific needs.
    By following these key steps, it is possible to create an effective and visually
    appealing dashboard that provides users with the insights they need to make informed
    decisions.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we’ll focus on arranging financial information for visual
    clarity using Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: Arranging financial visuals for clarity in Power BI
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'When designing financial dashboards in Power BI, arranging visuals for clarity
    is crucial to effectively communicate insights to users. Here are some key considerations
    for arranging financial visuals to enhance clarity:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Group related visuals**: Grouping related visuals together helps users understand
    the relationships between different elements of the financial analysis. For example,
    you can place visuals related to revenue and expenses side by side, or group visuals
    that show different aspects of the same financial metric. This grouping allows
    users to easily compare and analyze related data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Prioritize important visuals**: Place the most critical visuals prominently
    within the dashboard layout. Important metrics or KPIs should be positioned in
    a way that catches users’ attention immediately. Consider placing these visuals
    at the top or center of the dashboard to ensure they are easily visible and accessible.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use clear and concise titles**: Provide clear and concise titles for each
    visual to convey its purpose and context. The title should effectively describe
    the data being presented and enable users to quickly understand the information
    that’s displayed. Use descriptive titles that align with the overall objective
    of the financial analysis.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Align visuals for consistency**: Align visuals within the dashboard to create
    a sense of consistency and order. Aligning visuals along a common axis or grid
    helps create a visually pleasing and organized layout. Consider aligning visual
    elements such as legends, data labels, and axis titles for a more cohesive appearance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Utilize white space**: Don’t overcrowd the dashboard with visuals and information.
    Incorporate sufficient white space between visuals to improve readability and
    prevent visual clutter. White space helps users focus on important information
    without feeling overwhelmed. It also enhances the overall aesthetic appeal of
    the dashboard.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Provide clear data labels**: Data labels play a critical role in conveying
    precise information. Ensure that data labels are legible and appropriately positioned
    to avoid any confusion. Use appropriate formatting options, such as font size
    and color, to make the labels stand out and improve readability.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Consider the flow of information**: Arrange visuals in a logical sequence
    that guides users through the story or analysis. Think about the natural flow
    of information, from top to bottom or left to right, to ensure that users can
    easily follow the narrative of the financial analysis.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Include relevant tooltips**: Tooltips can provide additional details or context
    to specific data points within a visual. By incorporating informative tooltips,
    you can offer users the ability to explore the finer details of the data without
    overwhelming the main visual.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By following these guidelines and arranging financial visuals for clarity in
    Power BI, you can create dashboards that effectively communicate insights, enable
    efficient data analysis, and provide a user-friendly experience. Remember to iterate
    and seek feedback from users to continuously improve the clarity and effectiveness
    of your financial visuals.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we know a little bit more about data modeling and using Power BI, we
    can start looking at sharing visualizations and insights using Power BI.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will provide an illustration that pulls together what
    we have been talking about in the previous sections. We will take an example from
    the Microsoft Learn website. It looks at financial data related to sales and returns
    for a skateboard company.
  prefs: []
  type: TYPE_NORMAL
- en: Illustration – Power BI dashboard of finance data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The following is an example of an interactive Power BI dashboard. This example
    can be downloaded from the Microsoft site as an example. It is called **Sales
    & Return** **Sample v201912**.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can download the sales and returns sample Power BI report (a `.pbix` file)
    from the Microsoft Learn website (*Get samples for Power BI – Power BI* | *Microsoft
    Learn*: [https://learn.microsoft.com/en-us/power-bi/create-reports/sample-datasets](https://learn.microsoft.com/en-us/power-bi/create-reports/sample-datasets)).
    You can view it in the Data Stories Gallery, open and explore it in Power BI Desktop,
    or upload it to the Power BI service. Here are some more resources:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Store Sales sample for Power BI: Take a tour – Power BI* | Microsoft Learn:
    [https://learn.microsoft.com/en-us/power-bi/create-reports/sample-store-sales](https://learn.microsoft.com/en-us/power-bi/create-reports/sample-store-sales
    )'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Sales and Marketing sample for Power BI: Take a* *tour*: [https://learn.microsoft.com/en-us/power-bi/create-reports/sample-sales-and-marketing](https://learn.microsoft.com/en-us/power-bi/create-reports/sample-sales-and-marketing)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Take a Tour of the New Sales & Returns Sample Report* |*Microsoft*: [https://powerbi.microsoft.com/en-us/blog/take_a_tour_of_the_new_sales_returns_sample_report/](https://powerbi.microsoft.com/en-us/blog/take_a_tour_of_the_new_sales_returns_sample_report/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This dashboard of a skateboard company allows you to drill into the data and
    explore all the factors that impact sales and returns. It also analyzes what types
    of products are most popular in different regions and provides insights into areas
    to focus marketing efforts.
  prefs: []
  type: TYPE_NORMAL
- en: 'This report is loaded with Power BI features that will allow the user to understand
    a large amount of data with an easy-to-use interface. By integrating Power Apps
    within this Power BI report, the users can get from data to insights to action
    rapidly:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 2.1 – Sales and returns dashboard for the skateboard company](img/B21008_02_1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 2.1 – Sales and returns dashboard for the skateboard company
  prefs: []
  type: TYPE_NORMAL
- en: 'The following figure shows the dashboard of the sales and returns of the company:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 2.2 – Sales and returns dashboard for the skateboard company showing
    Net Sales and Units Sold](img/B21008_02_2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 2.2 – Sales and returns dashboard for the skateboard company showing
    Net Sales and Units Sold
  prefs: []
  type: TYPE_NORMAL
- en: It is best to download this sample to your Power BI desktop and peruse the interactive
    features that come with it – utilizing a lot of what Power BI has to offer. As
    stated at the start of this section, you can download this example from [https://learn.microsoft.com/en-us/power-bi/create-reports/sample-datasets](https://learn.microsoft.com/en-us/power-bi/create-reports/sample-datasets).
  prefs: []
  type: TYPE_NORMAL
- en: In this section, we learned how to create a Power BI dashboard using sample
    resources from Microsoft Learn using the available visualization techniques and
    tools. Some best practices are worth following when using Power BI in financial
    analysis. We’ll look at them in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Best practices for data modeling, visualization, and ChatGPT integration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Effective data modeling, visualization, and ChatGPT integration are critical
    aspects of leveraging Power BI for enhanced financial analysis. This section explores
    best practices to ensure clean and well-structured data modeling, choosing the
    right visualizations for effective communication, and leveraging ChatGPT insights
    to enhance financial analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Ensuring clean and well-structured data modeling
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Start with data cleansing**. Before modeling financial data in Power BI,
    ensure that the data is clean and free from errors, inconsistencies, and duplicates.
    This involves removing irrelevant or incomplete records, handling missing values,
    and standardizing data formats.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here’s an example of how you may go about doing this:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Import data**: Import your financial data into Power BI. This could be from
    a CSV file, a database, or any other source.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Identify irrelevant records**: Look through your data and identify any records
    that are not relevant to your analysis. For example, if you’re analyzing sales
    data, you might want to remove any records related to internal transactions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remove duplicates**: Check for duplicate records in your data and remove
    them. Power BI has a **Remove Duplicates** function that you can use for this.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Handle missing values**: Identify any missing values in your data. Depending
    on the nature of the data and the purpose of your analysis, you might choose to
    fill in missing values with a default value, interpolate between existing values,
    or exclude the records with missing values altogether.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Standardize data formats**: Ensure that all of your data is in a consistent
    format. For example, dates should all be in the same format (DD-MM-YYYY, MM-DD-YYYY,
    and so on), and monetary values should all have the same number of decimal places.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Check for inconsistencies**: Finally, look through your data for any inconsistencies.
    For example, if you have a column for “Sales Region” and another for “Sales Representative,”
    make sure that each representative is correctly matched with their region.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Establish relationships**. Establish appropriate relationships between tables
    based on key fields such as customer ID, product ID, or transaction ID. This allows
    for seamless navigation and analysis of financial data across different dimensions.
    Here’s an example of how you might establish between tables in Power BI:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Import tables**: Import your financial data tables into Power BI. This could
    be sales data, customer data, product data, and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Customer ID`, `Product ID` or `Transaction ID`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Create relationships**: In Power BI Desktop, go to the **Model** view. Here,
    you can see all your tables and fields. To create a relationship, simply click
    and drag the key field from one table to the corresponding field in another table.
    A line will appear connecting these two tables, indicating that a relationship
    has been established.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Set relationship properties**: Once you’ve created a relationship, you can
    set its properties. For example, you can specify the type of relationship (one-to-one,
    one-to-many, and so on) and the cross-filter direction.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Test your model**: After setting up your relationships, test your model by
    creating some visuals. You should be able to seamlessly analyze data across different
    tables.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For example, if you have a `Sales` table with `Transaction ID`, `Product ID`
    and `Sales Amount`, and a `Product` table with `Product ID`, `Product Name`, and
    `Product Category`, you can establish a relationship based on the `Product ID`
    field. This would allow you to analyze sales data by product name or category.
  prefs: []
  type: TYPE_NORMAL
- en: '**Implement data validation**. Apply data validation rules to ensure data integrity
    and accuracy. Validate data against predefined business rules, detect outliers,
    and flag potential errors for further investigation. Here’s how you might implement
    data validation in Power BI:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Define business rules**: Define the business rules that your data must adhere
    to. For example, sales figures must be positive, customer IDs must be unique,
    and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Create validation measures**: Create measures in Power BI to validate your
    data against these rules. For example, you could create a measure that counts
    the number of negative sales figures or duplicate customer IDs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`STDEV.P` function to calculate the standard deviation of a dataset and flag
    any values that are more than three standard deviations away from the mean.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`ERROR` if a sales figure is negative or a customer ID is duplicated.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Investigate errors**: Use Power BI’s data exploration features to investigate
    any potential errors flagged by your validation measures. This might involve filtering
    or drilling down into your data to identify the cause of the error.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Implement calculated columns and measures**. Utilize calculated columns and
    measures to perform necessary calculations, aggregations, and financial metrics.
    This helps derive meaningful insights and simplifies analysis within Power BI.
    Here’s an example of how you might implement calculated columns and measures in
    Power BI:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Quantity Sold` and `Price Per Unit` for each transaction. You can create a
    calculated column named `Total Sales` using the *Total Sales = [Quantity Sold]
    * [Price Per Unit]* formula. This will calculate the total sales for each transaction.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Measure**: Now, if you want to calculate the total sales across all transactions,
    you can create a measure, such as *Total Sales = SUM(‘Sales’[Total Sales])*. This
    measure will dynamically calculate the total sales based on the current filter
    context of your report.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Choosing the right visualizations for effective communication
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Understand data characteristics**. Gain a deep understanding of the characteristics
    of financial data, such as trends, comparisons, distributions, and correlations.
    This understanding will guide the selection of appropriate visualizations.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use simple and clear visuals**. Avoid clutter and complexity in financial
    visualizations. Opt for clean and intuitive visualizations that effectively communicate
    the intended message without overwhelming the audience.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Leverage** **key visualizations**:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Line charts**: Use line charts to depict trends over time, such as revenue
    growth or expense fluctuations'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Bar charts**: Utilize bar charts to compare financial data, such as the sales
    performance of assorted products or regions'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pie charts**: Employ pie charts to showcase proportions, such as the composition
    of expenses or revenue sources'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Tables**: Use tables to present detailed financial data, such as transactional
    information or financial statements'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Leveraging ChatGPT insights to enhance financial analysis
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Contextual conversations**: Integrate ChatGPT within Power BI to enable users
    to have interactive conversations and seek insights related to financial data.
    Contextual conversations provide a natural language interface for querying financial
    information and gaining additional insights.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Interpret user queries**: Develop ChatGPT models that can understand and
    interpret user queries related to financial analysis. Train the models to recognize
    common financial terms, metrics, and context to provide accurate responses.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Generate actionable insights**: Leverage ChatGPT to generate insightful responses
    based on user queries. The model can provide recommendations, predictions, or
    explanations that enhance the understanding and analysis of financial data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Continuous improvement**: Collect user feedback and iterate on the ChatGPT
    integration to improve the quality of generated insights. Refine the model’s training
    data, incorporate user suggestions, and update the responses based on the evolving
    needs of financial analysis.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensuring data security and privacy
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Data anonymization**: Prioritize data privacy and confidentiality by anonymizing
    sensitive financial data. Ensure that **personally identifiable information**
    (**PII**) or sensitive financial details are masked or encrypted to protect user
    privacy.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Access control**: Implement robust access control mechanisms within Power
    BI to restrict data access based on user roles and responsibilities. Ensure that
    only authorized individuals can access and interact with sensitive financial information.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In conclusion, by adhering to best practices for data modeling, visualization,
    and ChatGPT integration, financial analysts can unlock the full potential of Power
    BI for enhanced financial analysis. Clean and well-structured data modeling enables
    accurate insights while selecting the right visualizations facilitates effective
    communication. Integrating ChatGPT brings the power of natural language understanding
    to financial analysis, enabling interactive conversations and generating valuable
    insights. Embracing these best practices empowers financial professionals to make
    informed decisions, uncover hidden patterns, and drive better business outcomes.
    The next section provides a walkthrough of using Power BI in financial analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Walk-through use case – analyzing financial data using Power BI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the world of investing, it’s crucial to understand not just a company’s standalone
    performance, but also its performance relative to its peers. That’s where our
    Power BI visualization comes in. Let’s walk through pulling a dataset and creating
    a Power BI visual that compares Apple with its main competitors in the tech industry.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll take available financial data and transform it into visual narratives
    that give you an at-a-glance understanding of how Apple measures up against its
    competitors. We’ll examine historical stock data for Apple, Google, and Microsoft
    and use this to create Power BI visualizations that bring the data to life.
  prefs: []
  type: TYPE_NORMAL
- en: In the following steps, we will show how to install the necessary packages in
    Python, pull data from different locations, extract relevant information, and
    build a Power BI dashboard.
  prefs: []
  type: TYPE_NORMAL
- en: '**Step 1 – installing the necessary** **Python libraries**'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In this step, we must set up the necessary Python libraries:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Tip
  prefs: []
  type: TYPE_NORMAL
- en: Libraries in Python are collections of modules that provide specific functionalities,
    making our programming tasks easier. We’ll be using `pandas` for data manipulation
    and analysis, `yfinance` to download Yahoo! Finance data, `requests` to send HTTP
    requests, and `BeautifulSoup` to extract data from HTML and XML files. By installing
    these libraries, we can prepare our Python environment for the subsequent data
    extraction and analysis tasks.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: import yfinance as yf
  prefs: []
  type: TYPE_NORMAL
- en: import pandas as pd
  prefs: []
  type: TYPE_NORMAL
- en: Define the ticker symbols
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: tickers = ['AAPL', 'GOOG', 'MSFT']
  prefs: []
  type: TYPE_NORMAL
- en: Define the start and end dates
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: start_date = '2020-01-01'
  prefs: []
  type: TYPE_NORMAL
- en: end_date = '2022-12-31'
  prefs: []
  type: TYPE_NORMAL
- en: Create an empty DataFrame to store the data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: data = pd.DataFrame()
  prefs: []
  type: TYPE_NORMAL
- en: Download the data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'for ticker in tickers:'
  prefs: []
  type: TYPE_NORMAL
- en: df = yf.download(ticker, start=start_date, end=end_date, interval='1mo')
  prefs: []
  type: TYPE_NORMAL
- en: 'df[''Ticker''] = ticker # Add a column with the ticker symbol'
  prefs: []
  type: TYPE_NORMAL
- en: data = pd.concat([data, df])
  prefs: []
  type: TYPE_NORMAL
- en: Reset the index
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: data.reset_index(inplace=True)
  prefs: []
  type: TYPE_NORMAL
- en: Save the data to a CSV file
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: data.to_csv('stock_data.csv', index=False)
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: pip install openai
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '''dataset'' holds the input data for this script'
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H1
  type: TYPE_NORMAL
- en: Import Libraries
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H1
  type: TYPE_NORMAL
- en: import openai
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: import os
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
- en: Get Open AI API from windows environment
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H1
  type: TYPE_NORMAL
- en: openai.api_key = "Your Open AI API Key"
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
- en: Loop through each row in dataset & concatenate the data into a single string.
    Pass resulting string to the API
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H1
  type: TYPE_NORMAL
- en: 'for index,row in dataset.iterrows():'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: messages="I am going to give you a set of company information in the following
    order Company,Price to Earnings,Price to Book,Return on Equity %,Debt to Equity,Current
    Ratio,Gross Margin %,analyze the ratios for each company, refer to the company
    by its name and write a concise response"
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: message = ''.join ([str(col) for col in row])
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
- en: '#Build the API request to include row level data from source'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: messages += " " + str(message)
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '#Make a chat completion Request for the API'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: chat = openai.ChatCompletion.create(
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: model = "gpt-3.5-turbo",
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: messages = [{"role":"user","content":messages}],
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: temperature = 0.9,
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: max_tokens = 500,
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: top_p = 1,
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: frequency_penalty = 0,
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: presence_penalty = 0.6
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: )
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '#Process the response from API'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: reply = chat.choices[0].message.content
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '#Write the response Back to the Report'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: dataset.at[index, "reslt"] = reply
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
