- en: Alpha Factor Library
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Alpha 因子库
- en: Throughout this book, we've described how to engineer features from market,
    fundamental, and alternative data to build **machine learning** (**ML**) models
    that yield signals for a trading strategy. The smart design of features, including
    appropriate preprocessing and denoising, is what typically leads to an effective
    strategy. This appendix synthesizes some of the lessons learned on feature engineering
    and provides additional information on this important topic.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们已经描述了如何从市场、基本和替代数据中提取特征，以构建 **机器学习** (**ML**) 模型，为交易策略提供信号。特征的智能设计，包括适当的预处理和去噪，通常是实现有效策略的关键。本附录综合了关于特征工程的一些经验教训，并提供了有关这一重要主题的额外信息。
- en: '*Chapter 4*, *Financial Feature Engineering – How to Research Alpha Factors*,
    summarized the long-standing efforts of academics and practitioners to identify
    information or variables that help reliably predict asset returns. This research
    led from the single-factor capital asset pricing model to a "zoo of new factors"
    (Cochrane, 2011). This *factor zoo* contains hundreds of firm characteristics
    and security price metrics presented as statistically significant predictors of
    equity returns in the anomalies literature since 1970 (see a summary in Green,
    Hand, and Zhang, 2017).'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*第四章*，*金融特征工程 - 如何研究 Alpha 因子*，总结了学者和从业者长期以来努力识别有助于可靠预测资产回报的信息或变量。这项研究从单因素资本资产定价模型发展到了一个“新因子动物园”（Cochrane，2011）。*因子动物园*包含了自
    1970 年以来 anomalies 文献中呈现的数百种公司特征和证券价格指标，被认为是股票回报的统计显著预测因子（参见 Green，Hand 和 Zhang，2017）的摘要。'
- en: '*Chapter 4*, *Financial Feature Engineering – How to Research Alpha Factors*,
    categorized factors by the underlying risk they represent and for which an investor
    would earn a reward above and beyond the market return. These categories include
    value versus growth, quality, and sentiment, as well as volatility, momentum,
    and liquidity. Throughout this book, we used numerous metrics to capture these
    risk factors. This appendix expands on those examples and collects popular indicators
    so you can use it as a reference or inspiration for your own strategy development.
    It also shows you how to compute them and includes some steps to evaluate these
    indicators.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '*第四章*，*金融特征工程 - 如何研究 Alpha 因子*，按照它们所代表的基础风险将因子分类，以及投资者将在市场回报之上获得的奖励。这些类别包括价值与增长、质量和情绪，以及波动性、动量和流动性。在本书中，我们使用了众多指标来捕捉这些风险因素。本附录扩展了这些例子，并收集了流行指标，以便您将其用作策略开发的参考或灵感。它还向您展示如何计算这些指标，并包括一些评估这些指标的步骤。'
- en: To this end, we'll focus on the broad range of indicators implemented by TA-Lib
    (see *Chapter 4*, *Financial Feature Engineering – How to Research Alpha Factors*)
    and the *101 Formulaic Alphas* paper (Kakushadze 2016), which presents real-life
    quantitative trading factors used in production with an average holding period
    of 0.6-6.4 days. To facilitate replication, we'll limit this review to indicators
    that rely on readily available market data. This restriction notwithstanding,
    the vast and rapidly evolving scope of potentially useful data sources and features
    implies that this overview is far from comprehensive.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们将重点放在 TA-Lib 实施的广泛指标范围上（参见 *第四章*，*金融特征工程 - 如何研究 Alpha 因子*）以及 *101 Formulaic
    Alphas* 论文（Kakushadze，2016）上，该论文呈现了实际量化交易因子的使用情况，平均持有期为 0.6-6.4 天。为了方便复制，我们将限制此次审查的指标，使其依赖于易于获取的市场数据。尽管存在这一限制，但潜在有用数据源和特征的广泛且迅速发展的范围意味着此概述远非全面。
- en: Throughout this chapter, we will use *P*[t] for the closing price and *V*[t]
    for the trading volume of an asset at time *t*. Where necessary, superscripts
    like ![](img/B15439_A_001.png) or ![](img/B15439_A_002.png) differentiate between
    open, high, low, or close prices. *r*[t] denotes the simple return for the period
    return at time *t*.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用 *P*[t] 表示资产在时间 *t* 的收盘价，*V*[t] 表示交易量。必要时，上标，如 ![](img/B15439_A_001.png)
    或 ![](img/B15439_A_002.png)，用于区分开盘、最高、最低或收盘价。*r*[t] 表示时间 *t* 的简单回报率。
- en: '![](img/B15439_A_003.png) and ![](img/B15439_A_004.png) refer to a time series
    of prices and returns, respectively, from *t-d* to *t*.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '![](img/B15439_A_003.png) 和 ![](img/B15439_A_004.png) 分别指的是从 *t-d* 到 *t* 的价格和回报的时间序列。'
- en: Common alpha factors implemented in TA-Lib
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: TA-Lib 中实施的常见 alpha 因子
- en: 'The TA-Lib library is widely used to perform technical analysis of financial
    market data by trading software developers. It includes over 150 popular indicators
    from multiple categories that range from overlap studies, including moving averages
    and Bollinger Bands, to statistic functions such as linear regression. The following
    table summarizes the main categories:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: '| Function Group | # Indicators |'
  id: totrans-9
  prefs: []
  type: TYPE_TB
- en: '| Overlap Studies | 17 |'
  id: totrans-10
  prefs: []
  type: TYPE_TB
- en: '| Momentum Indicators | 30 |'
  id: totrans-11
  prefs: []
  type: TYPE_TB
- en: '| Volume Indicators | 3 |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
- en: '| Volatility Indicators | 3 |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
- en: '| Price Transform | 4 |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
- en: '| Cycle Indicators | 5 |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
- en: '| Math Operators | 11 |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
- en: '| Math Transform | 15 |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
- en: '| Statistic Functions | 9 |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
- en: There are also over 60 functions that aim to recognize candlestick patterns
    popular with traders that rely on the visual inspection of charts. Given the mixed
    evidence on their predictive ability (Horton 2009; Marshall, Young, and Rose 2006),
    and the goal of learning such patterns from data using the ML algorithms covered
    in this book, we will focus on the categories listed in the preceding table. Specifically,
    we will focus on moving averages, overlap studies, momentum, volume and liquidity,
    volatility, and fundamental risk factors in this section.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: See the notebook `common_alpha_factors` for the code examples in this section
    and additional implementation details regarding TA-Lib indicators. We'll demonstrate
    how to compute selected indicators for an individual stock, as well as a sample
    of the 500 most-traded US stocks over the 2007-2016 period (see the notebook `sample_selection`
    for the preparation of this larger dataset).
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: A key building block – moving averages
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Numerous indicators allow for calculation using different types of **moving
    averages** (**MAs**). They make different tradeoffs between smoothing a series
    and reacting to new developments. You can use them as building blocks for your
    own indicators or modify the behavior of existing indicators by altering the type
    of MA used in its construction, as we''ll demonstrate in the next section. The
    following table lists the available types of MAs, the TA-Lib function to compute
    them, and the code you can pass to other indicators to select the given type:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: '| Moving Average | Function | Code |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
- en: '| Simple | SMA | 0 |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
- en: '| Exponential | EMA | 1 |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
- en: '| Weighted | WMA | 2 |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
- en: '| Double Exponential | DEMA | 3 |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
- en: '| Triple Exponential | TEMA | 4 |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
- en: '| Triangular | TRIMA | 5 |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
- en: '| Kaufman Adaptive | KAMA | 6 |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
- en: '| MESA Adaptive | MAMA | 7 |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
- en: In the remainder of this section, we'll briefly outline their definitions and
    visualize their different behavior.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: Simple moving average
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'For price series *P*[t] with a window of length *N*, the **simple moving average**
    (**SMA**) at time *t* weighs each data point within the window equally:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_005.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
- en: Exponential moving average
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'For price series *P*[t] with a window of length *N*, the **exponential moving
    average** (**EMA**) at time *t*, EMA[t], is recursively defined as the weighted
    average of the current price and the most recent previous EMA[t][-1], where the
    weights ![](img/B15439_22_043.png) and ![](img/B15439_A_007.png) are defined as
    follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_008.png)![](img/B15439_A_009.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
- en: Weighted moving average
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'For price series *P*[t] with a window of length *N*, the **weighted moving
    average** (**WMA**) at time *t* is computed such that the weight of each data
    point corresponds to its index within the window:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_010.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
- en: Double exponential moving average
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **double exponential moving average** (**DEMA**) for a price series *P*[t]
    at time *t*, DEMA[t], is based on the EMA designed to react faster to changes
    in price. It is computed as the difference between twice the current EMA and the
    EMA applied to the current EMA, labeled ![](img/B15439_A_011.png):'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_012.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
- en: Since the calculation uses EMA[2], DEMA needs ![](img/B15439_A_013.png) samples
    to start producing values.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: Triple exponential moving average
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **triple exponential moving average** (**TEMA**) for a price series *P*[t]
    at time *t*, TEMA[t], is also based on the EMA, yet designed to react even faster
    to changes in price and indicate short-term price direction. It is computed as
    the difference between three times the difference between the current EMA and
    the EMA applied to the current EMA, EMA[2], with the addition of the EMA applied
    to the EMA[2], labeled EMA[3]:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_014.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
- en: Since the calculation uses EMA[3], DEMA needs ![](img/B15439_A_015.png) samples
    to start producing values.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
- en: Triangular moving average
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **triangular moving average** (**TRIMA**) with window length *N* for a
    price series *P*[t] at time *t*, TRIMA(*N*)[t], is a weighted average of the last
    *N* SMA(*N*)[t] values. In other words, it applies the SMA to a time series of
    SMA values:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_016.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
- en: Kaufman adaptive moving average
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The computation of the **Kaufman adaptive moving average** (**KAMA**) aims to
    take into account changes in market volatility. See the notebook for links to
    resources that explain the details of this slightly more involved computation.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: MESA adaptive moving average
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **MESA adaptive moving average** (**MAMA**) is an exponential moving average
    that adapts to price movement based on the rate change of phase, as measured by
    the **Hilbert Transform discriminator** (see TA-Lib documentation). In addition
    to the price series, MAMA accepts two additional parameters, *fastlimit* and *slowlimit*,
    that control the maximum and minimum alpha values that should be applied to the
    EMA when calculating MAMA.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: Visual comparison of moving averages
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '*Figure A.1* illustrates how the behavior of the different MAs differs in terms
    of smoothing the time series and adapting to recent changes. All the time series
    are calculated for a 21-day moving window (see the notebook for details and color
    images):'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 A.1* 说明了不同移动平均线在平滑时间序列和适应最近变化方面的行为差异。所有时间序列均计算为 21 天的移动窗口（有关详细信息和彩色图片，请参阅笔记本）：'
- en: '![](img/B15439_A_01.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_01.png)'
- en: 'Figure A.1: Comparison of MAs for AAPL closing price'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.1：AAPL 收盘价的移动平均线比较
- en: Overlap studies – price and volatility trends
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 重叠研究 – 价格和波动趋势
- en: 'TA-Lib includes several indicators aimed at capturing recent trends, as listed
    in the following table:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: TA-Lib 包括几个旨在捕捉近期趋势的指标，如下表所示：
- en: '| Function | Name |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 名称 |'
- en: '| BBANDS | Bollinger Bands |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| BBANDS | 布林带 |'
- en: '| HT_TRENDLINE | Hilbert Transform – Instantaneous Trendline |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| HT_TRENDLINE | 希尔伯特变换 – 瞬时趋势线 |'
- en: '| MAVP | Moving average with variable period |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| MAVP | 可变周期移动平均线 |'
- en: '| MA | Moving average |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| MA | 移动平均线 |'
- en: '| SAR | Parabolic SAR |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| SAR | 抛物线 SAR |'
- en: '| SAREXT | Parabolic SAR – Extended |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '| SAREXT | 扩展抛物线 SAR |'
- en: The `MA` and `MAVP` functions are wrappers for the various MAs described in
    the previous section. We will highlight a few examples in this section; see the
    notebook for additional information and visualizations.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '`MA` 和 `MAVP` 函数是前文描述的各种移动平均线的包装器。我们将在本节中重点介绍一些示例；更多信息和可视化内容请参阅笔记本。'
- en: Bollinger Bands
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 布林带
- en: 'Bollinger Bands combine an MA with an upper band and a lower band representing
    the moving standard deviation. We can obtain the three time series by providing
    an input price series, the length of the moving window, the multiplier for the
    upper and lower bands, and the type of MA, as follows:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 布林带将一个移动平均线与代表移动标准差的上下带相结合。我们可以通过提供输入价格系列、移动窗口的长度、上下带的乘数和移动平均线的类型来获得三个时间序列，如下所示：
- en: '[PRE0]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'For a sample of AAPL closing prices for 2012, we can plot the result like so:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 2012 年的 AAPL 收盘价格样本，我们可以如下绘制结果：
- en: '[PRE1]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The preceding code results in the following plot:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码的结果如下图所示：
- en: '![](img/B15439_A_02.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_02.png)'
- en: 'Figure A.2: Bollinger Bands for AAPL close price in 2012'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.2：AAPL 2012 年收盘价的布林带
- en: John Bollinger, who invented the concept, also defined over 20 trading rules
    based on the relationships between the three lines and the current price (see
    *Chapter 4*, *Financial Feature Engineering – How to Research Alpha Factors*).
    For example, a smaller distance between the outer bands implies reduced recent
    price volatility, which, in turn, is interpreted as greater volatility and price
    change going forward.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 发明该概念的约翰·波林格还根据三条线与当前价格之间的关系定义了 20 多个交易规则（参见*第 4 章*，*金融特征工程 – 如何研究阿尔法因子*）。例如，外部带之间的距离较小意味着近期价格波动减少，这反过来被解释为未来更大的波动和价格变动。
- en: 'We can standardize the security-specific values of the Bollinger Bands by forming
    ratios between the upper and lower bands, as well as between each of them and
    the close price, as follows:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过形成上下带之间以及它们与收盘价之间的比率来标准化布林带的特定于安全性的值，如下所示：
- en: '[PRE2]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The following plot displays the resulting normalized time series:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 下图显示了结果归一化的时间序列：
- en: '![](img/B15439_A_03.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_03.png)'
- en: 'Figure A.3: Normalized Bollinger Band indicators'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.3：归一化的布林带指标
- en: 'The following function can be used with the pandas `.groupby()` and `.apply()`
    methods to compute the indicators for a larger sample of 500 stocks, as shown
    here:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的函数可与 pandas 的 `.groupby()` 和 `.apply()` 方法一起使用，以计算 500 只股票的指标，如下所示：
- en: '[PRE3]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '*Figure A.4* plots the distribution of values for each indicator across the
    500 stocks (clipped at the 1^(st) and 99^(th) percentiles, hence the spikes in
    the plots):'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 A.4* 绘制了跨越 500 只股票的每个指标值的分布（在第 1 和第 99 百分位处截断，因此图中出现了尖峰）：'
- en: '![](img/B15439_A_04.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_04.png)'
- en: 'Figure A.4: Distribution of normalized Bollinger Band indicators'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.4：归一化的布林带指标分布
- en: Parabolic SAR
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 抛物线 SAR
- en: 'The **parabolic SAR** aims to identify trend reversals. It is a trend-following
    (lagging) indicator that can be used to set a trailing stop loss or determine
    entry or exit points. It is usually represented in a price chart as a set of dots
    near the price bars. Generally, when these dots are above the price, it signals
    a downward trend; it signals an upward trend when the dots are below the price.
    The change in the direction of the dots can be interpreted as a trade signal.
    However, the indicator is less reliable in a flat or range-bound market. It is
    computed as follows:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**抛物线SAR**旨在识别趋势反转。它是一种趋势跟踪（滞后）指标，可用于设置跟踪止损或确定入场或退出点。通常，在价格图表中表示为靠近价格条的一组点。一般来说，当这些点位于价格上方时，表示向下趋势；当点位于价格下方时，表示向上趋势。点的方向变化可解释为交易信号。但是，在平盘或区间市场中，该指标的可靠性较低。其计算如下：'
- en: '![](img/B15439_A_017.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_017.png)'
- en: The **extreme point** (**EP**) is a record that's kept during each trend that
    represents the highest value reached by the price during the current uptrend—or
    lowest value during a downtrend. During each period, if a new maximum (or minimum)
    is observed, the EP is updated with that value.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: '**极值点**（**EP**）是在每个趋势期间保留的记录，代表当前上涨趋势中达到的最高值或下跌趋势中的最低值。在每个周期内，如果观察到新的最大值（或最小值），则EP将使用该值进行更新。'
- en: The α value represents the acceleration factor and is typically set initially
    to a value of 0.02\. This factor increases by α each time a new EP is recorded.
    The rate will then quicken to a point where the SAR converges toward the price.
    To prevent it from getting too large, a maximum value for the acceleration factor
    is normally set to 0.20.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: α值代表加速因子，通常最初设置为0.02。每当记录新的EP时，此因子增加α。然后，速率将加快，直至SAR收敛于价格。为了防止它变得太大，通常将加速因子的最大值设置为0.20。
- en: 'We can compute and plot it for our sample close price series as follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以按以下方式计算和绘制样本收盘价序列：
- en: '[PRE4]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The preceding code produces the following plot:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 上述代码生成以下图表：
- en: '![](img/B15439_A_05.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_05.png)'
- en: 'Figure A.5: Parabolic SAR for AAPL stock price'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.5：AAPL股价的抛物线SAR
- en: Momentum indicators
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 动量指标
- en: '*Chapter 4*, *Financial Feature Engineering – How to Research Alpha Factors*,
    introduced **momentum** as one of the best-performing risk factors historically
    and listed several indicators designed to identify the corresponding price trends.
    These indicators include the **relative strength index** (**RSI**), as well as
    **price momentum** and **price acceleration**:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '*第四章*，*金融特征工程 - 如何研究阿尔法因子*，介绍了**动量**作为历史上表现最佳的风险因子之一，并列举了几个旨在识别相应价格趋势的指标。这些指标包括**相对强弱指数**（**RSI**），以及**价格动量**和**价格加速度**：'
- en: '| Factor | Description | Calculation |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| 因子 | 描述 | 计算 |'
- en: '| Relative strength index (RSI) | RSI compares the magnitude of recent price
    changes across stocks to identify stocks as overbought or oversold. A high RSI
    (usually above 70) indicates overbought and a low RSI (typically below 30) indicates
    oversold. It first computes the average price change for a given number (often
    14) of prior trading days with rising (![](img/B15439_A_018.png)) and falling
    prices (![](img/B15439_A_019.png)), respectively. | ![](img/B15439_A_020.png)
    |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '| 相对强弱指数（RSI） | RSI比较了股票近期价格变动的幅度，以识别股票是否处于超买或超卖状态。较高的RSI（通常超过70）表示超买，较低的RSI（通常低于30）表示超卖。首先，它分别计算过去给定数量（通常为14）的交易日内上涨（![](img/B15439_A_018.png)）和下跌价格（![](img/B15439_A_019.png)）的平均价格变动。
    | ![](img/B15439_A_020.png) |'
- en: '| Price momentum | This factor computes the total return for a given number
    of prior trading days d. In the academic literature, it is common to use the last
    12 months except for the most recent month due to a short-term reversal effect
    frequently observed. However, shorter periods have also been widely used. | ![](img/B15439_A_021.png)
    |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '| 价格动量 | 该因子计算给定数量的前期交易日d的总回报。在学术文献中，通常使用最近12个月，除了最近一个月之外，因为经常观察到短期逆转效应。但是，也广泛使用较短的期间。
    | ![](img/B15439_A_021.png) |'
- en: '| Price acceleration | Price acceleration calculates the gradient of the price
    trend using the linear regression coefficient ![](img/B15439_A_022.png) of a time
    trend on daily prices for a longer and a shorter period, for example, 1 year and
    3 months of trading days, and compares the change in the slope as a measure of
    price acceleration. | ![](img/B15439_A_023.png) |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| 价格加速度 | 价格加速度使用线性回归系数 ![](img/B15439_A_022.png) 计算价格趋势的梯度，时间跨度包括较长和较短的期间，例如，1
    年和 3 个月的交易日，比较斜率变化作为价格加速度的一种度量。 | ![](img/B15439_A_023.png) |'
- en: 'TA-Lib implements 30 momentum indicators; the most important ones are listed
    in the following table. We will introduce a few selected examples; please see
    the notebook `common_alpha_factors` for additional information:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: TA-Lib 实现了 30 个动量指标；其中最重要的指标列在下表中。我们将介绍一些选定的示例；更多信息请参见笔记本 `common_alpha_factors`：
- en: '| Function | Name |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 名称 |'
- en: '| PLUS_DM/MINUS_DM | Plus/Minus Directional Movement |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| PLUS_DM/MINUS_DM | 正/负方向运动 |'
- en: '| PLUS_DI/MINUS_DI | Plus/Minus Directional Indicator |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| PLUS_DI/MINUS_DI | 正/负方向指标 |'
- en: '| DX | Directional Movement Index |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '| DX | 方向运动指数 |'
- en: '| ADX | Average Directional Movement Index |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| ADX | 平均趋向指数 |'
- en: '| ADXR | Average Directional Movement Index Rating |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '| ADXR | 平均趋向指数评级 |'
- en: '| APO/PPO | Absolute/Percentage Price Oscillator |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '| APO/PPO | 绝对/百分比价格振荡器 |'
- en: '| AROON/AROONOSC | Aroon/Aroon Oscillator |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '| AROON/AROONOSC | 阿隆/阿隆振荡器 |'
- en: '| BOP | Balance of Power |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| BOP | 力量平衡指数 |'
- en: '| CCI | Commodity Channel Index |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| CCI | 商品通道指数 |'
- en: '| CMO | Chande Momentum Oscillator |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| CMO | Chande 动量振荡器 |'
- en: '| MACD | Moving Average Convergence/Divergence |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| MACD | 移动平均线收敛/发散 |'
- en: '| MFI | Money Flow Index |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| MFI | 资金流指标 |'
- en: '| MOM | Momentum |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| MOM | 动量 |'
- en: '| RSI | Relative Strength Index |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| RSI | 相对强弱指数 |'
- en: '| STOCH | Stochastic |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| STOCH | 随机指标 |'
- en: '| ULTOSC | Ultimate Oscillator |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| ULTOSC | 终极振荡器 |'
- en: '| WILLR | Williams'' %R |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| WILLR | 威廉指数 |'
- en: Several of these indicators are closely related and build on each other, as
    the following example demonstrates.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些指标密切相关且相互构建，如下例所示。
- en: Average directional movement indicators
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 平均趋向运动指标
- en: The **average directional movement index** (**ADX**) combines two other indicators,
    namely the positive and negative directional indicators (`PLUS_DI` and `MINUS_DI`),
    which, in turn, build on the positive and negative directional movement (`PLUS_DM`
    and `MINUS_DM`). See the notebook for additional details.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '**平均趋向指数**（**ADX**）结合了另外两个指标，即正向和负向方向指标（`PLUS_DI` 和 `MINUS_DI`），它们依次基于正向和负向方向运动（`PLUS_DM`
    和 `MINUS_DM`）。有关更多细节，请参阅笔记本。'
- en: Plus/minus directional movement
  id: totrans-128
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 正/负方向运动
- en: 'For a price series *P*[t] with daily highs ![](img/B15439_A_024.png) and daily
    lows ![](img/B15439_A_025.png), the directional movement tracks the absolute size
    of price moves over a time period *T*, as follows:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 对于价格序列 *P*[t]，其中每日最高价为 ![](img/B15439_A_024.png)，每日最低价为 ![](img/B15439_A_025.png)，方向性运动跟踪时间段
    *T* 内价格变动的绝对大小，计算方法如下：
- en: '![](img/B15439_A_026.png)![](img/B15439_A_027.png)![](img/B15439_A_028.png)![](img/B15439_A_029.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_026.png)![](img/B15439_A_027.png)![](img/B15439_A_028.png)![](img/B15439_A_029.png)'
- en: 'We can compute and plot this indicator for a 2-year price series of the AAPL
    stock in 2012-13:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以计算并绘制 AAPL 股票 2012-13 年的 2 年价格序列的此指标：
- en: '[PRE5]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The following plot visualizes the resulting time series:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图形可视化了结果时间序列：
- en: '![](img/B15439_A_06.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_06.png)'
- en: 'Figure A.6: PLUS_DM/MINUS_DM for AAPL stock price'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.6：AAPL 股票价格的 PLUS_DM/MINUS_DM
- en: Plus/minus directional index
  id: totrans-136
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 正/负方向指数
- en: '`PLUS_DI` and `MINUS_DI` are the simple MAs of `PLUS_DM` and `MINUS_DM`, respectively,
    each divided by the **average true range** (**ATR**). See the *Volatility indicators*
    section later in this chapter for more details.'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '`PLUS_DI` 和 `MINUS_DI` 分别是 `PLUS_DM` 和 `MINUS_DM` 的简单 MA，每个 MA 都除以**平均真实范围**（**ATR**）。有关更多细节，请参阅本章后面的*波动性指标*部分。'
- en: The simple MA is calculated over the given number of periods. The ATR is a smoothed
    average of the true ranges.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 简单 MA 是在给定的周期内计算的。ATR 是真实范围的平滑平均。
- en: Average directional index
  id: totrans-139
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 平均趋向指数
- en: 'Finally, the **average directional index** (**ADX**) is the (simple) MA of
    the absolute value of the difference between `PLUS_DI` and `MINUS_DI`, divided
    by their sum:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，**平均趋向指数**（**ADX**）是绝对值的简单 MA，该值等于 `PLUS_DI` 和 `MINUS_DI` 之间的差异除以它们的和：
- en: '![](img/B15439_A_030.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_030.png)'
- en: 'Its values oscillate in the 0-100 range and are often interpreted as follows:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 它的值在 0-100 范围内振荡，通常如下解释：
- en: '| ADX Value | Trend Strength |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| ADX 值 | 趋势强度 |'
- en: '| 0-25 | Absent or weak trend |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
- en: '| 25-50 | Strong trend |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
- en: '| 50-75 | Very strong trend |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
- en: '| 75-100 | Extremely strong trend |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
- en: 'We compute the ADX time series for our AAPL sample series similar to the previous
    examples, as follows:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'The following plot visualizes the result over the 2007-2016 period:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_07.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.7: ADX for the AAPL stock price series'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: Aroon Oscillator
  id: totrans-153
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The Aroon indicator measures the time between highs and the time between lows
    over a time period. It computes an `AROON_UP` and an `AROON_DWN` indicator, as
    follows:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_031.png)![](img/B15439_A_032.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
- en: 'The Aroon Oscillator is simply the difference between the `AROON_UP` and `AROON_DOWN`
    indicators and moves within the range from -100 to 100, as shown here for the
    AAPL price series:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_08.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.8: Aroon Oscillator for the AAPL stock price series'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: Balance of power
  id: totrans-159
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **balance of power** (**BOP**) intends to measure the strength of buyers
    relative to sellers in the market by assessing the influence of each side on the
    price. It is computed as the difference between the close and the open price,
    divided by the difference between the high and the low price:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_033.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
- en: Commodity channel index
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **commodity channel index** (**CCI**) measures the difference between the
    current *typical* price, computed as the average of current low, high, and close
    price and the historical average price. A positive (negative) CCI indicates that
    the price is above (below) the historic average. It is computed as follows:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_034.png)![](img/B15439_A_035.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
- en: Moving average convergence divergence
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Moving average convergence divergence** (**MACD**) is a very popular trend-following
    (lagging) momentum indicator that shows the relationship between two MAs of a
    security''s price. It is calculated by subtracting the 26-period EMA from the
    12-period EMA.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: 'The TA-Lib implementation returns the MACD value and its signal line, which
    is the 9-day EMA of the MACD. In addition, the MACD-Histogram measures the distance
    between the indicator and its signal line. The following charts show the results:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_09.png)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.9: The three MACD series for the AAPL stock price series'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: Stochastic relative strength index
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The **stochastic relative strength index** (**StochRSI**) is based on the RSI
    described at the beginning of this section and intends to identify crossovers,
    as well as overbought and oversold conditions. It compares the distance of the
    current RSI to the lowest RSI over a given time period *T* to the maximum range
    of values the RSI has assumed for this period. It is computed as follows:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_036.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
- en: The TA-Lib implementation offers more flexibility than the original unsmoothed
    stochastic RSI version by Chande and Kroll (1993). To calculate the original indicator,
    keep `timeperiod` and `fastk_period` equal.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: 'The return value `fastk` is the unsmoothed RSI. `fastd_period` is used to compute
    a smoothed StochRSI, which is returned as `fastd`. If you do not care about StochRSI
    smoothing, just set `fastd_period` to 1 and ignore the `fasytd` output:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '*Figure A.10* plots the closing price and both the smoothed and unsmoothed
    stochastic RSI:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_10.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.10: Smoothed and unsmoothed StochRSI series for the AAPL stock price'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
- en: Stochastic oscillator
  id: totrans-179
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'A stochastic oscillator is a momentum indicator that compares a particular
    closing price of a security to a range of its prices over a certain period of
    time. Stochastic oscillators are based on the idea that closing prices should
    confirm the trend. For Stochastic (STOCH), there are four different lines: *K*^(Fast),
    *D*^(Fast), *K*^(Slow), and *D*^(Slow). *D* is the signal line usually drawn over
    its corresponding *K* function:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_037.png)![](img/B15439_A_038.png)![](img/B15439_A_039.png)![](img/B15439_A_040.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
- en: '![](img/B15439_A_041.png), ![](img/B15439_A_042.png), and ![](img/B15439_A_041.png)
    are the extreme values of the last ![](img/B15439_A_044.png) period. ![](img/B15439_A_045.png)
    and ![](img/B15439_A_046.png) are equivalent when using the same period. We obtain
    the series shown in *Figure A.11*, as follows:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](img/B15439_A_11.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.11: STOCH series for the AAPL stock price'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: Ultimate oscillator
  id: totrans-186
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **ultimate oscillator** (**ULTOSC**) measures the average difference between
    the current close and the previous lowest price over three timeframes—with the
    default values 7, 14, and 28—to avoid overreacting to short-term price changes
    and incorporate short-, medium-, and long-term market trends.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: 'It first computes the buying pressure, BP[t], then sums it over the three periods
    T[1], T[2], and T[3], normalized by the true range (TR[t]):'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_047.png)![](img/B15439_A_048.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
- en: 'ULTOSC is then computed as a weighted average over the three periods, as follows:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_049.png)![](img/B15439_A_050.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
- en: 'The following plot shows the result of this:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_12.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.12: ULTOSC series for the AAPL stock price'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Williams %R
  id: totrans-195
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '**Williams %R**, also known as the **Williams Percent Range**, is a momentum
    indicator that moves between 0 and -100 and measures overbought and oversold levels
    to identify entry and exit points. It is similar to the stochastic oscillator
    and compares the current closing price ![](img/B15439_A_051.png) to the range
    of highest (![](img/B15439_A_052.png)) and lowest (![](img/B15439_A_053.png))
    prices over the last *T* periods (typically 14). The indicators are computed as
    follows, and the result is shown in the following chart:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_054.png)![](img/B15439_A_13.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.13: WILLR series for the AAPL stock price'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: Volume and liquidity indicators
  id: totrans-199
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Risk factors that focus on volume and liquidity incorporate metrics like turnover,
    dollar volume, or market capitalization. TA-Lib implements three indicators, the
    first two of which are closely related:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: '| Function | Name |'
  id: totrans-201
  prefs: []
  type: TYPE_TB
- en: '| AD | Chaikin A/D Line |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
- en: '| ADOSC | Chaikin A/D Oscillator |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
- en: '| OBV | On Balance Volume |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
- en: Also see *Chapter 20*, *Autoencoders for Conditional Risk Factors and Asset
    Pricing*, where we use the Amihud Illiquidity indicator to measure a rolling average
    ratio between absolute returns and the dollar volume.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: Chaikin accumulation/distribution line and oscillator
  id: totrans-206
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **Chaikin advance/decline** (**AD**) or **accumulation/distribution** (**AD**)
    line is a volume-based indicator designed to measure the cumulative flow of money
    into and out of an asset. The indicator assumes that the degree of buying or selling
    pressure can be determined by the location of the close, relative to the high
    and low for the period. There is buying (selling) pressure when a stock closes
    in the upper (lower) half of a period's range. The intention is to signal a change
    in direction when the indicator diverges from the security price.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: 'The A/D line is a running total of each period''s **money flow volume** (**MFV**).
    It is calculated as follows:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: Compute the **money flow index** (**MFI**) as the relationship of the close
    to the high-low range
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Multiply the MFI by the period's volume *V*[t] to come up with the MFV
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Obtain the AD line as the running total of the MFV:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/B15439_A_055.png)![](img/B15439_A_056.png)![](img/B15439_A_057.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
- en: The **Chaikin A/D oscillator** (**ADOSC**) is the MACD indicator that's applied
    to the Chaikin AD line. The Chaikin oscillator intends to predict changes in the
    AD line.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: 'It is computed as the difference between the 3-day EMA and the 10-day EMA of
    the AD line. The following chart shows the ADOSC series:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_14.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
- en: 'Figure A.14: ADOSC series for the AAPL stock price'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: On-balance volume
  id: totrans-217
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **on-balance volume** (**OBV**) indicator is a cumulative momentum indicator
    that relates volume to price change. It assumes that OBV changes precede price
    changes because smart money can be seen flowing into the security by a rising
    OBV. When the public then follows, both the security and OBV will rise.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: 'The current OBV[t] is computed by adding (subtracting) the current volume to
    (from) the last OBV[t][-1] if the security closes higher (lower) than the previous
    close:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B15439_A_058.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
- en: Volatility indicators
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Volatility indicators include stock-specific measures like the rolling (normalized)
    standard deviation of asset prices and returns. It also includes broader market
    measures like the Chicago Board Options Exchange's CBOE **volatility index** (**VIX**),
    which is based on the implied volatility of S&P 500 options.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: TA-Lib implements both normalized and averaged versions of the true range indicator.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: Average true range
  id: totrans-224
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **average true range** (**ATR**) indicator shows the volatility of the market.
    It was introduced by Wilder (1978) and has been used as a component of numerous
    other indicators since. It aims to anticipate changes in trend such that the higher
    its value, the higher the probability of a trend change; the lower the indicator's
    value, the weaker the current trend.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '**平均真实波幅**（**ATR**）指标显示了市场的波动性。它由Wilder（1978年）引入，并被用作许多其他指标的组成部分。它旨在预测趋势变化，其数值越高，趋势变化的可能性越大；指标值越低，当前趋势越弱。'
- en: 'ATR is computed as the simple moving average for a period *T* of the **true
    range** (**TRANGE**), which measures volatility as the absolute value of the largest
    recent trading range:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: ATR被计算为真实范围（**TRANGE**）的周期*T*的简单移动平均，其将波动性定义为最近交易范围的绝对值：
- en: '![](img/B15439_A_059.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_059.png)'
- en: 'The resulting series is shown in the following plot:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 结果系列如下图所示：
- en: '![](img/B15439_A_15.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_15.png)'
- en: 'Figure A.15: ATR series for the AAPL stock price'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.15：AAPL股票价格的ATR系列
- en: Normalized average true range
  id: totrans-231
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 标准化平均真实波幅
- en: 'TA-Lib also offers a normalized ATR that permits comparisons across assets.
    The **normalized average true range** (**NATR**) is computed as follows:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: TA-Lib还提供了一种标准化的ATR，允许跨资产进行比较。**标准化平均真实波幅**（**NATR**）的计算方法如下：
- en: '![](img/B15439_A_060.png)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_060.png)'
- en: Normalization makes the ATR more relevant for long-term analysis where the price
    changes substantially and for cross-market or cross-security comparisons.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 标准化使ATR对于长期分析更为相关，在价格大幅变动和跨市场或跨证券比较时尤为重要。
- en: Fundamental risk factors
  id: totrans-235
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 基本风险因素
- en: Commonly used measures of risk include the exposure of asset returns to the
    returns of portfolios designed to represent fundamental factors. We introduced
    the five-factor model by Fama and French (2015) and showed how to estimate factor
    loadings and risk factor premia using two-state Fama-Macbeth regressions in *Chapter
    7*, *Linear Models – From Risk Factors to Return Forecasts*.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 风险的常用度量包括资产回报对旨在代表基本因素的投资组合回报的敞口。我们介绍了法玛和弗伦奇（2015年）的五因子模型，并展示了如何使用两状态法玛-麦克贝斯回归估计因子负载和风险因子溢价，详情见*第7章*，*线性模型-从风险因素到回报预测*。
- en: To estimate the relationship between the price of security and the forces included
    in the five-factor model such as firm size, value-versus-growth dynamic, investment
    policy and profitability, in addition to the broad market, we can use the portfolio
    returns provided by Kenneth French's data library as exogenous variables in a
    rolling linear regression.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 为了估计证券价格与五因子模型中包括公司规模、价值与成长动态、投资政策和盈利能力等因素之间的关系，除了广义市场外，我们可以使用Kenneth French的数据库提供的投资组合回报作为滚动线性回归中的外生变量。
- en: 'The following example accesses the data using the `pandas_datareader` module
    (see *Chapter 2*, *Market and Fundamental Data – Sources and Techniques*). It
    then computes the regression coefficients for windows of 21, 63, and 252 trading
    days:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 以下示例使用`pandas_datareader`模块访问数据（详见*第2章*，*市场和基本数据-来源和技术*）。然后，它计算了21、63和252个交易日的窗口的回归系数：
- en: '[PRE9]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The risk factors just described are commonly used and also known as **smart
    beta factors** (see *Chapter 1*, *Machine Learning for Trading – From Idea to
    Execution*). In addition, hedge funds have started to resort to alpha factors
    derived from large-scale data mining exercises, which we'll turn to now.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 刚刚描述的风险因素通常被称为**智能贝塔因子**（见*第1章*，*用于交易的机器学习-从想法到执行*）。此外，对冲基金已经开始使用从大规模数据挖掘练习中派生出的alpha因子，我们现在将转向这些因子。
- en: WorldQuant's quest for formulaic alphas
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: WorldQuant寻找公式阿尔法
- en: We introduced WorldQuant in *Chapter 1*, *Machine Learning for Trading – From
    Idea to Execution*, as part of a trend toward crowd-sourcing investment strategies.
    WorldQuant maintains a virtual research center where quants worldwide compete
    to identify **alphas**. These alphas are trading signals in the form of computational
    expressions that help predict price movements, just like the common factors described
    in the previous section.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在*第1章*，*用于交易的机器学习-从想法到执行*中介绍了WorldQuant，作为一种众包投资策略的趋势的一部分。WorldQuant维护着一个虚拟研究中心，全球量化分析师在此竞争，以确定**阿尔法**。这些阿尔法是以计算表达式形式的交易信号，帮助预测价格变动，就像前一节描述的通用因子一样。
- en: These **formulaic alphas** translate the mechanism to extract the signal from
    data into code, and they can be developed and tested individually with the goal
    to integrate their information into a broader automated strategy (Tulchinsky 2019).
    As stated repeatedly throughout this book, mining for signals in large datasets
    is prone to multiple testing bias and false discoveries. Regardless of these important
    caveats, this approach represents a modern alternative to the more conventional
    features presented in the previous section.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: Kakushadze (2016) presents 101 examples of such alphas, 80 percent of which
    were used in a real-world trading system at the time. It defines a range of functions
    that operate on cross-sectional or time-series data and can be combined, for example,
    in nested form.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: The notebook `101_formulaic_alphas` shows how to implement these functions using
    pandas and NumPy, and also illustrates how to compute around 80 of these formulaic
    alphas for which we have input data (we lack, for example, accurate historical
    sector information).
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
- en: Cross-sectional and time-series functions
  id: totrans-246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The building blocks of the formulaic alphas proposed by Kakushadze (2016) are
    relatively simple expressions that compute over longitudinal or cross-sectional
    data that are readily implemented using pandas and NumPy.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: 'The cross-sectional functions include ranking and scaling, as well as the group-wise
    normalization of returns, where the groups are intended to represent sector information
    at different levels of granularity:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
- en: 'We can directly translate the ranking function into a pandas expression, using
    a DataFrame as an argument in the format *number of period* × *number of tickers*,
    as follows:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'There are also several time-series functions that will likely be familiar:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: '| Function | Definition |'
  id: totrans-252
  prefs: []
  type: TYPE_TB
- en: '| `ts_{O}(x, d)` | Operator *O* applied to the time series for the past *d*
    days; non-integer number of days *d* converted to floor(*d*). |'
  id: totrans-253
  prefs: []
  type: TYPE_TB
- en: '| `ts_lag(x, d)` | Value of *x*, *d* days ago. |'
  id: totrans-254
  prefs: []
  type: TYPE_TB
- en: '| `ts_delta(x, d)` | Difference between the value of *x* today and *d* days
    ago. |'
  id: totrans-255
  prefs: []
  type: TYPE_TB
- en: '| `ts_rank(x, d)` | Rank over the past *d* days. |'
  id: totrans-256
  prefs: []
  type: TYPE_TB
- en: '| `ts_mean(x, d)` | Simple moving average over the past *d* days. |'
  id: totrans-257
  prefs: []
  type: TYPE_TB
- en: '| `ts_weighted_mean(x, d)` | Weighted moving average over the past *d* days
    with linearly decaying weights *d*, *d* – 1, …, 1 (rescaled to sum up to 1). |'
  id: totrans-258
  prefs: []
  type: TYPE_TB
- en: '| `ts_sum(x, d)` | Rolling sum over the past *d* days. |'
  id: totrans-259
  prefs: []
  type: TYPE_TB
- en: '| `ts_product(x, d)` | Rolling product over the past *d* days. |'
  id: totrans-260
  prefs: []
  type: TYPE_TB
- en: '| `ts_stddev(x, d)` | Moving standard deviation over the past *d* days. |'
  id: totrans-261
  prefs: []
  type: TYPE_TB
- en: '| `ts_max(x, d), ts_min(x, d)` | Rolling maximum/minimum over the past *d*
    days. |'
  id: totrans-262
  prefs: []
  type: TYPE_TB
- en: '| `ts_argmax(x, d), ts_argmin(x, d)` | Day of ts_*max(x, d), ts_min*(*x*, *c*).
    |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
- en: '| `ts_correlation(x, y, d)` | Correlation of *x* and *y* for the past *d* days.
    |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
- en: 'These time-series functions are also straightforward to implement using pandas''
    rolling window functionality. For the rolling weighted mean, for example, we can
    combine pandas with TA-Lib, as demonstrated in the previous section:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 这些时间序列函数也很容易使用pandas的滚动窗口功能来实现。例如，对于滚动加权平均值，我们可以结合pandas和TA-Lib，就像在前一节中演示的那样：
- en: '[PRE11]'
  id: totrans-266
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'To create the rolling correlation function, we provide two DataFrames containing
    time series for different tickers in the columns:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建滚动相关函数，我们提供了两个包含不同股票的时间序列的DataFrame列：
- en: '[PRE12]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: In addition, the expressions use common operators, as we will see as we turn
    to the formulaic alphas that each combine several of the preceding functions.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，这些表达式使用了常见的运算符，正如我们将在转向每个结合了前述几个函数的公式α时看到的那样。
- en: Formulaic alpha expressions
  id: totrans-270
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 公式化的α表达式
- en: 'To illustrate the computation of the alpha expressions, we need to create the
    following input tables using the sample of the 500 most-traded stocks from 2007-2016
    from the previous section (see the notebook `sample_selection` for details on
    data preparation). Each table contains columns of time series for individual tickers:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明α表达式的计算，我们需要使用前一节中从2007年到2016年的500支交易最多的股票的样本创建以下输入表格（有关数据准备的详细信息，请参见笔记本`sample_selection`）。每个表格包含了个股的时间序列列：
- en: '| Variable | Description |'
  id: totrans-272
  prefs: []
  type: TYPE_TB
  zh: '| 变量 | 描述 |'
- en: '| `returns` | Daily close-to-close returns |'
  id: totrans-273
  prefs: []
  type: TYPE_TB
  zh: '| `returns` | 每日收盘至收盘收益 |'
- en: '| `open`, `close`, `high`, `low`, `volume` | Standard definitions for daily
    price and volume data |'
  id: totrans-274
  prefs: []
  type: TYPE_TB
  zh: '| `open`、`close`、`high`、`low`、`volume` | 每日价格和交易量数据的标准定义 |'
- en: '| `vwap` | Daily volume-weighted average price |'
  id: totrans-275
  prefs: []
  type: TYPE_TB
  zh: '| `vwap` | 每日成交量加权平均价格 |'
- en: '| adv(d) | Average daily dollar volume for the past *d* days |'
  id: totrans-276
  prefs: []
  type: TYPE_TB
  zh: '| adv(d) | 过去*d*天的平均每日美元交易额 |'
- en: Our data does not include the daily volume-weighted average price required by
    many alpha expressions. To be able to demonstrate their computation, we very roughly
    approximate this value using the simple average of the daily open, high, low,
    and close prices.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据不包括许多α表达式所需的每日成交量加权平均价格。为了能够演示它们的计算，我们使用每日开盘、最高、最低和收盘价格的简单平均值来非常粗略地近似这个值。
- en: Contrary to the common alphas presented in the previous section, the formulaic
    alphas do not come with an economic interpretation of the risk exposure they represent.
    We will now demonstrate a few simply numbered instances.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 与前一节中介绍的常见α相反，公式α没有对其所代表的风险敞口进行经济解释。我们将展示几个简单编号的实例。
- en: Alpha 001
  id: totrans-279
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Alpha 001
- en: 'The first alpha expression is formulated as follows:'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个α表达式的公式如下所示：
- en: '[PRE13]'
  id: totrans-281
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The ternary operator `a ? b : c` executes *b* if *a* evaluates to `true`, and
    *c* otherwise. Thus, if the daily returns are positive, it squares the 20-day
    rolling standard deviation; otherwise, it squares the current close price. It
    then proceeds to rank the assets by the index of the day that shows the maximum
    for this value.'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: '三元运算符`a ? b : c`在*a*评估为`true`时执行*b*，否则执行*c*。因此，如果每日收益为正，它会计算20天滚动标准差的平方；否则，它会计算当前收盘价的平方。然后，它会按照显示此值最大的日期的指数对资产进行排名。'
- en: 'Using *c* and *r* to represent the close and return inputs, the alpha translates
    into Python using the previous functions and pandas methods, like so:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 使用*c*和*r*分别表示收盘价和收益输入，α可以使用前述函数和pandas方法在Python中进行转换，如下所示：
- en: '[PRE14]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'For the 10-year sample of 500 stocks, the distribution of Alpha 001 values
    and its relationship with one-day forward returns looks as follows:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 对于500支股票的10年样本，Alpha 001值的分布及其与一日前向收益的关系如下所示：
- en: '![](img/B15439_A_16.png)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_16.png)'
- en: 'Figure A.16: Alpha 001 histogram and scatter plot'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.16：Alpha 001直方图和散点图
- en: The **information coefficient** (**IC**) is fairly low, yet it is statistically
    significant at -0.0099 and the **mutual information** (**MI**) estimate yields
    0.0129 (see *Chapter 4*, *Financial Feature Engineering – How to Research Alpha
    Factors*, and the notebook `101_formulaic_alphas`, for implementation details).
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: '**信息系数**（**IC**）相当低，但在-0.0099处具有统计显著性，**互信息**（**MI**）估计值为0.0129（有关实现细节，请参见*第四章*，*金融特征工程
    - 如何研究α因子*，和笔记本`101_formulaic_alphas`）。'
- en: Alpha 054
  id: totrans-289
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Alpha 054
- en: 'Our second expression is the ratio of the difference between the low and the
    close price and the low and the high price, each multiplied by the open and close,
    respectively, raised to the fifth power:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个表达式是收盘价和最低价之间的差异与收盘价和最高价之间的差异的比率，分别乘以开盘价和收盘价，然后再乘以五次方：
- en: '[PRE15]'
  id: totrans-291
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Similarly, the translation into pandas is straightforward. We use `o`, `h`,
    `l`, and c to represent the DataFrames containing the respective price series
    for each ticker in the 500 columns:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，转换为pandas很简单。我们使用`o`，`h`，`l`和c来表示包含500列中每个股票的相应价格系列的数据帧：
- en: '[PRE16]'
  id: totrans-293
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: In this case, the IC is significant at 0.025, while the MI score is lower at
    0.005.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，IC为0.025，而MI得分为0.005。
- en: We will now take a look at how these different types of alpha factors compare
    from a univariate and a multivariate perspective.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将看看这些不同类型的alpha因子在单变量和多变量视角下的比较情况。
- en: Bivariate and multivariate factor evaluation
  id: totrans-296
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双变量和多变量因素评估
- en: 'To evaluate the numerous factors, we rely on the various performance measures
    introduced in this book, including the following:'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估众多因素，我们依赖于本书介绍的各种性能指标，包括以下内容：
- en: Bivariate measures of the signal content of a factor with respect to the one-day
    forward returns
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有关某一因素与一日前收益率的信号内容的双变量测量
- en: Multivariate measures of feature importance for a gradient boosting model trained
    to predict the one-day forward returns using all factors
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用所有因素来预测一日前收益率的梯度提升模型的多变量特征重要性度量
- en: Financial performance of portfolios invested according to factor quantiles using
    Alphalens
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据Alphalens使用因子分位数投资的投资组合的财务表现
- en: We will first discuss the bivariate metrics and then turn to the multivariate
    metrics; we will conclude by comparing the results. See the notebook `factor_evaluation`
    for the relevant code examples and additional exploratory analysis, such as the
    correlation among the factors, which we'll omit here.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先讨论双变量度量，然后转向多变量度量；我们将通过比较结果来结束。有关相关代码示例和其他探索性分析，请参阅笔记本`factor_evaluation`，我们将在此处省略因素之间的相关性。
- en: Information coefficient and mutual information
  id: totrans-302
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 信息系数和互信息
- en: 'We will use the following bivariate metrics, which we introduced in *Chapter
    4*, *Financial Feature Engineering – How to Research Alpha Factors*:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用以下双变量度量标准，这些度量标准在*第4章*，*金融特征工程 - 如何研究Alpha因子*中进行了介绍：
- en: The IC measured as the Spearman rank correlation
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IC以斯皮尔曼等级相关性衡量
- en: The MI score computed using `mutual_info_regression`, provided by scikit-learn
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用由scikit-learn提供的`mutual_info_regression`计算的MI分数
- en: The MI score uses a sample of 100,000 observations to limit the computational
    cost of the nearest neighbor computations. Both metrics are otherwise easy to
    compute and have been used repeatedly; see the notebook for implementation details.
    We will see, however, that they can yield quite different results.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: MI分数使用了100,000个观察样本来限制最近邻计算的计算成本。除此之外，这两个度量标准都很容易计算，并且已经被反复使用；有关实施细节，请参阅笔记本。然而，我们将看到它们可以产生非常不同的结果。
- en: Feature importance and SHAP values
  id: totrans-307
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征重要性和SHAP值
- en: To measure the predictive relevance of a feature given all other available factors,
    we can train a LightGBM gradient boosting model with default settings to predict
    the forward returns using all of the (approximately) 130 factors. The model uses
    8.5 years of data to train 104 trees using early stopping. We will obtain test
    predictions for the last year of data, which yield a global IC of 3.40 and a daily
    average of 2.01.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 为了衡量给定所有其他可用因素的特征的预测相关性，我们可以使用默认设置的LightGBM梯度提升模型来训练，以使用所有（大约）130个因素来预测前瞻性收益。该模型使用8.5年的数据训练104棵树，使用提前停止。我们将获得最后一年数据的测试预测，这将产生3.40的全局IC和2.01的日均值。
- en: 'We will then proceed to compute the feature importance and **SHapley Additive
    exPlanation** (**SHAP**) values, as described in *Chapter 12*, *Boosting Your
    Trading Strategy*; see the notebook for details. The influence plot in *Figure
    A.17* highlights how the values of the 20 most important features impact the model''s
    predictions positively or negatively relative to the model''s default output.
    In SHAP value terms, alphas 054 and 001 are among the top five factors:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将计算特征重要性和**SHapley加法解释**（**SHAP**）值，如*第12章*，*提升您的交易策略*中所述；有关详细信息，请参阅笔记本。
    *图A.17*中的影响图突出显示了20个最重要特征的值如何相对于模型的默认输出正面或负面地影响模型的预测。以SHAP值衡量，alphas 054和001位于前五因素之列：
- en: '![](img/B15439_A_17.png)'
  id: totrans-310
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_17.png)'
- en: 'Figure A.17: SHAP values for common and formulaic alphas'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.17：常见和公式化alpha的SHAP值
- en: Now, let's compare how the different metrics rate our factors.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们比较不同指标如何评价我们的因素。
- en: Comparison – the top 25 features for each metric
  id: totrans-313
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 比较 - 每个指标的前25个特征
- en: The rank correlation among SHAP values and conventional feature importance measured
    as the weighted contribution of a feature to the reduction of the model's loss
    function is high at 0.89\. It is also substantial between SHAP values and both
    univariate metrics at around 0.5.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SHAP 值和传统特征重要性之间的排名相关性，后者是特征对模型损失函数减少的加权贡献，为 0.89。SHAP 值与两个单变量指标之间的相关性也很大，约为
    0.5。
- en: 'Interestingly, though, MI and IC disagree significantly in their feature rankings
    with a correlation of only 0.16, as shown in the following diagram:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，MI 和 IC 在特征排名上存在显著差异，相关性仅为 0.16，如下图所示：
- en: '![](img/B15439_A_18.png)'
  id: totrans-316
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_18.png)'
- en: 'Figure A.18: Rank correlation of performance metrics'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.18：性能指标的排名相关性
- en: '*Figure A.19* displays the top 25 features according to each metric. Except
    for the MI score, which prefers the "common" alpha factors, features from both
    sources are ranked highly:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 A.19*显示了根据每个指标的前 25 个特征。除了 MI 分数喜欢 "常见" alpha 因子之外，两个来源的特征都排名很高：'
- en: '![](img/B15439_A_19.png)'
  id: totrans-319
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_19.png)'
- en: 'Figure A.19: Top 25 features for each performance metric'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.19：每种性能指标的前 25 个特征
- en: It is not immediately apparent why MI disagrees with the other metrics and why
    few of the features it assigns a high score play a significant role in the gradient
    boosting model. A possible explanation is that the computation uses only a 10
    percent sample and the scores appear sensitive to the sample size.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 目前尚不清楚为什么 MI 与其他指标不一致，以及为什么它分配高分的特征在梯度提升模型中发挥了重要作用。一个可能的解释是计算仅使用了 10% 的样本，分数似乎对样本大小敏感。
- en: Financial performance – Alphalens
  id: totrans-322
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 金融业绩-Alphalens
- en: Finally, we mostly care about the value of the trading signals emitted by an
    alpha factor. As introduced in *Chapter 4*, *Financial Feature Engineering – How
    to Research Alpha Factors*, and demonstrated repeatedly, Alphalens evaluates factor
    performance on a standalone basis.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们主要关心 alpha 因子发出的交易信号的价值。如*第四章*介绍的，*金融特征工程-如何研究 alpha 因子*，并反复演示，Alphalens
    对因子性能进行单独评估。
- en: The notebook `alphalens_analysis` lets you select an individual factor and compute
    how portfolios invested for a given horizon according to how factor quantile values
    would have performed.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 笔记本 `alphalens_analysis` 让您选择一个单独的因子，并计算根据因子分位值投资的投资组合在给定时间段内的表现如何。
- en: 'The example in *Figure A.20* shows the result for Alpha 54; while portfolios
    in the top and bottom quintiles did achieve a 1.5 bps average spread on a daily
    basis, the cumulative returns of a long-short portfolio were negative:'
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: '*图 A.20*中的示例显示了 Alpha 54 的结果；尽管头部和底部五分位组合在每日基础上取得了 1.5 bps 的平均收益，但长短组合的累积收益为负值：'
- en: '![](img/B15439_A_20.png)'
  id: totrans-326
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B15439_A_20.png)'
- en: 'Figure A.20: Alphalens performance metric for Alpha 54'
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 图 A.20：Alpha 54 的 Alphalens 性能指标
- en: Feel free to use the notebook as a template to evaluate the sample factors or
    others of your own choosing more systematically.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 随意使用笔记本作为模板，更系统地评估样本因子或您自己选择的其他因子。
