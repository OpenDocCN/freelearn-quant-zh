- en: '13'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Portfolio Management System
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Toto, I have a feeling we are not in Kansas anymore."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Dorothy, The Wizard of Oz
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: My first job in the hedge fund world was to build and maintain a **Portfolio
    Management System** (**PMS**) for a start-up hedge fund with less than $5 million
    under management. The principals believed that risk management was not some ornament
    of the business, but the business itself. Fast forward to now, and they are the
    dominant player in the Japanese alternative space. In this chapter, we will continue
    with our work from the last two chapters, and introduce a customized PMS which
    shows risk visualization across the portfolio.
  prefs: []
  type: TYPE_NORMAL
- en: 'To illustrate the importance of a robust PMS, let''s connect a few concepts
    we explored throughout this book. In *Chapter 1*, *The Stock Market Game*, we
    set the context that the market is an infinite, complex random game. In *Chapter
    6*, *The Trading Edge is a Number, and Here is the Formula*, we unveiled the magical,
    mysterious, and mythical trading edge formula. In *Chapter 8*, *Position Sizing:
    Money is Made in the Money Management Module*, we demonstrated that position sizing
    determines performance. And we learned in *Chapter 11*, *The Long/Short Toolbox*,
    about the tools in our toolbox. So, we know that position sizing is the key determinant,
    but we don''t know which positions will work out, yet we must maintain a positive
    expectancy while managing exposures. Rinse and repeat every day for years to attract
    and keep investors.'
  prefs: []
  type: TYPE_NORMAL
- en: Over the course of my career, friends and colleagues have been generous enough
    to unveil their PMSes. Survival is directly correlated to the quality of their
    PMSes. Not everyone who had a proper system made it. Yet every single manager
    who did not have a system eventually crashed.
  prefs: []
  type: TYPE_NORMAL
- en: 'A PMS is like flight instruments. Any rookie can fly a plane in clear skies.
    Instruments are there to prevent crashes during takeoff and when landing at night,
    through fog and turbulence. Without instruments, not everyone will be coming home.
    The market is not fair weather and smooth sailing all the time. Things do get
    ugly unexpectedly. Emotions do steer us off course. In execution trader English,
    how can you claim to be a portfolio manager if you don''t have a solid PMS? Building a
    customized PMS using Python deserves its own book, if not its own dedicated literary
    genre, and therefore exceeds the scope of this book. However, in this chapter
    we will briefly touch on a few fundamental concepts and guiding principles that
    will hopefully guide you:'
  prefs: []
  type: TYPE_NORMAL
- en: Symptoms of poor portfolio management systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Your portfolio management system is your Iron Man suit
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automating the boring stuff
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Building a robust portfolio management system
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can access color versions of all images in this chapter via the following
    link: [https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf).
    You can also access the source code for this chapter via the book''s GitHub repository:
    [https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt](https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt).'
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter and the rest of the book, we will be working with the `pandas`,
    `numpy`, `yfinance`, and `matplotlib` libraries. So, please remember to import
    them first:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Symptoms of poor portfolio management systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When it comes to turning performance around, a good PMS is the lowest hanging
    fruit. In 2005, I joined a hedge fund whose PMS was so ugly, looking at it could
    have caused brain damage. I promptly tooled it up, at least to get rid of the
    health hazard. Suddenly, problem children lit up like garlands on a Christmas
    tree. Volatile penny stocks on the short side, lazy dogs, and unappreciated racing
    hounds were all swiftly dealt with. Volatility came down. Performance was more
    consistent. The Sharpe ratio jumped. Investors noticed. **Assets Under Management**
    (**AUM**) grew. It was that simple.
  prefs: []
  type: TYPE_NORMAL
- en: Everyone wants to know the "secret sauce" of the winners, but this is one area
    where the lessons of the "alpha-challenged" ones might help us from inadvertently
    repeating the same mistakes. Here is a simple exercise that will help you figure
    out if your system is in need of an upgrade. Deficient PMSes share one or more
    of the following symptoms.
  prefs: []
  type: TYPE_NORMAL
- en: Ineffective capital allocation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As much as portfolio managers like to project an Olympian demi-god image to
    the public, they can be reeled back to earth with a few sentences:'
  prefs: []
  type: TYPE_NORMAL
- en: '"Nice guys finish last": some stocks post impressive returns that go unnoticed
    because positions are small. Those are often exploratory tiny positions. They
    post high returns but contribute poorly because they are not adequately sized.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '"Fat cats don''t catch the mice": some big positions contribute only because
    of their massive weight. This is a classic problem with PMS. It is directly related
    to the above point. Those are often high-conviction ideas that occupy far too
    much real estate for their paltry returns.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '"Once we were warriors": those are veteran contributors who are now mooching
    rent-free. Those are ideas that have been stale for a while. They have a lot of
    embedded historical contribution but do not pay rent anymore. We have addressed
    the situation in the game of two thirds in *Chapter 7*, *Improve Your Trading
    Edge*.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Undermonitored risk detection
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A key metric to keep an eye on is liquidity, to avoid "Hotel California Syndrome."
    In other words, you do not own what you cannot liquidate, it owns you. Liquidity
    is the currency of bear markets. Are there positions that cannot be liquidated
    without severe market impact? Below is a function that restates position size
    in days to exit at a fraction of the average volume. Sheer terror for a short
    seller is when you see a bear market rally gain momentum and realize your position
    is too big to get out unscathed. There are few worse feelings than being squeezed
    out of a position only to see it resume its downward descent post bear market
    tsunami.
  prefs: []
  type: TYPE_NORMAL
- en: 'A simple risk measure is to restate a position size as the number of days necessary
    to liquidate at a fraction of the average volume. The code below simply calculates
    a fraction of the average volume. The position quantity is divided by this fraction:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'This produces an output something like the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'We can produce the chart shown in *Figure 13.1*:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'We downloaded `volume` data since the beginning of 2021\. The function multiplies
    a fixed percentage by a moving average of the volume. This number of shares is
    divided by a fraction of volume: `0.01`, or 1%. This value is arbitrary and deliberately
    low to show the principle. In practice, 5-10% are reasonable thresholds. At the
    end of June 2021, it would take roughly 5 days to liquidate the entire position
    if the order size did not exceed 1% of the average volume. We printed the last
    number in the series and plotted the moving average:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_01.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.1: Days to liquidate at 1% of 3 months average volume'
  prefs: []
  type: TYPE_NORMAL
- en: The above chart shows liquidity is not static. It would originally take about
    2 days to liquidate the position trading at 1% of the average daily volume. As
    liquidity thins out, the number of days necessary to liquidate increases to 5
    days, then comes back down to around 3.5 days. A week is an eternity when price
    moves against you. Liquidity should therefore be monitored.
  prefs: []
  type: TYPE_NORMAL
- en: Market impact is the adverse change in price caused by trading large quantities.
    Market impact starts when positions are bigger than 5% of the daily volume. If
    a position takes more than 5 days at 10% of the volume, then expect some serious
    market impact. Besides, the violence of bear market rallies cannot be understated
    enough. You will mentally be on your back foot trading yourself out of a hole.
    So, always monitor liquidity and trim positions when volume thins out.
  prefs: []
  type: TYPE_NORMAL
- en: High volatility
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Crowded shorts have high average borrow utilization. Liquidity will thin out,
    volatility will increase, and returns will deteriorate. Heatmaps of utilization
    or borrowing fees are very valuable tools. At the date of publication, there are
    unfortunately no free sources for borrow utilization. As a shortcut, when the
    lending fee is largely above the average, assume popularity. The simplest way
    to deal with crowded shorts is to reduce position size as popularity rises. Again,
    make simple rules, like (for example) cut exposure in half if utilization rises
    above 40% and by an additional half for every 10% increase. By the time utilization
    reaches 60%, exposure would be 25% of the original size. This is just food for
    thought.
  prefs: []
  type: TYPE_NORMAL
- en: 'Blow-ups do not stand out: people want to feel good about themselves. In the
    markets, doing what feels good is rarely the most lucrative course of action.
    Stocks at risk must visually nag managers into taking action. Stocks rarely blow
    up unexpectedly. They often give subtle signals that things are not going the
    way they should.'
  prefs: []
  type: TYPE_NORMAL
- en: High correlation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The goal of diversification is to reduce correlation. Correlation is difficult
    to avoid. In *Chapter 4*, *Long/Short Methodologies: Absolute and Relative*, we
    introduced the relative series to reduce correlation with the benchmark. However,
    the focus shifts from timing the absolute top or bottom to catching sector rotation,
    and allocating assets accordingly. Correlation within a portfolio is hard to eliminate.
    Frankly speaking, I do not know how to accomplish this in practice. Neither have
    I encountered successful methods so far.'
  prefs: []
  type: TYPE_NORMAL
- en: Poor exposure management
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are a few different types of exposures, which can indicate a poorly managed
    portfolio in the following ways:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Net exposure: when portfolio net exposure does not match the current bullish/bearish
    view. This is particularly true in bear phases, when net exposure still points
    to residual bullishness despite ambient gloom. Portfolio cognitive dissonance
    is when exposures do not reflect the claims of managers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Net beta exposure: true market sensitivity is absent in most deficient systems.
    When managers focus solely on net exposure, they conflate low directionality with
    net market sensitivity. Net beta goes one step beyond net exposure to reflect
    the sensitivity to the market.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Market cap exposure: shorting futures is the junk food of hedging. As we saw
    in *Chapter 11*, *The Long/Short Tooolbox*, small and large caps have different
    risk profiles. Small caps perform well when the general mood of the market is
    optimistic, while large caps are safer bets. The net market cap exposure reflects
    the overall optimism of the portfolio'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Gross exposure: too much leverage in good times and too much cash in bad times.
    Gross exposure is the easiest lever to reduce or add risk. When in doubt, collapse
    leverage is the simplest risk policy to live by.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Exchange exposure: exposure by market cap and exchange explains a lot of good/bad
    performance. As we saw in *Chapter 4*, *Long/Short Methodologies: Absolute and
    Relative*, Nasdaq has outperformed S&P 500 for years. Years of easy money have
    rewarded speculative issues and those who bet on them. When money is easy, it
    is easy to make money. No bull market has ever boosted anyone''s IQ.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All in all, the highest return on investment in the asset management industry
    is a bespoke PMS. As the information gap closes, market participants scramble
    to find an edge. If you can spot and address problems earlier than your peers,
    you gain a sustainable competitive edge.
  prefs: []
  type: TYPE_NORMAL
- en: Your portfolio management system is your Iron Man suit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"You know, the question I get asked most often is, "Tony, how do you go to
    the bathroom in your suit?" [Long pause] Just like that."'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: – Tony Stark, Iron Man
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Tony Stark may be a genius, a billionaire, a playboy, and a philanthropist.
    What truly gives him his superpower is his custom-made Iron Man suit. He did not
    buy his suit off the rack at Macy's. He torpedoed a few Lamborghinis in his garage
    building something that uniquely enhanced his fighting style. In the same way,
    your PMS is your Iron Man suit. It is an extension of your trading strategy. Its
    sole purpose is to help you make trading decisions under uncertainty. Since no
    one trades like you, it requires a high degree of customization.
  prefs: []
  type: TYPE_NORMAL
- en: A classic mistake is to buy an expensive off-the-shelf software package, thinking
    that more information will lead to better trading decisions. Software solutions
    are primarily reporting tools designed by middle office personnel for front office
    professionals. Your PMS is a trading tool, not a reporting one. A Barra factor
    decomposition or the Street consensus earnings per share will not tell you how
    many shares of whichever company you should be buying or selling short today.
    Information turns into knowledge, which does not readily translate into skill.
    The key to building skill is to focus exclusively on information that directly
    leads to action.
  prefs: []
  type: TYPE_NORMAL
- en: 'In practice, a few months after system integration, portfolio managers often
    end up managing their portfolio with a low-tech Excel spreadsheet feeding from
    those shiny toys. They bought a Lamborghini to fetch the milk. Therefore, before
    you rush to buy the most expensive toy out there, here are a few principles that
    will help you clarify your needs. Information must be organized under four principles:
    clarity, relevance, simplicity, and flexibility.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Clarity: bypass the left brain'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Under stress, your amygdala releases chemicals that reduce the activity of
    your prefrontal cortex, or "thinking brain." Your ability to think clearly gets
    impaired. Your PMS needs clarity: the information must be organized so that problems
    jump out at you. Secondly, the left brain cannot process rows and columns of numbers.
    It is slow, 5 to 7 bits per second. It does not make associations. Everything
    blurs into a sterile number soup. Meanwhile, the right brain processes information
    one hundred times faster, seeks patterns, and makes associations. Fortunately,
    data visualization is the new trend in data science. Visual cues bypass the slower-thinking
    brain. When decisions involve multiple factors, painting by numbers facilitates
    associations. For example, visualizing your positions within your investment universe
    as a heatmap will immediately tell you whether you are on the right track and
    riding the best horse within each sector. We will look at a portfolio heatmap
    at the end of the chapter.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Another topic is alerts. Did you ever wonder why disaster sirens are so annoying?
    People might not get the same sense of urgency if the "Ode to Joy" were to announce
    an imminent earthquake, tsunami, or volcanic eruption. We are hardwired to move
    away from pain and toward pleasure. Alarms are there to compel the most reluctant
    people into action. When a position needs to be dealt with, make the alert as
    nagging as possible. The more annoying the alert, the more likely it will be swiftly
    dealt with. The best alerts are those you must manually acknowledge first before
    doing your daily routine. Example: let''s say that a stock has reached a stop
    loss. If an alert is set such that you must click on it to be able to continue
    to your portfolio, two things can happen. Either you will swiftly deal with the
    problem, or you will end up avoiding your tool altogether. When the need to be
    right supersedes the imperative to make money, our inner idiot works extra hard
    to self-sabotage.'
  prefs: []
  type: TYPE_NORMAL
- en: A classic mistake is to have multiple pages, one for each risk factor. This
    means users must juggle between pages and take notes. Every degree of friction
    increases information leakage. A pilot should not have to run up and down the
    plane to see if the hydraulics and the fuel gauge are all in order. If you want
    to make associations between different risks, you need to bring all relevant information
    into a one-page summary that allows drill-down in later pages. Think of it like
    the dashboard of a car or a plane. All the information you need is on display
    before you.
  prefs: []
  type: TYPE_NORMAL
- en: 'Put things in context. The left brain does not process numbers effectively.
    Gross exposure of 295% is just a number. When plotted on a chart that displays
    benchmark, gross, and net exposures and performance, that number is in context.
    It is a visual representation of what the market did, how you were positioned,
    and the resulting performance over time. A picture is worth a thousand words.
    Let''s recycle the example we saw in *Chapter 11*, *The Long/Short Toolbox*. We
    simulated a portfolio from the following tickers. We ran the numbers assuming
    no trading from December 31st 2020 through to June 2021:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: In *Chapter 11*, *The Long/Short Toolbox*, we worked on the `port` dataframe.
    This time, we will visualize exposures using `price_df`. We will first calculate
    benchmark returns. Then, we will calculate long and short market values in relative
    and absolute.
  prefs: []
  type: TYPE_NORMAL
- en: We will calculate exposures and returns in absolute and relative.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The `rel_price` frame is the `price_df` dataframe divided by the benchmark close
    multiplied by 1,000\. We use continuous series, not rebased to the beginning of
    the series. The value of the index at the beginning is 4 decimals long. We therefore
    multiply the relative price by 1,000 to have easier numbers to work with. We multiply
    the prices by the number of shares, aggregate by the sign of the positions, and
    sum up to obtain relative long and short market values. Since there was no trading,
    there was no change to the market values other than returns. We therefore calculate
    cumulative returns using the market value daily changes. As we saw in *Chapter
    11*, *The Long/Short Toolbox*, the gross exposure uses the absolute series. This
    is the actual balance sheet usage.
  prefs: []
  type: TYPE_NORMAL
- en: 'We plot the main exposures and the returns in a chart. We then plot the relative
    series:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'We will have four graphs. The first one is the "who are you?" chart:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_02.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.2: The "who are you" chart: market returns and exposures'
  prefs: []
  type: TYPE_NORMAL
- en: 'The above chart is a personal favorite. If there was one chart to sum up the
    portfolio management skill of a manager, it would be this one. It shows how managers
    respond to what the market throws at them. The benchmark market returns is the
    solid red line and all the other lines are the manager''s response:'
  prefs: []
  type: TYPE_NORMAL
- en: Gross exposure is the dashed line. Leverage is a direct reflection of confidence.
    Rising gross exposure displays confidence.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Net exposure is the dotted line. Net exposure symbolizes optimism. A rising
    net exposure indicates growing bullishness. As both sides of the portfolio worked
    out nicely, shorts decreased while longs increased in value. This resulted in
    a net long drift.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Net beta is the dashed-dotted stable line. Net beta symbolizes risk appetite.
    When risk is on, more speculative issues will populate the long book and defensive
    sectors and names will be on the short side. There was no trading, so the net
    beta is simply a reflection of the evolution of the market values.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, the solid black line is the returns. Managing exposures this way resulted
    in this performance.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The only missing component in this chart is net trading. Plot net long/short
    trading in bars and this will display responses. Since there was no trading in
    this example, there are no bars.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Next, let''s look at how the long and short books contributed to performance.
    Our original premise is that a long/short portfolio is the sum of two relative
    books. The long book must outperform the index while the short one has to trail
    the benchmark. Here is how it came about:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_03.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.3: Returns: benchmark, absolute, relative, long and short'
  prefs: []
  type: TYPE_NORMAL
- en: In practice, it is exceedingly rare to consistently outperform the index over
    a short period of time. The red solid line is the benchmark. The dotted blue line
    is the relative performance and the solid black line is the absolute one.
  prefs: []
  type: TYPE_NORMAL
- en: 'First of all, the performance of the long/short exceeded the index. This is
    as close to fiction as this book will ever get. The relative long returns are
    upward triangles. The short relative returns are downward triangles. Secondly,
    note how close to the index the long and short relative returns are. They are
    the excess returns over the index. Put this in perspective with the number of
    stocks in the relative bullish or bearish regime we saw in *Chapter 4*, *Long/Short
    Methodologies: Absolute and Relative*. They oscillate around the benchmark.'
  prefs: []
  type: TYPE_NORMAL
- en: 'To fully understand the meaning of excess returns, let''s compare the relative
    long/short returns with the absolute ones:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_04.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.4: Returns: benchmark, absolute, relative, long and short'
  prefs: []
  type: TYPE_NORMAL
- en: This noisy chart shows the absolute long and short returns. It shows a principle
    still foreign to many absolute players. Making money on the short side in a bull
    market means losing as little as possible. Breaking even is a good thing. Think
    about it from your long positions in a bear market. You do not expect to make
    any money, and quite frankly you would be happy if you did not lose your shirt
    on your longs.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s remove both absolute and relative net returns and concentrate on long
    and short absolute and relative returns to drive the point home:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_05.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.5: Returns: benchmark, absolute, relative, long and short'
  prefs: []
  type: TYPE_NORMAL
- en: 'In execution trader English, expect your shorts to bleed in a bull market.
    Just make sure you do not let a small scratch turn into an infection and gangrene
    the entire portfolio. This is where a lot of novice short sellers make the classic
    mistake of shrinking their short book. Here is how this syllogism usually goes:'
  prefs: []
  type: TYPE_NORMAL
- en: The long/short arena is a highly competitive sport. Every basis point of performance
    counts.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The short book is leaking alpha, financial creole for losing money.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: So, let's shrink the short book to jugulate the alpha hemorrhage and focus on
    the long side.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That line of thinking usually ends up in an atrophied short side. This widens
    the net exposure and increases the net beta. This directly increases the correlation
    with the markets and the volatility of returns. Those two are precisely what investors
    are willing to pay a premium to avoid. Selling short is a muscle that atrophies
    when not flexed. In conclusion, focus on your mandate, your exposures, and the
    excess returns over the index.
  prefs: []
  type: TYPE_NORMAL
- en: 'Relevance: the Iron Man auto radio effect'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Despite all the gadgets in his suit, have you ever wondered why Tony Stark does
    not have a low-tech auto radio in his Iron Man suit? He is also the CEO of Stark
    Industries and maybe he would like to know what market experts think about his
    share price. However, listening to the chrematocoulrophony on CNBC is simply a
    distraction Tony Stark cannot afford when he fights some bad guy.
  prefs: []
  type: TYPE_NORMAL
- en: The Iron Man auto radio effect is the reason why market participants sometimes
    invoke a human limitation to the number of stocks they can manage. Your PMS is
    not here to provide information. It is an extension of your trading strategy,
    here to tell you what to do. It will spit out orders that will either come from
    signals in your strategy or your risk management. You do not need to know your
    Sharpe ratio or consensus EPS 2 years out to execute a stop loss. You need to
    know your main exposures and how many shares you need to trade to hedge your portfolio
    according to the mandate you designed in *Chapter 11*, *The Long/Short Toolbox*.
  prefs: []
  type: TYPE_NORMAL
- en: Everyone has a monitoring screen that shows what goes on in their portfolio.
    Very few market participants have taken the extra step to build a trading screen
    that embeds their trading rules and processes information into trading decisions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Build a separate trading sheet with a column for each trading decision: stop
    loss, profit taking, time exit, re-entry, and so on. Have your trading rules or
    investment process run in the background. When a decision needs to be made, display
    the number of shares in the corresponding cell, else leave it blank.'
  prefs: []
  type: TYPE_NORMAL
- en: For example, when a stock has reached a profit-taking target, just print the
    number of shares that need to be closed.
  prefs: []
  type: TYPE_NORMAL
- en: 'In *Chapter 11*, *The Long/Short Toolbox*, we performed a pro rata risk adjustment.
    First, we will republish the code. We will show the aggregates before and after
    adjustment. We will then print out orders:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'We decide to update risk equally on the long and short side by `-0.01`, which
    equates to reducing risk by 1%. The sorting key to pro-rate the adjustment was
    the relative risk-adjusted returns. The lower the relative performance in units
    of relative risk, the bigger the adjustment. The adjusted stocks and quantities
    to be traded were:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: You can adjust the value of the `adjust_long` and `adjust_short` variables to
    whatever risk adjustment you'd like to make (positive or negative). Add a column
    for prices, another for order type, and that is all the system must spit out.
    You do not need to know anything about malolactic fermentation and aging in barrels
    every time you drink a glass of wine.
  prefs: []
  type: TYPE_NORMAL
- en: 'Simplicity: complexity is a form of laziness'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: When you are fighting for your life, you do not need a heavy, shiny parade costume.
    You need Spartan armor—light, effective, battle-tested.
  prefs: []
  type: TYPE_NORMAL
- en: As you start building your PMS, you will be tempted to add more bells and whistles.
    Complexity is a form of laziness. Build what is necessary, not what is nice. For
    example, if you trade moving averages, you do not need four columns with price,
    first and second moving averages, and shares. This is information overload. All
    you need is a column with the number of shares or the weight to be traded and
    only when the condition is met.
  prefs: []
  type: TYPE_NORMAL
- en: Your PMS does not need to reinvent the wheel. Prime brokers provide a lot of
    the information you need through their API. For example, performance calculation
    is a waste of resources. It involves corporate actions such as stock splits, dividends,
    and subscriptions/redemptions. This all goes into modified Dietz time series performance
    calculation, separated by share class. Meanwhile, your prime brokers will provide
    **net asset value** (**NAV**) and performance calculations via their API every
    morning before breakfast.
  prefs: []
  type: TYPE_NORMAL
- en: The rule of thumb is to only display information that will lead to a decision,
    either directly, such as trades to take, or indirectly, such as levels of open
    risk. Another example is borrow utilization. Your system spits out a short trade
    for *x* thousands of shares. You start to salivate, but then the system also shows
    that borrow utilization is around 40%. It would probably be wiser to trade smaller
    sizes.
  prefs: []
  type: TYPE_NORMAL
- en: 'Flexibility: information does not translate into decision'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Tooling up managers with a PMS is like giving glasses to a myopic person. At
    first, they are happy to see anything at all. Then, they start asking for more.
    Eyesight gives vision. A classic mistake is to buy expensive software before figuring
    out what you need. Software solutions are conceived by middle-office personnel
    for front-office warriors. This often results in front-office personnel using
    a fraction of the software's capability and building a separate tool on Excel.
  prefs: []
  type: TYPE_NORMAL
- en: Another mistake is to hardcode everything from inception. Your PMS will evolve
    with you. Every small improvement has a knock-on effect. When people take on an
    exercise routine, the prospect of a night out drinking is not so attractive. No
    one trades like you do, so no one else can do it for you. It does not have to
    be perfect, but it must work first. In the beginning, make it cheap and flexible.
    Excel, Google Sheets, R, Python, and Jupyter Notebooks are enough to start experimenting.
    In theory, C++ is faster than Python. In practice, C++ is months, if not years,
    slower than Python. Python is the new Excel!
  prefs: []
  type: TYPE_NORMAL
- en: Automating the boring stuff
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: All market participants want to be the next Jim Simmons. No one wants to take
    care of the plumbing. People want to do the exciting stuff. They want to show
    up with their billion-dollar idea and trade away. They do not want to take care
    of risk management. In this section are a few examples of time-consuming and ultimately
    boring processes that should be automated and the reasons why.
  prefs: []
  type: TYPE_NORMAL
- en: Trade reconciliation is the process of reconciling orders placed with trades
    executed. It shows what trades went through at what price. This is one of the
    few tasks that would make reading the tax code look like an exciting endeavor.
    Yet it is an important task as the data is used to perform trade analysis. Did
    the price beat the **volume at weighted average price** (**VWAP**) or not?
  prefs: []
  type: TYPE_NORMAL
- en: Updating the PMS is boring but not as easy as it seems. Companies go through
    all sorts of corporate actions, such as dividends and stock splits. Those corporate
    actions have an impact on the consistency of the data. It requires attention to
    detail.
  prefs: []
  type: TYPE_NORMAL
- en: Automate trading orders routing. The vast majority of algorithmic traders have
    automated execution. After all, if the system says "Buy this much of this" or
    "Sell that much of that," then just do it. Execution is on autopilot. Discretionary
    traders still struggle with fully trusting their system. What if the system spits
    out a ludicrous number? Or, what if the market does this or that? Well, trust
    is built. A simple solution is to default to automatic execution unless there
    is a manual override.
  prefs: []
  type: TYPE_NORMAL
- en: Building a robust portfolio management system
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Below is a quick step-by-step guide to building a robust PMS. Remember that
    each PMS requires a high degree of customization. You are building your own Iron
    Man suit. As a result, this guide will remain fairly vague.
  prefs: []
  type: TYPE_NORMAL
- en: 'Formalize your strategy into simple trading decisions: buy/sell, how much,
    at what price. A trading sequence is fairly straightforward. Draw a flowchart
    and fill the sequence.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Add decisions that come out of risk management: liquidity, weight, borrow utilization,
    net beta, and gross and net exposure. We saw earlier a risk reduction across the
    entire portfolio.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: From your monitoring tool, create a separate trading sheet with each trading
    decision in a separate column. This minimalist monitoring tool is particularly
    efficient for large portfolios.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Beyond your field of vision, embed your trading rules. This can be columns in
    the far right of the sheet, macros on Excel, and scripts on Python. All you need
    is the sausage on your plate, not a visual of the entire cooking process.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In your field of vision, index your portfolio with tickers as rows and trading
    decisions as columns.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Decision visualization: if a trading decision is triggered, print the number
    of shares, or the weight, in the corresponding cell, and leave everything else
    blank. This adds visual impact.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Start small with rule-based actions: stop loss or profit taking are low-effort
    high-impact decisions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Over time, build an integrated tool. Add your trading history to directly calculate
    position size. A powerful tool is to integrate your portfolio monitoring tool
    and watchlist into a market heatmap.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Throw out the auto radio. As you refine your process, you will be tempted to
    add cells and columns. Work a little bit harder to keep as much as possible in
    the background.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In *Chapter 11*, *The Long/Short Toolbox*, there was an expanded table with
    shares to be traded. We re-sort the dataframe by side (long or short) and relative
    risk-adjusted returns (`rRAR`). We slice the dataframe to display only relevant
    columns:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'It all looked something like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_10.png)'
  prefs: []
  type: TYPE_IMG
- en: Let's contextualize the above table in a portfolio management framework.
  prefs: []
  type: TYPE_NORMAL
- en: Let's visualize the side of the portfolio and the sensitivity to the market
    first. We want to know on which side the high/low beta sits. Do we have a bullish
    or a bearish skew?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Next, we want to have our trading decisions. We do not need to finally come
    to a conclusion on the last column. We want to know what to do first. Then, we
    can check that the system works as expected.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We already know that the adjustment will reduce our gross exposure. Now, we
    want to know the before/after impact on each position. These are the "weight"
    and "weight_adj" columns.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Risk purists would show the impact on risk next to weight. Our asset allocation
    key was to reduce risk prorated to performance instead of weight. We wanted to
    trim poorly performing positions first. So, we display contribution, "CTR," "rCTR,"
    and relative risk-adjusted return, "rRAR."
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, we display relative risks before and after "rRISK" and "rRisk_adj."
    The last column shows the residual risk across the portfolio at the stock level.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This conceptual framework is boiled down to its most essential components. Every
    number in every column has a *raison d'être*. Even the upper echelon of office
    Solitaire and Tetris grand masters, otherwise referred to as compliance and risk
    officers, would concur that this was compiled in accordance with the strictest
    risk management guidelines in vigor in the industry, vernacular for "I don't know,
    it doesn't look like it is about to blow up the farm."
  prefs: []
  type: TYPE_NORMAL
- en: 'The only problem is that the left hemisphere of our brain is not equipped to
    process this information. This is a sterile number soup that the brain cannot
    process, let alone relate to. The conscious brain can process 5 +/-2 bits of information
    per second. In execution trader English, by the time your eyes have gone from
    one end of the table to the other, your brain has forgotten what it needed to
    look for in the first place. Second bit of bad news: you are nothing special.
    It happens to everyone. Besides, Rain Man, if you can memorize the table, you
    would make a better living counting cards at a Blackjack table.'
  prefs: []
  type: TYPE_NORMAL
- en: The real question is, how can we turn this sterile soup into something we can
    accurately process in a single glance? It turns out our brain comes equipped with
    a right hemisphere. It processes information at lighting speed, making associations
    between seemingly random bits of data. The only drawback is that the data needs
    to be repackaged in a format this brain can process. In execution trader English,
    let's paint by numbers. We will be using a built-in constructor called Styler.
    It only takes a few lines of code to return a versatile heatmap. These few lines
    of code can be recycled to draw quick and efficient heatmaps for market returns.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: We run a long/short portfolio. Numbers appearing on the short side often carry
    a negative sign. We do not want our subconscious brain to associate short positions
    with negative returns. So, we dissociate descriptive fields (`desc_cols`) from
    the performance-related columns (`perf_cols`). The more color maps you want to
    display on a single dataframe, the more you simply stack back to back.
  prefs: []
  type: TYPE_NORMAL
- en: The `sort_values` method is added to enhance even further the versatility of
    the heatmap. This sterile soup number comes alive when painted properly. The frescoes
    in the Sistine Chapel may look divine, but behind them is just a wall.
  prefs: []
  type: TYPE_NORMAL
- en: '![A screenshot of a computer  Description automatically generated with low
    confidence](img/B17704_13_06.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.6: Portfolio heatmap'
  prefs: []
  type: TYPE_NORMAL
- en: 'This heatmap is sorted by side (long/short) and relative risk-adjusted returns
    (rRAR). Numbers come alive when painted. This table could be further simplified.
    Again, the guiding principle is to display as little distraction as possible.
    Let''s note the improvements to this display:'
  prefs: []
  type: TYPE_NORMAL
- en: First, the quantity, cost, price, and stop loss columns are hidden. They are
    important information, but not critical. Noncritical information that could otherwise
    distract is removed. If a stop loss is triggered, you need to know how many shares
    need to be traded. Until then, they are a distraction.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this example, the first five columns are strictly descriptive. The number
    of shares to be traded has no additional meaning. It therefore does not require
    a paint job.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The other descriptive columns operate on a yellow to turquoise to purple color
    code. Side immediately shows which side of the book we are dealing with. Beta
    shows how we are axed. It looks like most of the low beta stuff is on the short
    side. The largest weights before/after are still the stocks where post adjustment
    risk remains high.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Everything else is color-coded with a three color pattern ranging from red to
    orange to green, indicating the health or weight of each cell. The system works.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here are other visualization ideas. When building a PMS, focus on what resonates
    for you. It is your Iron Man suit. Some people like tables and work with heatmaps.
    Some people react to charts. In the next block of code, we will visualize the
    information in the form of bar charts. We will use different keys to sort the
    data to illustrate different perspectives.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: There is nothing really fancy in the code except the color code. Entrust a Frenchman
    with color coding his own book and the proverbial pig will have pastel and lavender
    lipstick reminiscent of a summer Monet garden.
  prefs: []
  type: TYPE_NORMAL
- en: 'We used three different sorting keys to display the data under three different
    perspectives:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_07.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.7: Portfolio sorted by "rRAR"'
  prefs: []
  type: TYPE_NORMAL
- en: The sorting key is rRAR in ascending order regardless of the side. Overall,
    the first half of the chart is occupied by long positions. The tide of a bull
    market lifts all stocks. Even though the short book has not generated massive
    absolute money, it has clocked massive returns.
  prefs: []
  type: TYPE_NORMAL
- en: 'Secondly, we sort by "Weight" and "rRAR":'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_08.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.8: Portfolio sorted by "Weight" and "rRAR"'
  prefs: []
  type: TYPE_NORMAL
- en: This reclassifies everything into long/short books and puts an "rRAR" perspective
    on the portfolio. The heaviest positions are the best risk-adjusted contributors,
    which is in line with this portfolio management strategy.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_09.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.9: Portfolio sorted by "Side" and "rRisk_adj"'
  prefs: []
  type: TYPE_NORMAL
- en: 'This sorts by "Side" and relative risk post-adjustment, "rRisk_adj." This produces
    a two-sided chart with the short side on the left and the long side on the right.
    Results are consistent with the strategy. Best performers have bigger weights
    and higher risk. Next, let''s look at a market participant''s favorite stalking
    tool: the watchlist.'
  prefs: []
  type: TYPE_NORMAL
- en: 'A watchlist is inert unless it has some trading decisions embedded. We have
    all missed a few trades simply because we took our eyes off the ball. Here is
    a step-by-step method that will ensure you maintain a healthy actionable watchlist:'
  prefs: []
  type: TYPE_NORMAL
- en: Input ticker, target levels, date of entry
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Automate triggers: when the price reaches the target level, print the number
    of shares to be traded, else blank'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Weed out stale ideas: periodically sort by date. Delete stale ideas after each
    review'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sort the list once a day
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This semi-automated watchlist will set you apart from the competition. Market
    participants rarely take the time to formalize their plan. When everyone else
    tries to improvise while gripped by fear, you will show up with a rational plan.
  prefs: []
  type: TYPE_NORMAL
- en: 'This process will probably take weeks if not months, depending on your level
    of formalization. A bespoke PMS will have these positive effects:'
  prefs: []
  type: TYPE_NORMAL
- en: It will force you to formalize your process. If investment is a process, then
    automation is the logical conclusion. This principle has withstood the test of
    time since the dawn of the industrial revolution. The evolution of computer processing
    has reinforced it.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It will shed a crude light on the flaws in your process. Discretionary and semi-automated
    market participants have blind spots.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It will reduce emotional interference: making decisions out of a monitoring
    screen is 100% discretionary. Running an algorithm is 100% systematic. You will
    fall somewhere along the spectrum.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It reduces stress: when all decisions run in the background and only show up
    when needed, you do not need to worry and preemptively take action.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It frees up mental bandwidth to either manage more names or spend more time
    thinking. When your system is aligned with your process, you will spend less time
    worrying, in other words, consuming mental bandwidth, and more time planning.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When you are an analyst or a hobby retail trader, you are a stock jockey. You
    champion a few stocks. You have some skin in the game, but you do not go to bed
    with million-dollar tickets hanging over your sleep like swords of Damocles. When
    you choose to become a portfolio manager, you are not a jockey anymore. You take
    on the responsibility of stable master. Your job is to optimize finite resources
    among all the horses in your stable. This is why you need a PMS.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Investing in a PMS is the highest return on investment decision you will ever
    make. Without one, you might get lucky a few times picking the right stocks here
    and there, but nothing compares to the disciplined consistency of a robust PMS.
    You will top up winners and deal with flesh wounds before gangrene sets in and
    limits performance. You will become a more disciplined market participant. Risk
    management is not part of the business. It is the business. Portfolio managers
    are not in the business of picking stocks. They are in the business of managing
    risk with the stocks they either picked or passed. Small benefits compound over
    time and set you apart from the competition who still run around believing stock
    picking is the key to success. When your portfolio management becomes your Iron
    Man suit, you will be competing against people who think they trade a system.
  prefs: []
  type: TYPE_NORMAL
- en: Short selling is risky. The market does not cooperate. Yet choosing not to learn
    to sell short is riskier. You may well choose never to engage in short selling,
    but regardless, learning to sell short can only enrich your repertoire. We sincerely
    hope that this book will spark a conversation about short selling. The field has
    been demonized and under-researched for too long. We hope to have given its letters
    of nobility to the discipline.
  prefs: []
  type: TYPE_NORMAL
- en: We began by dispelling myths about short selling and explaining why the long
    mindset predictably fails on the short side. We continued by looking into idea
    generation with the relative series and regime definition. It was also about position
    sizing and risk management. The final part of the book was much more than long/short
    portfolio construction. It was about designing a product that investors find attractive—uncorrelated
    low volatility returns—using a long/short vehicle.
  prefs: []
  type: TYPE_NORMAL
- en: You will find an automated stock screening tool in *Appendix, Stock Screening*
    that we hope you will find useful!
  prefs: []
  type: TYPE_NORMAL
