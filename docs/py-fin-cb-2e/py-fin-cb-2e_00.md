# 前言

在过去几年中，我们在数据科学领域看到了惊人的增长。几乎每天都会有一些新的进展，例如，发布的研究论文宣布新的或改进的机器学习或深度学习算法，或者为最流行的编程语言之一发布的新库。

过去，许多这些进展并没有进入主流媒体。但这一点也在迅速改变。最近的一些例子包括 AlphaGo 程序击败 18 次围棋世界冠军，利用深度学习生成从未存在过的逼真人类面孔，或者通过 DALL-E 2 或 Stable Diffusion 等模型从文本描述生成美丽的数字艺术。

另一个最近的、惊人的发展例子是 OpenAI 的 ChatGPT。这是一个语言模型，能够让我们进行自然流畅的对话。该模型能够跟踪过去的问题并对其进行跟进，承认错误或拒绝不当请求。更重要的是，它不仅限于自然语言，我们还可以要求它编写各种编程语言的实际代码片段。

除了那些值得关注的成就外，在过去几十年里，人工智能几乎已经被各行各业采用。我们随处可见它的身影，例如我们在 Netflix 上获得的推荐，或者我们收到的关于一个我们近期没有使用的在线商店提供额外折扣的邮件。因此，世界各地的企业都在使用人工智能，通过以下方式获得竞争优势：

+   做出更好的、基于数据的决策

+   通过高效的目标定位或精准的推荐来提高利润

+   通过及早识别面临风险的客户来减少客户流失

+   自动化重复性任务，AI 能够比人类员工更快速（且可能更精确）地完成这些任务

同样的人工智能革命也在影响着金融行业。根据《福布斯》2020 年一篇文章的报道，“70%的金融服务公司正在使用机器学习来预测现金流事件、微调信用评分并检测欺诈行为”。此外，数据科学的各个方面也被用于算法交易、机器人顾问服务、个性化银行服务、流程自动化等。

本书提供了一本基于食谱的指南，介绍如何使用现代 Python 库解决金融领域中的各种任务。因此，我们尽量减少需要编写的代码量，利用成熟且经过“实战验证”的库，这些库在许多行业中被专业人士广泛使用。虽然本书假设读者具备一定的基础知识，并不会从理论角度解释所有概念，但它提供了相关的参考资料，帮助读者深入了解各个主题。

在本书的前言中，您将了解到本书的内容概述、组织结构以及在实践中如何实现目标的过程中所需的内容。我希望您能享受这段旅程！

# 本书适合谁阅读

本书面向数据分析师、金融分析师、数据科学家或机器学习工程师，他们希望学习如何在金融环境中实施广泛的任务。本书假设读者对金融市场和交易策略有一定的了解，并且能够熟练使用 Python 及其面向数据科学的流行库（例如`pandas`、`numpy`和`scikit-learn`）。

本书将帮助读者正确地使用金融领域中的高级数据分析方法，避免潜在的陷阱和常见错误，并为他们可能试图解决的问题得出正确的结论。此外，由于数据科学和金融领域在不断变化和扩展，本书还包含了学术论文和其他相关资源的参考，旨在拓宽对所涵盖主题的理解。

# 本书的内容

*第一章*，*获取金融数据*，介绍了几种最受欢迎的高质量金融数据来源，包括 Yahoo Finance、Nasdaq Data Link、Intrinio 和 Alpha Vantage。重点介绍了如何利用专用的 Python 库并处理数据以便进一步分析。

*第二章*，*数据预处理*，描述了用于预处理数据的各种技术。它描述了从获取数据到使用数据构建机器学习模型或研究交易策略之间的关键步骤。因此，它涵盖了诸如将价格转换为收益、根据通货膨胀调整价格、填补缺失值或将交易数据聚合成各种类型的柱状图等主题。

*第三章*，*可视化金融时间序列*，专注于可视化金融（以及其他）时间序列数据。通过绘制数据，我们可以直观地识别一些模式，如趋势、季节性和拐点，并可以使用统计测试进一步确认这些模式。在这一阶段获得的洞察可以帮助我们在选择建模方法时做出更好的决策。

*第四章*，*探索金融时间序列数据*，展示了如何使用各种算法和统计测试自动识别时间序列数据中的潜在问题，例如异常值的存在。此外，它还涉及分析数据中是否存在趋势或其他模式，如均值回归。最后，它探讨了资产收益的风格化事实。这些概念在处理金融数据时至关重要，因为我们希望确保构建的模型/策略能够准确捕捉资产收益的动态。

*第五章*，*技术分析与构建交互式仪表板*，通过展示如何计算一些最流行的技术指标并自动识别蜡烛图数据中的模式，解释了 Python 中技术分析的基础知识。它还演示了如何创建基于 Streamlit 的 Web 应用程序，使我们能够以交互方式可视化和检查预定义的技术分析指标。

*第六章*，*时间序列分析与预测*，介绍了时间序列建模的基础知识。它首先研究了时间序列的构建块以及如何使用各种分解方法将其分离。然后，讨论了平稳性概念、如何进行平稳性检验以及在原始序列不平稳的情况下如何使其平稳。最后，展示了如何使用两种最广泛应用于时间序列建模的统计方法——指数平滑法和 ARIMA 类模型。

*第七章*，*基于机器学习的时间序列预测方法*，首先解释了验证时间序列模型的不同方法。接着，概述了特征工程的方法。它还介绍了一种自动特征提取工具，可以通过几行代码生成数百或数千个特征。此外，解释了简约回归的概念以及如何使用 Meta 的流行算法 Prophet。本章最后介绍了其中一个流行的时间序列预测 AutoML 框架。

*第八章*，*多因子模型*，涵盖了各种因子模型的估计，从最简单的单因子模型（CAPM）开始，然后扩展到更高级的三因子、四因子和五因子模型。

*第九章*，*使用 GARCH 类模型建模波动率*，重点介绍了波动率和条件异方差性的概念。它展示了如何使用单变量和多变量 GARCH 模型，这些模型是建模和预测波动率的最流行方法之一。

*第十章*，*金融中的蒙特卡洛模拟*，解释了如何使用蒙特卡洛方法进行各种任务，例如模拟股票价格、定价没有封闭解的衍生品（美式/另类期权），或估计投资组合的不确定性（例如，通过计算风险价值和预期短缺）。

*第十一章*，*资产配置*，首先解释了最基本的资产配置策略，并在此基础上展示了如何评估投资组合的表现。接着，它展示了三种不同的获取有效前沿的方法。最后，它探讨了层次风险平价，这是基于图论和机器学习相结合的一种新型资产配置方法。

*第十二章*，*回测交易策略*，介绍了如何使用两种方法（矢量化方法和事件驱动方法），借助流行的 Python 库运行各种交易策略的回测。为此，使用了一些基于流行技术指标或均值-方差投资组合优化构建的策略实例。

*第十三章*，*应用机器学习：识别信用违约*，展示了如何处理预测贷款违约这一实际的机器学习任务。它涵盖了机器学习项目的整个范围，从收集和清洗数据到构建和调优分类器。本章的重要收获是理解机器学习项目的通用方法，这些方法可以应用到许多不同的任务中，无论是客户流失预测还是估算新房地产在某个社区的价格。

*第十四章*，*机器学习项目的高级概念*，延续了前一章中介绍的工作流程，并展示了机器学习项目 MVP 阶段的可能扩展。它首先介绍了更先进的分类器。接着，讨论了对类别特征进行编码的替代方法，并介绍了几种处理不平衡数据的方法。

此外，它展示了如何创建堆叠集成的机器学习模型，并利用贝叶斯超参数调优来改进传统的网格搜索。它还探讨了各种计算特征重要性的方法，并利用这些信息来选择最具信息量的预测因子。最后，它简要介绍了快速发展的可解释 AI 领域。

*第十五章*，*金融中的深度学习*，描述了如何将一些近期的神经网络架构应用于金融领域的两个潜在使用案例——预测信用卡违约（一个分类任务）和时间序列预测。

# 为了最大化从本书中获得的收益

在本书中，我们尝试为读者提供一个关于金融领域各种技术的高层次概览，同时重点关注这些方法的实际应用。这就是为什么我们特别强调展示如何使用各种流行的 Python 库，来使分析师或数据科学家的工作更加轻松，并减少出错的可能性。

由于学习任何东西的最佳方式是通过实践，我们强烈鼓励读者尝试使用提供的代码示例（代码可以在附带的 GitHub 仓库中找到），将这些技术应用到不同的数据集上，并探索可能的扩展（其中一些在食谱的*另见*部分中提到）。

为了深入了解理论基础，我们提供了进一步阅读的参考资料。这些参考资料还包括一些更为高级的技术，超出了本书的范围。

## 下载示例代码文件

本书的代码包托管在 GitHub 上，网址是 [`github.com/PacktPublishing/Python-for-Finance-Cookbook-2E`](https://github.com/PacktPublishing/Python-for-Finance-Cookbook-2E)。我们还提供了来自我们丰富图书和视频目录的其他代码包，地址是 [`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。赶紧去看看吧！

## 下载彩色图像

我们还提供了一份包含本书中截图/图表的彩色图片的 PDF 文件。你可以在此下载：[`packt.link/JnpTe`](https://packt.link/JnpTe)。

## 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、Python 库的名称、数据库表名称、文件夹名称、文件名、文件扩展名和路径名。例如：“我们还可以使用`get_by_id`函数来下载特定的 CPI 系列。”

一段代码块以以下方式显示：

```py
def realized_volatility(x): 
 return np.sqrt(np.sum(x**2)) 
```

任何命令行输入或输出如下所示：

```py
Downloaded 2769 rows of data. 
```

**粗体**：表示新术语或重要词汇。例如：“**成交量柱**是解决这一问题的尝试。”

信息框显示如下。

小贴士和技巧以这种方式展示。

此外，在每个 Jupyter Notebook 的最开始（可以在本书的 GitHub 仓库中找到），我们运行几个单元格，导入并设置 `matplotlib` 的绘图功能。为了简洁起见，后续我们不再提及这一点。因此，任何时候都可以假设已经执行了以下命令。

首先，我们（可选地）使用以下代码增加了生成图形的分辨率：

```py
%config InlineBackend.figure_format = "retina" 
```

然后我们执行第二段代码：

```py
import matplotlib.pyplot as plt
import seaborn as sns

import warnings
from pandas.core.common import SettingWithCopyWarning
warnings.simplefilter(action="ignore", category=FutureWarning)
warnings.simplefilter(action="ignore", category=SettingWithCopyWarning)

# feel free to modify, for example, change the context to "notebook"
sns.set_theme(context="talk", style="whitegrid",
              palette="colorblind", color_codes=True,
              rc={"figure.figsize": [12, 8]}) 
```

在此单元格中，我们导入了 `matplotlib`、`warnings` 和 `seaborn`。然后，我们禁用了部分警告并设置了绘图风格。在某些章节中，为了提高图形的可读性（尤其是黑白图），我们可能会调整这些设置。
