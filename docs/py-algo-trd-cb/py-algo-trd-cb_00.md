前言

Python 是一种非常流行的语言，用于构建和执行算法交易策略。如果您想了解如何使用 Python 构建算法交易的坚实基础，本书可以帮助您。

从设置 Python 环境进行交易和与经纪人建立连接开始，您将了解金融市场的重要方面。随着您在这本算法交易书中的进展，您将学会获取金融工具，查询和计算各种类型的蜡烛图和历史数据，最后，计算和绘制技术指标。接下来，您将了解如何下达各种类型的订单，例如普通订单、套利订单和套单，并了解它们的状态转换。您还将揭示从零开始设计和执行强大的算法交易策略时所面临的挑战。后续章节将带您进行回测、模拟交易，最终进行真实交易，使用您从零开始创建的算法策略。您甚至将了解如何自动化交易，并找到进行有效决策的正确策略，这对人类交易者来说是不可能的。

本书结束时，你将能够通过实现 Python 库来进行算法交易，从而使用 Python 进行算法交易生态系统中的关键任务。

# 第一章：本书适合对象

如果你是金融分析师、金融交易员、数据分析师、算法交易员、交易爱好者或任何想要学习使用 Python 进行算法交易和重要技术以解决金融领域所面临挑战的人，这本书适合你。需要具备 Python 编程语言的基本工作知识。虽然对交易相关术语的一些基本知识将会有所帮助，但并非必须。

# 本书内容概述

第一章，*处理和操作日期、时间和时间序列数据*，详细介绍了 Python `DateTime`模块和 pandas DataFrame，这些是有效处理时间序列数据所需的。

第二章，*股票市场 - 交易入门*，介绍了如何设置 Python 与经纪人的连接，获取金融工具，并简要了解如何下达简单订单。您还将学习如何查询保证金和计算经纪费和政府税。

第三章，*获取金融数据*，深入讨论了金融工具。

第四章，*计算蜡烛图和历史数据*，解释了如何获取和理解历史数据，以及如何获取、计算和绘制各种蜡烛图模式，包括日本蜡烛图（OHLC）、Renko、线段破坏和平均蜡烛图。

第五章，*计算和绘制技术指标*，解释了如何计算和绘制包括趋势指标、动量指标、波动率指标和成交量指标在内的 10 种技术指标。

第六章，*在交易所下常规订单*，解释了如何在两种交易类型、两种订单代码和四种订单品种之间下 16 种常规订单。您将学习如何实时查询订单状态，同时还将了解经纪人支持的可能订单状态以及常规订单的订单生命周期。

第七章，*在交易所下挂单和交易所下覆盖单*，解释了如何在两种交易类型和多种订单品种之间下八种挂单和四种覆盖单。您将学习有关目标、止损和跟踪止损的信息，以及经纪人支持的可能订单状态以及挂单和覆盖单的订单生命周期。

第八章，*算法交易策略 – 逐步编码*，解释了如何使用两个策略编码示例从头开始编写您自己的算法交易策略，其中包括常规订单和挂单。

第九章，*算法交易 – 回测*，介绍了如何使用两个策略编码示例来回测您自己的算法交易策略，其中包括常规订单和挂单。您还将学习如何实时获取执行日志和各种类型的回测报告，包括盈亏报告、统计报告和订单历史日志。

第十章，*算法交易 – 模拟交易*，解释了如何在实时市场中使用两个策略编码示例来模拟交易您自己的算法交易策略，其中包括常规订单和挂单。您还将学习如何实时获取执行日志和各种类型的模拟交易报告，包括盈亏报告、统计报告和订单历史日志。

第十一章，*算法交易 – 实盘交易*，解释了如何在实时市场和真实资金中使用两个策略编码示例进行真实交易您自己的算法交易策略，其中包括常规订单和挂单。您还将学习如何实时获取执行日志和各种类型的真实交易报告，包括盈亏报告和统计报告。

# 要充分利用本书

本书适合任何对算法交易领域感兴趣的人士。您不需要有金融或算法交易背景。您需要有 Python 编程语言的基本知识。每一章都介绍算法交易中的一个新概念，并逐步引导您从零到高手。本书可以帮助您在使用 Python 进行算法交易方面建立坚实的基础。

您需要在计算机上安装最新版本的 Python 3。本书中的示例在 Python 3.8.2 上进行了测试，它们应该在任何将来的 Python 发布版本上都能正常工作。

您还需要在 Zerodha，一家现代经纪商，拥有一个经纪账户，以尝试大多数章节中涵盖的各种技术。*附录 I*提供了如何设置 Zerodha 账户的详细、逐步信息，以防您没有账户。

要执行交易策略，您还需要在 AlgoBulls 上拥有一个账户。*附录 II*提供了如何设置 AlgoBulls 账户的详细、逐步信息，以防您没有账户。

此外，几乎每一章都期望您已安装了其他 Python 包，例如 `pyalgotrading`。您可以使用 `pip` 进行安装。这在每一章的技术要求部分有解释。

本章中的所有示例都作为 Jupyter 笔记本提供在我们的 GitHub 存储库上：[`github.com/PacktPublishing/Python-Algorithmic-Trading-Cookbook`](https://github.com/PacktPublishing/Python-Algorithmic-Trading-Cookbook)。如果您想要直接尝试示例而无需输入任何代码，您也可以安装 Jupyter Notebook。您可以使用 `pip` 进行安装：`pip install notebook`。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.7+ ([`www.python.org/downloads/`](https://www.python.org/downloads/)) | 任何支持 Python 3.7+ 的操作系统；Linux、Windows、macOS X 等等。 |

每一章的要求总结在以下表格中：

| **章节编号** | **Zerodha 账户** | **AlgoBulls 账户** |
| --- | --- | --- |
| 1 | 否 | 否 |
| 2 | 是 | 否 |
| 3 | 是 | 否 |
| 4 | 是 | 否 |
| 5 | 是 | 否 |
| 6 | 是 | 否 |
| 7 | 是 | 否 |
| 8  | 否 | 是 |
| 9 | 否 | 是 |
| 10 | 否 | 是 |
| 11 | 否 | 是 |

**如果您使用本书的数字版本，我们建议您自己输入代码或通过 GitHub 存储库访问代码（链接在下一节中提供）。这样做可以帮助您避免与复制和粘贴代码相关的任何潜在错误。**

## 下载示例代码文件

您可以从您在 [www.packt.com](http://www.packt.com) 的账户中下载本书的示例代码文件。如果您在其他地方购买了本书，您可以访问 [www.packtpub.com/support](https://www.packtpub.com/support) 并注册，文件将直接发送到您的邮箱。

您可以按照以下步骤下载代码文件：

1.  在 [www.packt.com](http://www.packt.com) 登录或注册。

1.  选择“支持”选项卡。

1.  单击“Code Downloads”。

1.  在搜索框中输入书名，并按照屏幕上的指示操作。

下载文件后，请确保使用最新版本的以下工具解压或提取文件夹：

+   用于 Windows 的 WinRAR/7-Zip

+   用于 Mac 的 Zipeg/iZip/UnRarX

+   用于 Linux 的 7-Zip/PeaZip

本书的代码包也托管在 GitHub 上：[`github.com/PacktPublishing/Python-Algorithmic-Trading-Cookbook`](https://github.com/PacktPublishing/Python-Algorithmic-Trading-Cookbook)。如果代码有更新，将在现有的 GitHub 存储库上更新。

我们还有其他代码包，来自我们丰富的书籍和视频目录，可以在 **[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)** 查看！快去看看吧！

## 下载彩色图像

我们还提供了一个 PDF 文件，其中包含本书中使用的屏幕截图/图表的彩色图像。您可以在此处下载：[`static.packt-cdn.com/downloads/9781838989354_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781838989354_ColorImages.pdf)。

## 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名称、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄。以下是一个例子：“经纪人通常为每个客户提供唯一的密钥，通常是作为 `api-key` 和 `api-secret` 键对。”

代码块设置如下：

```py
>>> plot_candlestick_chart(historical_data, 
                           PlotType.OHLC, 
                           'Historical Data | '
                           'Japanese Candlesticks Pattern | '
                           'NSE:TATASTEEL | 1st Jan, 2020 | '
                           'Candle Interval: 1 Minute')
```

任何命令行输入或输出都按照以下方式编写：

```py
$ pip install pyalgotrading
```

**粗体**：表示新术语、重要词或屏幕上看到的词。例如，菜单或对话框中的单词会像这样出现在文本中。以下是一个例子：“如果一个日本蜡烛的 **收盘** 价格高于其 **开盘** 价格，它的颜色就是绿色的。”

警告或重要说明会显示如下。

提示和技巧显示如下。

# 章节

在本书中，您会发现一些经常出现的标题（*Getting ready*、*How to do it...*、*How it works...*、*There's more...* 和 *See also*）。

要清晰地说明如何完成配方，请按照以下部分进行操作：

## 准备工作

本节告诉您可以在配方中期望什么，并描述设置任何软件或任何配方所需的任何初步设置的方法。

## 如何实现…

本节包含完成配方所需的步骤。

## 工作原理…

本节通常包括对前一节发生的情况的详细解释。

## 还有更多…

本节包含有关配方的其他信息，以使您对配方更加了解。

## 另请参阅

本节提供有用的链接，指向配方的其他有用信息。
