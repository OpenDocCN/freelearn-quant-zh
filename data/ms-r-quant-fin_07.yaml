- en: Chapter 7. Exotic Options
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章 外来期权
- en: 'All derivatives are financial contracts, and in these contracts, there are
    far more features that can be agreed on than a simple right to buy or to sell.
    Complex payout structures can be engineered based on what-if scenarios; thus,
    the final payout of an exotic contract can be dependent on a whole set of circumstances.
    Often, even the path of the underlying has a serious influence on the final payout.
    Compared to these derivatives, the good old call and put options were soon seen
    simple, earning them a not too impressive nickname: plain vanilla.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 所有衍生品都是金融合约，在这些合约中，可以商定的特性远超过简单的买卖权利。可以根据假设情境设计复杂的支付结构；因此，外来合约的最终支付可能依赖于一整套情形。通常，甚至标的物的路径也对最终支付有重大影响。与这些衍生品相比，传统的认购和认沽期权很快就被视为简单，从而获得了一个不太令人印象深刻的昵称：普通香草期权。
- en: Vanilla call and put options are like plain vanilla ice-creams, the simplest
    possible ice-cream without any fancy optional toppings. The expression "plain
    vanilla" is so strongly embedded in finance that it is even used in the bond market,
    where a vanilla bond is the simplest possible coupon-paying bond.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 普通的认购期权和认沽期权就像普通香草冰淇淋，是最简单的冰淇淋，没有任何复杂的配料。“普通香草”这个表达在金融领域中根深蒂固，甚至在债券市场中也使用，其中香草债券是最简单的支付票息债券。
- en: Any option that has some extras over the basic plain vanilla options belong
    to a very numerous group called exotic options. Exotic options are popular because
    sell-side bankers are in fierce competition to offer tailor-made products for
    the clients. Another reason behind the fact that exotics are widely spread is
    that, interestingly enough, most of the time, quoting a price on an exotic structure
    is not a much more difficult task for market makers than quoting vanilla prices.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 任何相对于基本的普通香草期权有额外特点的期权都属于一个庞大的群体，称为外来期权。外来期权很受欢迎，因为卖方银行家在激烈竞争中，为客户提供量身定制的产品。外来期权广泛传播的另一个原因是，有趣的是，大多数情况下，对外来结构报价对市场制造者来说并不比报价普通香草期权更加困难。
- en: A general pricing approach
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一种通用的定价方法
- en: Exotic or not, there is one intrinsic feature that is always the same in every
    derivative product, that is, it is a function of other instruments, hence the
    name derivative. Thus, the price of a derivative is not independently developed
    as the outcome of a direct supply and demand; rather, it is given as an estimated
    construction cost. For example, the one month forward dollar price of a euro is
    highly dependent on the spot dollar price of the euro; the forward price is just
    the function of the spot price (and the interest rates).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 无论是外来品还是其他，所有衍生品都有一个内在的共同特点，那就是它们是其他工具的函数，因此得名“衍生品”。因此，衍生品的价格并不是通过直接的供需关系独立发展出来的，而是作为一种估算的构建成本。例如，欧元的一个月期远期美元价格高度依赖于欧元现货美元价格；远期价格只是现货价格（以及利率）的函数。
- en: If exactly the same benefits that are granted by holding a derivative can be
    constructed by a trading strategy that involves less complex instruments, then
    the derivative can be replicated. Derivatives are not like unique paintings; the
    forgery of a derivative has the very same value, while replicas are as good as
    the original. By using the no-arbitrage argument, *Black and Scholes (1973)* and
    *Merton (1973)* showed that the price of a derivative should be equal to the expected
    sum of expenses that arise during the proper implementation of the dynamic replication
    strategy. *Taleb (1997)* extensively describes that implementing a proper replication
    strategy under real market circumstances could often be really tricky.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 如果通过一种涉及较简单工具的交易策略能够构建与持有衍生品相同的利益，那么该衍生品就可以被复制。衍生品不像独一无二的画作；衍生品的伪造品具有相同的价值，而复制品与原件一样好。通过使用无套利论证，*Black和Scholes（1973）*以及*Merton（1973）*表明，衍生品的价格应该等于在适当实施动态复制策略过程中产生的预期费用之和。*Taleb（1997）*广泛描述了，在实际市场环境中实施适当的复制策略往往是非常棘手的。
- en: The role of dynamic hedging
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 动态对冲的作用
- en: Most of the time, replication is a dynamic strategy. You should do more or less
    trading almost continuously during the lifetime of the derivatives. *Haug (2007b)*
    shows that the hedging error of non-continuous hedging could be significant even
    for plain vanilla options. Anyway, continuous hedging is a huge effort, which
    is often not seen explicitly in the pricing formulas; however, most pricing functions
    are based on the assumption that dynamic hedging should be done in the background
    properly all the time. This is also the case whenever we talk about risk-neutral
    world or the risk-neutral pricing. For further references, see *Wilmott (2006)*.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时候，复制是一个动态策略。在衍生品的生命周期内，你几乎需要不断地进行交易。*Haug (2007b)* 表明，非连续对冲的对冲误差，即使对于普通的香草期权，也可能是显著的。无论如何，连续对冲是一项巨大的工作，通常在定价公式中没有显式体现；然而，大多数定价函数都假设在后台应始终正确进行动态对冲。这也适用于我们每次谈论风险中性世界或风险中性定价时。更多参考资料，见
    *Wilmott (2006)*。
- en: Luckily, no matter how hard dynamic hedging could be, running an option book
    is at least a scalable business; hedging thousands of options is not much more
    difficult than hedging just a couple of them. All options can be decomposed into
    certain sensitivities, the so-called Greek letters (or simply Greeks). This nickname
    came from the fact that some crucial sensitivity was named with a letter from
    the Greek alphabet (delta, gamma, rho, and theta). They are partial derivatives
    and thus they are additive. Summing up the deltas of the individual options gives
    the delta of the portfolio and so on. This works not only for the plain vanillas
    but for the exotics too, thus creating a very strong link between the vanillas
    and the exotics.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，不管动态对冲有多困难，运行期权组合至少是一个可扩展的业务；对冲成千上万的期权并不比对冲几个期权更难。所有期权都可以分解为某些敏感度，即所谓的希腊字母（或简称为希腊字母）。这个昵称源于某些关键敏感度是用希腊字母命名的（例如delta、gamma、rho和theta）。它们是偏导数，因此它们是可加的。将各个期权的delta加总起来就得到组合的delta，以此类推。这不仅适用于普通的香草期权，也适用于异域期权，从而在香草期权和异域期权之间建立了一个非常强的联系。
- en: How R can help a lot
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: R如何提供很大帮助
- en: We start this chapter by showing some examples for exotic options, giving one
    possible classification. We will show examples from the `fExoticOptions` package
    and how the so-called Black-Scholes surface can be created for any derivative-pricing
    function. Afterwards, we will focus on the numerical estimation of the Greeks
    of any exotic derivative. Next, we will show the pricing of an exotic option that
    is not yet included in the `fExoticOptions` package.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过展示一些异域期权的例子来开始本章，给出一种可能的分类方法。我们将展示来自`fExoticOptions`包的例子，并说明如何为任何衍生品定价函数创建所谓的Black-Scholes表面。之后，我们将专注于对任何异域衍生品希腊值的数值估算。接下来，我们将展示一种尚未包含在`fExoticOptions`包中的异域期权定价方法。
- en: We have chosen the **Double-no-touch (DNT)** binary option mainly because of
    its popularity on the foreign exchange (**FX**) markets and the many conclusions
    that are relevant even for other exotics. We will use AUDUSD as underlying because
    at the time of writing this chapter, there is a significant interest differential
    between the AUD and the USD interest rates, and we can show how to put these rates
    into the pricing functions. We will show a second way of calculating the price
    of a DNT by using static option replication arguments. We will show a real-life
    example of a DNT, and in a simulation, we will show a way to estimate the survivorship
    probability of a DNT. Using this, we can discuss the relationship of real-world
    and risk-neutral probabilities and the role of risk premium. Finally, we will
    show some practical fine-tuning tricks to embed exotic options into structured
    products.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 我们选择**双无触碰（DNT）**二元期权，主要是因为它在外汇（**FX**）市场上的流行程度以及它所蕴含的许多对其他异域期权仍然适用的结论。我们将以AUDUSD作为标的，因为在撰写本章时，澳元和美元的利率之间存在显著的利差，我们可以展示如何将这些利率纳入定价函数中。我们将通过使用静态期权复制论证展示第二种计算DNT价格的方法。我们将展示一个DNT的实际例子，并通过模拟展示一种估算DNT存活概率的方法。利用这一方法，我们可以讨论现实世界概率与风险中性概率之间的关系以及风险溢价的作用。最后，我们将展示一些实用的微调技巧，用于将异域期权嵌入结构化产品中。
- en: Besides seeing examples to implement complex exotic option-pricing functions
    and simulations in R, as a side effect, understanding the Greeks as links between
    exotics and vanillas will be the learning outcome of this chapter. We will use
    the same terminology that was introduced in [Chapter 5](ch05.html "Chapter 5. FX
    Derivatives"), *FX Derivatives*, which also includes much more about currencies
    and plain vanilla options.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 除了通过在 R 中实现复杂的异型期权定价函数和模拟的示例，作为附带效果，本章的学习成果还包括将希腊字母作为异型期权与普通期权之间的联系来理解。我们将使用在[第5章](ch05.html
    "第5章 外汇衍生品")中介绍的相同术语，*外汇衍生品*，该章还详细介绍了更多关于货币和普通期权的内容。
- en: A glance beyond vanillas
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 透视普通期权
- en: '*Haug (2007a)* comprehensively covers the collection of pricing formulas for
    around 100 exotic derivatives. The `fOptions` and `fExoticOptions` packages are
    based on this book. *Wilmott (2006)*, *Taleb (1997)*, and *DeRosa (2011)* describe
    a lot of practical issues about them.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '*Haug (2007a)* 全面覆盖了大约100种异型衍生品的定价公式。`fOptions` 和 `fExoticOptions` 包都是基于这本书的。*Wilmott
    (2006)*、*Taleb (1997)* 和 *DeRosa (2011)* 讨论了很多关于这些期权的实际问题。'
- en: The first impression could be that there are way too many exotic options. There
    are many ways of classification. Market makers talk about different generations
    of exotics, such as first generation, second generation, and so on. Their approach
    is from a hedging point of view. We will use a slightly different angle, the end-user
    approach, and classify the options based on their main exotic feature.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 第一印象可能是异型期权种类繁多。它们的分类方式有很多种。市场做市商讨论不同世代的异型期权，如第一代、第二代等等。他们的分类方法是从对冲的角度出发。我们将采用稍有不同的角度，即最终用户的角度，按照期权的主要异型特征来分类。
- en: 'Asian type exotics are about the average. It could be an average rate or an
    average strike, and it could also be an arithmetic or geometric average. These
    options are path dependent; that is, their value at expiry is not purely a function
    of the underlying price at expiry but the total path. Asian options are cheaper
    than the vanillas since the volatility of the average price is lower than the
    volatility of the price itself:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 亚洲型期权大致属于平均型期权。它可以是一个平均利率或平均执行价，也可以是算术平均或几何平均。这些期权是路径依赖的；也就是说，它们在到期时的价值不仅仅是到期时标的价格的函数，还取决于整个路径。由于平均价格的波动率低于标的价格本身的波动率，亚洲期权比普通期权便宜：
- en: '[PRE0]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Barrier type exotics are also path-dependent options. There could be one or
    two barriers. Each barrier could be either **knock-in (KI)** or **knock-out (KO)**.
    During the lifetime of the option, the price of the underlying is monitored, and
    if it is traded at or over the barrier, there will be a knock event. Options with
    KI barriers become exercisable if the knock event occurs. Options with KO barriers
    start their life as exercisable options, however, they become non-exercisable
    if the knock event occurs. If there are two barriers, both of them could be the
    same type: **double-knock-out (DKO)** and **double-knock-in (DKI)**, or it could
    be a **knock-in-knock-out (KIKO)** type.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 屏障型异型期权也是路径依赖型期权。它们可能有一个或两个屏障。每个屏障可能是 **触及入场 (KI)** 或 **触及出场 (KO)**。在期权的有效期内，标的价格会被监控，如果价格达到或超过屏障，就会发生触及事件。具有
    KI 屏障的期权在触及事件发生后变得可以行使。具有 KO 屏障的期权在开始时是可以行使的，但如果发生触及事件，就会变得不可行使。如果有两个屏障，它们可以是相同类型的：**双重触及出场
    (DKO)** 和 **双重触及入场 (DKI)**，或者是 **触及入场触及出场 (KIKO)** 类型。
- en: 'If all other parameters are set to be the same, then the following equation
    holds:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果其他所有参数相同，那么以下方程成立：
- en: '*KI + KO = vanilla.*'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '*KI + KO = 普通期权*。'
- en: 'This is because in this case, KI and KO options are mutually exclusive, but
    one of them will be exercisable for sure. The first parameters `cuo` and `cui`
    are flags for call-up-and-out and call-up-and-in. Next, we check for the following
    condition:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为在这种情况下，KI 和 KO 期权是互斥的，但它们中的一个一定会被行使。第一个参数 `cuo` 和 `cui` 是表示“打击出场”和“打击入场”的标志。接下来，我们检查以下条件：
- en: '*vanilla - KO - KI = 0.*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*普通期权 - KO - KI = 0*。'
- en: 'The following code illustrates the preceding condition:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码演示了前述条件：
- en: '[PRE1]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Based on the same logic of *DKO + DKI = vanilla*, we can even state that *KO
    - DKO = KIKO*. So, the KIKO options start as non-exercisable, and as long as both
    the short DKO and the long KO are alive, they neutralize each other. Should the
    short DKO die and the long KO survive, then it is a KI event for the KIKO option.
    However, the KIKO can still die even after being knocked-in. Naturally, the KIKO
    + DKO = KO approach leads to the same conclusion.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 基于*DKO + DKI = vanilla*的相同逻辑，我们甚至可以表示*KO - DKO = KIKO*。因此，KIKO期权从一开始就是不可行使的，只要短期DKO和长期KO都有效，它们就会互相中和。如果短期DKO失效而长期KO依然有效，那么对KIKO期权来说就是KI事件。然而，即使在被击中后，KIKO期权仍然可能会失效。当然，KIKO
    + DKO = KO的方式也得出相同的结论。
- en: Also, there are some important convergence features among barrier options. Based
    on the KO + KI= vanilla equation, the KO converges into vanilla as we push the
    barrier further from the spot, since KI converges into zero if we push the barrier
    further from the spot. The next chart will to demonstrate this feature.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，障碍期权之间存在一些重要的收敛特征。根据KO + KI = vanilla方程，当我们将障碍推得远离现货时，KO会收敛到vanilla，因为KI会随着障碍远离现货而收敛为零。接下来的图表将展示这一特征。
- en: '[PRE3]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The following output is the result of the preceding code:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 以下输出是前面代码的结果：
- en: '![A glance beyond vanillas](img/2078OT_07_01.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![一瞥超越vanilla](img/2078OT_07_01.jpg)'
- en: Similarly, double barrier options converge into single barrier ones if one of
    the barriers starts to get unimportant and converges towards plain vanillas if
    both the barriers are getting unimportant.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，当其中一个障碍变得不重要时，双障碍期权会收敛为单一障碍期权，如果两个障碍都变得不重要，它们会收敛为普通vanilla期权。
- en: Thanks to the preceding mentioned parities, most of the time, finding pricing
    formulas for KO options is enough. Although this is of huge help, often, pricing
    a KO could be still very tricky. Replicating the KO event is based on a technique
    that tries to build a portfolio made of vanillas that have exactly zero worth
    when the knock event occurs, so at that point, they can be closed for free. There
    are two famous methods for this, explained by *Derman-Ergener-Kani (1995)* and
    *Carr-Ellis-Gupta (1998)*.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 得益于前述的对称性，大多数情况下，找到KO期权的定价公式就足够了。尽管这非常有帮助，但定价KO期权往往仍然非常棘手。复制KO事件的技术是通过一种尝试建立一个由vanilla期权组成的投资组合，这些期权在击中事件发生时的价值恰好为零，因此在该时刻它们可以免费关闭。对此有两种著名的方法，分别由*Derman-Ergener-Kani
    (1995)*和*Carr-Ellis-Gupta (1998)*解释。
- en: The so-called Black-Scholes surface is a 3D chart where the option price can
    be shown as a function of time to maturity and the underlying price. Since some
    of the exotic pricing functions can go crazy under extreme input circumstances,
    it is advisable to use our financial knowledge that an option price can never
    go below zero.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 所谓的Black-Scholes曲面是一个三维图表，其中期权价格可以作为到期时间和标的价格的函数显示。由于一些复杂的定价函数在极端输入情况下可能会出现异常，因此建议利用我们的金融知识，期权价格永远不能低于零。
- en: 'The following is the code for the Black-Scholes surface:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Black-Scholes曲面的代码：
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The preceding code yields the following output:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 前面代码的输出结果如下：
- en: '![A glance beyond vanillas](img/2078OT_07_02.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![一瞥超越vanilla](img/2078OT_07_02.jpg)'
- en: 'First, we prepared the Black-Scholes surface of a plain vanilla call option.
    However, the `BS_surface` code can be used for many more purposes. Just like the
    fact that the concept of the Black-Scholes surface can be used for any kind of
    single underlying dependent derivative, if we have a pricing function, it can
    be used as the `FUN` argument:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们准备了一个普通vanilla看涨期权的Black-Scholes曲面。然而，`BS_surface`代码可以用于更多的目的。就像Black-Scholes曲面的概念可以用于任何种类的单一标的相关衍生品一样，如果我们有一个定价函数，它可以作为`FUN`参数使用：
- en: '[PRE5]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The following screenshot is the result of the preceding code:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图是前面代码的结果：
- en: '![A glance beyond vanillas](img/2078OT_07_03.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![一瞥超越vanilla](img/2078OT_07_03.jpg)'
- en: It is easy to see that compared to the plain vanilla call, the up-and-out call
    option has a limited value.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 很容易看出，与普通vanilla看涨期权相比，上涨打破期权的价值是有限的。
- en: On [page 156], we use this same function to chart the BS Surface for a Double-no-touch
    option.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第156页]，我们使用相同的函数绘制了双触碰期权的BS曲面。
- en: 'Binary options are exotics that have a fixed contingent payout. The name comes
    from the feature that they have only two possible outcomes: either pay a fixed
    amount or don''t pay at all. They have the 0-1 relationship in the options world.
    Binary features could be mixed with the barrier feature; thus, they become path
    dependent. A One-Touch (OT) option pays only if a knock event occurred during
    its lifetime, while a No-Touch pays only if no knock event occurred.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 二元期权是一种外来期权，其支付方式是固定的应急支付。其名称来自于它只有两种可能的结果：要么支付一个固定金额，要么完全不支付。它们在期权世界中具有0-1关系。二元特性可以与障碍特性结合，从而变得路径依赖。单触及（OT）期权仅在其生命周期内发生敲击事件时支付，而不触及期权（No-Touch）则仅在没有发生敲击事件时支付。
- en: 'There could be two barriers associated with the binaries, thus getting the
    Double-One-Touch and Double-No-Touch options. Based on no arbitrage arguments,
    the following equations must hold:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 二元期权可能与两个障碍相关，从而得到双一触及和双不触及期权。基于无套利原理，必须满足以下方程：
- en: '*NT + OT = T-Bill*'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '*NT + OT = T-Bill*'
- en: '*DNT + DOT = T-Bill*'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '*DNT + DOT = T-Bill*'
- en: Convergence can be seen here too, similar to the cases we have shown for the
    barriers. A DNT converges to an NT if one of the barriers is far enough, and converges
    to a T-Bill if both the barriers are far enough. A pricing function for a DNT
    is the Jack-of-all-trades of the binaries, similar to the DKO option for the barrier
    type.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 收敛性在这里也能看到，类似于我们之前展示的障碍案例。如果其中一个障碍足够远，DNT会收敛到NT；如果两个障碍都足够远，它会收敛到T-Bill。DNT的定价函数是二元期权中的“万金油”，类似于障碍类型的DKO期权。
- en: Lookback options are also path dependent. The lookback feature is very convenient.
    At expiry, the holder of the position can look back and choose the best price
    from the path of the underlying. For a floating rate lookback, the option holder
    can look back for the strike price. For a fixed rate lookback, the holder can
    exercise the option against any price on which the underlying was traded during
    the lifetime of the option. *Taleb (1997)* shows how lookbacks can be replicated
    by an infinite chain of KIKO options. In this sense, this is at least second generation
    exotic, since we need exotics as building blocks to be able to replicate a lookback.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 回望期权也是路径依赖的。回望特性非常方便。到期时，持有者可以回顾并选择从标的物路径中得到的最佳价格。对于浮动利率回望，期权持有者可以回溯选择执行价格；对于固定利率回望，持有者可以在期权生命周期内选择任何价格进行行权。*Taleb
    (1997)*展示了如何通过无限链条的KIKO期权来复制回望期权。从这个意义上讲，这至少是第二代的外来期权，因为我们需要将外来期权作为构建模块来复制回望期权。
- en: More than one underlying is also a common exotic feature. Two examples have
    already been discussed in the *exchange options* and *quanto options* sections
    of [Chapter 5](ch05.html "Chapter 5. FX Derivatives"), *FX Derivatives*. However,
    there are plenty more. Best-of and worst-of (also called rainbow) options are
    give the best or the worst performing underlying from a basket. The spread option
    is very similar to a vanilla option with the twist that the underlying of this
    option is the difference of two assets. These are just a few examples, which are
    enough to show that not surprisingly, in all of these cases, correlation plays
    an important role. Also, these features can be mixed with barrier or lookback
    or Asian features that result in an almost endless number of combinations. In
    this chapter, we will not be discussing these types any further.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 多个标的物也是一种常见的外来特性。两个例子已经在[第5章](ch05.html "第5章 FX衍生品")的*外汇衍生品*部分讨论过，分别是*交换期权*和*定量期权*。然而，还有许多其他例子。最优和最差（也叫彩虹）期权从一篮子标的物中选择表现最好或最差的标的。价差期权非常类似于普通期权，不同之处在于此期权的标的是两种资产的差价。这只是一些例子，足以表明在所有这些情况下，相关性都起着重要作用。此外，这些特性还可以与障碍、回望或亚洲期权特性相结合，从而产生几乎无限的组合。在本章中，我们不会进一步讨论这些类型。
- en: Greeks – the link back to the vanilla world
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 希腊字母 – 回到普通世界的连接
- en: 'As we explained in the introductory part of this chapter, Greeks are partial
    derivatives. Some important Greeks are as follows:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在本章介绍部分解释的那样，希腊字母是偏导数。一些重要的希腊字母如下：
- en: '**delta**: This denotes the DvalueDspot, which is the change of the option
    price with respect to the change of the underlying spot price'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**delta**：表示DvalueDspot，指的是期权价格相对于标的现货价格变化的变化量'
- en: '**gamma**: This denotes the DdeltaDspot'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**gamma**：表示DdeltaDspot'
- en: '**vega**: This denotes the DvalueDvolatility'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**vega**：表示DvalueDvolatility'
- en: '**theta**: This denotes the DvalueDtime'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**theta**：表示DvalueDtime'
- en: '**rho**: This denotes the DvalueDinterest rate'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**rho**：表示D值的利率'
- en: In some simple cases, these partial derivatives can be found analytically. For
    example, the `fOptions` package includes the `GBSGreeks` function that gives the
    Greeks for vanillas.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在一些简单的情况下，这些偏导数可以通过解析方法找到。例如，`fOptions`包包括一个`GBSGreeks`函数，它提供了经典期权的希腊字母。
- en: Analytical Greeks are convenient; however, there are two problems with them.
    The first problem is that market-traded parameters are not changing in infinitesimal
    small increments. For example, on the New York Stock Exchange, the smallest possible
    change in the stock price is one cent. The stock price either changes at least
    one cent or there is no change at all. On the OTC (over-the-counter), FX market
    traders are quoting volatility as an integer multiple of 0.0005\. The second problem
    with analytical Greeks comes from the fact that for many exotics, we have no closed
    formula. We still need to know the Greeks anyway, because we would like to sum
    them up to get the Greeks for the portfolio. Adding up analytical Greeks and numerical
    ones can lead to errors, so using numerical Greeks is a much safer way.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 解析希腊字母非常方便；然而，它们存在两个问题。第一个问题是，市场交易的参数并不是在无穷小的增量中变化。例如，在纽约证券交易所，股票价格的最小变化为一美分。股票价格要么变化至少一美分，要么没有变化。在场外交易（OTC）外汇市场，交易者报价波动率时通常是0.0005的整数倍。第二个问题是，许多外来期权没有封闭的公式。我们仍然需要知道希腊字母，因为我们希望将它们加起来以获得整个投资组合的希腊字母。将解析希腊字母和数值希腊字母相加可能会导致错误，因此使用数值希腊字母是一种更安全的方法。
- en: 'The `GetGreeks` function calculates any Greeks for any pricing function:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`GetGreeks`函数计算任何定价函数的希腊字母：'
- en: '[PRE6]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: OTC market makers do not quote FX volatility in any quantities, but normally,
    as an integer multiple of 0.0005, a typical quote for AUDUSD at-the-money volatility
    is 5.95 percent/6.05 percent. Of course, for exchange-traded derivatives that
    are quoted in price instead of volatility, the price-change-implied volatility
    change could be smaller than 0.0005.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 场外市场做市商不会以任何数量报价外汇波动率，但通常会作为0.0005的整数倍报价，典型的AUDUSD平值波动率报价为5.95%/6.05%。当然，对于以价格报价而非波动率的交易所衍生品，价格变化隐含的波动率变化可能小于0.0005。
- en: So when we calculate vega numerically, we should set epsilon to 0.0005 as a
    market consistent smallest possible change; for example, to calculate a delta
    of an AUDUSD option, we can set epsilon as 0.0001 (one pip), or for a stock, we
    can set epsilon as 0.01 (one cent). It is also useful to adjust epsilon to 1/365
    (one day) for theta, and to 0.0001 (one basis point) for rho.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，当我们计算vega时，应该将epsilon设置为0.0005，这是市场一致的最小可能变化；例如，要计算AUDUSD期权的delta，我们可以将epsilon设置为0.0001（一个点），对于股票，我们可以将epsilon设置为0.01（一美分）。调整epsilon为1/365（一天）用于theta，0.0001（一个基点）用于rho也是有用的。
- en: 'The following code plots the delta, vega theta, and rho for a `FloatingStrikeLookbackOption`:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码绘制了`FloatingStrikeLookbackOption`的delta、vega、theta和rho：
- en: '[PRE7]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The preceding code gives the following output:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码产生以下输出：
- en: '![Greeks – the link back to the vanilla world](img/2078OT_07_04.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![希腊字母 – 回到经典期权世界的链接](img/2078OT_07_04.jpg)'
- en: Pricing the Double-no-touch option
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定价双重无触碰期权
- en: A Double-no-touch (DNT) option is a binary option that pays a fixed amount of
    cash at expiry. Unfortunately, the `fExoticOptions` package does not contain a
    formula for this option at present. We will show two different ways to price DNTs
    that incorporate two different pricing approaches. In this section, we will call
    the function `dnt1`, and for the second approach, we will use `dnt2` as the name
    for the function.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 双重无触碰（DNT）期权是一种二元期权，在到期时支付固定现金金额。不幸的是，`fExoticOptions`包目前没有此期权的公式。我们将展示两种不同的定价方式来定价DNT，其中包含两种不同的定价方法。在本节中，我们将使用`dnt1`作为第一个方法的函数名，对于第二种方法，我们将使用`dnt2`作为函数名。
- en: '*Hui (1996)* showed how a one-touch double barrier binary option can be priced.
    In his terminology, "one-touch" means that a single trade is enough to trigger
    the knock-out event, and "double barrier" binary means that there are two barriers
    and this is a binary option. We call this DNT as it is commonly used on the FX
    markets. This is a good example for the fact that many popular exotic options
    are running under more than one name. In *Haug (2007a)*, the Hui-formula is already
    translated into the generalized framework. *S*, *r*, *b*, *σ*, and *T* have the
    same meaning as in [Chapter 5](ch05.html "Chapter 5. FX Derivatives"), *FX Derivatives*.
    K means the payout (dollar amount) while L and U are the lower and upper barriers.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '*Hui (1996)*展示了如何为单触及双障碍二元期权定价。在他的术语中，“单触及”意味着单一交易足以触发击穿事件，而“双障碍”二元期权意味着存在两个障碍，这是一种二元期权。我们称之为DNT，因为它在外汇市场中被广泛使用。这是一个很好的例子，说明许多流行的另类期权有多种不同的名称。在*Haug
    (2007a)*中，Hui公式已被转化为广义框架。*S*、*r*、*b*、*σ*和*T*的含义与[第五章](ch05.html "第五章 外汇衍生品")中的含义相同，*外汇衍生品*。K表示支付金额（美元数额），而L和U分别是下限和上限障碍。'
- en: '![Pricing the Double-no-touch option](img/2078OT_07_05.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_05.jpg)'
- en: Where, ![Pricing the Double-no-touch option](img/2078OT_07_06.jpg), ![Pricing
    the Double-no-touch option](img/2078OT_07_07.jpg), ![Pricing the Double-no-touch
    option](img/2078OT_07_08.jpg).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，![定价双无触及期权](img/2078OT_07_06.jpg)，![定价双无触及期权](img/2078OT_07_07.jpg)，![定价双无触及期权](img/2078OT_07_08.jpg)。
- en: 'Implementing the *Hui (1996)* function to R starts with a big question mark:
    what should we do with an infinite sum? How high a number should we substitute
    as infinity? Interestingly, for practical purposes, small number like 5 or 10
    could often play the role of infinity rather well. *Hui (1996)* states that convergence
    is fast most of the time. We are a bit skeptical about this since α will be used
    as an exponent. If b is negative and sigma is small enough, the *(S/L)^α* part
    in the formula could turn out to be a problem.'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 将*Hui (1996)*函数实现到R中时，首先面临一个大问号：我们该如何处理无限级数？我们应该用多大的数字来替代无穷大？有趣的是，对于实际用途，像5或10这样的较小数字通常能够很好地充当无穷大的角色。*Hui
    (1996)*指出，大多数情况下收敛是快速的。我们对此有些怀疑，因为α将作为指数使用。如果b为负且σ足够小，公式中的*(S/L)^α*部分可能会成为问题。
- en: 'First, we will try with normal parameters and see how quick the convergence
    is:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将尝试使用常规参数，看看收敛速度如何：
- en: '[PRE8]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The following screenshot shows the result of the preceding code:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了前述代码的结果：
- en: '![Pricing the Double-no-touch option](img/2078OT_07_09.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_09.jpg)'
- en: The Formula Error chart shows that after the seventh step, additional steps
    were not influencing the result. This means that for practical purposes, the infinite
    sum can be quickly estimated by calculating only the first seven steps. This looks
    like a very quick convergence indeed. However, this could be pure luck or coincidence.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 公式误差图表显示，在第七步之后，额外的步骤对结果没有影响。这意味着在实际应用中，可以通过计算前七步来快速估算无限级数。这看起来确实是一个非常快速的收敛。然而，这可能是纯粹的运气或巧合。
- en: 'What about decreasing the volatility down to 3 percent? We have to set N as
    50 to see the convergence:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果将波动率降至3%会怎样？我们必须将N设置为50才能看到收敛：
- en: '[PRE9]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The preceding command gives the following output:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令给出的输出如下：
- en: '![Pricing the Double-no-touch option](img/2078OT_07_10.jpg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_10.jpg)'
- en: Not so impressive? 50 steps are still not that bad. What about decreasing the
    volatility even lower? At 1 percent, the formula with these parameters simply
    blows up. First, this looks catastrophic; however, the price of a DNT was already
    98.75 percent of the payout when we used 3 percent volatility. Logic says that
    the DNT price should be a monotone-decreasing function of volatility, so we already
    know that the price of the DNT should be worth at least 98.75 percent if volatility
    is below 3 percent.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来不太令人印象深刻？50步仍然不算太差。那如果将波动率降得更低呢？在1%的波动率下，这些参数的公式会直接爆炸。首先，这看起来是灾难性的；然而，当我们使用3%的波动率时，DNT的价格已经是支付金额的98.75%。逻辑上讲，DNT价格应当是波动率的单调递减函数，因此我们已经知道，如果波动率低于3%，DNT的价格至少应该是98.75%。
- en: Another issue is that if we choose an extreme high U or extreme low L, calculation
    errors emerge. However, similar to the problem with volatility, common sense helps
    here too; the price of a DNT should increase if we make U higher or L lower.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个问题是，如果我们选择极高的U或极低的L，就会出现计算错误。然而，类似于波动性问题，常识在这里同样有效；如果我们将U提高或L降低，DNT的价格应该会上升。
- en: There is still another trick. Since all the problem comes from the α parameter,
    we can try setting b as 0, which will make α equal to 0.5\. If we also set r to
    0, the price of a DNT converges into 100 percent as the volatility drops.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 还有一个技巧。由于所有问题都来源于α参数，我们可以尝试将b设置为0，这样α将等于0.5。如果我们还将r设置为0，DNT的价格将随着波动率的下降而趋于100%。
- en: 'Anyway, whenever we substitute an infinite sum by a finite sum, it is always
    good to know when it will work and when it will not. We made a new code that takes
    into consideration that convergence is not always quick. The trick is that the
    function calculates the next step as long as the last step made any significant
    change. This is still not good for all the parameters as there is no cure for
    very low volatility, except that we accept the fact that if implied volatilities
    are below 1 percent, than this is an extreme market situation in which case DNT
    options should not be priced by this formula:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，每当我们用有限的和替代无限的和时，了解何时有效，何时无效总是很重要。我们编写了一个新代码，考虑到收敛并不总是迅速的。诀窍在于，只要最后一步产生了任何显著变化，函数就会计算下一步。对于所有参数来说，这仍然不是完全适用，因为对非常低波动性的情况没有解决办法，除非我们接受这样一个事实：如果隐含波动率低于1%，这就是一个极端市场情形，在这种情况下，DNT期权不应该通过这个公式来定价：
- en: '[PRE10]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now that we have a nice formula, it is possible to draw some DNT-related charts
    to get more familiar with this option. Later, we will use a particular AUDUSD
    DNT option with the following parameters: L equal to 0.9200, U equal to 0.9600,
    K (payout) equal to USD 1 million, T equal to 0.25 years, volatility equal to
    6 percent, r_AUD equal to 2.75 percent, r_USD equal to 0.25 percent, and b equal
    to -2.5 percent. We will calculate and plot all the possible values of this DNT
    from 0.9200 to 0.9600; each step will be one pip (0.0001), so we will use 2,000
    steps.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了一个不错的公式，可以绘制一些与DNT相关的图表，以便更熟悉这种期权。稍后，我们将使用一个特定的AUDUSD DNT期权，其参数如下：L等于0.9200，U等于0.9600，K（支付金额）等于100万美元，T等于0.25年，波动率等于6%，r_AUD等于2.75%，r_USD等于0.25%，b等于-2.5%。我们将计算并绘制从0.9200到0.9600的所有可能的DNT值；每步为一个点（0.0001），因此我们将使用2000步。
- en: 'The following code plots a graph of price of underlying:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码绘制了基础资产价格的图表：
- en: '[PRE11]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The following output is the result of the preceding code:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 以下输出是前述代码的结果：
- en: '![Pricing the Double-no-touch option](img/2078OT_07_11.jpg)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![定价双触碰期权](img/2078OT_07_11.jpg)'
- en: It can be clearly seen that even a small change in volatility can have a huge
    impact on the price of a DNT. Looking at this chart is an intuitive way to find
    that vega must be negative. Interestingly enough even just taking a quick look
    at this chart can convince us that the absolute value of vega is decreasing if
    we are getting closer to the barriers.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 很明显，即使是波动性的小幅变化也会对DNT的价格产生巨大影响。通过查看这张图，我们可以直观地发现vega必须是负值。有趣的是，甚至仅仅快速浏览这张图，也足以让我们相信，当我们接近障碍时，vega的绝对值在减少。
- en: Most end users think that the biggest risk is when the spot is getting close
    to the trigger. This is because end users really think about binary options in
    a binary way. As long as the DNT is alive, they focus on the positive outcome.
    However, for a dynamic hedger, the risk of a DNT is not that interesting when
    the value of the DNT is already small.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数终端用户认为最大风险是在现货接近触发点时。这是因为终端用户通常以二元的方式来考虑二元期权。只要DNT还有效，他们就会专注于积极的结果。然而，对于动态对冲者来说，当DNT的价值已经很小的时候，DNT的风险就不那么引人关注了。
- en: It is also very interesting that since the T-Bill price is independent of the
    volatility and since the DNT + DOT = T-Bill equation holds, an increasing volatility
    will decrease the price of the DNT by the exact same amount just like it will
    increase the price of the DOT. It is not surprising that the vega of the DOT should
    be the exact mirror of the DNT.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个非常有趣的现象是，由于T-Bill价格与波动性无关，并且DNT + DOT = T-Bill公式成立，因此波动性的增加将以完全相同的金额降低DNT的价格，就像它会增加DOT的价格一样。毫不奇怪，DOT的vega应该是DNT的精确镜像。
- en: 'We can use the `GetGreeks` function to estimate vega, gamma, delta, and theta.
    For gamma we can use the GetGreeks function in the following way:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`GetGreeks`函数来估算维加、伽玛、德尔塔和塞塔。对于伽玛，我们可以通过以下方式使用GetGreeks函数：
- en: '[PRE12]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The following chart is the result of the preceding code:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表是上面代码的结果：
- en: '![Pricing the Double-no-touch option](img/2078OT_07_12.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_12.jpg)'
- en: 'After having a look at the value chart, the delta of a DNT is also very close
    to intuitions; if we are coming close to the higher barrier, our delta gets negative,
    and if we are coming closer to the lower barrier, the delta gets positive as follows:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 看过价值图表后，可以发现DNT的德尔塔值也与直觉非常接近；如果接近上边界，德尔塔变为负值；而接近下边界时，德尔塔变为正值，如下所示：
- en: '[PRE13]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![Pricing the Double-no-touch option](img/2078OT_07_13.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_13.jpg)'
- en: This is really a non-convex situation; if we would like to do a dynamic delta
    hedge, we will lose money for sure. If the spot price goes up, the delta of the
    DNT decreases, so we should buy some AUDUSD as a hedge. However, if the spot price
    goes down, we should sell some AUDUSD. Imagine a scenario where AUDUSD goes up
    20 pips in the morning and then goes down 20 pips in the afternoon. For a dynamic
    hedger, this means buying some AUDUSD after the price moved up and selling this
    very same amount after the price comes down.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 这真的是一种非凸的情况；如果我们想进行动态德尔塔对冲，肯定会亏钱。如果现货价格上涨，DNT的德尔塔会减少，所以我们应该购买一些AUDUSD来对冲。然而，如果现货价格下跌，我们应该卖出一些AUDUSD。想象一个场景，上午AUDUSD上涨20个点，下午又下跌20个点。对于动态对冲者来说，这意味着在价格上涨后购买一些AUDUSD，然后在价格下跌后卖出同样数量的AUDUSD。
- en: 'The changing of the delta can be described by the gamma as follows:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 德尔塔的变化可以通过伽玛描述，如下所示：
- en: '[PRE14]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![Pricing the Double-no-touch option](img/2078OT_07_14.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_14.jpg)'
- en: Negative gamma means that if the spot goes up, our delta is decreasing, but
    if the spot goes down, our delta is increasing. This doesn't sound great. For
    this inconvenient non-convex situation, there is some compensation, that is, the
    value of theta is positive. If nothing happens, but one day passes, the DNT will
    automatically worth more.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 负伽玛意味着如果现货上涨，我们的德尔塔会减少；而如果现货下跌，我们的德尔塔会增加。这听起来并不理想。对于这种不方便的非凸情况，有一定的补偿，即塞塔值为正。如果没有其他变化，只有一天过去，DNT将自动变得更值钱。
- en: 'Here, we use theta as minus 1 times the partial derivative, since if (T-t)
    is the time left, we check how the value changes as t increases by one day:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们使用塞塔等于负1倍的偏导数，因为如果(T-t)是剩余时间，我们检查随着t增加一天，价值的变化：
- en: '[PRE15]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![Pricing the Double-no-touch option](img/2078OT_07_15.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_15.jpg)'
- en: The more negative the gamma, the more positive our theta. This is how time compensates
    for the potential losses generated by the negative gamma.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 伽玛越负，塞塔越正。这就是时间如何弥补负伽玛可能带来的损失。
- en: Risk-neutral pricing also implicates that negative gamma should be compensated
    by a positive theta. This is the main message of the Black-Scholes framework for
    vanilla options, but this is also true for exotics. See *Taleb (1997)* and *Wilmott
    (2006)*.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 风险中性定价也意味着负伽玛应该由正塞塔进行补偿。这是Black-Scholes框架在普通期权中的主要信息，但同样适用于衍生品。参见*Taleb (1997)*和*Wilmott
    (2006)*。
- en: 'We already introduced the Black-Scholes surface before; now, we can go into
    more detail. This surface is also a nice interpretation of how theta and delta
    work. It shows the price of an option for different spot prices and times to maturity,
    so the slope of this surface is the theta for one direction and delta for the
    other. The code for this is as follows:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前已经介绍过Black-Scholes曲面；现在可以更详细地讨论。这个曲面也是一个很好的解释，说明了塞塔和德尔塔如何工作。它展示了期权在不同现货价格和到期时间下的价格，因此，这个曲面的斜率代表了一个方向上的塞塔和另一个方向上的德尔塔。代码如下：
- en: '[PRE16]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The preceding code gives the following output:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的代码给出了以下输出：
- en: '![Pricing the Double-no-touch option](img/2078OT_07_16.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![定价双无触及期权](img/2078OT_07_16.jpg)'
- en: We can see what was already suspected; DNT likes when time is passing and the
    spot is moving to the middle of the (L,U) interval.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到之前的猜测得到了验证；DNT更倾向于时间流逝且现货价格接近(L,U)区间的中点。
- en: Another way to price the Double-no-touch option
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 另一种定价双无触及期权的方法
- en: Static replication is always the most elegant way of pricing. The no-arbitrage
    argument will let us say that if, at some time in the future, two portfolios have
    the same value for sure, then their price should be equal any time before this.
    We will show how double-knock-out (DKO) options could be used to build a DNT.
    We will need to use a trick; the strike price could be the same as one of the
    barriers. For a DKO call, the strike price should be lower than the upper barrier
    because if the strike price is not lower than the upper barrier, the DKO call
    would be knocked out before it could become in-the-money, so in this case, the
    option would be worthless as nobody can ever exercise it in-the-money. However,
    we can choose the strike price to be equal to the lower barrier. For a put, the
    strike price should be higher than the lower barrier, so why not make it equal
    to the upper barrier. This way, the DKO call and DKO put option will have a very
    convenient feature; if they are still alive, they will both expiry in-the-money.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 静态复制通常是最优雅的定价方式。无套利理论告诉我们，如果未来某一时刻，两组投资组合的价值必定相等，那么在此之前的任何时刻，它们的价格应该也相等。我们将展示如何利用双击敲出（DKO）期权来构建DNT。我们需要用到一个技巧：执行价可以与某个障碍位相同。对于DKO看涨期权，执行价应低于上方障碍位，因为如果执行价不低于上方障碍位，DKO看涨期权会在成为实值期权之前被敲出，因此该期权将毫无价值，因为没人能以实值行使它。然而，我们可以选择将执行价设为下方障碍位。对于看跌期权，执行价应高于下方障碍位，那为什么不将其设为上方障碍位呢？这样，DKO看涨期权和DKO看跌期权将具有一个非常方便的特点：如果它们仍然有效，它们都会以实值到期。
- en: 'Now, we are almost done. We just have to add the DKO prices, and we will get
    a DNT that has a payout of (U-L) dollars. Since DNT prices are linear in the payout,
    we only have to multiply the result by K*(U-L):'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们差不多完成了。我们只需要加上DKO价格，就能得到一份具有（U-L）美元支付的DNT。由于DNT价格与支付金额是线性关系，我们只需要将结果乘以K*(U-L)：
- en: '[PRE17]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Now, we have two functions for which we can compare the results:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们有两个函数可以进行结果比较：
- en: '[PRE18]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: For a DNT with a USD 1 million contingent payout and an initial market value
    of over 48,000 dollars, it is very nice to see that the difference in the prices
    is only 14 cents. Technically, however, having a second pricing function is not
    a big help since low volatility is also an issue for `dnt2`.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一份拥有100万美元应急支付且初始市场价值超过48,000美元的DNT来说，看到价格差仅为14美分是非常令人欣慰的。然而，从技术上讲，拥有第二个定价函数并不是很有帮助，因为低波动性也是`dnt2`面临的问题。
- en: We will use `dnt1` for the rest of the chapter.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 本章剩余部分我们将使用`dnt1`。
- en: The life of a Double-no-touch option – a simulation
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双触发期权的生命周期 - 一次模拟
- en: 'How has the DNT price been evolving during the second quarter of 2014? We have
    the open-high-low-close type time series with five minute frequency for AUDUSD,
    so we know all the extreme prices:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: DNT价格在2014年第二季度是如何变化的？我们拥有AUDUSD的开盘-最高-最低-收盘类型的时间序列数据，频率为五分钟，因此我们知道所有的极端价格：
- en: '[PRE19]'
  id: totrans-129
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The following is the output for the preceding code:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前述代码的输出：
- en: '![The life of a Double-no-touch option – a simulation](img/2078OT_07_17.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![双触发期权的生命周期 - 一次模拟](img/2078OT_07_17.jpg)'
- en: 'The price of a DNT is shown in red on the right axis (divided by 1000), and
    the actual AUDUSD price is shown in grey on the left axis. The green lines are
    the barriers of 0.9200 and 0.9600\. The chart shows that in 2014 Q2, the AUDUSD
    currency pair was traded inside the (0.9200; 0.9600) interval; thus, the payout
    of the DNT would have been USD 1 million. This DNT looks like a very good investment;
    however, reality is just one trajectory out of an *a priori* almost infinite set.
    It could have happened differently. For example, on May 02, 2014, there were still
    59 days left until expiry, and AUDUSD was traded at 0.9203, just three pips away
    from the lower barrier. At this point, the price of this DNT was only USD 5,302
    dollars which is shown in the following code:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: DNT价格在右轴上以红色显示（单位为千分之一），而实际的AUDUSD价格在左轴上以灰色显示。绿色线条代表0.9200和0.9600的障碍位。图表显示，在2014年第二季度，AUDUSD货币对在（0.9200;
    0.9600）区间内交易，因此DNT的支付将为100万美元。这份DNT看起来是一个非常好的投资；然而，现实只是几乎无限多轨迹中的一个。它本来可能会发生得不一样。例如，在2014年5月2日，距离到期还有59天，AUDUSD交易价为0.9203，离下方障碍位仅差三点。当时，这份DNT的价格只有5,302美元，以下代码显示了这一点：
- en: '[PRE20]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Compare this USD 5,302 to the initial USD 48,564 option price!
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 将这USD 5,302与最初的USD 48,564期权价格进行比较！
- en: 'In the following simulation, we will show some different trajectories. All
    of them start from the same 0.9266 AUDUSD spot price as it was on the dawn of
    April 01, and we will see how many of them stayed inside the (0.9200; 0.9600)
    interval. To make it simple, we will simulate geometric Brown motions by using
    the same 6 percent volatility as we used to price the DNT:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的模拟中，我们将展示一些不同的轨迹。所有轨迹都从 4 月 1 日黎明时的 0.9266 AUDUSD 即期价格开始，我们将查看其中有多少轨迹保持在
    (0.9200; 0.9600) 区间内。为了简化，我们将使用与定价 DNT 时相同的 6% 波动率来模拟几何布朗运动：
- en: '[PRE21]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The following is the output for the preceding code:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前述代码的输出：
- en: '![The life of a Double-no-touch option – a simulation](img/2078OT_07_18.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![双触碰期权的生命周期 - 一次模拟](img/2078OT_07_18.jpg)'
- en: Here, the only surviving trajectory is the red one; in all other cases, the
    DNT hits either the higher or the lower barrier. The line `set.seed(214)` grants
    that this simulation will look the same anytime we run this. One out of five is
    still not that bad; it would suggest that for an end user or gambler who does
    no dynamic hedging, this option has an approximate value of 20 percent of the
    payout (especially since the interest rates are low, the time value of money is
    not important).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，唯一存活的轨迹是红色的；在所有其他情况下，DNT 要么触碰到上界，要么触碰到下界。`set.seed(214)` 这一行确保了每次运行时模拟结果都是一致的。五分之一的存活率还不算太差；它表明对于没有进行动态对冲的最终用户或赌徒来说，这个期权的估算价值大约是支付额的
    20%（尤其是在利率较低、货币时间价值不重要的情况下）。
- en: However, five trajectories are still too few to jump to such conclusions. We
    should check the DNT survivorship ratio for a much higher number of trajectories.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，五条轨迹仍然太少，不能轻易得出结论。我们应该检查更多轨迹下的 DNT 生存率。
- en: The ratio of the surviving trajectories could be a good estimator of the a priori
    real-world survivorship probability of this DNT; thus, the end user value of it.
    Before increasing N rapidly, we should keep in mind how much time this simulation
    took. For my computer, it took 50.75 seconds for N = 5, and 153.11 seconds for
    N = 15.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 存活轨迹的比率可以作为该 DNT 在实际世界中的生存概率的良好估算；因此，它的最终用户价值。在迅速增加 N 的同时，我们应该记住这次模拟花费了多少时间。对于我的计算机，N
    = 5 时花费了 50.75 秒，N = 15 时花费了 153.11 秒。
- en: 'The following is the output for N = 15:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 N = 15 时的输出：
- en: '![The life of a Double-no-touch option – a simulation](img/2078OT_07_19.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![双触碰期权的生命周期 - 一次模拟](img/2078OT_07_19.jpg)'
- en: Now, 3 out of 15 survived, so the estimated survivorship ratio is still 3/15,
    which is equal to 20 percent. Looks like this is a very nice product; the price
    is around 5 percent of the payout, while 20 percent is the estimated survivorship
    ratio. Just out of curiosity, run the simulation for N equal to 200\. This should
    take about 30 minutes.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，15 条轨迹中有 3 条存活，因此估算的生存比率仍然是 3/15，等于 20%。看起来这是一个非常不错的产品；价格大约是支付额的 5%，而生存比率估算为
    20%。出于好奇，运行一次 N 等于 200 的模拟。这应该会花费大约 30 分钟。
- en: 'The following is the output for N = 200:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 N = 200 时的输出：
- en: '![The life of a Double-no-touch option – a simulation](img/2078OT_07_20.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![双触碰期权的生命周期 - 一次模拟](img/2078OT_07_20.jpg)'
- en: The results are shocking; now, only 12 out of 200 survive, and the ratio is
    only 6 percent! So to get a better picture, we should run the simulation for a
    larger N.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 结果令人震惊；现在，200 条轨迹中只有 12 条存活，生存比率仅为 6%！因此，为了获得更好的结果，我们应该对更大的 N 进行模拟。
- en: The movie *Whatever Works* by *Woody Allen* (starring Larry David) is 92 minutes
    long; in simulation time, that is N = 541\. For this N = 541, there are only 38
    surviving trajectories, resulting in a survivorship ratio of 7 percent.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '*伍迪·艾伦*（*Woody Allen*）执导的电影 *Whatever Works*（由拉里·大卫主演）长 92 分钟；在模拟时间中，这相当于 N
    = 541。对于这个 N = 541，只有 38 条轨迹存活，生存比率为 7%。'
- en: '![The life of a Double-no-touch option – a simulation](img/2078OT_07_21.jpg)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![双触碰期权的生命周期 - 一次模拟](img/2078OT_07_21.jpg)'
- en: What is the real expected survivorship ratio? Is it 20 percent, 6 percent, or
    7 percent? We simply don't know at this point. Mathematicians warn us that the
    law of large numbers requires large numbers, where large is much more than 541,
    so it would be advisable to run this simulation for as large an N as time allows.
    Of course, getting a better computer also helps to do more N during the same time.
    Anyway, from this point of view, *Hui's (1996)* relatively fast converging DNT
    pricing formula gets some respect.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，真正的预期存活比率是多少？是20%、6%还是7%？我们现在根本不知道。数学家提醒我们，大数法则要求较大的样本量，其中“较大”远远超过541，因此，建议在时间允许的情况下，尽可能使用更大的N来运行这个模拟。当然，获取更好的计算机也有助于在相同的时间内进行更多的N。无论如何，从这个角度看，*Hui（1996）*
    相对较快收敛的DNT定价公式得到了些许尊重。
- en: 'So far, we have used the very same stochastic process for pricing that we used
    for the simulation. Common sense says that in some cases, market-implied volatility
    could be biased as either higher or lower than the expected volatility. Not surprisingly,
    running the simulation for these two conditions, N = 200 and sigma = 5.5 percent,
    results in more surviving trajectories, 15 for this seed. Running the simulation
    for N = 200 and sigma = 6.5 percent results in fewer surviving trajectories: nine
    for this seed. This again shows the high impact of vega in a very intuitive way.
    The number of surviving trajectories, which can be 9, 12, or 15, mostly depends
    on the volatility of the process. Survivorship rates are 4.5 percent, 6 percent,
    or 7.5 percent. This also raises a more philosophical question: what about risk
    premium? If the market needs vega, it could happen that we can purchase a DNT
    based on 6 percent volatility even if we expect 5.5 percent volatility. In some
    tense circumstances, the market could be really vega-thirsty. In these cases,
    risk premium is included.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们使用了与模拟中相同的随机过程进行定价。常识告诉我们，在某些情况下，市场隐含波动率可能会偏高或偏低于预期波动率。毫不奇怪，在这两种条件下运行模拟，N
    = 200和sigma = 5.5%的情况下，结果是更多的存活轨迹，15条轨迹来自这个种子。而在N = 200和sigma = 6.5%的情况下，结果是较少的存活轨迹：这个种子只有九条轨迹。这再次以非常直观的方式显示了vega的高影响力。存活轨迹的数量，可能是9、12或15，主要取决于过程的波动性。存活率为4.5%、6%或7.5%。这也引发了一个更哲学性的问题：那风险溢价呢？如果市场需要vega，可能会出现即使我们预期波动率为5.5%，也能基于6%波动率购买DNT的情况。在一些紧张的情况下，市场可能真的很渴望vega。在这些情况下，风险溢价是包含在内的。
- en: Derivative pricing always assumes dynamic hedging because we are looking for
    the marginal cost of producing such an instrument then we use the no-arbitrage
    argument. Some market players are actually trying to play this strategy and become
    providers for the derivatives, like a factory. They are willing to take any side
    of a deal, since they will eliminate almost all of their risks by almost continuous
    dynamic hedging. They are the market makers. However, not all market players are
    derivative factories; there are many of them who deliberately seek sensitivities;
    thus, they are not hedging their derivative position. This second group is called
    the market takers or end users. Some of them are looking for sensitivities because
    they already have some and they want to decrease those (natural hedgers). Some
    others don't have any sensitivities at the beginning, but would like to make a
    financial bet (speculators).
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 衍生品定价总是假设动态对冲，因为我们在寻找这种工具的边际生产成本，然后使用无套利理论。实际上，一些市场参与者正在尝试实施这一策略，并成为衍生品的供应商，就像工厂一样。他们愿意接受任何交易的一方，因为通过几乎持续的动态对冲，他们将消除几乎所有的风险。他们就是市场做市商。然而，并非所有市场参与者都是衍生品工厂；其中有许多人故意寻求敏感性，因此，他们并没有对冲他们的衍生品头寸。第二组被称为市场接受者或终端用户。他们中的一些人寻找敏感性，因为他们已经有了一些，并希望减少这些（自然对冲者）。另一些人最初没有任何敏感性，但希望进行金融投机（投机者）。
- en: Interestingly, there could be a significant difference between the price of
    the derivative and its value for the end user. By purchasing a DNT, an end-user
    can make a bet and eventually either get nothing, or win much more than the initial
    price. Is there any risk premium for this bet, or is it similar to a casino? Is
    the real-life expected value of a DNT higher than the risk-neutral expected value
    (which equals the price)? The value in use or the "user experience" could be different
    because the market maker will quote a price based on the implied volatilities.
    In the case of a tense market situation, the demand for vega could push its price
    (that is, the implied volatility) higher than the expected volatility.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，衍生品的价格和最终用户的价值之间可能存在显著差异。通过购买DNT，最终用户可以进行投注，最终要么什么都得不到，要么赢得比最初价格更多的收益。那么，这个赌注是否存在风险溢价，还是类似于赌场？DNT的实际预期值是否高于风险中性预期值（即价格）？使用价值或“用户体验”可能会有所不同，因为做市商将根据隐含波动率报价。在市场紧张的情况下，对Vega的需求可能会推动其价格（即隐含波动率）高于预期波动率。
- en: In this case, anyone who can still sell volatility will get a premium. In the
    case of DNT, getting a premium means that its price will be lower than the real
    life expected value of its payout.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，任何仍然能够卖出波动率的人都会获得溢价。对于DNT来说，获得溢价意味着它的价格将低于其实际预期支付的价值。
- en: What about a **Double-one-touch (DOT)**? Since the Treasury Bill can be seen
    as the sum of a DNT and a DOT, if the DNT is too cheap, then the DOT must be too
    expensive. Thus, these exotic options are easy bets on volatilities; if a speculator
    thinks volatility will be significantly lower than the implied, purchasing a DNT
    is a straightforward bet. If the speculator expects higher volatility than the
    implied, a DOT is the proper bet.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，**双触及期权（DOT）**怎么样呢？由于国库券可以看作是DNT和DOT的总和，如果DNT太便宜，则DOT一定会太贵。因此，这些异国期权是对波动率的简单投注；如果投机者认为波动率会显著低于隐含波动率，那么购买DNT是一种直接的投注。如果投机者预期波动率高于隐含波动率，则DOT是合适的投注方式。
- en: 'In this sense, DNT is similar to a short straddle and DOT is to a long straddle;
    however, binary options are much easier to calibrate to the desired size. A long
    straddle is a long call and long put in the same size, strike price, and expiry.
    A short straddle is the mirror picture: short call and short put. A strangle is
    very similar to a straddle; the only difference is that the strike price of a
    call is not equal but higher than the strike price of the put. Compared to a short
    straddle or a short strangle, betting on volatility is much more convenient by
    purchasing a DNT, because holding a long DNT option position requires no further
    collateral adjustment. DNT is a highly-leveraged product; however, the total amount
    that can be lost is already paid upfront, so it fits to the menu of online trading
    platforms where the typical client is a small retail speculator.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个角度来看，DNT（双触及期权）类似于一个短跨式期权，而DOT（双触及期权）则类似于一个长跨式期权；然而，二元期权更容易调整到所需的规模。一个长跨式期权由同等规模、行权价和到期日的长看涨期权和长看跌期权组成。短跨式期权则是镜像：短看涨期权和短看跌期权。一个跨式期权与宽跨式期权非常相似，唯一的区别在于看涨期权的行权价高于看跌期权的行权价。相比于短跨式期权或宽跨式期权，购买DNT进行波动率投注要方便得多，因为持有一个长DNT期权头寸不需要进一步的抵押调整。DNT是一种高度杠杆化的产品；然而，最大损失金额已经提前支付，因此它适合在线交易平台的菜单，其中典型客户是小型零售投机者。
- en: Based on this logic, the risk premium goes only to players who are willing to
    take a position that is less favorable by other market players. If there is an
    extra demand for volatility, then DNTS will include risk premium, but if there
    is an extra supply for volatility then DOTs will include risk premium. It could
    also happen that the market is in a stable equilibrium and neither DNTs nor DOTs
    include any risk premium.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 基于这一逻辑，风险溢价只会归那些愿意采取不利于其他市场参与者的头寸的玩家。如果波动率需求增加，那么DNT将包含风险溢价，但如果波动率供应增加，则DOT将包含风险溢价。也有可能市场处于稳定的均衡状态，既没有DNT也没有DOT包含任何风险溢价。
- en: Exotic options embedded in structured products
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 嵌入结构化产品中的异国期权
- en: Most of the time, exotic options are traded in camouflage; they are embedded
    in structured bonds or certificates. The exotic behavior is translated into a
    much more user-friendly language that is easier to understand by an everyday investor.
    For example, a binary payout can be calculated into a coupon yield; the investor
    gets a higher coupon if the circumstances let the binary option give its payout.
    A structure that includes a knock-out option could be called an airbag certificate,
    since as far as a long KO option is not knocked-out, it gives some protection
    against market losses, similar to an airbag that protects the driver in case of
    a less serious accident.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数情况下，复杂期权以伪装的方式进行交易；它们被嵌入到结构化债券或证书中。复杂的行为被转化为一种更加用户友好的语言，普通投资者更容易理解。例如，二元支付可以转化为票息收益；如果条件允许二元期权支付收益，投资者将获得更高的票息。包含敲出期权的结构可以被称为气囊证书，因为只要长期KO期权没有被敲出，它就能提供一些对抗市场损失的保护，类似于气囊在较轻微事故中保护驾驶员。
- en: Another example is a turbo certificate, which, most of the time, is just a securitized
    form of a knock-out option with a deep in-the-money strike and a KO close to the
    strike. Lookback options can be found in capital guarantee products with coupons
    linked to the extreme values of stock indices.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个例子是涡轮证书，它通常只是深度实值行权价的敲出期权的证券化形式，敲出点接近行权价。回望期权可以在与股票指数极端值挂钩的资本保障型产品中找到。
- en: As a numerical example, let's take a look at a three-month maturity certificate
    of deposit (CD) that either pays a 3 percent coupon or 0 percent, conditionally
    on the FX market behavior. This capital-guaranteed product can be seen as a portfolio
    of a T-Bill and a binary option. If the 3-month T-bill can be purchased at 99.75
    percent, then there is 0.25 cent on each dollar that can be spent on a binary
    option. The capital at maturity will be granted by the T-Bill part, while the
    binary option will be responsible for the contingent 3 percent coupon.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一个数值示例，我们来看一份三个月到期的定期存单（CD），它根据外汇市场的表现，支付3%的票息或0%。这种资本保障型产品可以看作是国债票据和二元期权的组合。如果这只三个月的国债票据能以99.75%的价格购买，那么每一美元上有0.25美分可以用来购买二元期权。到期时的资本将由国债票据部分提供，而二元期权将负责支付有条件的3%票息。
- en: 'At this point, any binary option would do the trick; purchasing a DNT would
    work too, but there are way too many parameters. Banks must fine-tune all the
    parameters to make the whole construction attractive. In the risk-neutral world
    from the market makers'' point of view, a lower trigger of L=0.9200 with a 3-month
    maturity is almost the same as L=0.9195, with a bit more than a 3-month maturity:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，任何二元期权都能起作用；购买DNT也可以，但参数太多。银行必须精细调整所有参数，以使整个结构对投资者有吸引力。在市场做市商的风险中性世界里，一个触发点为L=0.9200、3个月到期的期权与L=0.9195、略长于3个月到期的期权几乎相同：
- en: '[PRE22]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: This is a very common feature among options, including knock-out events; some
    extra time can most of the time compensate for pushing the barrier a bit further
    from the spot. In the risk-neutral world, the S/L distance is always divided by
    a factor of ![Exotic options embedded in structured products](img/2078OT_07_22.jpg),
    so there is a trade-off; we can make L lower, but in return, we should increase
    the maturity. In the real world, the expectations of end users are driven by their
    subjective or perceived probabilities. Provided that we are not planning to dynamically
    hedge our DNT, we would prefer L = 0.9195 and T = 94 days over L = 0.9200 and
    T = 90 days.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这是期权中一个非常常见的特征，包括敲出事件；额外的时间通常可以补偿将障碍进一步推离现货价格的行为。在风险中性世界中，S/L距离总是被一个因子所除，因此存在权衡；我们可以降低L，但作为交换，我们应该增加到期时间。在现实世界中，最终用户的预期是由他们的主观或感知概率驱动的。假设我们不打算动态对冲我们的DNT，我们更倾向于选择L
    = 0.9195和T = 94天，而不是L = 0.9200和T = 90天。
- en: That is why L, U, and T should be set in a way that helps the product look attractive
    to end users. Also, if the exotic option is embedded into a structure, the structure
    itself should be easy to sell. At the end, most of the structures will be cut
    into smaller, retail-sized pieces, like 1000 USD notional. Of course, each slice
    of the cake will be the same, so for the bank, it can be seen as one huge product.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是为什么L、U和T应设置为有利于让产品对最终用户具有吸引力的方式。而且，如果复杂期权嵌入到某个结构中，结构本身也应当容易销售。最终，大多数结构将被切分成更小的零售化产品，如1000美元的名义金额。当然，每一份“蛋糕”将是相同的，因此对银行来说，它可以看作是一个巨大的产品。
- en: 'Coming back to setting L, U, and T, it is easy to see that the price of a DNT
    is strictly a monotone function of L, U, and T (and also a monotone for volatility).
    Under certain market conditions (S, r, b, and volatility), we set, say, L = 0.9195
    and T = 94 days. Now, we can ask the following inverse pricing question: for what
    U will the price of the DNT be 33 percent of the payout?'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 回到设置L、U和T的问题，我们很容易看出，DNT的价格是L、U和T（以及波动率）的严格单调函数。在特定的市场条件下（S、r、b和波动率），假设我们设置L
    = 0.9195和T = 94天。现在，我们可以提出以下反向定价问题：对于什么U，DNT的价格将是支付金额的33%？
- en: 'This will be the implied upper barrier, implied in a sense that the price is
    already given. Here comes a strange answer: it is not certain that such an implied
    U exists! This is because if we start increasing the upper barrier, the DNT price
    will converge to the price of a No-Touch (NT) option. If this NT is worth less
    than 33 percent, no U will make our DNT worth 33 percent. We use the `BinaryBarrierOption`
    function from the `fExoticOptions` package to price the No-Touch option which
    is depicted in the following code:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这将是隐含的上限障碍，所谓隐含是指价格已经给定。这里有一个奇怪的答案：并不确定是否存在这样的隐含U！这是因为如果我们开始增加上限障碍，DNT的价格将收敛于无触及（No-Touch，NT）期权的价格。如果这个NT的价值小于33%，那么没有U能让我们的DNT价值达到33%。我们使用`fExoticOptions`包中的`BinaryBarrierOption`函数来定价无触及期权，相关代码如下所示：
- en: '[PRE23]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: In the risk-neutral world, if we push U 1000 pips higher, it will become almost
    completely irrelevant, so DNT behaves like an NT.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在风险中性世界中，如果我们将U提高1000个点，它将变得几乎完全不相关，因此DNT的行为就像一个NT。
- en: So, in this case, if we want the DNT to cost 33 percent, we should choose an
    L that is lower than 0.9195\. Next, we set L = 0.9095 and find a U that makes
    the DNT worth 33 percent. At the end of this part, we will show a way to find
    an implied U by using the `implied_U_DNT` function which is shown in the following
    code. Now, suppose we use U = 0.9745 for other reasons.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在这种情况下，如果我们希望DNT的成本为33%，我们应该选择一个低于0.9195的L。接下来，我们设置L = 0.9095并找到一个U，使得DNT的价值为33%。在这一部分结束时，我们将展示如何使用`implied_U_DNT`函数来找到隐含的U，相关代码如下所示。现在，假设我们出于其他原因选择了U
    = 0.9745。
- en: '[PRE24]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This DNT costs only 31.44 percent of the payout, so there will still be some
    room for the bank to have some profit for all the hard work of structuring. Suppose
    the bank can sell a total of USD 100 million of this CD, then 3 months later,
    the bank has to pay to the clients either USD 100 million (0 percent per annum)
    or USD 100.75 million (approximately 3 percent per annum). This contingent promise
    can be hedged by purchasing T-Bills in 100 million USD notional and DNT options
    with 0.75 million USD payout. At the beginning, these instruments cost the bank
    *99.75%*100.000.000+31.44338%*750.000 = USD 99.985.825,35*; thus, the bank makes
    a profit of 14,174.65 USD.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 这个DNT只需要支付31.44%的支付金额，因此银行仍然有一定的空间从所有辛苦的结构工作中获得一些利润。假设银行能够销售总计1亿美元的这种CD，那么3个月后，银行必须向客户支付1亿美元（年利率0%）或1.0075亿美元（大约年利率3%）。这个或有承诺可以通过购买1亿美元名义的国库券和支付75万美元的DNT期权进行对冲。最初，这些工具的成本是银行*99.75%*100.000.000+31.44338%*750.000
    = 99.985.825,35美元*；因此，银行获利14,174.65美元。
- en: In other cases, the implied time to maturity could be an interesting question.
    Under certain market conditions (where S, r, b, and volatility are given) for
    a given (L,U) pair, what is the T that makes the DNT cost, say, 50 percent? Even
    for a very tight (L-U) interval, we can find a T small enough to make the DNT
    price go up to 50 percent; this is also true the other way round; even a very
    wide (L,U) pair will make a DNT worth only 50 percent if there is enough time.
    See *implied_T_DNT* at the end of this section.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在其他情况下，隐含的到期时间可能是一个有趣的问题。在特定的市场条件下（当S、r、b和波动率已知）对于给定的（L，U）对，什么是能让DNT成本达到50%的T？即使对于一个非常紧密的（L-U）区间，我们也能找到一个足够小的T，使得DNT的价格达到50%；反之亦然；即使是一个非常宽的（L，U）对，只要有足够的时间，DNT的价值也会降到50%。请参见本节末尾的*implied_T_DNT*。
- en: Unlike L, U, or T, we cannot choose the volatility parameter deliberately; however,
    calculating the implied volatility could be useful to price other derivatives.
    This is a key pricing concept; risk-neutral pricing is based on comparison. If
    we know the price (and all other parameters) of a DNT, we can find out what volatility
    was used for pricing. See *implied_vol_DNT* at the end of this section.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 与L、U或T不同，我们不能故意选择波动率参数；然而，计算隐含波动率对于定价其他衍生品可能是有用的。这是一个关键的定价概念；风险中性定价基于比较。如果我们知道一个DNT期权的价格（以及所有其他参数），我们就可以找出用于定价的波动率。请参见本节末尾的*implied_vol_DNT*。
- en: 'Next, we will show a lot of implied functions and finally draw the implied
    charts:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将展示许多隐含函数，并最终绘制隐含图表：
- en: '[PRE25]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The following is the output for the preceding code:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是前面代码的输出：
- en: '![Exotic options embedded in structured products](img/2078OT_07_23.jpg)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![嵌入结构化产品中的奇异期权](img/2078OT_07_23.jpg)'
- en: Summary
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: We started this chapter by introducing exotic options. In a brief theoretical
    summary, we explained how exotics and plain vanillas are linked together. There
    are many types of exotics. We showed one possible way of classification that is
    consistent with the `fExoticOptions` package. We showed how the Black-Scholes
    surface (a 3D chart that contains the price of a derivative dependent on time
    and the underlying price) can be constructed for any pricing function.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本章开始时介绍了奇异期权。在简要的理论总结中，我们解释了奇异期权和普通期权是如何相互关联的。奇异期权有很多类型。我们展示了一种与`fExoticOptions`包一致的分类方法。我们展示了如何构建Black-Scholes表面（一个三维图表，包含依赖于时间和标的价格的衍生品价格），适用于任何定价函数。
- en: Pricing of exotic options is just the first step. Market makers keep thousands
    of different options in their trading books. This is possible only because each
    option can be decomposed into certain sensitivities, the so-called Greeks. Being
    partial derivatives, Greeks are additive; thus, the portfolio of derivatives has
    the sum of the Greeks of its elements. The next step was estimating Greeks for
    any derivative-pricing functions. Our numerical method can be calibrated to the
    real market conditions; for many parameters, we already know what the smallest
    possible change is. For example, the smallest change for an interbank AUDUSD fx
    rate is 0.0001\. Even multiple partial derivatives such as gamma or vanna can
    be calculated with this numerical method.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 奇异期权的定价只是第一步。市场做市商在他们的交易簿中持有成千上万种不同的期权。这只有在每个期权可以分解为某些敏感度（即所谓的希腊字母）时才有可能。作为偏导数，希腊字母具有可加性；因此，衍生品组合的希腊字母之和等于其组成部分的希腊字母之和。下一步是估算任何衍生品定价函数的希腊字母。我们的方法可以根据实际市场情况进行校准；对于许多参数，我们已经知道最小的变化量。例如，银行间AUDUSD外汇汇率的最小变化是0.0001。即使是多个偏导数，比如gamma或vanna，也可以通过这种数值方法计算出来。
- en: 'In the second half of this chapter, we focused on one particular exotic option:
    the Double-No-Touch (DNT) binary option. The reason behind this focus is based
    on the popularity of DNT options and also because there are many tricks that can
    be shown on DNTs with conclusions relevant to many other exotic options. We showed
    two different ways to price DNT options. First, we implemented the *Hui (1996)*
    closed form solution, where the price is a result of an infinite sum. The speed
    of convergence is often very quick; however, this is not always the case. We showed
    a practical way of how convergence issues can be handled without wasting too much
    computing time. Another way to price a DNT is a static replication from one DKO
    call and one DKO put option. To price these DKO options, we used the `fExoticOptions`
    package. We found very little difference between the results of the two DNT pricing
    methods.'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的下半部分，我们集中讨论了一种特殊的奇异期权：双无触（DNT）二元期权。之所以专注于DNT期权，主要是因为DNT期权的流行性，以及它们中包含的许多技巧，这些技巧对许多其他类型的奇异期权也具有参考意义。我们展示了两种定价DNT期权的方法。首先，我们实现了*Hui
    (1996)*的封闭形式解，其中价格是一个无限级数的结果。收敛速度通常非常快，但这并非总是如此。我们展示了一种实际的方法，说明如何在不浪费太多计算时间的情况下处理收敛问题。定价DNT的另一种方式是通过静态复制，一个DKO看涨期权和一个DKO看跌期权来实现。为了定价这些DKO期权，我们使用了`fExoticOptions`包。我们发现两种DNT定价方法的结果几乎没有区别。
- en: We showed how the DNT option behaves on real-life data by using 5 minutes frequency
    open-low-high-close type time series of AUDUSD fx rates from the second quarter
    of 2014\. We estimated the survivorship probability of a DNT by simulation to
    show how risk premium can be included in DNTs or DOTs based on the supply-demand
    tensions for volatility. Finally, we showed some practical fine-tuning methods
    to find missing parameters for DNT with a certain price in the case of building
    a structured product by introducing functions to find implied parameters.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过使用2014年第二季度的AUDUSD外汇汇率的5分钟频率开盘-最低-最高-收盘类型时间序列，展示了DNT期权在实际数据中的表现。我们通过模拟估算了DNT的生存概率，以展示如何根据波动率的供需紧张情况将风险溢价纳入DNT或DOT中。最后，我们展示了一些实用的微调方法，通过引入函数来找到隐含参数，以便在构建结构化产品时找到具有特定价格的DNT的缺失参数。
- en: References
  id: totrans-184
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: '**Black, F. and Scholes, M. [1973]**: *The Pricing of Options and Corporate
    Liabilities*, The Journal of Political Economy, 81(3), pp. 637-654'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Black, F. 和 Scholes, M. [1973]**: *期权定价与企业负债*，《政治经济学杂志》，81(3)，第637-654页'
- en: '**Carr, P., Ellis, K. and Gupta, V. [1998]**: *Static hedging of exotic options*,
    Journal of Finance, 53, 1165-1190'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Carr, P., Ellis, K. 和 Gupta, V. [1998]**: *外来期权的静态对冲*，《金融学杂志》，53，第1165-1190页'
- en: '**Derman, E., Ergener, D. and Kani, I. [1995]**: *Static Options Replication*,
    Journal of Derivatives, 2 (4), 78-95'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Derman, E., Ergener, D. 和 Kani, I. [1995]**: *静态期权复制*，《衍生品杂志》，2(4)，第78-95页'
- en: '**DeRosa, D. F. [2011]**: *Options on Foreign Exchange*. Wiley Finance'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**DeRosa, D. F. [2011]**: *外汇期权*。Wiley Finance'
- en: '**Haug, E. G. [2007a]**: *The Complete Guide to Option Pricing Formulas*, 2nd
    edition. The McGraw-Hill Companies'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Haug, E. G. [2007a]**: *期权定价公式完全指南*，第二版。麦格劳-希尔公司'
- en: '**Haug, E. G. [2007b]**: *Derivatives Models on Models*. John Wiley & Sons'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Haug, E. G. [2007b]**: *衍生品模型的模型*。John Wiley & Sons'
- en: '**Hui, C. H. [1996]**: One-touch Double Barrier Binary Option Values, Applied
    Financial Economics, 1996, 6, pp. 343-346'
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hui, C. H. [1996]**: 单触式双障碍二元期权价值，《应用金融经济学》，1996年，第6期，第343-346页'
- en: '**Merton, R. [1973]**: *Theory of Rational Option Pricing*, The Bell Journal
    of Economics and Management Science, 4(1), pp. 141-183'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Merton, R. [1973]**: *理性期权定价理论*，《贝尔经济学与管理科学杂志》，4(1)，第141-183页'
- en: '**Taleb, N. N., [1997]**: *Dynamic Hedging*. John Wiley & Sons'
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Taleb, N. N., [1997]**: *动态对冲*。John Wiley & Sons'
- en: '**Wilmott, P., [2006]**: *Quantitative Finance*, 2nd edition. John Wiley &
    Sons'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Wilmott, P., [2006]**: *量化金融*，第二版。John Wiley & Sons'
